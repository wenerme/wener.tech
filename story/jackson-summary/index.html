<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.4">
<link rel="alternate" type="application/rss+xml" href="/story/rss.xml" title="Wener Live &amp; Life Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/story/atom.xml" title="Wener Live &amp; Life Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-30404720-1","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-30404720-1"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-30404720-1",{})</script>
<link rel="search" type="application/opensearchdescription+xml" title="Wener Live &amp; Life" href="/opensearch.xml"><title data-react-helmet="true">Jackson ä½¿ç”¨æ€»ç»“ | Wener Live &amp; Life</title><meta data-react-helmet="true" property="og:title" content="Jackson ä½¿ç”¨æ€»ç»“ | Wener Live &amp; Life"><meta data-react-helmet="true" name="description" content="åŠ¨æ€ç­–ç•¥"><meta data-react-helmet="true" property="og:description" content="åŠ¨æ€ç­–ç•¥"><meta data-react-helmet="true" property="og:url" content="https://wener.me/story/jackson-summary"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="default"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://wener.me/story/jackson-summary"><link data-react-helmet="true" rel="alternate" href="https://wener.me/story/jackson-summary" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://wener.me/story/jackson-summary" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.82b257c7.css">
<link rel="preload" href="/assets/js/runtime~main.67ea70b0.js" as="script">
<link rel="preload" href="/assets/js/main.25556fba.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/wener-logo-head.svg" alt="Wener Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/wener-logo-head.svg" alt="Wener Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Wener</b></a><a class="navbar__item navbar__link" href="/notes/java/java">ç¬”è®°</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/story">æ•…äº‹</a><a class="navbar__item navbar__link" href="/notes/howto/network/dns-prevent-spoofing">æŒ‡å—</a><a class="navbar__item navbar__link" href="/notes/tool/network/ip-lookup">å·¥å…·</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/wenerme/wener" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ğŸŒ</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="searchBox_1Doo"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_2ahu thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_2hhb margin-bottom--md">Recent posts</div><ul class="sidebarItemList_2xAf"><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/story/k8s-distro-compare">K8S Distro Compare</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/story/out-of-daily-work">æ—¥å¸¸å·¥ä½œä¹‹å¤–</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/story/how-i-build-my-site">æˆ‘çš„ç«™ç‚¹æ˜¯å¦‚ä½•æ„å»ºçš„ï¼Ÿï¼</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/story/macos-wechat-backup">macOS å¾®ä¿¡å¤‡ä»½åŸç†</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/story/agi-vs-ami-vs-ari">å¦‚ä½•é€‰æ‹© Asterisk æ¥å£</a></li></ul></nav></aside><main class="col col--7"><article><header><h1 class="blogPostTitle_GeHD">Jackson ä½¿ç”¨æ€»ç»“</h1><div class="blogPostData_291c margin-vert--md"><time datetime="2019-08-11T00:00:00.000Z">August 11, 2019</time> Â· 4 min read</div><div class="avatar margin-vert--md"><div class="avatar__intro"></div></div></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="åŠ¨æ€ç­–ç•¥"></a>åŠ¨æ€ç­–ç•¥<a class="hash-link" href="#åŠ¨æ€ç­–ç•¥" title="Direct link to heading">#</a></h2><p>åŠ¨æ€ç­–ç•¥æ¦‚å¿µç›¸å¯¹å®½æ³›ï¼Œåœ¨è¿›å…¥æ­£å¼çš„å†…å®¹ä¹‹å‰å®¹æˆ‘å…ˆæ˜ç¡®é¢˜ç›®ä¸­åŠ¨æ€ç­–ç•¥çš„èŒƒç•´ã€‚</p><p>è¿™é‡Œçš„åŠ¨æ€ç­–ç•¥æŒ‡ï¼Œç°åœ¨ä»¥ A æ–¹å¼æ¥åšæŸä»¶äº‹ï¼Œåœ¨è¿‡ç¨‹ä¸­å¯èƒ½è¢«åˆ‡æ¢ä¸º B æ–¹æ¡ˆï¼Œä½†å¯¹ä¸Šå±‚æ¥è¯´æ˜¯æ— æ„Ÿçš„ã€‚ç­–ç•¥å¯ä»¥æ˜ å°„ä¸ºç­–ç•¥æ¨¡å¼ï¼ˆStrategy Patternï¼‰ï¼Œä¾‹å¦‚</p><p><em>å›¾ç‰‡ç¼ºå¤±</em></p><p>ä¸Šä¸‹æ–‡ä¾èµ–äº†ä¸€ä¸ª IStrategy æ¥å£ï¼Œè€Œ IStrategy æœ‰ä¸¤ç§å®ç°ï¼ŒStrategyAã€StrategyBï¼Œåœ¨è¿è¡Œä¸­å¯èƒ½æ˜¯é€‰æ‹©çš„ A ç­–ç•¥æˆ– B ç­–ç•¥ã€‚å†ä¸€ä¸ªç°å®ä¸€ç‚¹çš„ä¾‹å­</p><p><em>å›¾ç‰‡ç¼ºå¤±</em></p><p>å›¾ä¾‹æè¿°äº†ä¸€ä¸ªå…·ä½“çš„å­˜å‚¨ç­–ç•¥ï¼ŒCachedStrategy æ˜¯å¸¦ç¼“å­˜çš„å­˜å‚¨ç­–ç•¥ï¼Œ cache å’Œ backend å®ç°ç¼“å­˜é€»è¾‘ï¼ŒIStorage æœ¬èº«æ˜¯æŠ½è±¡çš„æ¥å£ï¼Œå› æ­¤ç¼“å­˜é€»è¾‘ä¹Ÿåªéœ€è¦ä¾èµ–æ¥å£è€Œä¸éœ€è¦å…³å¿ƒå…·ä½“å®ç°ã€‚MemoryStorage æ˜¯ä¸€ä¸ªå†…å­˜å­˜å‚¨ï¼Œæ•°æ®å­˜åœ¨å†…å­˜çš„ Map ä¸­ï¼ŒRedisStorage æ˜¯è®¿é—®è¿œç¨‹çš„å­˜å‚¨ã€‚æ‰€æœ‰çš„è¿™äº›ç­–ç•¥ç»†èŠ‚å¯¹ä¸Šå±‚è€Œè¨€éƒ½æ˜¯æ— æ„Ÿçš„ï¼Œæœ€ä¸Šå±‚ä½¿ç”¨çš„ä¾ç„¶æ˜¯ä¸€ä¸ªå­˜å‚¨æ¥å£ã€‚</p><p>è¿™æ ·çš„ç­–ç•¥æ˜¯è¿˜å¯ä»¥å åŠ çš„ï¼Œè¿™æ ·åšç­–ç•¥çš„ç›®çš„æ˜¯ç®€åŒ–äº†å•ä¸ªç­–ç•¥å®ç°çš„å¤æ‚åº¦ï¼Œä¸“æ³¨äºå®ç°ä¸€ä¸ªåŠŸèƒ½ç‚¹ï¼Œå¦‚æœä¸ä½¿ç”¨ç­–ç•¥ï¼Œåˆ™éœ€è¦åœ¨ä¸€ä¸ªå®ç°ç±»é‡Œå®ç°è¿‡å¤šçš„é€»è¾‘ï¼Œå½“é¢ä¸´æ–°çš„éœ€æ±‚ï¼Œæ¥å…¥æ–°çš„é€‚é…çš„æ—¶å€™ï¼Œå¯¼è‡´æ”¹åŠ¨ä¼šå¼‚å¸¸å›°éš¾ï¼Œä»¥ä¸‹çš„ä¼ªä»£ç å±•ç¤ºäº†è¿™æ ·çš„åŒºåˆ«</p><p><strong>å•ä¸ªç±»å®ç°</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">StorageImpl</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">constructor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token parameter"> redisUrl</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> redisPort </span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">cache</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">redis</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Redis</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> url</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> redisUrl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> port</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> redisPort </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword control-flow" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">cache</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">cache</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">let</span><span class="token plain"> val </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">redis</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword control-flow" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">val</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">cache</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> val</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> val</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">set</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> value</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">delete</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">cache</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">redis</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">set</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> value</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>æ¥å£ç­–ç•¥å®ç°</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">CachedStorage</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">constructor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token parameter"> cache</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> backend </span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">cache</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> cache</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">backend</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> backend</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">let</span><span class="token plain"> val </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">cache</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword control-flow" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token plain">val</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      val </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">backend</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword control-flow" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">val</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">cache</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">set</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> val</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> val</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">set</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> val</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">cache</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">set</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token keyword null nil" style="font-style:italic">null</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">backend</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">set</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> val</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">MemoryStorage</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">constructor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">data</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">set</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> val</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> val</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">RedisStorage</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">constructor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token parameter"> url</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> host </span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">redis</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Redis</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> url</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> port </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">redis</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">set</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> val</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">redis</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">set</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> val</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>å½“ä»£ç å’Œç­–ç•¥è¾ƒå°‘çš„æ—¶å€™ï¼Œå¯èƒ½ç›´æ¥å®ç°æ˜¯æ›´ç®€å•çš„ï¼Œä½†å½“ç­–ç•¥é€æ¸å¢å¤šï¼Œä¸šåŠ¡é€»è¾‘è¶ŠåŠ å¤æ‚çš„æ—¶å€™ï¼Œå†™åœ¨å•ä¸ªå®ç°ä¸­æ˜¯éå¸¸éš¾ä»¥ç»´æŠ¤çš„ï¼Œä¸€äº›ç®€å•çš„ä¾‹å­ï¼Œä¾‹å¦‚ åç«¯è®¿é—®éœ€è¦æ”¯æŒæŒ‰ key è¿›è¡Œåˆ†ç‰‡è®¿é—®ï¼Œæ”¯æŒä»å¦å¤–ä¸€ç§å­˜å‚¨åŠ è½½æ•°æ®ã€‚</p><p>ç­–ç•¥å¯ä»¥å¾ˆçµæ´»ï¼Œä¸”ä¸å¯é¢„çŸ¥çš„ï¼Œå› æ­¤éœ€è¦å®ç°è¿™æ ·çš„ç­–ç•¥ç®¡ç†ç›´æ¥ç¡¬ç¼–ç çš„æ–¹å¼æ˜¯ä¸å¯è¡Œçš„ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="åŸºäº-json-çš„åŠ¨æ€ç­–ç•¥é…ç½®"></a>åŸºäº JSON çš„åŠ¨æ€ç­–ç•¥é…ç½®<a class="hash-link" href="#åŸºäº-json-çš„åŠ¨æ€ç­–ç•¥é…ç½®" title="Direct link to heading">#</a></h2><p>æ¯ä¸ªç­–ç•¥éƒ½æ˜¯ä¸€ä¸ªé€šç”¨çš„æ¥å£å®ç°ï¼Œä¸€ä¸ªç­–ç•¥çš„å®ç°å¯èƒ½ä¾èµ–å…¶å®ƒç­–ç•¥ï¼Œè¿™æ ·çš„ç»“æ„æ˜¯ä¸€ä¸ªæ ‘å½¢çš„ï¼Œé‚£ä¹ˆé…ç½®ä¹Ÿæ˜¯ä¸€ä¸ªæ ‘å½¢çš„ç»“æ„ï¼Œä¾‹å¦‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly json"><pre tabindex="0" class="prism-code language-json codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;cached&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;cache&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;memory&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;backend&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;redis&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;port&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">6379</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;host&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;127.0.0.1&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>æ•´ä½“ç»“æ„ä¸ç­–ç•¥çš„ç»„æˆä¸€è‡´ï¼Œä»é…ç½®è§’åº¦æ¥è¯´ï¼Œéå¸¸ç›´è§‚ä¾¿äºç†è§£ã€‚ä½†å®é™…ä½¿ç”¨æ—¶éœ€è¦è¿›è¡Œè§£æå¤„ç†å¹¶æ˜ å°„ä¸ºå…·ä½“çš„ç­–ç•¥å®ç°ã€‚</p><p>åœ¨ç°æœ‰çš„ Java JSON è§£æåº“ä¸­ï¼ŒJackson åŠŸèƒ½æœ€ä¸ºä¸°å¯Œï¼Œè¦å®ç°è¿™æ ·çš„ç­–ç•¥é…ç½®æœ‰ä¸‰ç§æ–¹å¼</p><ol><li>JSON -&gt; é…ç½®å¯¹è±¡ -&gt; å®ç°<ul><li>ä½•æ—¶é€‰ç”¨ï¼šå®ç°å¤æ‚ï¼Œæœ‰è¾ƒå¤šè¿è¡ŒçŠ¶æ€</li><li>éœ€è¦é¢å¤–çš„ä¸€æ¬¡å®ç°æ˜ å°„</li><li>åºåˆ—åŒ–ååºåˆ—åŒ–ç®€å•</li></ul></li><li>JSON -&gt; å®ç°<ul><li>ä½•æ—¶é€‰ç”¨ï¼šå®ç°ç®€å•ï¼Œè¿è¡ŒçŠ¶æ€å¯æ§</li><li>éœ€è¦é¢å¤–æ–¹æ³•è¿›è¡Œåˆå§‹åŒ–</li><li>çŠ¶æ€å­—æ®µéœ€è¦æ³¨æ„ä¸è¦è¢«åºåˆ—åŒ– - <code>@JsonIgnore</code> æˆ– transient</li></ul></li><li>JSON-&gt;æŠ½è±¡é…ç½®å¯¹è±¡-&gt;æŠ½è±¡å®ç°-&gt;å®é™…é…ç½®å¯¹è±¡-&gt;å®é™…å®ç°<ul><li>ä½•æ—¶é€‰ç”¨ï¼šå®ç°å¤æ‚ä¸”æœ‰ç»§æ‰¿å…³ç³»ï¼Œæ¯ä¸€å±‚å®ç°å¤æ‚å¤„ç†ä¸åŒçš„é…ç½®</li><li>éœ€è¦åŸºäºé…ç½®å¯¹è±¡ï¼Œé…ç½®å¯¹è±¡æœ‰ç»§æ‰¿å…³ç³»</li><li>é…ç½®å¯¹è±¡èƒ½æŒæœ‰ä»»æ„é…ç½®å†…å®¹ï¼Œä¸åŒé…ç½®å¯¹è±¡å¯åœ¨ä¸ä¸¢å¤±æ•°æ®çš„å‰æä¸‹äº’ç›¸è½¬æ¢</li></ul></li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="é…ç½®è¿‡ç¨‹"></a>é…ç½®è¿‡ç¨‹<a class="hash-link" href="#é…ç½®è¿‡ç¨‹" title="Direct link to heading">#</a></h3><p>ä»¥ä¸‹ä»£ç æ¼”ç¤ºäº†ä½¿ç”¨é…ç½®å¯¹è±¡æ¥å®ç°é…ç½®çš„æŠ½è±¡åºåˆ—åŒ–å’Œååºåˆ—åŒ–</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><pre tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class ConfigObjectDemo {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void test() throws IOException {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ObjectMapper mapper = new ObjectMapper();</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String config = &quot;{\&quot;type\&quot;:\&quot;cached\&quot;,\&quot;cache\&quot;:{\&quot;type\&quot;:\&quot;memory\&quot;},\&quot;backend\&quot;:{\&quot;type\&quot;:\&quot;redis\&quot;,\&quot;port\&quot;:6379,\&quot;host\&quot;:\&quot;127.0.0.1\&quot;}}&quot;;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        StorageConfig storageConfig = mapper.readValue(config, StorageConfig.class);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // è¾“å‡º CachedStorageConfig(cache=MemoryConfig(), backend=RedisConfig(host=127.0.0.1, port=6379))</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        System.out.println(storageConfig);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // è¾“å‡º {&quot;type&quot;:&quot;cached&quot;,&quot;cache&quot;:{&quot;type&quot;:&quot;memory&quot;},&quot;backend&quot;:{&quot;type&quot;:&quot;redis&quot;,&quot;host&quot;:&quot;127.0.0.1&quot;,&quot;port&quot;:6379}}</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        System.out.println(mapper.writeValueAsString(storageConfig));</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@JsonTypeInfo(use = JsonTypeInfo.Id.NAME, property = &quot;type&quot;)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@JsonSubTypes({</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        @JsonSubTypes.Type(value = CachedStorageConfig.class, name = &quot;cached&quot;),</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        @JsonSubTypes.Type(value = MemoryConfig.class, name = &quot;memory&quot;),</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        @JsonSubTypes.Type(value = RedisConfig.class, name = &quot;redis&quot;)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">})</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@JsonInclude(JsonInclude.Include.NON_EMPTY)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@JsonAutoDetect(fieldVisibility = JsonAutoDetect.Visibility.ANY, getterVisibility = JsonAutoDetect.Visibility.NONE)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">interface StorageConfig{ String getType();}</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Data</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">class CachedStorageConfig implements StorageConfig{</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private StorageConfig cache;private StorageConfig backend;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Override public String getType() { return &quot;cached&quot;; }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Data</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">class MemoryConfig implements StorageConfig{ @Override public String getType() { return &quot;memory&quot;; }}</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Data</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">class RedisConfig implements StorageConfig{</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private String host; private int port;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Override public String getType() { return &quot;redis&quot;; }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>åœ¨è¿™é‡Œçœ‹åˆ°æ¯”è¾ƒå¤æ‚çš„æ³¨è§£æ˜¯ <code>@JsonSubTypes</code>ï¼Œè¯¥æ³¨è§£é…ç½®äº†ç±»å‹ä¸å®é™…å®ç°çš„æ˜ å°„å…³ç³»ï¼Œè€Œ <code>@JsonTypeInfo</code> é…ç½®äº†é‚£ä¸ªå­—æ®µä½œä¸ºç±»å‹ä¿¡æ¯å­—æ®µã€‚é€šè¿‡æ³¨è§£çš„æ–¹å¼é…ç½®ä¸å¤ªçµæ´»ï¼Œå¯èƒ½æœ‰æ—¶å€™ä¼šå¿½ç•¥é…ç½®æˆ–é…ç½®é”™è¯¯ï¼Œä¸”ä¸èƒ½åŠ¨æ€å¢åŠ ã€‚</p><p>è§£å†³é…ç½®æ¯”è¾ƒé—®é¢˜ä¹Ÿæœ‰ä¸¤ç§åŠæ³•ï¼Œç¬¬ä¸€ç§åŠæ³•æ˜¯ä¿ç•™ <code>@JsonTypeInfo</code> æ³¨è§£ï¼Œç„¶åæ‰‹åŠ¨è¿›è¡Œæ˜ å°„å…³ç³»çš„é…ç½®ï¼Œä¾‹å¦‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><pre tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">ObjectMapper mapper = new ObjectMapper();</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mapper.registerSubtypes(new NamedType(CachedStorageConfig.class,&quot;cached&quot;));</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mapper.registerSubtypes(new NamedType(MemoryConfig.class,&quot;memory&quot;));</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mapper.registerSubtypes(new NamedType(RedisConfig.class,&quot;redis&quot;));</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>ç»“æœä¸é€šè¿‡æ³¨è§£çš„æ–¹å¼é…ç½®æ˜¯ç›¸åŒçš„ï¼Œè¿™æ ·å°±å¯ä»¥åŠ¨æ€é…ç½®äº†ã€‚å¦‚æœè¿ <code>@JsonTypeInfo</code> ä¹Ÿä¸æƒ³è¦ï¼Œå¸Œæœ›é€šè¿‡ä»£ç å®Œå…¨åŠ¨æ€æ·»åŠ ï¼Œè¿™æ ·çš„è¿‡ç¨‹ä¼šæ¯”è¾ƒå¤æ‚ã€‚æœ€ç»ˆçš„ç»“æœç±»ä¼¼äº</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><pre tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// æ³¨å†Œä¸€ä¸ªåŠ¨æ€ç±»å‹ï¼Œä¸”è¯´æ˜å¦‚ä½•è·å–åˆ°ç±»å‹</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">MyJson.registerDynamicType(StorageConfig.class, StorageConfig::getType);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">MyJson.registerDynamicSubtypes(StorageConfig.class, new NamedType(CachedStorageConfig.class, &quot;cached&quot;));</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">MyJson.registerDynamicSubtypes(StorageConfig.class, new NamedType(MemoryConfig.class, &quot;memory&quot;));</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">MyJson.registerDynamicSubtypes(StorageConfig.class, new NamedType(RedisConfig.class, &quot;redis&quot;));</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><code>registerDynamicType</code> å’Œ <code>registerDynamicSubtypes</code> çš„å®ç°å¯å‚è€ƒ<a href="https://github.com/wenerme/wava/blob/a216dfe8e92fe4822c9659949fbe862b9419eef4/wava-common/src/main/java/me/wener/wava/util/JSON.java#L114" target="_blank" rel="noopener noreferrer">è¿™é‡Œ</a>ã€‚</p><p>è‡³æ­¤ä¾¿å®Œæˆäº†æ‰€æœ‰çš„åŠ¨æ€é…ç½®ï¼Œååºåˆ—åŒ–ä¸ºé…ç½®å¯¹è±¡å’Œå®ç°æ²¡æœ‰ç‰¹åˆ«å¤§çš„åŒºåˆ«ï¼Œåªéœ€è¦æ§åˆ¶å¥½å­—æ®µå¯è§æ€§å³å¯ã€‚</p><p>ä½¿ç”¨æŠ½è±¡é…ç½®ï¼Œåˆ™éœ€è¦èƒ½å¤Ÿè®°å½•å®Œæ•´çš„ä¿¡æ¯ï¼Œä»æŠ½è±¡é…ç½®è½¬æ¢ä¸ºå®é™…é…ç½®æ—¶ä¸èƒ½ä¸¢é…ç½®å†…å®¹ï¼Œä½¿ç”¨ Jacksonï¼Œå¯ä½¿ç”¨ <code>@JsonAnyGetter</code> å’Œ <code>@JsonAnySetter</code> å®ç°ï¼Œå› ä¸ºæˆ‘ä¼šå®šä¹‰ä¸€ä¸ªç±»ä¼¼å¦‚ä¸‹çš„åŸºç¡€ç±»</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><pre tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class PropertyObject {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @JsonIgnore @Setter private Map&lt;String, Object&gt; properties;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @JsonAnyGetter public Map&lt;String, Object&gt; getProperties() { return properties; }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @JsonAnySetter</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public Object set(String name, Object value) {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if (properties == null) { properties = Maps.newHashMap(); }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return properties.put(name, value);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>å®Œæ•´å®šä¹‰å‚è€ƒ <a href="https://github.com/wenerme/wava/blob/a216dfe8e92fe4822c9659949fbe862b9419eef4/wava-common/src/main/java/me/wener/wava/model/PropertyObject.java" target="_blank" rel="noopener noreferrer">PropertyObject</a>ã€‚</p><p>å¯¹é…ç½®çš„å¤„ç†åˆ™å¯ä»¥ä½¿ç”¨ç±»ä¼¼è´£ä»»é“¾çš„æ–¹å¼ï¼Œå¦‚æœå®ç°å¯¹é…ç½®æ„Ÿå…´è¶£ï¼Œåˆ™å°†å…¶è½¬æ¢ä¸ºè‡ªå·±æ„Ÿå…´è¶£çš„é…ç½®å¯¹è±¡ï¼Œè¿™æ ·ä¹Ÿä¾¿äºæ·»åŠ æ³¨è§£è¿›è¡Œæ ¡éªŒå’ŒéªŒè¯ã€‚</p><blockquote><p>å®ç°è¿‡ç¨‹</p><p>é…ç½®çš„æ­£ç¡®å¤„ç†å’Œæ ¡éªŒä½¿å¾—å®ç°è¿‡ç¨‹ç›¸å¯¹ç®€å•ï¼Œç›¸å½“äºç¡®å®šäº†ç¨‹åºçš„æ‰€æœ‰å…¥å‚ï¼Œå®ç°ä¾¿ä¸åœ¨æ­¤èµ˜è¿°ã€‚</p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ç­–ç•¥æ‰©å±•"></a>ç­–ç•¥æ‰©å±•<a class="hash-link" href="#ç­–ç•¥æ‰©å±•" title="Direct link to heading">#</a></h2><p>æ¯ä¸€ç§ç­–ç•¥å®é™…å¯¹åº”çš„éƒ½æ˜¯ä¸€éƒ¨åˆ†ä¸šåŠ¡é€»è¾‘ï¼Œé‚£ä¹ˆ <code>1+1</code> å’Œ <code>1-1</code> ä¹Ÿæ˜¯å¯ä»¥è¢«è®¤ä¸ºæ˜¯ä¸¤ç§ç­–ç•¥ï¼Œåœ¨<a href="https://wener.me/story/get-started-with-dsl/" target="_blank" rel="noopener noreferrer">ä» 0 åˆ° 1 å®ç°è‡ªå®šä¹‰è¯­è¨€</a>ä¸­æœ‰æåˆ°ï¼Œè¯­è¨€è¢«è§£æåä¼šç”Ÿæˆè¯­æ³•æ ‘ï¼Œè€Œè¯­æ³•æ ‘ä¹Ÿå¯ä»¥ç†è§£ä¸ºæ˜¯ä¸€ç§æ ‘å½¢çš„ç­–ç•¥é€»è¾‘ã€‚è¡¨è¾¾å¼ä¸­çš„é€šç”¨èŠ‚ç‚¹ä¸€èˆ¬å«åš Expressionï¼Œè€Œæ¯ä¸ª Expression éƒ½å¯ä»¥è®¡ç®—å‡ºæ¥ä¸€ä¸ªå€¼ï¼Œè¿™ä¸ªå€¼å¯ä»¥éšå«åœ¨å…¶å®ƒçš„ä¸€ä¸ª Expression ä¸­ï¼Œä¾‹å¦‚ 1+1 å¯ä»¥è¡¨ç¤ºä¸º</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly json"><pre tabindex="0" class="prism-code language-json codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;BinaryOperation&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;operator&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ADD&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;left&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><span class="token property">&quot;type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Literal&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token property">&quot;value&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;right&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><span class="token property">&quot;type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Literal&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token property">&quot;value&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>è€Œ 1+1+1 åˆ™è¡¨ç¤ºä¸º</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly json"><pre tabindex="0" class="prism-code language-json codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;BinaryOperation&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;operator&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ADD&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;left&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><span class="token property">&quot;type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Literal&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token property">&quot;value&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;right&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;BinaryOperation&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;operator&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ADD&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;left&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><span class="token property">&quot;type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Literal&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token property">&quot;value&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;right&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><span class="token property">&quot;type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Literal&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token property">&quot;value&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>å…¶åºåˆ—åŒ–å’Œååºåˆ—åŒ–ä¹‹å‰è®¨è®ºçš„é…ç½®æ˜¯å®Œå…¨ä¸€è‡´çš„ã€‚å¾ˆå¤šçš„ä¸šåŠ¡é€»è¾‘æœ¬èº«ä¹Ÿæ˜¯å¯ä»¥é€šè¿‡è¡¨è¾¾å¼æ¥è¡¨è¿°çš„ï¼Œè€Œä½¿ç”¨è¡¨è¾¾å¼åˆ™èƒ½æ˜¯çš„åœºæ™¯é…ç½®æ›´ä¸ºçµæ´»ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å®é™…åº”ç”¨"></a>å®é™…åº”ç”¨<a class="hash-link" href="#å®é™…åº”ç”¨" title="Direct link to heading">#</a></h2><p>ä»¥ä¸‹åˆ—ä¸¾åœ¨å®ä¾‹å¼€å‘ä¸­ä½¿ç”¨åˆ°çš„åœºæ™¯ï¼Œä¸‰ç§åœºæ™¯å„ä¸ç›¸åŒã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å¥¥æ ¼å­˜å‚¨"></a>å¥¥æ ¼å­˜å‚¨<a class="hash-link" href="#å¥¥æ ¼å­˜å‚¨" title="Direct link to heading">#</a></h3><p>åœ¨ å¥¥æ ¼äººç¾¤äºŒæ–¹åŒ…å¼€å‘æ€»ç»“ ä¸­æœ‰æåˆ°åº•å±‚å­˜å‚¨çš„å¤æ‚æ€§</p><p><em>å›¾ç‰‡ç¼ºå¤±</em></p><p>è¯¥é…ç½®çš„å®ç°ä¾¿æ˜¯åŸºäºè¿™æ ·çš„é…ç½®é€»è¾‘å®ç°çš„ã€‚åˆ†åˆ«å¯¹åº”æ¥å£</p><ul><li>CrowdStorage</li><li>CrowdStore</li></ul><p>å¦‚æœé›†æˆäº†å¥¥æ ¼äºŒæ–¹åŒ… æ˜¯çœ‹å¾—åˆ°ç›¸åº”å®ç°çš„ã€‚</p><p>ä½¿ç”¨çš„æ˜¯ JSON ç›´æ¥ååºåˆ—åŒ–ä¸ºå®ç°çš„æ–¹å¼ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ä»»åŠ¡è°ƒåº¦"></a>ä»»åŠ¡è°ƒåº¦<a class="hash-link" href="#ä»»åŠ¡è°ƒåº¦" title="Direct link to heading">#</a></h3><p>å¥¥æ ¼çš„æ¸ é“ç®¡ç†åº•å±‚å®ç°æ˜¯ä¸€å¥—ç›¸å¯¹é€šç”¨çš„ï¼Œåœ¨æ€»ç»“ä¸­æåˆ°å¤šå±‚çº§çš„æ”¯æŒä¾¿æ˜¯é€šè¿‡æŠ½è±¡é…ç½®å®ç°</p><ul><li>ä»»åŠ¡è°ƒåº¦æ”¯æŒ
<em> æ¸ é“æŠ•æ”¾
</em> æ¸ é“æ”¯æŒ - çŸ­ä¿¡ã€å¤–å‘¼ã€é‚®ä»¶/SMTP
<em> æ•°æ®æºæ”¯æŒ - æ¥å£ã€äººç¾¤ã€ODPS
</em> è°ƒåº¦æ”¯æŒ - å•æ¬¡ã€å‘¨æœŸã€æ‰‹åŠ¨</li></ul><p>é…ç½®å¯¹è±¡ç±»å›¾å¦‚ä¸‹</p><p><em>å›¾ç‰‡ç¼ºå¤±</em></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="çŠ¶æ€äººç¾¤è¡¨è¾¾å¼"></a>çŠ¶æ€äººç¾¤è¡¨è¾¾å¼<a class="hash-link" href="#çŠ¶æ€äººç¾¤è¡¨è¾¾å¼" title="Direct link to heading">#</a></h3><p>å¥¥æ ¼äºŒæ–¹åŒ…ç°æœ‰è¡¨è¾¾å¼å¤„ç†èƒ½åŠ›ï¼Œä½†åœ¨ä¸‹ä¸€ä¸ªç‰ˆæœ¬ä¸­è¯¥åŠŸèƒ½ä¼šè¢«å¢å¼ºï¼Œå°†ä¸åœ¨å®¢æˆ·ç«¯è§£æç¼–è¯‘ï¼Œè€Œæ˜¯åœ¨æœåŠ¡ç«¯å¤„ç†åä¸‹å‘è¯­æ³•æ ‘ï¼Œä¸‹å‘çš„è¯­æ³•æ ‘å…¶å®å°±æ˜¯ä¸€ä¸ªç­–ç•¥é…ç½®ï¼Œè¡¨è¾¾å¼çš„ç±»å›¾å¦‚ä¸‹</p><p><em>å›¾ç‰‡ç¼ºå¤±</em></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æ€»ç»“"></a>æ€»ç»“<a class="hash-link" href="#æ€»ç»“" title="Direct link to heading">#</a></h2><p>ç†Ÿç»ƒçš„æŒæ¡å’Œä½¿ç”¨å„ç§åœºæ™¯ä¸‹çš„é…ç½®å¯ä»¥å‡å°‘å¤§é‡çš„ä¸å¿…è¦çš„å¤„ç†é€»è¾‘ï¼Œä¸”èƒ½å‡å°‘ä¸å°‘çš„ BUGï¼Œä¸€äº› Bad Smell ä¾‹å¦‚ <code>JSON.parse(jsonString).get(&quot;someThing&quot;).asLong()</code> æ˜¯åº”è¯¥è¢«é¿å…çš„ï¼Œå› ä¸ºæ²¡æœ‰äººèƒ½çŸ¥é“è¿™æ˜¯åœ¨åšä»€ä¹ˆï¼Œä¹Ÿä¸çŸ¥é“é‡Œé¢éƒ½æœ‰ä»€ä¹ˆï¼Œåƒæ˜¯ä¸€ä¸ªé»‘ç›’ã€‚å¼€å‘æ—¶å¾€å¾€ä¸šåŠ¡é€»è¾‘æ˜¯ç›¸å¯¹ç®€å•çš„ï¼Œä½†æ˜¯ç¡®ä¿æ‹¿åˆ°æ­£ç¡®çš„é…ç½®å¾ˆéš¾ï¼Œé¢å‘å¤±è´¥è®¾è®¡ï¼Œå¼€é—­åŸåˆ™ï¼Œæœ‰é—®é¢˜çš„åœ°æ–¹å¿…ç„¶ä¼šå‡ºé—®é¢˜ï¼Œå¾€å¾€æˆ‘ä»¬ç”¨æ¥æ ¡éªŒæ˜¯å¦æ­£ç¡®çš„ä»£ç æ¯”å®é™…çš„ä»£ç è¿˜è¦å¤šï¼Œå½“é‡åˆ°è¿™æ ·é—®é¢˜çš„æ—¶å€™ï¼Œæ€è€ƒæ˜¯å¦æœ‰æ›´å¥½çš„æ–¹å¼æ¥åšè¿™äº›äº‹æƒ…ã€‚</p></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_3kfx"><div class="col"><b>Tags:</b><a class="margin-horiz--sm" href="/story/tags/java">Java</a><a class="margin-horiz--sm" href="/story/tags/jackson">Jackson</a><a class="margin-horiz--sm" href="/story/tags/json">Json</a><a class="margin-horiz--sm" href="/story/tags/é˜¿é‡Œ">é˜¿é‡Œ</a></div><div class="col margin-top--sm"><a href="https://github.com/wenerme/wener/edit/master/story/2019/2019-08-11-jackson-summary.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/story/wener-apis"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Â« Wener&#x27;s APIs</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/story/tt10627720-review"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">å›§ -ã€Šå“ªå’ä¹‹é­”ç«¥é™ä¸–ã€‹è§‚åæ„Ÿ Â»</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#åŠ¨æ€ç­–ç•¥" class="table-of-contents__link">åŠ¨æ€ç­–ç•¥</a></li><li><a href="#åŸºäº-json-çš„åŠ¨æ€ç­–ç•¥é…ç½®" class="table-of-contents__link">åŸºäº JSON çš„åŠ¨æ€ç­–ç•¥é…ç½®</a><ul><li><a href="#é…ç½®è¿‡ç¨‹" class="table-of-contents__link">é…ç½®è¿‡ç¨‹</a></li></ul></li><li><a href="#ç­–ç•¥æ‰©å±•" class="table-of-contents__link">ç­–ç•¥æ‰©å±•</a></li><li><a href="#å®é™…åº”ç”¨" class="table-of-contents__link">å®é™…åº”ç”¨</a><ul><li><a href="#å¥¥æ ¼å­˜å‚¨" class="table-of-contents__link">å¥¥æ ¼å­˜å‚¨</a></li><li><a href="#ä»»åŠ¡è°ƒåº¦" class="table-of-contents__link">ä»»åŠ¡è°ƒåº¦</a></li><li><a href="#çŠ¶æ€äººç¾¤è¡¨è¾¾å¼" class="table-of-contents__link">çŠ¶æ€äººç¾¤è¡¨è¾¾å¼</a></li></ul></li><li><a href="#æ€»ç»“" class="table-of-contents__link">æ€»ç»“</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">ç¬”è®°</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/notes/java/java">Java</a></li><li class="footer__item"><a class="footer__link-item" href="/notes/os/alpine/alpine">AlpineLinux</a></li><li class="footer__item"><a class="footer__link-item" href="/notes/devops/kubernetes/kubernetes">Kubernates</a></li><li class="footer__item"><a class="footer__link-item" href="/notes/voip/voip">VoIP</a></li></ul></div><div class="col footer__col"><div class="footer__title">Projects</div><ul class="footer__items"><li class="footer__item">
              <div>
              <a class="footer__link-item" href="https://github.com/wenerme/wener">Wener</a>
              - <a class="footer__link-item" href="https://github.com/wenerme/wener/actions" title="wenerme/wener - ci">
                <img style="vertical-align: middle;opacity: .4;" src="https://github.com/wenerme/wener/workflows/Build/badge.svg">
                </a>
              </div>
              </li><li class="footer__item"><a href="https://apis.wener.me" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Wener&#x27;s Apis<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/story">Blog</a></li><li class="footer__item"><a href="https://github.com/wenerme" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://twitter.com/wenerme" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/img/wener-logo.svg" alt="Wener Site" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="/img/wener-logo.svg" alt="Wener Site" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></div><div class="footer__copyright">Copyright Â© 1992-2021 Wener - <img alt="cc-by-sa-4.0" src="https://mirrors.creativecommons.org/presskit/buttons/80x15/svg/by-sa.svg"> - Build @2021-08-08 00:51</div></div></div></footer></div>
<script src="/assets/js/runtime~main.67ea70b0.js"></script>
<script src="/assets/js/main.25556fba.js"></script>
</body>
</html>