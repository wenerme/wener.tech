<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.65">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-30404720-1","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-30404720-1"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-30404720-1",{})</script>
<link rel="search" type="application/opensearchdescription+xml" title="Wener Live & Life" href="/opensearch.xml"><title data-react-helmet="true">Blog | Wener Live &amp; Life</title><meta data-react-helmet="true" property="og:title" content="Blog | Wener Live &amp; Life"><meta data-react-helmet="true" name="description" content="Blog"><meta data-react-helmet="true" property="og:description" content="Blog"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/styles.98d7e791.css">
<link rel="preload" href="/styles.056e693e.js" as="script">
<link rel="preload" href="/runtime~main.9748ac90.js" as="script">
<link rel="preload" href="/main.8bc432ef.js" as="script">
<link rel="preload" href="/1.814e8bab.js" as="script">
<link rel="preload" href="/2.374e262d.js" as="script">
<link rel="preload" href="/3.ccf1708d.js" as="script">
<link rel="preload" href="/a6aa9e1f.31758413.js" as="script">
<link rel="preload" href="/01d92d65.6e4faf37.js" as="script">
<link rel="preload" href="/681c1604.87aaf470.js" as="script">
<link rel="preload" href="/dc9f8bc7.a3d796d4.js" as="script">
<link rel="preload" href="/3667dc5f.e3bee78b.js" as="script">
<link rel="preload" href="/3bd2f44d.6b61325b.js" as="script">
<link rel="preload" href="/d8bff700.36463a03.js" as="script">
<link rel="preload" href="/99700096.77cae82c.js" as="script">
<link rel="preload" href="/c4c9eda3.c33c7866.js" as="script">
<link rel="preload" href="/5a3ed685.a81c52f2.js" as="script">
<link rel="preload" href="/51b11dec.7384e675.js" as="script">
<link rel="preload" href="/96d535f5.caaccc52.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/wener-logo-head.svg" alt="Wener Logo"><strong class="navbar__title">Wener</strong></a><a class="navbar__item navbar__link" href="/notes/java/java">笔记</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/story">故事</a><a class="navbar__item navbar__link" href="/notes/howto/network/dns-prevent-spoofing">指南</a><a class="navbar__item navbar__link" href="/notes/tool/network/ip-lookup">工具</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/wenerme/wener" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">🌞</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span><span class="DocSearch-Button-Key">⌘</span><span class="DocSearch-Button-Key">K</span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/wener-logo-head.svg" alt="Wener Logo"><strong class="navbar__title">Wener</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/notes/java/java">笔记</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/story">故事</a></li><li class="menu__list-item"><a href="https://github.com/wenerme/wener" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li><li class="menu__list-item"><a class="menu__link" href="/notes/howto/network/dns-prevent-spoofing">指南</a></li><li class="menu__list-item"><a class="menu__link" href="/notes/tool/network/ip-lookup">工具</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="container margin-vert--lg"><div class="row"><main class="col col--8 col--offset-2"><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_1mse"><a href="/story/jraphql">Java with GraphQL</a></h2><div class="margin-vert--md"><time datetime="2018-05-21T00:00:00.000Z" class="blogPostDate_3bQP">May 21, 2018  · 1 min read</time></div><div class="avatar margin-vert--md"><div class="avatar__intro"></div></div></header><section class="markdown"></section><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/story/tags/项目">项目</a><a class="margin-horiz--sm" href="/story/tags/java">Java</a><a class="margin-horiz--sm" href="/story/tags/graph-ql">GraphQL</a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_1mse"><a href="/story/ubuntu-home">Ubuntu 家用</a></h2><div class="margin-vert--md"><time datetime="2017-02-09T00:00:00.000Z" class="blogPostDate_3bQP">February 9, 2017  · 8 min read</time></div><div class="avatar margin-vert--md"><div class="avatar__intro"></div></div></header><section class="markdown"><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="ubuntu-家用"></a>Ubuntu 家用<a aria-hidden="true" tabindex="-1" class="hash-link" href="#ubuntu-家用" title="Direct link to heading">#</a></h1><ul><li>Ubuntu 桌面版</li><li>安装至少需要 1024*768 的显示器</li></ul><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">apt</span><span class="token plain"> update</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">apt</span><span class="token plain"> upgrade</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">apt</span><span class="token plain"> dist-upgrade</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 桌面版没有 sshd</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">apt</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> -y openssh-server</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">############</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># brew</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">############</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">brew </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> gcc redis tmux mosh</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">############</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 容器服务配置</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">############</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 使用阿里提供的仓库进行安装会非常快</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> -sSL http://acs-public-mirror.oss-cn-hangzhou.aliyuncs.com/docker-engine/internet </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">sh</span><span class="token plain"> -</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 安装完毕后为当前用户添加权限,需要退出重新登录才能生效</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">usermod</span><span class="token plain"> -aG docker </span><span class="token environment constant" style="color:rgb(130, 170, 255)">$USER</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 安装完成建议选择一家容器镜像,比如 https://cr.console.aliyun.com 或者 daocloud</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker pull gogs/gogs</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker network create --subnet</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">172.18</span><span class="token plain">.1.0/24 home-net</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 准备数据目录</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">mkdir</span><span class="token plain"> /data</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">chown</span><span class="token plain"> </span><span class="token environment constant" style="color:rgb(130, 170, 255)">$USER</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token environment constant" style="color:rgb(130, 170, 255)">$USER</span><span class="token plain"> /data</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">cd</span><span class="token plain"> /data</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># ==========</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 监控配置</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># ==========</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker pull grafana/grafana</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker pull prom/container-exporter</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker pull prom/prometheus</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker run --net home-net --ip </span><span class="token number" style="color:rgb(247, 140, 108)">172.18</span><span class="token plain">.1.10 -d --restart always -v /etc/localtime:/etc/localtime:ro </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    -v </span><span class="token environment constant" style="color:rgb(130, 170, 255)">$PWD</span><span class="token plain">/grafana:/var/lib/grafana </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    -v </span><span class="token environment constant" style="color:rgb(130, 170, 255)">$PWD</span><span class="token plain">/grafana.ini:/etc/grafana/grafana.ini </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    --name grafana grafana/grafana</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">nohup</span><span class="token plain"> node_exporter </span><span class="token operator file-descriptor important" style="color:rgb(137, 221, 255)">2</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">node_exporter.log </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker run -d --net home-net --ip </span><span class="token number" style="color:rgb(247, 140, 108)">172.18</span><span class="token plain">.1.21 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    -v /sys/fs/cgroup:/cgroup </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    -v /var/run/docker.sock:/var/run/docker.sock </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    --name container-exporter prom/container-exporter</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker run --net home-net --ip </span><span class="token number" style="color:rgb(247, 140, 108)">172.18</span><span class="token plain">.1.20 -d --restart always -v /etc/localtime:/etc/localtime:ro </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    -v </span><span class="token environment constant" style="color:rgb(130, 170, 255)">$PWD</span><span class="token plain">/prom:/prometheus </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    -v </span><span class="token environment constant" style="color:rgb(130, 170, 255)">$PWD</span><span class="token plain">/prom.yaml:/etc/prometheus/prometheus.yml </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    --name prom prom/prometheus</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Web 服务</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 选择需要的 Caddy 插件用于构建容器</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">mkdir</span><span class="token plain"> -p /tmp/caddy </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;&amp;</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">cd</span><span class="token plain"> /tmp/caddy</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">wget</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;https://caddyserver.com/download/build?os=linux&amp;arch=amd64&amp;features=cors%2Cexpires%2Cfilemanager%2Cgit%2Chugo%2Cipfilter%2Cjsonp%2Cjwt%2Clocale%2Cmailout%2Cminify%2Cmultipass%2Cprometheus%2Cratelimit%2Crealip%2Csearch%2Cupload&#x27;</span><span class="token plain"> -O caddy.tar.gz</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">tar</span><span class="token plain"> -zxvf caddy.tar.gz</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker build -t home/caddy -f caddy.Dockerfile </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">cd</span><span class="token plain"> -</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker run --net home-net --ip </span><span class="token number" style="color:rgb(247, 140, 108)">172.18</span><span class="token plain">.1.30  -d --restart always -v /etc/localtime:/etc/localtime:ro </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    -v </span><span class="token environment constant" style="color:rgb(130, 170, 255)">$PWD</span><span class="token plain">/Caddyfile:/etc/Caddyfile </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    -v </span><span class="token environment constant" style="color:rgb(130, 170, 255)">$PWD</span><span class="token plain">/caddy:/data </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    -v </span><span class="token environment constant" style="color:rgb(130, 170, 255)">$HOME</span><span class="token plain">/.caddy:/root/.caddy </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    -p </span><span class="token number" style="color:rgb(247, 140, 108)">80</span><span class="token plain">:80 -p </span><span class="token number" style="color:rgb(247, 140, 108)">443</span><span class="token plain">:443 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    --name web home/caddy</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="caddydockerfile"></a>caddy.Dockerfile<a aria-hidden="true" tabindex="-1" class="hash-link" href="#caddydockerfile" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-Dockerfile codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">FROM alpine</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">MAINTAINER wener &lt;wener@wener.me&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">COPY caddy /app/caddy</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">VOLUME     [ &quot;/data&quot; ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">WORKDIR    /data</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">EXPOSE 2015</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">EXPOSE 2000</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">ENTRYPOINT [&quot;/app/caddy&quot;]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">CMD [&quot;-conf&quot;,&quot;/etc/Caddyfile&quot;,&quot;-log&quot;,&quot;./internal/log&quot;]</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="grafanaini"></a>grafana.ini<a aria-hidden="true" tabindex="-1" class="hash-link" href="#grafanaini" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-ini codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">##################### Grafana Configuration Example #####################</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Everything has defaults so you only need to uncomment things you want to</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># change</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># possible values : production, development</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">; app_mode = production</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># instance name, defaults to HOSTNAME environment variable value or hostname if HOSTNAME var is empty</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">; instance_name = ${HOSTNAME}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#################################### Paths ####################################</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[paths]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Path to where grafana can store temp files, sessions, and the sqlite3 db (if that is used)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;data = /var/lib/grafana</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Directory where grafana can store logs</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;logs = /var/log/grafana</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Directory where grafana will automatically scan and look for plugins</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;plugins = /var/lib/grafana/plugins</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#################################### Server ####################################</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[server]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Protocol (http or https)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;protocol = http</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># The ip address to bind to, empty will bind to all interfaces</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;http_addr =</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># The http port  to use</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;http_port = 3000</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># The public facing domain name used to access grafana from a browser</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">domain = d.yikaiye.com</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Redirect to correct domain if host header does not match domain</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Prevents DNS rebinding attacks</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;enforce_domain = false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># 使用 /monitor 作为路径,以便于反向代理</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;root_url = %(protocol)s://%(domain)s:%(http_port)s/</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">root_url = /monitor</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Log web requests</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;router_logging = false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># the path relative working path</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;static_root_path = public</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># enable gzip</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">enable_gzip = true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># https certs &amp; key file</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;cert_file =</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;cert_key =</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#################################### Database ####################################</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[database]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Either &quot;mysql&quot;, &quot;postgres&quot; or &quot;sqlite3&quot;, it&#x27;s your choice</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;type = sqlite3</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;host = 127.0.0.1:3306</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;name = grafana</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;user = root</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;password =</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># For &quot;postgres&quot; only, either &quot;disable&quot;, &quot;require&quot; or &quot;verify-full&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;ssl_mode = disable</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># For &quot;sqlite3&quot; only, path relative to data_path setting</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;path = grafana.db</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#################################### Session ####################################</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[session]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Either &quot;memory&quot;, &quot;file&quot;, &quot;redis&quot;, &quot;mysql&quot;, &quot;postgres&quot;, default is &quot;file&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;provider = file</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Provider config options</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># memory: not have any config yet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># file: session dir path, is relative to grafana data_path</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># redis: config like redis server e.g. `addr=127.0.0.1:6379,pool_size=100,db=grafana`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># mysql: go-sql-driver/mysql dsn config string, e.g. `user:password@tcp(127.0.0.1:3306)/database_name`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># postgres: user=a password=b host=localhost port=5432 dbname=c sslmode=disable</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;provider_config = sessions</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Session cookie name</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;cookie_name = grafana_sess</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># If you use session in https only, default is false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;cookie_secure = false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Session life time, default is 86400</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;session_life_time = 86400</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#################################### Analytics ####################################</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[analytics]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Server reporting, sends usage counters to stats.grafana.org every 24 hours.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># No ip addresses are being tracked, only simple counters to track</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># running instances, dashboard and error counts. It is very helpful to us.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Change this option to false to disable reporting.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;reporting_enabled = true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Set to false to disable all checks to https://grafana.net</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># for new vesions (grafana itself and plugins), check is used</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># in some UI views to notify that grafana or plugin update exists</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># This option does not cause any auto updates, nor send any information</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># only a GET request to http://grafana.net to get latest versions</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">check_for_updates = true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Google Analytics universal tracking code, only enabled if you specify an id here</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;google_analytics_ua_id =</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#################################### Security ####################################</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[security]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># default admin user, created on startup</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;admin_user = admin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># default admin password, can be changed before first start of grafana,  or in profile settings</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;admin_password = admin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># used for signing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;secret_key = SW2YcwTIb9zpOOhoPsMm</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Auto-login remember days</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;login_remember_days = 7</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;cookie_username = grafana_user</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;cookie_remember_name = grafana_remember</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># disable gravatar profile images</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;disable_gravatar = false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># data source proxy whitelist (ip_or_domain:port separated by spaces)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;data_source_proxy_whitelist =</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[snapshots]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># snapshot sharing options</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">external_enabled = false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;external_snapshot_url = https://snapshots-origin.raintank.io</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;external_snapshot_name = Publish to snapshot.raintank.io</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#################################### Users ####################################</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[users]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># 禁用注册功能</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">allow_sign_up = false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># 不允许非管理员创建组织</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">allow_org_create = false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Set to true to automatically assign new users to the default organization (id 1)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">auto_assign_org = true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Default role new users will be automatically assigned (if disabled above is set to true)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">auto_assign_org_role = Viewer</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Background text for the user field on the login page</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">login_hint = 用户名</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Default UI theme (&quot;dark&quot; or &quot;light&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">default_theme = light</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#################################### Anonymous Auth ##########################</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[auth.anonymous]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># enable anonymous access</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">enabled = false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># specify organization name that should be used for unauthenticated users</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;org_name = Main Org.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># specify role for unauthenticated users</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;org_role = Viewer</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#################################### Auth Proxy ##########################</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[auth.proxy]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;enabled = false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;header_name = X-WEBAUTH-USER</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;header_property = username</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;auto_sign_up = true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#################################### Basic Auth ##########################</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[auth.basic]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;enabled = true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#################################### SMTP / Emailing ##########################</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[smtp]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;enabled = false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;host = localhost:25</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;user =</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;password =</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;cert_file =</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;key_file =</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;skip_verify = false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;from_address = admin@grafana.localhost</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[emails]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;welcome_email_on_sign_up = false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#################################### Logging ##########################</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[log]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Either &quot;console&quot;, &quot;file&quot;, &quot;syslog&quot;. Default is console and  file</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Use space to separate multiple modes, e.g. &quot;console file&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;mode = console, file</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Either &quot;trace&quot;, &quot;debug&quot;, &quot;info&quot;, &quot;warn&quot;, &quot;error&quot;, &quot;critical&quot;, default is &quot;info&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;level = info</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># For &quot;console&quot; mode only</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[log.console]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;level =</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># log line format, valid options are text, console and json</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;format = console</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># For &quot;file&quot; mode only</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[log.file]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;level =</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># log line format, valid options are text, console and json</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;format = text</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># This enables automated log rotate(switch of following options), default is true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;log_rotate = true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Max line number of single file, default is 1000000</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;max_lines = 1000000</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Max size shift of single file, default is 28 means 1 &lt;&lt; 28, 256MB</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;max_size_shift = 28</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Segment log daily, default is true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;daily_rotate = true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Expired days of log file(delete after max days), default is 7</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;max_days = 7</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[log.syslog]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;level =</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># log line format, valid options are text, console and json</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;format = text</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Syslog network type and address. This can be udp, tcp, or unix. If left blank, the default unix endpoints will be used.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;network =</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;address =</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Syslog facility. user, daemon and local0 through local7 are valid.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;facility =</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Syslog tag. By default, the process&#x27; argv[0] is used.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;tag =</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#################################### AMQP Event Publisher ##########################</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[event_publisher]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;enabled = false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;rabbitmq_url = amqp://localhost/</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;exchange = grafana_events</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;#################################### Dashboard JSON files ##########################</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[dashboards.json]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;enabled = false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;path = /var/lib/grafana/dashboards</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#################################### Internal Grafana Metrics ##########################</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Metrics available at HTTP API Url /api/metrics</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[metrics]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Disable / Enable internal metrics</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;enabled           = true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Publish interval</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">;interval_seconds  = 10</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Send internal metrics to Graphite</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">; [metrics.graphite]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">; address = localhost:2003</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">; prefix = prod.grafana.%(instance_name)s.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#################################### Internal Grafana Metrics ##########################</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Url used to to import dashboards directly from Grafana.net</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[grafana_net]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">url = https://grafana.net</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="promyaml"></a>prom.yaml<a aria-hidden="true" tabindex="-1" class="hash-link" href="#promyaml" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-yaml codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">global</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">scrape_interval</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">     5s</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Attach these labels to any time series or alerts when communicating with</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># external systems (federation, remote storage, Alertmanager).</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">external_labels</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">monitor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;dev-monitor&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">rule_files</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> mysql.rules</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># A scrape configuration containing exactly one endpoint to scrape:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Here it&#x27;s Prometheus itself.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">scrape_configs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># The job name is added as a label `job=&lt;job_name&gt;` to any timeseries scraped from this config.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">job_name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;prometheus&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Override the global default and scrape targets from this job every 5 seconds.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">scrape_interval</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 5s</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">static_configs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">targets</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;localhost:9090&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">job_name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> container_exporter</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">static_configs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">targets</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;172.18.1.21:9104&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">job_name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> node_exporter</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">static_configs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">targets</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;172.18.1.1:9100&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">job_name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> caddy</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">static_configs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">targets</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;172.18.1.30:2000&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="caddyfile"></a>Caddyfile<a aria-hidden="true" tabindex="-1" class="hash-link" href="#caddyfile" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">:80 {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  log internal/access.log {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      rotate {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          size 50</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          age  14</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          keep 10</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  prometheus :2000</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  root .</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  internal ./internal</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  filemanager /file {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    show file/</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  proxy /monitor 172.18.1.10:3000 {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    without /monitor</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    transparent</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div></div></div><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ sudo vim /etc/udev/rules.d/75-persistent-net-generator.rules</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">SUBSYSTEM==&quot;net&quot;, ACTION==&quot;add&quot;, ATTR{address}==&quot;f0:42:1c:85:07:41&quot;, NAME=&quot;eth0&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">sudo vim /etc/network/interfaces</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div></div></div></section></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_1mse"><a href="/story/attack-on-programmer">进击的程序猿</a></h2><div class="margin-vert--md"><time datetime="2017-01-19T00:00:00.000Z" class="blogPostDate_3bQP">January 19, 2017  · 1 min read</time></div><div class="avatar margin-vert--md"><div class="avatar__intro"></div></div></header><section class="markdown"><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="进击的程序猿"></a>进击的程序猿<a aria-hidden="true" tabindex="-1" class="hash-link" href="#进击的程序猿" title="Direct link to heading">#</a></h1><p>2016 年会节目</p><ul><li><a href="https://github.com/wenerme/wener/tree/master/story/2017/am2016/%E8%BF%9B%E5%87%BB%E7%9A%84%E7%A8%8B%E5%BA%8F%E7%8C%BF.fountain" target="_blank" rel="noopener noreferrer">脚本</a>/<a href="https://github.com/wenerme/wener/tree/master/story/2017/am2016/%E8%BF%9B%E5%87%BB%E7%9A%84%E7%A8%8B%E5%BA%8F%E7%8C%BF.pdf" target="_blank" rel="noopener noreferrer">PDF</a></li><li>舞台前端/舞台后端</li></ul></section></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_1mse"><a href="/story/ubuntu-new-server">Ubuntu 新服务器配置</a></h2><div class="margin-vert--md"><time datetime="2016-09-28T00:00:00.000Z" class="blogPostDate_3bQP">September 28, 2016  · 2 min read</time></div><div class="avatar margin-vert--md"><div class="avatar__intro"></div></div></header><section class="markdown"><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="ubuntu-新服务器配置"></a>Ubuntu 新服务器配置<a aria-hidden="true" tabindex="-1" class="hash-link" href="#ubuntu-新服务器配置" title="Direct link to heading">#</a></h1><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 修改主机名</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">hostnamectl set-hostname myHostName</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 如果想要直接使用主机名,还需要在 /etc/hosts 里添加相关记录</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># nano /etc/hostname</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># nano /etc/hosts</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 生成中文</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">locale-gen zh_CN.UTF-8</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 基本更新</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">apt-get</span><span class="token plain"> update</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">apt-get</span><span class="token plain"> upgrade</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 出现 The following packages have been kept back 可考虑 apt dist-upgrade 或 install</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 当 /etc/apt/sources.list* 有其他仓库时使用 dist-upgrade 相对没那么安全</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 修改密码</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">passwd</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 创建用于部署的用户</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">useradd</span><span class="token plain"> deploy</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">mkdir</span><span class="token plain"> /home/deploy</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">mkdir</span><span class="token plain"> /home/deploy/.ssh</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">chmod</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">700</span><span class="token plain"> /home/deploy/.ssh</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 将需要使用该用户的公钥添加进去</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">vim</span><span class="token plain"> /home/deploy/.ssh/authorized_keys</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">chmod</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">400</span><span class="token plain"> /home/deploy/.ssh/authorized_keys</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">chown</span><span class="token plain"> deploy:deploy /home/deploy -R</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 编辑 sudoers</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">visudo</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 将需要 sudo 的用户添加进去</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># deploy  ALL=(ALL) ALL</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 修改 sshd 权限</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">vim</span><span class="token plain"> /etc/ssh/sshd_config</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># PermitRootLogin no # 不允许直接 root 登陆</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># PasswordAuthentication no # 不允许密码登陆</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># AllowUsers deploy@(your-ip) deploy@(another-ip-if-any) # 只允许指定地址的人登陆</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># service ssh restart</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 防火墙设置</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># DNS 53</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># mosh allow 60000:61000/udp 或 allow mosh</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">ufw allow </span><span class="token number" style="color:rgb(247, 140, 108)">22</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">ufw allow </span><span class="token number" style="color:rgb(247, 140, 108)">80</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">ufw allow </span><span class="token number" style="color:rgb(247, 140, 108)">443</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">ufw default deny</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">ufw </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">enable</span></div></div></div></div></div><ul><li><a href="https://news.ycombinator.com/item?id=5316093" target="_blank" rel="noopener noreferrer">How I spend my first 5 minutes on a server </a></li><li><a href="https://www.upguard.com/blog/10-essential-steps-for-configuring-a-new-server" target="_blank" rel="noopener noreferrer">10 Essential Steps for Configuring a New Server</a></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="tips"></a>Tips<a aria-hidden="true" tabindex="-1" class="hash-link" href="#tips" title="Direct link to heading">#</a></h2><p>当有多台主机需要部署的时候,建议使用 sshrc, tmuxrc, 这样能快速的将所有的配置都带给服务器,能够快速方便的对多台进行安装部署.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="mosh-dev"></a>mosh-dev<a aria-hidden="true" tabindex="-1" class="hash-link" href="#mosh-dev" title="Direct link to heading">#</a></h3><p>由于 mosh 部分鼠标相关的功能需要最新版,所以建议直接安装 dev 版本</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">apt-get</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> -y software-properties-common</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">add-apt-repository ppa:keithw/mosh-dev</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">apt-get</span><span class="token plain"> update</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">apt</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> -y mosh</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="fail2ban"></a>fail2ban<a aria-hidden="true" tabindex="-1" class="hash-link" href="#fail2ban" title="Direct link to heading">#</a></h2><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">apt-get</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> fail2ban</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">cp</span><span class="token plain"> /etc/fail2ban/jail.conf /etc/fail2ban/jail.local</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># bantime = 3600 # ban 1 小时</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># destemail = admin@admin # 发送警告的邮箱地址</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 将 ssh/ssh-ddos 等段落下的 enable 设置为 true 打开相应的 filter</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="env"></a>env<a aria-hidden="true" tabindex="-1" class="hash-link" href="#env" title="Direct link to heading">#</a></h2><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">apt-get</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> software-properties-common</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 添加 Oracle Java 仓库</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">add-apt-repository ppa:webupd8team/java</span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">apt-get</span><span class="token plain"> update</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 安装 Oracle Java 8 JDK</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">apt-get</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> oracle-java8-installer</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 如果有多个 Java 环境可调整配置</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">update-alternatives --config java</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="ipv6"></a>ipv6<a aria-hidden="true" tabindex="-1" class="hash-link" href="#ipv6" title="Direct link to heading">#</a></h2><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># https://jiandanxinli.github.io/2016-08-06.html</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># /etc/sysctl.conf</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># net.ipv6.conf.all.disable_ipv6=0</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># net.ipv6.conf.default.disable_ipv6=0</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># net.ipv6.conf.lo.disable_ipv6=0</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">sysctl -p</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># https://www.tunnelbroker.net/</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 选择 linux route2, 然后执行脚本</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 检测 ipv6 是否可用</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># http://ready.chair6.net/?url=wener.me</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 如果操作失败了则删除通道从来</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">ip</span><span class="token plain"> tun del he-ipv6</span></div></div></div></div></div></section></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_1mse"><a href="/story/learning-dist-arch">分布式架构手记</a></h2><div class="margin-vert--md"><time datetime="2016-08-25T15:33:00.000Z" class="blogPostDate_3bQP">August 25, 2016  · 1 min read</time></div><div class="avatar margin-vert--md"><div class="avatar__intro"></div></div></header><section class="markdown"><p>这几天尝试了很多的 *aaS, 期望能找到在当前架构下适合公司后续发展的一个系统架构, 然而一路下来发现并没那么简单.</p></section><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/story/tags/架构">架构</a></div><div class="col text--right"><a aria-label="Read more about 分布式架构手记" href="/story/learning-dist-arch"><strong>Read More</strong></a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_1mse"><a href="/story/go-rm">Go Redis module</a></h2><div class="margin-vert--md"><time datetime="2016-08-09T00:00:00.000Z" class="blogPostDate_3bQP">August 9, 2016  · 1 min read</time></div><div class="avatar margin-vert--md"><div class="avatar__intro"></div></div></header><section class="markdown"><p>Writing Redis Module in Golang.</p></section><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/story/tags/项目">项目</a><a class="margin-horiz--sm" href="/story/tags/golang">Golang</a><a class="margin-horiz--sm" href="/story/tags/redis">Redis</a></div><div class="col text--right"><a aria-label="Read more about Go Redis module" href="/story/go-rm"><strong>Read More</strong></a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_1mse"><a href="/story/2016/08/06/tap-titans"></a></h2><div class="margin-vert--md"><time datetime="2016-08-06T23:43:00.000Z" class="blogPostDate_3bQP">August 6, 2016  · 1 min read</time></div><div class="avatar margin-vert--md"><div class="avatar__intro"></div></div></header><section class="markdown"><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="play-titans-using-shell"></a>Play Titans using shell<a aria-hidden="true" tabindex="-1" class="hash-link" href="#play-titans-using-shell" title="Direct link to heading">#</a></h1><p><a href="https://play.google.com/store/apps/details?id=com.gamehivecorp.taptitans" target="_blank" rel="noopener noreferrer">Tap Titans</a> on Play Store</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="features"></a>Features<a aria-hidden="true" tabindex="-1" class="hash-link" href="#features" title="Direct link to heading">#</a></h2><ul><li>Auto upgrade</li><li>Auto spell skill</li><li>Auto start challenge</li><li>Auto close ad dialog</li><li>Verify fast tap (0.03s/tap)</li></ul><blockquote><p><strong>NOTE</strong></p><ul><li>Only tested on Nexus 5, different devices may use different coordinates and event dev.</li><li>Used to plat tiantis long time ago, may not works in current version.Different version may use different color and coordinates</li></ul></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="requirement"></a>Requirement<a aria-hidden="true" tabindex="-1" class="hash-link" href="#requirement" title="Direct link to heading">#</a></h2><ul><li>ADB</li><li>Image Magic</li><li>Bash</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="get-started"></a>Get started<a aria-hidden="true" tabindex="-1" class="hash-link" href="#get-started" title="Direct link to heading">#</a></h2><ul><li><p>Start game</p></li><li><p>Get source <a href="https://github.com/wenerme/wener/tree/master/story/2016/tap-titans-play.sh" target="_blank" rel="noopener noreferrer">tap-titans-play.sh</a></p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">chmod</span><span class="token plain"> +x play.sh</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Connect through lan, so you don&#x27;t have to use the usb</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">./play.sh use-tcp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Push the pre-generated event file</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">adb push events /mnt/sdcard</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Start playing</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">./play.sh</span></div></div></div></div></div></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="how-is-works-"></a>How is works ?<a aria-hidden="true" tabindex="-1" class="hash-link" href="#how-is-works-" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="why-fast-"></a>Why fast ?<a aria-hidden="true" tabindex="-1" class="hash-link" href="#why-fast-" title="Direct link to heading">#</a></h3><ul><li>Because I don&#x27;t use <code>adb shell input tap</code>, instead use a generated file that represent a tap event, then <code>cat tap &gt; /dev/input/event1</code>.</li><li>Use generated shell run in android.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="how-to-detect-the-screen-event-"></a>How to detect the screen event ?<a aria-hidden="true" tabindex="-1" class="hash-link" href="#how-to-detect-the-screen-event-" title="Direct link to heading">#</a></h3><p>Use screen capture, then use the image magic to check the color,kind of slowly, but works.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="more"></a>More<a aria-hidden="true" tabindex="-1" class="hash-link" href="#more" title="Direct link to heading">#</a></h2><p>Check the <a href="https://github.com/wenerme/wener/tree/master/story/2016/tap-titans-play.sh" target="_blank" rel="noopener noreferrer">source</a></p></section><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/story/tags/game">Game</a><a class="margin-horiz--sm" href="/story/tags/android">Android</a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_1mse"><a href="/story/bbvm">BBVM - BeBasic Virtual Machine</a></h2><div class="margin-vert--md"><time datetime="2015-10-30T00:00:00.000Z" class="blogPostDate_3bQP">October 30, 2015  · 1 min read</time></div><div class="avatar margin-vert--md"><div class="avatar__intro"></div></div></header><section class="markdown"><p>The first VM in my live.</p></section><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/story/tags/项目">项目</a><a class="margin-horiz--sm" href="/story/tags/golang">Golang</a><a class="margin-horiz--sm" href="/story/tags/java">Java</a><a class="margin-horiz--sm" href="/story/tags/游戏">游戏</a><a class="margin-horiz--sm" href="/story/tags/虚拟机">虚拟机</a></div><div class="col text--right"><a aria-label="Read more about BBVM - BeBasic Virtual Machine" href="/story/bbvm"><strong>Read More</strong></a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_1mse"><a href="/story/guava-intro">Guava 简介</a></h2><div class="margin-vert--md"><time datetime="2015-10-02T00:00:00.000Z" class="blogPostDate_3bQP">October 2, 2015  · 2 min read</time></div><div class="avatar margin-vert--md"><div class="avatar__intro"></div></div></header><section class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="overviews---five-ws"></a>Overviews - Five Ws<a aria-hidden="true" tabindex="-1" class="hash-link" href="#overviews---five-ws" title="Direct link to heading">#</a></h2><table><thead><tr><th>问题</th><th>答案</th></tr></thead><tbody><tr><td>是什么</td><td>一套开源的 Java 公共组件</td></tr><tr><td>谁开发的</td><td>主要由 Google 工程师开发维护</td></tr><tr><td>哪里用</td><td>所有使用 Java 的地方</td></tr><tr><td>什么时候出现的</td><td>2008 年九月 第一个 Google Collection 版本出现在 <a href="http://mvnrepository.com/artifact/com.google.collections/google-collections" target="_blank" rel="noopener noreferrer">maven 仓库</a>;<br>2010 年四月第一个 Guava 版本出现在<a href="http://mvnrepository.com/artifact/com.google.guava/guava" target="_blank" rel="noopener noreferrer">maven 仓库</a></td></tr><tr><td>什么使用</td><td>为什么不使用 ?</td></tr></tbody></table></section><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/story/tags/java">Java</a></div><div class="col text--right"><a aria-label="Read more about Guava 简介" href="/story/guava-intro"><strong>Read More</strong></a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_1mse"><a href="/story/2015/09/25/blog-hugo">转战 Hugo, 博客迁移之路</a></h2><div class="margin-vert--md"><time datetime="2015-09-25T09:32:05.000Z" class="blogPostDate_3bQP">September 25, 2015  · 1 min read</time></div><div class="avatar margin-vert--md"><div class="avatar__intro"></div></div></header><section class="markdown"><p>都快要把自己感动, 从最初(2011年)的 Wordpress, 到后来自己开发的 Tellets , 现在又到了 Hugo.</p><p>之所以抛弃 Wordpress 是因为它太笨重了,那些年是租的虚拟主机来挂博客,每年也还会有些投入,但是后来很少维护了,便不在想续费了.</p><p>后面想找一个轻便的能根据文件时生成的博客系统,所幸找到了 Droplet,但发现好多东西都不能满足要求,后来把 Droplet 完全重写成了 Tellts,自己添加的最喜欢的功能是直接配置 Github 的文章引用. Tellets 也是 PHP 的,而且必须要支持文件操作,但很多 PHP 应用服务器都不提供文件操作(例如: 新浪 SEA, 当初的京东云擎),后来主机停了便没有去管了. 再后来有点想用 Go 重写 Tellts, 但实在没时间,然后又过了很长一段时间.</p><p>在工作的情况下需要了解 Docker, 顺势也就利用 Docker 部署了 Hugo.</p></section></article><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/story"><h4 class="pagination-nav__label">« Newer Entries</h4></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/story/page/3"><h4 class="pagination-nav__label">Older Entries »</h4></a></div></nav></main></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">笔记</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/notes/java/java">Java</a></li><li class="footer__item"><a class="footer__link-item" href="/notes/ops/os/alpine/alpine">AlpineLinux</a></li><li class="footer__item"><a class="footer__link-item" href="/notes/devops/kubernetes/k8s-intro">Kubernates</a></li><li class="footer__item"><a class="footer__link-item" href="/notes/voip/voip-intro">VoIP</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Projects</h4><ul class="footer__items"><li class="footer__item">
              <div>
              <a class="footer__link-item" href="https://github.com/wenerme/wener">Wener</a>
              - <a class="footer__link-item" href="https://github.com/wenerme/wener/actions" title="wenerme/wener - ci">
                <img style="vertical-align: middle;opacity: .4;" src="https://github.com/wenerme/wener/workflows/Build/badge.svg">
                </a>
              </div>
              </li><li class="footer__item"><a href="https://apis.wener.me" target="_blank" rel="noopener noreferrer" class="footer__link-item">Wener&#x27;s Apis</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Social</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/story">Blog</a></li><li class="footer__item"><a href="https://github.com/wenerme" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://twitter.com/wenerme" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div></div><div class="text--center"><div class="margin-bottom--sm"><img class="footer__logo" alt="Wener Site" src="/img/wener-logo.svg"></div><div>Copyright © 1992-2020 Wener - 构建时间 2020-10-17 22:57</div></div></div></footer></div>
<script src="/styles.056e693e.js"></script>
<script src="/runtime~main.9748ac90.js"></script>
<script src="/main.8bc432ef.js"></script>
<script src="/1.814e8bab.js"></script>
<script src="/2.374e262d.js"></script>
<script src="/3.ccf1708d.js"></script>
<script src="/a6aa9e1f.31758413.js"></script>
<script src="/01d92d65.6e4faf37.js"></script>
<script src="/681c1604.87aaf470.js"></script>
<script src="/dc9f8bc7.a3d796d4.js"></script>
<script src="/3667dc5f.e3bee78b.js"></script>
<script src="/3bd2f44d.6b61325b.js"></script>
<script src="/d8bff700.36463a03.js"></script>
<script src="/99700096.77cae82c.js"></script>
<script src="/c4c9eda3.c33c7866.js"></script>
<script src="/5a3ed685.a81c52f2.js"></script>
<script src="/51b11dec.7384e675.js"></script>
<script src="/96d535f5.caaccc52.js"></script>
</body>
</html>