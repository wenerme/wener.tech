<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/story/rss.xml" title="Wener Live &amp; Life Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/story/atom.xml" title="Wener Live &amp; Life Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-30404720-1","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-30404720-1"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-30404720-1",{})</script>
<link rel="search" type="application/opensearchdescription+xml" title="Wener Live &amp; Life" href="/opensearch.xml">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css"><title data-react-helmet="true">Alpine 运维笔记 | Wener Live &amp; Life</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://wener.me/notes/os/alpine/alpine-ops"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Alpine 运维笔记 | Wener Live &amp; Life"><meta data-react-helmet="true" name="description" content="Tips"><meta data-react-helmet="true" property="og:description" content="Tips"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://wener.me/notes/os/alpine/alpine-ops"><link data-react-helmet="true" rel="alternate" href="https://wener.me/notes/os/alpine/alpine-ops" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://wener.me/notes/os/alpine/alpine-ops" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.1f8f45d9.css">
<link rel="preload" href="/assets/js/runtime~main.9410da03.js" as="script">
<link rel="preload" href="/assets/js/main.4b2b2a3e.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/wener-logo-head.svg" alt="Wener Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/wener-logo-head.svg" alt="Wener Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Wener</b></a><a class="navbar__item navbar__link" href="/notes/note">笔记</a><a class="navbar__item navbar__link" href="/story">故事</a><a class="navbar__item navbar__link" href="/notes/howto/network/dns-prevent-spoofing">指南</a><a class="navbar__item navbar__link" href="/notes/tool/network/ip-lookup">工具</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/wenerme/wener" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">🌞</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="searchBox_1Doo"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">自我成长</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Java</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Web</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">语言</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">AlpineLinux</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/alpine/alpine">Alpine</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/alpine/alpine-awesome">AlpineLinux Awesome</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/alpine/alpine-boot">Alpin Boot</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/alpine/alpine-chroot">Alpine chroot 环境</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/alpine/alpine-faq">Alpine FAQ</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/alpine/alpine-install">AlpineLinux Install</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/alpine/alpine-intro">Alpine 入门</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/alpine/alpine-lbu">Alpine local backup</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/notes/os/alpine/alpine-ops">Alpine 运维笔记</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/alpine/alpine-pkgs">Alpine 包维护</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/alpine/alpine-setup">AlpineLinux Setup</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/alpine/alpine-version">版本历史</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Docker</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Kubernetes</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Linux</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">虚拟化</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">操作系统</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">VoIP</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">开发</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">DevOps</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">数据库</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">消息队列</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">安全</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">服务</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">运维</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">指南</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">硬件</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">算法</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">健康</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">参考</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">工具</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Alpine 运维笔记</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="tips"></a>Tips<a class="hash-link" href="#tips" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 常用命令</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">lsblk --output NAME,SIZE,VENDOR,FSTYPE,LABEL,UUID,MODE</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 使用 NAME 排序</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">lsblk -x NAME --output NAME,SIZE,VENDOR,FSTYPE,LABEL,UUID,MODE</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 基础安装包</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> wpa_supplicant e2fsprogs-extra</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="bash"></a>bash<a class="hash-link" href="#bash" title="Direct link to heading">#</a></h2><ul><li><a href="https://pkgs.alpinelinux.org/packages?name=*-bash-completion&amp;branch=v3.6&amp;repo=&amp;arch=x86_64" target="_blank" rel="noopener noreferrer">*-bash-completion</a><ul><li>其他的 bash 补全的包</li></ul></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Bash</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> shadow </span><span class="token function" style="color:rgb(130, 170, 255)">bash</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">usermod</span><span class="token plain"> --shell /bin/bash admin</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 该步骤要求输入密码</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># chsh root -s /bin/bash</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 补全</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> bash-completion</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 加载补全</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">source</span><span class="token plain"> /etc/profile.d/bash_completion.sh</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="manpages"></a>manpages<a class="hash-link" href="#manpages" title="Direct link to heading">#</a></h2><ul><li>Alpine 默认不会安装 doc 和 man</li><li>所有的文档以 -doc 结尾</li><li>文档位于 /usr/share/man</li><li><a href="https://wiki.alpinelinux.org/wiki/How_to_get_regular_stuff_working" target="_blank" rel="noopener noreferrer">How to get regular stuff working</a></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> --no-cache </span><span class="token function" style="color:rgb(130, 170, 255)">man</span><span class="token plain"> man-pages mdocml-apropos </span><span class="token function" style="color:rgb(130, 170, 255)">less</span><span class="token plain"> less-doc</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">PAGER</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">less</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 安装和查看</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> --no-cache curl-doc</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">man</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 或者直接使用 docker 便于查文档</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run --rm -it wener/base:man</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 可以安装映射到主机</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run --rm -it -v </span><span class="token environment constant" style="color:rgb(130, 170, 255)">$PWD</span><span class="token plain">/man:/usr/share/man wener/base:man</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="基础运维"></a>基础运维<a class="hash-link" href="#基础运维" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 基础工具</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">nano</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">file</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">grep</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">htop</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">rsync</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> openssl</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 简化链接</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> tmux mosh</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># sshrc - https://github.com/Russell91/sshrc</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 依赖包</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">vim</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">tar</span><span class="token plain"> coreutils openssl</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 证书</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># /etc/ssl/certs/ca-certificates.crt</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 系统信息</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> neofetch</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="系统运维"></a>系统运维<a class="hash-link" href="#系统运维" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 常用工具</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> util-linux</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 扩展工具</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> blkid </span><span class="token function" style="color:rgb(130, 170, 255)">cfdisk</span><span class="token plain"> findmnt mcookie setpriv sfdisk</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 补全</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> util-linux-bash-completion</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 信息查询工具</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">lsof</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="硬件运维"></a>硬件运维<a class="hash-link" href="#硬件运维" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> pciutils</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> usbutils</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">parted</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">ddrescue</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># dmidecode ownership vpddecode biosdecode</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> dmidecode</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="setup-disk"></a>setup-disk<a class="hash-link" href="#setup-disk" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 制作系统盘</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># swap 0</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">setup-disk -m sys -s </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"> -v /dev/sda</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># ==========</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 新系统检查项</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># ==========</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 修改主机名</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">setup-hostname -n alpine-test</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">/etc/init.d/hostname --quiet restart</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">nano</span><span class="token plain"> /etc/hosts</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 修改网络地址</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">nano</span><span class="token plain"> /etc/network/interfaces</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="本地仓库"></a>本地仓库<a class="hash-link" href="#本地仓库" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token assign-left variable" style="color:rgb(191, 199, 213)">ARCH</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable" style="color:rgb(191, 199, 213)">apk print --print-arch</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">REPO</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token environment constant" style="color:rgb(130, 170, 255)">$PWD</span><span class="token plain">/repo</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">mkdir</span><span class="token plain"> -p </span><span class="token variable" style="color:rgb(191, 199, 213)">$REPO</span><span class="token plain">/</span><span class="token variable" style="color:rgb(191, 199, 213)">$ARCH</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk fetch -vRo </span><span class="token variable" style="color:rgb(191, 199, 213)">$REPO</span><span class="token plain">/</span><span class="token variable" style="color:rgb(191, 199, 213)">$ARCH</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">nano</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 可以指定仓库</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk fetch -vRo </span><span class="token variable" style="color:rgb(191, 199, 213)">$REPO</span><span class="token plain">/</span><span class="token variable" style="color:rgb(191, 199, 213)">$ARCH</span><span class="token plain"> -X http://mirrors.aliyun.com/alpine/edge/main --no-cache linux-firmware-brcm</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 创建索引</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 这里的 APKINDEX 是未签名的</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk index -o </span><span class="token variable" style="color:rgb(191, 199, 213)">$REPO</span><span class="token plain">/</span><span class="token variable" style="color:rgb(191, 199, 213)">$ARCH</span><span class="token plain">/APKINDEX.tar.gz </span><span class="token variable" style="color:rgb(191, 199, 213)">$REPO</span><span class="token plain">/</span><span class="token variable" style="color:rgb(191, 199, 213)">$ARCH</span><span class="token plain">/*.apk</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk -X </span><span class="token variable" style="color:rgb(191, 199, 213)">$REPO</span><span class="token plain"> update --allow-untrust</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk -X </span><span class="token variable" style="color:rgb(191, 199, 213)">$REPO</span><span class="token plain"> search --allow-untrust </span><span class="token function" style="color:rgb(130, 170, 255)">nano</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="容器"></a>容器<a class="hash-link" href="#容器" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Docker</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> docker</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">rc-update </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> docker</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="磁盘扩展"></a>磁盘扩展<a class="hash-link" href="#磁盘扩展" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 扩展分区</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 假设分区结构为: boot,swap,root,空闲</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 删除最后一个分区, 再创建最后一个分区, 确保起点位置不变</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># F 可以看到空余空间</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 手动分区</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># fdisk /dev/sda</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 或直接分区</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> util-linux</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">echo</span><span class="token plain"> -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;d</span><span class="token string entity" style="color:rgb(195, 232, 141)">\n</span><span class="token string entity" style="color:rgb(195, 232, 141)">\n</span><span class="token string" style="color:rgb(195, 232, 141)">n</span><span class="token string entity" style="color:rgb(195, 232, 141)">\n</span><span class="token string entity" style="color:rgb(195, 232, 141)">\n</span><span class="token string entity" style="color:rgb(195, 232, 141)">\n</span><span class="token string entity" style="color:rgb(195, 232, 141)">\n</span><span class="token string entity" style="color:rgb(195, 232, 141)">\n</span><span class="token string entity" style="color:rgb(195, 232, 141)">\n</span><span class="token string" style="color:rgb(195, 232, 141)">p</span><span class="token string entity" style="color:rgb(195, 232, 141)">\n</span><span class="token string" style="color:rgb(195, 232, 141)">w</span><span class="token string entity" style="color:rgb(195, 232, 141)">\n</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">fdisk</span><span class="token plain"> /dev/sda</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 重启</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 不重启应该也是可以的 - ext4 支持在线扩容</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># reboot</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 扩展文件系统</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> e2fsprogs-extra</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">resize2fs /dev/sda2</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 检查结果</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">df</span><span class="token plain"> -h /</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># parted 也可以</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">parted</span><span class="token plain"> /dev/sdb resize </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> 200M</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">parted</span><span class="token plain"> /dev/sdb resizepart </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> 400M</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">resize2fs /dev/sdb1 400M</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="udev"></a>udev<a class="hash-link" href="#udev" title="Direct link to heading">#</a></h2><ul><li>Gentoo <a href="https://wiki.gentoo.org/wiki/Project:Eudev" target="_blank" rel="noopener noreferrer">Eudev</a></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 设置 /dev/disk</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> udev-init-scripts</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># OpenRC compatible fork of systemd-udev</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> eudev</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># init: udev udev-trigger udev-postmount udev-settle</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">rc-update </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> udev sysinit</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">rc-update </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> udev-trigger sysinit</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 如果想要立即启用</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">rc-service udev start</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">rc-service udev-trigger start</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">udevadm trigger</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 该包会影响网卡名字</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 会添加 /lib/udev/rules.d/80-net-name-slot.rules</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 需要参数 net.ifnames=0 来关闭</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 大多数时候不需要</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># apk add eudev-netifnames</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 所有定义的规则</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">udevadm info --export-db</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="zfs"></a>zfs<a class="hash-link" href="#zfs" title="Direct link to heading">#</a></h2><ul><li>先安装 <a href="#udev">udev</a> 环境</li><li>使用 zfs 时最好使用 uuid, 因为名字可能会发生变化</li><li>0.6 时, 导致直接系统重启</li><li>0.6 的 init 不是 openrc 的脚本, 启动会警告</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> zfs zfs-</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">scripts,udev,utils-py</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># vanilla 内核</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> zfs-vanilla</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 加载内核模块</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">modprobe zfs</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">echo</span><span class="token plain"> zfs </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;&gt;</span><span class="token plain"> /etc/modules</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># init: zfs-import zfs-mount zfs-share zfs-zed</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">rc-update </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> zfs-import sysinit</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">rc-update </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> zfs-mount sysinit</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 立即启动</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">rc-service zfs-import start</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">rc-service zfs-mount start</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 检测是否正常</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">zpool status</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 查看磁盘量</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">parted</span><span class="token plain"> --list</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 查看现有磁盘 UUID</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 依赖于 udev</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 一般会有 ata, scsi, wwn 前缀之类</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">ls</span><span class="token plain"> -lh /dev/disk/by-id/</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 只看主盘</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">ls</span><span class="token plain"> -lh /dev/disk/by-id/ </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">grep</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;sd.$&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># -f 强制创建, 避免 Does not contain an EFI label 错误</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># -o ashift=12 使用高级磁盘格式</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># -m /mnt/data 指定挂载点, 不指定则默认挂载为 /&lt;pool&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># p1 Pool 的名字</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># raidz 使用 RADI-Z 冗余</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">zpool create -f -o </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">ashift</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">12</span><span class="token plain"> -m /mnt/data p1 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  raidz </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ata-VBOX_HARDDISK_VB63cffc10-3a66b288 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ata-VBOX_HARDDISK_VBfb21373d-56cc6c57 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ata-VBOX_HARDDISK_VB91ae7aad-d4a73895</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 查看状态</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">zpool status</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#   pool: p1</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#  state: ONLINE</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#   scan: none requested</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># config:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#   NAME                                       STATE     READ WRITE CKSUM</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#   p1                                         ONLINE       0     0     0</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#     raidz1-0                                 ONLINE       0     0     0</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#       ata-VBOX_HARDDISK_VB63cffc10-3a66b288  ONLINE       0     0     0</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#       ata-VBOX_HARDDISK_VBfb21373d-56cc6c57  ONLINE       0     0     0</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#       ata-VBOX_HARDDISK_VB91ae7aad-d4a73895  ONLINE       0     0     0</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># errors: No known data errors</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 此时可以重启测试看看 pool 是否还在</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">zpool status -x</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 将 scrub 作为周期性任务</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 一般一两周一次, 至少一月一次</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;#!/bin/sh -</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">zpool scrub main</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> /etc/periodic/weekly/zfs-scrub</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">chmod</span><span class="token plain"> +x /etc/periodic/weekly/zfs-scrub</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 测试 crond</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># busybox 的 run-parts 功能较少</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> run-parts</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">run-parts /etc/periodic/weekly -v --report</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="uninstall-zfs"></a>uninstall zfs<a class="hash-link" href="#uninstall-zfs" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 销毁使用的 pool</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">zpool destroy pool</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 停止 service</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">rc-service zfs-import stop</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">rc-service zfs-mount stop</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 移除 init</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">rc-update del zfs-import sysinit</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">rc-update del zfs-mount sysinit</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 移除内核模块</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">modprobe -r zfs</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="btrfs"></a>btrfs<a class="hash-link" href="#btrfs" title="Direct link to heading">#</a></h2><ul><li><p>kernel <a href="https://btrfs.wiki.kernel.org/" target="_blank" rel="noopener noreferrer">btrfs</a></p><ul><li><a href="https://btrfs.wiki.kernel.org/index.php/Manpage/btrfs(5)" target="_blank" rel="noopener noreferrer">btrfs.5</a></li><li><a href="https://btrfs.wiki.kernel.org/index.php/Status" target="_blank" rel="noopener noreferrer">Status</a></li><li><a href="https://btrfs.wiki.kernel.org/index.php/Mount_options" target="_blank" rel="noopener noreferrer">Mount options</a></li><li><a href="https://btrfs.wiki.kernel.org/index.php/Incremental_Backup" target="_blank" rel="noopener noreferrer">Incremental Backup</a></li><li><a href="https://btrfs.wiki.kernel.org/index.php/Problem_FAQ" target="_blank" rel="noopener noreferrer">FAQ</a></li><li><a href="https://btrfs.wiki.kernel.org/index.php/Gotchas" target="_blank" rel="noopener noreferrer">Gotchas</a><ul><li>不建议使用 RAID5, RAID6</li></ul></li><li><a href="https://btrfs.wiki.kernel.org/index.php/Using_Btrfs_with_Multiple_Devices" target="_blank" rel="noopener noreferrer">Using Btrfs with Multiple Devices</a></li></ul></li><li><p>Debian <a href="https://wiki.debian.org/Btrfs" target="_blank" rel="noopener noreferrer">Btrfs</a></p><ul><li>不要使用 4.11.x</li><li>quotas 和 qgroups 有问题</li><li>subvol 不能够被挂在为不同的选项</li><li>compress=lzo 可能比较危险</li><li>-o compress 可能会放大碎片</li></ul></li><li><p>Archlinux <a href="https://wiki.archlinux.org/index.php/Btrfs" target="_blank" rel="noopener noreferrer">Btrfs</a></p><ul><li><a href="https://wiki.archlinux.org/index.php/Btrfs_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)" target="_blank" rel="noopener noreferrer">中文</a></li></ul></li><li><p>raid0, raid1, raid5, raid6, raid10, dup, single</p></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 辅助程序</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> btrfs-progs</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> btrfs-progs-extra</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 补全</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> btrfs-progs-bash-completion</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 加载内核模块</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">modprobe btrfs</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 确保启动时加载</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">echo</span><span class="token plain"> btrfs </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;&gt;</span><span class="token plain"> /etc/modules</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 加载模块后会生成, 如果没有可以手动创建</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># mknod /dev/btrfs-control c 10 234</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># -M 混合元数据和数据, 适用于小数据, 数据大了过后磁盘布局不可预见</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># -L 指定标签</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># -U 可手动指定 UUID, 避免修改 fstab</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># -O 指定特性</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mkfs.btrfs --help</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 查看支持的特性</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mkfs.btrfs -O list-all</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># mixed-bg            - mixed data and metadata block groups (0x4, compat=2.6.37, safe=2.6.37)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># extref              - increased hardlink limit per file to 65536 (0x40, compat=3.7, safe=3.12, default=3.12)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># raid56              - raid56 extended format (0x80, compat=3.9)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># skinny-metadata     - reduced-size metadata extent refs (0x100, compat=3.10, safe=3.18, default=3.18)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># no-holes            - no explicit hole extents for files (0x200, compat=3.14, safe=4.0)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># a.b.c.d 做 raid 1</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 这几个设备的 uuid 会变成一样</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mkfs.btrfs -d raid1 -m raid1 /dev/sd</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">a,b,c,d</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 此时可以将任意一个设备进行挂载</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">mount</span><span class="token plain"> /dev/sda /mnt/main/</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 设备扫描</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">btrfs device scan</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 查看文件系统</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">btrfs filesystem show</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 查看使用量</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">btrfs </span><span class="token keyword" style="font-style:italic">fi</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">df</span><span class="token plain"> /data</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 执行 scrub</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># https://btrfs.wiki.kernel.org/index.php/Manpage/btrfs-scrub</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 结果会存储于 /var/lib/btrfs/</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">btrfs sc start /data</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 查看执行状态</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">btrfs sc status /data</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 执行 check</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># check or repair a btrfs filesystem</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># https://btrfs.wiki.kernel.org/index.php/Manpage/btrfs-check</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 不建议执行在线检测</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 自动挂载需要修改 /etc/fstab</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;UUID=</span><span class="token string variable" style="color:rgb(191, 199, 213)">$(</span><span class="token string variable" style="color:rgb(191, 199, 213)">blkid -s UUID -o value /dev/sda</span><span class="token string variable" style="color:rgb(191, 199, 213)">)</span><span class="token string" style="color:rgb(195, 232, 141)"> /data btrfs defaults 0 0&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;&gt;</span><span class="token plain"> /etc/fstab</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="failed-to-read-the-system-array"></a>failed to read the system array<a class="hash-link" href="#failed-to-read-the-system-array" title="Direct link to heading">#</a></h3><ul><li>会导致启动时挂载失败</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1985.671707</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> BTRFS info </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">device sde</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">: disk space caching is enabled</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1985.671712</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> BTRFS info </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">device sde</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">: has skinny extents</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1985.675608</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> BTRFS error </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">device sde</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">: failed to </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">read</span><span class="token plain"> the system array: -5</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1985.731217</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> BTRFS error </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">device sde</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">: open_ctree failed</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 从新扫描后挂载</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">btrfs dev scan</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">mount</span><span class="token plain"> -a</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 如果还不行可以尝试</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">btrfs rescue zero-log /dev/sde</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">mount</span><span class="token plain"> -a</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="networking"></a>networking<a class="hash-link" href="#networking" title="Direct link to heading">#</a></h2><ul><li>auto<ul><li>try to <code>ip link set &lt;dev&gt; up</code>  at boot.  Best choice for anything PCIe/SoC.</li></ul></li><li>allow-hotplug<ul><li>for kernel+drivers+udev to detect the device, then <code>ip link set &lt;dev&gt; up</code> it.  The only thing that can deal with annoying USB, SDIO, etc.</li></ul></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">ethtool</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 支持更多的参数</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> ifupdown</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> iftop</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 支持 -v</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> run-parts</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> iproute2</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># A utility to ping multiple hosts at once</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># http://fping.org/</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> fping</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 设置地址和掩码</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">ifconfig</span><span class="token plain"> eth1 </span><span class="token number" style="color:rgb(247, 140, 108)">192.168</span><span class="token plain">.8.182 netmask </span><span class="token number" style="color:rgb(247, 140, 108)">255.255</span><span class="token plain">.252.0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 实际调用</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 这里的 run-parts 可能是 busybox 的 run-parts, 不支持 -v, 建议额外安装</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># run-parts --exit-on-error --verbose /etc/network/if-pre-up.d</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># ip addr add 192.168.8.182/255.255.252.0 broadcast 192.168.11.255    dev eth1 label eth1</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">ifup</span><span class="token plain"> -v eth1</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># 一个网卡, 多个网关</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">auto eth0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">iface eth0 inet static</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    address 10.1.248.11</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    netmask 255.255.255.0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    up ip route add default via 10.1.248.1 dev eth0  metric 100</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    up ip route add default via 10.1.248.3 dev eth0  metric 200</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># 一个网卡, 多个地址</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">auto eth0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">iface eth0 inet static</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  address aaa.aaa.aaa.aaa</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  netmask 255.255.254.0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  gateway bbb.bbb.bbb.bbb</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  dns-nameservers ccc.ccc.ccc.ccc ddd.ddd.ddd.ddd eee.eee.eee.eee</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  dns-search vps-number.com</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  # 或者</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  up ip addr add fff.fff.fff.fff/prefixlen dev eth0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">auto eth0:0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">iface eth0:0 inet static</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  address fff.fff.fff.fff</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  netmask 255.255.254.0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="network-benchmark"></a>network benchmark<a class="hash-link" href="#network-benchmark" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> iperf3 iptraf-ng iftop</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">iperf3 -s</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">iperf3 -c HOST</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="init"></a>init<a class="hash-link" href="#init" title="Direct link to heading">#</a></h2><ul><li>openrc</li><li><code>/etc/conf.d/localmount</code><ul><li>可配置强制挂载点</li></ul></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly conf"><pre tabindex="0" class="prism-code language-conf codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="iscsi"></a>iscsi<a class="hash-link" href="#iscsi" title="Direct link to heading">#</a></h2><ul><li><a href="https://github.com/open-iscsi" target="_blank" rel="noopener noreferrer">https://github.com/open-iscsi</a></li><li><a href="https://github.com/open-iscsi/open-iscsi" target="_blank" rel="noopener noreferrer">https://github.com/open-iscsi/open-iscsi</a></li><li><a href="https://github.com/open-iscsi/targetcli-fb" target="_blank" rel="noopener noreferrer">https://github.com/open-iscsi/targetcli-fb</a></li><li><a href="https://wiki.archlinux.org/index.php/ISCSI_Target" target="_blank" rel="noopener noreferrer">https://wiki.archlinux.org/index.php/ISCSI_Target</a></li></ul><p><a href="http://scst.sourceforge.net/" target="_blank" rel="noopener noreferrer">http://scst.sourceforge.net/</a></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># An administration shell for storage targets</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># init: targetcli</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># bin: targetcli</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># apk add targetcli</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># ISCSI target for SCST - userspace tools</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># apk add iscsi-scst</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># High performance, transport independent, multi-platform iSCSI initiator</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># init: iscsid</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># bin: iscsi_discovery, iscsiadm, iscsi-iname</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># sbin: iscsid, iscsistart</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># conf:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#   /etc/iscsi/initiatorname.iscsi</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#   /etc/iscsi/iscsid.conf</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#   /etc/iscsi/ifaces/iface</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> open-iscsi</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="netatalk"></a>netatalk<a class="hash-link" href="#netatalk" title="Direct link to heading">#</a></h2><ul><li><a href="http://netatalk.sourceforge.net" target="_blank" rel="noopener noreferrer">netatalk</a></li><li><a href="https://en.wikipedia.org/wiki/Netatalk" target="_blank" rel="noopener noreferrer">Netatalk:wiki</a></li><li><a href="https://en.wikipedia.org/wiki/Apple_Filing_Protocol" target="_blank" rel="noopener noreferrer">APF</a> - Apple Filing Protocol<ul><li>CNID - Catalog Node ID</li><li>使用 ID 引用, 而非路径</li></ul></li><li><a href="http://netatalk.sourceforge.net/3.1/htmldocs/configuration.html" target="_blank" rel="noopener noreferrer">http://netatalk.sourceforge.net/3.1/htmldocs/configuration.html</a></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="stress"></a>stress<a class="hash-link" href="#stress" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">stress --vm-bytes </span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable function" style="color:rgb(130, 170, 255)">awk</span><span class="token variable" style="color:rgb(191, 199, 213)"> </span><span class="token variable string" style="color:rgb(195, 232, 141)">&#x27;/MemFree/{printf &quot;%d</span><span class="token variable string entity" style="color:rgb(195, 232, 141)">\n</span><span class="token variable string" style="color:rgb(195, 232, 141)">&quot;, </span><span class="token variable string variable" style="color:rgb(191, 199, 213)">$2</span><span class="token variable string" style="color:rgb(195, 232, 141)"> * 0.9;}&#x27;</span><span class="token variable" style="color:rgb(191, 199, 213)"> </span><span class="token variable operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token variable" style="color:rgb(191, 199, 213)"> /proc/meminfo</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain">k --vm-keep -m </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">stress --vm-bytes </span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable function" style="color:rgb(130, 170, 255)">awk</span><span class="token variable" style="color:rgb(191, 199, 213)"> </span><span class="token variable string" style="color:rgb(195, 232, 141)">&#x27;/MemFree/{printf &quot;%d</span><span class="token variable string entity" style="color:rgb(195, 232, 141)">\n</span><span class="token variable string" style="color:rgb(195, 232, 141)">&quot;, </span><span class="token variable string variable" style="color:rgb(191, 199, 213)">$2</span><span class="token variable string" style="color:rgb(195, 232, 141)"> * 0.097;}&#x27;</span><span class="token variable" style="color:rgb(191, 199, 213)"> </span><span class="token variable operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token variable" style="color:rgb(191, 199, 213)"> /proc/meminfo</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain">k --vm-keep -m </span><span class="token number" style="color:rgb(247, 140, 108)">10</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="disk"></a>disk<a class="hash-link" href="#disk" title="Direct link to heading">#</a></h2><ul><li>badblocks</li><li>e2fsprogs-extra</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> cdrkit</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 检测 iso 是否可启动</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 结果中会包含 El Torito 信息</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># https://en.wikipedia.org/wiki/El_Torito_(CD-ROM_standard)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">isoinfo -d -i is_it_bootable.iso</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># burn iso</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">pv</span><span class="token plain"> spp-2016.10.0.iso </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">dd</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">bs</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">4M </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">of</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">/dev/sdd</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="qemu"></a>QEMU<a class="hash-link" href="#qemu" title="Direct link to heading">#</a></h2><ul><li><a href="https://www.qemu.org/" target="_blank" rel="noopener noreferrer">QEMU</a><ul><li><a href="https://qemu.weilnetz.de/doc/qemu-doc.html" target="_blank" rel="noopener noreferrer">Doc</a></li></ul></li></ul><p>If you want to run VM as unprivileged user and let Qemu create tunX devices,
then you must add that user to the group &quot;qemu&quot;.
If you use KVM for hardware-assisted virtualization, then you may also need
to add that user to the group &quot;kvm&quot;.</p><p><a href="https://wiki.archlinux.org/index.php/QEMU_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)" target="_blank" rel="noopener noreferrer">https://wiki.archlinux.org/index.php/QEMU_(简体中文)</a></p><p><a href="https://allyourco.de/running-vmware-esxi-under-qemu-kvm/" target="_blank" rel="noopener noreferrer">https://allyourco.de/running-vmware-esxi-under-qemu-kvm/</a></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="kvm"></a>kvm<a class="hash-link" href="#kvm" title="Direct link to heading">#</a></h3><ul><li><a href="https://wiki.alpinelinux.org/wiki/KVM" target="_blank" rel="noopener noreferrer">https://wiki.alpinelinux.org/wiki/KVM</a></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 基础</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> qemu-system-x86_64 libvirt</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 32 位</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> qemu-system-i386</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 如果需要 GUI 管理</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> libvirt-daemon dbus polkit</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 如果想用其他磁盘格式</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> qemu-img</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 启用内核模块</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">modprobe kvm-intel</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">echo</span><span class="token plain"> kvm-intel </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;&gt;</span><span class="token plain"> /etc/modules</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 如果是 AMD</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># modprobe kvm-amd</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 开机启用</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">rc-update </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> libvirtd</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">rc-update </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> dbus</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># KVM 默认会桥接 NAT, 如果想使用默认的网络配置, 需要加载 tun 模块</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">modprobe tun</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 添加用户到分组</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">addgroup </span><span class="token environment constant" style="color:rgb(130, 170, 255)">$USER</span><span class="token plain"> kvm</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">addgroup </span><span class="token environment constant" style="color:rgb(130, 170, 255)">$USER</span><span class="token plain"> qemu</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">addgroup </span><span class="token environment constant" style="color:rgb(130, 170, 255)">$USER</span><span class="token plain"> libvirt</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="virtual-disk"></a>virtual-disk<a class="hash-link" href="#virtual-disk" title="Direct link to heading">#</a></h3><ul><li><a href="https://en.wikibooks.org/wiki/QEMU/Images" target="_blank" rel="noopener noreferrer">https://en.wikibooks.org/wiki/QEMU/Images</a></li><li>qemu-nbd<ul><li>QEMU Disk Network Block Device Server</li></ul></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">modprobe nbd </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">max_part</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">16</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 链接</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">qemu-nbd -c /dev/nbd0 image.qcow2</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">partprobe /dev/nbd0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 挂载</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">mount</span><span class="token plain"> /dev/nbd0p1 /mnt/image</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">umount</span><span class="token plain"> /mnt/image</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 断开连接</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">qemu-nbd -c /dev/nbd0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="ftp"></a>ftp<a class="hash-link" href="#ftp" title="Direct link to heading">#</a></h2><ul><li>Archlinux <a href="https://wiki.archlinux.org/index.php/Very_Secure_FTP_Daemon" target="_blank" rel="noopener noreferrer">vsftpd</a></li><li><a href="http://vsftpd.beasts.org/vsftpd_conf.html" target="_blank" rel="noopener noreferrer">vsftpd.conf</a></li><li><a href="https://security.appspot.com/vsftpd.html" target="_blank" rel="noopener noreferrer">https://security.appspot.com/vsftpd.html</a></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> vsftp</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 修改配置</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">nano</span><span class="token plain"> /etc/vsftpd/vsftpd.conf</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 最简配置, 允许匿名操作</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">cp</span><span class="token plain"> /etc/vsftpd/vsftpd.conf /etc/vsftpd/vsftpd.conf.old</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">anonymous_enable=YES</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">write_enable=YES</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">anon_upload_enable=YES</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">anon_mkdir_write_enable=YES</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">dirmessage_enable=YES</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">xferlog_enable=YES</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">xferlog_file=/dev/stdout</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">connect_from_port_20=YES</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">ftpd_banner=Welcome to wener FTP service.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">listen=YES</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">background=NO</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> /etc/vsftpd/vsftpd.conf</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="lvm"></a>lvm<a class="hash-link" href="#lvm" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> lvm2</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">modprobe dm-mod</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 扫描逻辑分组</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">vgscan</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 激活</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">vgchange -ay SangomaVG</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">lvs</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 挂载</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">mount</span><span class="token plain"> /dev/SangomaVG/root /mnt/data</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="libguestfs"></a>libguestfs<a class="hash-link" href="#libguestfs" title="Direct link to heading">#</a></h2><ul><li><a href="https://en.wikipedia.org/wiki/Libguestfs" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/Libguestfs</a></li><li><a href="https://bugs.alpinelinux.org/issues/1792" target="_blank" rel="noopener noreferrer">https://bugs.alpinelinux.org/issues/1792</a></li><li>会编译失败, 因为用了 glibc 特有的 printf 修饰符<ul><li><a href="https://www.redhat.com/archives/libguestfs/2016-August/msg00002.html" target="_blank" rel="noopener noreferrer">https://www.redhat.com/archives/libguestfs/2016-August/msg00002.html</a></li><li>No support for glibc-style extended printf formatters.</li></ul></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">guestfish: guest filesystem shell</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">guestfish lets you edit virtual machine filesystems</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Copyright (C) 2009-2016 Red Hat Inc.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Usage:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  guestfish [--options] cmd [: cmd : cmd ...]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Options:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -h|--cmd-help        List available commands</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -h|--cmd-help cmd    Display detailed help on &#x27;cmd&#x27;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -a|--add image       Add image</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -c|--connect uri     Specify libvirt URI for -d option</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --csh                Make --listen csh-compatible</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -d|--domain guest    Add disks from libvirt guest</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --echo-keys          Don&#x27;t turn off echo for passphrases</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -f|--file file       Read commands from file</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --format[=raw|..]    Force disk format for -a option</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -i|--inspector       Automatically mount filesystems</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --keys-from-stdin    Read passphrases from stdin</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --listen             Listen for remote commands</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --live               Connect to a live virtual machine</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -m|--mount dev[:mnt[:opts[:fstype]]]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       Mount dev on mnt (if omitted, /)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --network            Enable network</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -N|--new [filename=]type</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       Create prepared disk (test&lt;N&gt;.img or filename)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -n|--no-sync         Don&#x27;t autosync</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --no-dest-paths      Don&#x27;t tab-complete paths from guest fs</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --pipe-error         Pipe commands can detect write errors</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --progress-bars      Enable progress bars even when not interactive</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --no-progress-bars   Disable progress bars</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --remote[=pid]       Send commands to remote guestfish</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -r|--ro              Mount read-only</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --selinux            Enable SELinux support</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -v|--verbose         Verbose messages</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -V|--version         Display version and exit</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -w|--rw              Mount read-write</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -x                   Echo each command before executing it</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">To examine a disk image, ISO, hard disk, filesystem etc:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  guestfish [--ro|--rw] -i -a /path/to/disk.img</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">or</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  guestfish [--ro|--rw] -i -d name-of-libvirt-domain</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--ro recommended to avoid any writes to the disk image.  If -i option fails</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">run again without -i and use &#x27;run&#x27; + &#x27;list-filesystems&#x27; + &#x27;mount&#x27; cmds.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">For more information, see the manpage guestfish(1).</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="acf"></a>acf<a class="hash-link" href="#acf" title="Direct link to heading">#</a></h2><ul><li><a href="https://wiki.alpinelinux.org/wiki/Alpine_Configuration_Framework_Design" target="_blank" rel="noopener noreferrer">Alpine Configuration Framework Design</a></li><li><a href="https://wiki.alpinelinux.org/wiki/ACF_packages" target="_blank" rel="noopener noreferrer">ACF packages</a></li><li><a href="https://pkgs.alpinelinux.org/packages?name=acf-*&amp;branch=v3.6&amp;arch=x86_64" target="_blank" rel="noopener noreferrer">acf-*</a></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="crond"></a>crond<a class="hash-link" href="#crond" title="Direct link to heading">#</a></h2><ul><li>实际执行时使用的 run-parts</li><li>busybox 自带的 run-parts 功能较少, 可额外安装</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">echo &#x27;CRON_OPTS=&quot;-c /etc/crontabs -L /var/log/crond.log -l 6&quot;&#x27; &gt; /etc/conf.d/crond</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">rc-update add crond</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">rc-service crond restart</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">BusyBox v1.26.2 (2017-10-04 13:37:41 GMT) multi-call binary.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Usage: run-parts [-a ARG]... [-u UMASK] [--reverse] [--test] [--exit-on-error] DIRECTORY</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Run a bunch of scripts in DIRECTORY</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    -a ARG      Pass ARG as argument to scripts</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    -u UMASK    Set UMASK before running scripts</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --reverse   Reverse execution order</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --test      Dry run</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --exit-on-error Exit if a script exits with non-zero</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Usage: run-parts [OPTION]... DIRECTORY</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      --test          print script names which would run, but don&#x27;t run them.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      --list          print names of all valid files (can not be used with</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                      --test)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -v, --verbose       print script names before running them.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      --report        print script names if they produce output.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      --reverse       reverse execution order of scripts.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      --exit-on-error exit as soon as a script returns with a non-zero exit</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                      code.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      --lsbsysinit    validate filenames based on LSB sysinit specs.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      --new-session   run each script in a separate process session</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      --regex=PATTERN validate filenames based on POSIX ERE pattern PATTERN.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -u, --umask=UMASK   sets umask to UMASK (octal), default is 022.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -a, --arg=ARGUMENT  pass ARGUMENT to scripts, use once for each argument.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -V, --version       output version information and exit.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -h, --help          display this help and exit.</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="wireguard"></a>wireguard<a class="hash-link" href="#wireguard" title="Direct link to heading">#</a></h2><ul><li>3.8 还没有，需要使用 edge</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">qemu-img create -f raw edge-virt.raw 300M</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">wget</span><span class="token plain"> https://mirrors.tuna.tsinghua.edu.cn/alpine/v3.8/releases/x86_64/alpine-virt-3.8.2-x86_64.iso</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">qemu-system-x86_64 -m 2g -hda edge-virt.raw -net nic -net user,hostfwd</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">tcp::2222-:22 -cdrom alpine-virt-3.8.2-x86_64.iso -boot d</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Setup VM</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">setup-interfaces</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">rc-service networking restart</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">setup-sshd -c openssh</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;PermitRootLogin yes&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;&gt;</span><span class="token plain"> /etc/ssh/sshd_config</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">echo</span><span class="token plain"> root:root </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> chpasswd</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">rc-service sshd restart</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># From Host</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ssh-keygen -R </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">127.0</span><span class="token plain">.0.1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">:2222</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">ssh</span><span class="token plain"> root@127.0.0.1 -p </span><span class="token number" style="color:rgb(247, 140, 108)">2222</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;http://mirrors.aliyun.com/alpine/edge/main</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">http://mirrors.aliyun.com/alpine/edge/community</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">http://mirrors.aliyun.com/alpine/edge/testing&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;&gt;</span><span class="token plain"> /etc/apk/repositories</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk update</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">ERASE_DISKS</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">/dev/sda setup-disk -m sys -s </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"> /dev/sda</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">poweroff</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="faq"></a>FAQ<a class="hash-link" href="#faq" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="ip-ioctl-0x8913-failed-no-such-device"></a>ip: ioctl 0x8913 failed: no such device<a class="hash-link" href="#ip-ioctl-0x8913-failed-no-such-device" title="Direct link to heading">#</a></h3><ul><li>可能是网卡名字发生了改变</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="恢复网卡名字"></a>恢复网卡名字<a class="hash-link" href="#恢复网卡名字" title="Direct link to heading">#</a></h3><ul><li>安装 udev 后可能会出现, 因为 udev 可能会进行重命名</li><li>此时 eth0 可能就不存在了, 此时可能名字为 enp0s3 这样的</li><li>在 udev 中改变 if name 的为独立包, <code>	eudev-netifnames</code>, 将该包移除即可<ul><li><code>/lib/udev/rules.d/80-net-name-slot.rules</code></li></ul></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 查看网络设备名</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">cat</span><span class="token plain"> /proc/net/dev</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 查看网络控制器</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">lspci </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">egrep</span><span class="token plain"> -i --color </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;network|ethernet&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 查看网络相关硬件</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">lshw -class network</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">ifconfig</span><span class="token plain"> -a</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">ip</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">link</span><span class="token plain"> show</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">ip</span><span class="token plain"> a</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="文件系统变成了只读"></a>文件系统变成了只读<a class="hash-link" href="#文件系统变成了只读" title="Direct link to heading">#</a></h3><ul><li>看看 <code>/etc/fstab</code> 的 UUID 是否有多的,错误的或重复的</li><li>使用 df 查看当前挂载设备</li><li>blkid 查看设备 UUID</li><li>从新挂载为读写 <code>mount -rw -o remount UUID=&lt;正确的 UUID&gt; /</code></li><li>修改 <code>/etc/fstab</code></li><li>重启</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="find-sysmodulepcc_cpufreq"></a>find: /sys/module/pcc_cpufreq<a class="hash-link" href="#find-sysmodulepcc_cpufreq" title="Direct link to heading">#</a></h3><ul><li>查看 linux/cpufreq</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="traps-rc-status3854-general-protection"></a>traps: rc-status[3854] general protection<a class="hash-link" href="#traps-rc-status3854-general-protection" title="Direct link to heading">#</a></h3><ul><li><code>rc-status sysinit</code> 时出现该异常</li><li><a href="https://github.com/OpenRC/openrc/issues/168" target="_blank" rel="noopener noreferrer">OpenRC/openrc#168</a></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[ 6921.149981] traps: rc-status[3854] general protection ip:7ca2e00baa1b sp:7ecdf01d7038 error:0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[ 6921.149987]  in ld-musl-x86_64.so.1[7ca2e009d000+89000]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[ 6921.150003] grsec: From 192.168.11.29: Segmentation fault occurred at            (nil) in /bin/rc-status[rc-status:3854] uid/euid:0/0 gid/egid:0/0, parent /bin/bash[bash:3570] uid/euid:0/0 gid/egid:0/0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[ 6921.150020] grsec: From 192.168.11.29: denied resource overstep by requesting 4096 for RLIMIT_CORE against limit 0 for /bin/rc-status[rc-status:3854] uid/euid:0/0 gid/egid:0/0, parent /bin/bash[bash:3570] uid/euid:0/0 gid/egid:0/0</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 生成转储的异常为 denied resource overstep by requesting 4096 for RLIMIT_CORE against limit 0</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 查看当前的 limit</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">ulimit</span><span class="token plain"> -a</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 配置文件</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">cat</span><span class="token plain"> /etc/security/limits.conf</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># RLIMIT_CORE = 0 说明不能创建转储</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 针对当前会话设置, 再次调用时会生成 core 文件</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">ulimit</span><span class="token plain"> -c </span><span class="token number" style="color:rgb(247, 140, 108)">4096</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>RLIMIT_AS //进程的最大虚内存空间，字节为单位。
RLIMIT_CORE //内核转存文件的最大长度。
RLIMIT_CPU //最大允许的CPU使用时间，秒为单位。当进程达到软限制，内核将给其发送SIGXCPU信号，这一信号的默认行为是终止进程的执行。然而，可以捕捉信号，处理句柄可将控制返回给主程序。如果进程继续耗费CPU时间，核心会以每秒一次的频率给其发送SIGXCPU信号，直到达到硬限制，那时将给进程发送 SIGKILL信号终止其执行。
RLIMIT_DATA //进程数据段的最大值。
RLIMIT_FSIZE //进程可建立的文件的最大长度。如果进程试图超出这一限制时，核心会给其发送SIGXFSZ信号，默认情况下将终止进程的执行。
RLIMIT_LOCKS //进程可建立的锁和租赁的最大值。
RLIMIT_MEMLOCK //进程可锁定在内存中的最大数据量，字节为单位。
RLIMIT_MSGQUEUE //进程可为POSIX消息队列分配的最大字节数。
RLIMIT_NICE //进程可通过setpriority() 或 nice()调用设置的最大完美值。
RLIMIT_NOFILE //指定比进程可打开的最大文件描述词大一的值，超出此值，将会产生EMFILE错误。
RLIMIT_NPROC //用户可拥有的最大进程数。
RLIMIT_RTPRIO //进程可通过sched_setscheduler 和 sched_setparam设置的最大实时优先级。
RLIMIT_SIGPENDING //用户可拥有的最大挂起信号数。
RLIMIT_STACK //最大的进程堆栈，以字节为单位。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="ip-rtnetlink-answers-file-exists"></a>ip: RTNETLINK answers: File exists<a class="hash-link" href="#ip-rtnetlink-answers-file-exists" title="Direct link to heading">#</a></h3><ul><li>ip addr add 时出现</li><li>usually indicates that a route already exists and you are trying to add it again.</li><li><a href="http://man7.org/linux/man-pages/man7/rtnetlink.7.html" target="_blank" rel="noopener noreferrer">rtnetlink.7</a><ul><li>Linux IPv4 routing socket</li></ul></li><li>网络启停时是依据 <code>/var/run/ifstate</code> 中的 if 状态进行操作</li><li>如果一开始停止失败, 那么就会导致启动是会, 导致实际的 if 状态和 ifstate 中的状态不一致</li><li><a href="https://www.thomas-krenn.com/en/wiki/Two_Default_Gateways_on_One_System" target="_blank" rel="noopener noreferrer">Two Default Gateways on One System</a></li><li>inetfaces 中只能指定一条 gateway<ul><li>如果指定了多条会出现该异常</li></ul></li><li><a href="http://lartc.org/" target="_blank" rel="noopener noreferrer">Linux Advanced Routing &amp; Traffic Control</a></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 例如</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">ip</span><span class="token plain"> addr </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">192.168</span><span class="token plain">.8.182/255.255.252.0 broadcast </span><span class="token number" style="color:rgb(247, 140, 108)">192.168</span><span class="token plain">.8.255 dev eth1 label eth1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 此时可以尝试</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">ip</span><span class="token plain"> addr flush dev eth1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 查看实际操作</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">strace</span><span class="token plain"> -e </span><span class="token function" style="color:rgb(130, 170, 255)">open</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">ifup</span><span class="token plain"> eth1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 直接添加 eth1=eth1</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">nano</span><span class="token plain"> /var/run/ifstate</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 然后就可以正常操作 ifup 和 ifdown 了</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="grsec-time-set-by-sbinhwclockhwclock2863"></a>grsec: time set by /sbin/hwclock[hwclock:2863]<a class="hash-link" href="#grsec-time-set-by-sbinhwclockhwclock2863" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[   14.977686] grsec: time set by /sbin/hwclock[hwclock:2863] uid/euid:0/0 gid/egid:0/0, parent /lib/rc/sh/openrc-run.sh[openrc-run.sh:2838] uid/euid:0/0 gid/egid:0/0</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="node-docker-seg-fault"></a>node docker seg fault<a class="hash-link" href="#node-docker-seg-fault" title="Direct link to heading">#</a></h3><ul><li><a href="https://github.com/sass/node-sass/issues/2031" target="_blank" rel="noopener noreferrer">sass/node-sass#2031</a> Segmentation fault on Node 8 alpine (docker)</li><li>是由于线程栈太小了导致</li><li>jubel-han 的 <a href="https://github.com/jubel-han/dockerfiles/blob/master/node/Dockerfile" target="_blank" rel="noopener noreferrer">Dockerfile</a> 提供了一个 LD_PRELOAD</li><li><a href="https://stackoverflow.com/q/426230/1870054" target="_blank" rel="noopener noreferrer">What is the LD_PRELOAD trick?</a></li><li><a href="http://wiki.musl-libc.org/wiki/Functional_differences_from_glibc#Thread_stack_size" target="_blank" rel="noopener noreferrer">http://wiki.musl-libc.org/wiki/Functional_differences_from_glibc#Thread_stack_size</a></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="php-下-iconv-有问题"></a>PHP 下 iconv 有问题<a class="hash-link" href="#php-下-iconv-有问题" title="Direct link to heading">#</a></h3><p>Alpine 下 PHP 的 iconv 有问题 <a href="https://github.com/docker-library/php/issues/428" target="_blank" rel="noopener noreferrer">https://github.com/docker-library/php/issues/428</a>
<a href="https://github.com/docker-library/php/issues/240" target="_blank" rel="noopener noreferrer">https://github.com/docker-library/php/issues/240</a></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> --no-cache gnu-libiconv --repository http://mirrors.aliyun.com/alpine/edge/testing</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">LD_PRELOAD</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">/usr/lib/preloadable_libiconv.so php</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 或</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">LD_PRELOAD</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/usr/lib/preloadable_libiconv.so php&quot;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly Dockerfile"><pre tabindex="0" class="prism-code language-Dockerfile codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">RUN apk add gnu-libiconv --no-cache --repository mirrors.aliyun.com/alpine/edge/testing</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ENV LD_PRELOAD /usr/lib/preloadable_libiconv.so php</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="rc-status-sysinit-异常"></a>rc-status sysinit 异常<a class="hash-link" href="#rc-status-sysinit-异常" title="Direct link to heading">#</a></h3><ul><li>可能是由于 zfs-zed 导致</li><li><a href="https://github.com/OpenRC/openrc/issues/168#issuecomment-349870167" target="_blank" rel="noopener noreferrer">https://github.com/OpenRC/openrc/issues/168#issuecomment-349870167</a></li><li><a href="https://github.com/zfsonlinux/zfs/issues/6930" target="_blank" rel="noopener noreferrer">https://github.com/zfsonlinux/zfs/issues/6930</a></li><li><a href="https://wiki.debian.org/LSBInitScripts" target="_blank" rel="noopener noreferrer">https://wiki.debian.org/LSBInitScripts</a></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="启动分区修复"></a>启动分区修复<a class="hash-link" href="#启动分区修复" title="Direct link to heading">#</a></h3><ol><li>mbr 坏了但分区是好的</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">dd</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">bs</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">440</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">conv</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">notrunc </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">count</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">if</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">/usr/share/syslinux/mbr.bin </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">of</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">/dev/sdc</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ol start="2"><li>启动分区坏了</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 查看分区信息</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">file</span><span class="token plain"> -s /dev/sdc1</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="tbd"></a>TBD<a class="hash-link" href="#tbd" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[    0.013013] DMAR-IR: This system BIOS has enabled interrupt remapping</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">               on a chipset that contains an erratum making that</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">               feature unstable.  To maintain system stability</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">               interrupt remapping is being disabled.  Please</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">               contact your BIOS vendor for an update</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[ 7785.189928] perf: interrupt took too long (2658 &gt; 2500), lowering kernel.perf_event_max_sample_rate to 75000</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/wenerme/wener/edit/master/notes/os/alpine/alpine-ops.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/notes/os/alpine/alpine-lbu"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Alpine local backup</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/notes/os/alpine/alpine-pkgs"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Alpine 包维护 »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#tips" class="table-of-contents__link">Tips</a></li><li><a href="#bash" class="table-of-contents__link">bash</a></li><li><a href="#manpages" class="table-of-contents__link">manpages</a></li><li><a href="#基础运维" class="table-of-contents__link">基础运维</a></li><li><a href="#系统运维" class="table-of-contents__link">系统运维</a></li><li><a href="#硬件运维" class="table-of-contents__link">硬件运维</a></li><li><a href="#setup-disk" class="table-of-contents__link">setup-disk</a></li><li><a href="#本地仓库" class="table-of-contents__link">本地仓库</a></li><li><a href="#容器" class="table-of-contents__link">容器</a></li><li><a href="#磁盘扩展" class="table-of-contents__link">磁盘扩展</a></li><li><a href="#udev" class="table-of-contents__link">udev</a></li><li><a href="#zfs" class="table-of-contents__link">zfs</a><ul><li><a href="#uninstall-zfs" class="table-of-contents__link">uninstall zfs</a></li></ul></li><li><a href="#btrfs" class="table-of-contents__link">btrfs</a><ul><li><a href="#failed-to-read-the-system-array" class="table-of-contents__link">failed to read the system array</a></li></ul></li><li><a href="#networking" class="table-of-contents__link">networking</a></li><li><a href="#network-benchmark" class="table-of-contents__link">network benchmark</a></li><li><a href="#init" class="table-of-contents__link">init</a></li><li><a href="#iscsi" class="table-of-contents__link">iscsi</a></li><li><a href="#netatalk" class="table-of-contents__link">netatalk</a></li><li><a href="#stress" class="table-of-contents__link">stress</a></li><li><a href="#disk" class="table-of-contents__link">disk</a></li><li><a href="#qemu" class="table-of-contents__link">QEMU</a><ul><li><a href="#kvm" class="table-of-contents__link">kvm</a></li><li><a href="#virtual-disk" class="table-of-contents__link">virtual-disk</a></li></ul></li><li><a href="#ftp" class="table-of-contents__link">ftp</a></li><li><a href="#lvm" class="table-of-contents__link">lvm</a></li><li><a href="#libguestfs" class="table-of-contents__link">libguestfs</a></li><li><a href="#acf" class="table-of-contents__link">acf</a></li><li><a href="#crond" class="table-of-contents__link">crond</a></li><li><a href="#wireguard" class="table-of-contents__link">wireguard</a></li><li><a href="#faq" class="table-of-contents__link">FAQ</a><ul><li><a href="#ip-ioctl-0x8913-failed-no-such-device" class="table-of-contents__link">ip: ioctl 0x8913 failed: no such device</a></li><li><a href="#恢复网卡名字" class="table-of-contents__link">恢复网卡名字</a></li><li><a href="#文件系统变成了只读" class="table-of-contents__link">文件系统变成了只读</a></li><li><a href="#find-sysmodulepcc_cpufreq" class="table-of-contents__link">find: /sys/module/pcc_cpufreq</a></li><li><a href="#traps-rc-status3854-general-protection" class="table-of-contents__link">traps: rc-status3854 general protection</a></li><li><a href="#ip-rtnetlink-answers-file-exists" class="table-of-contents__link">ip: RTNETLINK answers: File exists</a></li><li><a href="#grsec-time-set-by-sbinhwclockhwclock2863" class="table-of-contents__link">grsec: time set by /sbin/hwclockhwclock:2863</a></li><li><a href="#node-docker-seg-fault" class="table-of-contents__link">node docker seg fault</a></li><li><a href="#php-下-iconv-有问题" class="table-of-contents__link">PHP 下 iconv 有问题</a></li><li><a href="#rc-status-sysinit-异常" class="table-of-contents__link">rc-status sysinit 异常</a></li><li><a href="#启动分区修复" class="table-of-contents__link">启动分区修复</a></li><li><a href="#tbd" class="table-of-contents__link">TBD</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">笔记</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/notes/java/java">Java</a></li><li class="footer__item"><a class="footer__link-item" href="/notes/os/alpine/alpine">AlpineLinux</a></li><li class="footer__item"><a class="footer__link-item" href="/notes/devops/kubernetes/kubernetes">Kubernates</a></li><li class="footer__item"><a class="footer__link-item" href="/notes/voip/voip">VoIP</a></li></ul></div><div class="col footer__col"><div class="footer__title">Projects</div><ul class="footer__items"><li class="footer__item">
              <div>
              <a class="footer__link-item" href="https://github.com/wenerme/wener">Wener</a>
              - <a class="footer__link-item" href="https://github.com/wenerme/wener/actions" title="wenerme/wener - ci">
                <img style="vertical-align: middle;opacity: .4;" src="https://github.com/wenerme/wener/workflows/Build/badge.svg">
                </a>
              </div>
              </li><li class="footer__item"><a href="https://apis.wener.me" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Wener&#x27;s Apis<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/story">Blog</a></li><li class="footer__item"><a href="https://github.com/wenerme" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://twitter.com/wenerme" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/img/wener-logo.svg" alt="Wener Site" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="/img/wener-logo.svg" alt="Wener Site" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></div><div class="footer__copyright">Copyright © 1992-2021 Wener - <img alt="cc-by-sa-4.0" src="https://mirrors.creativecommons.org/presskit/buttons/80x15/svg/by-sa.svg"> - Build @2021-10-07 22:33</div></div></div></footer></div>
<script src="/assets/js/runtime~main.9410da03.js"></script>
<script src="/assets/js/main.4b2b2a3e.js"></script>
</body>
</html>