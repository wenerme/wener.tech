<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.4">
<link rel="alternate" type="application/rss+xml" href="/story/rss.xml" title="Wener Live &amp; Life Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/story/atom.xml" title="Wener Live &amp; Life Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-30404720-1","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-30404720-1"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-30404720-1",{})</script>
<link rel="search" type="application/opensearchdescription+xml" title="Wener Live &amp; Life" href="/opensearch.xml"><title data-react-helmet="true">interfaces | Wener Live &amp; Life</title><meta data-react-helmet="true" property="og:url" content="https://wener.me/notes/os/linux/network/interfaces"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="interfaces | Wener Live &amp; Life"><meta data-react-helmet="true" name="description" content="Tips"><meta data-react-helmet="true" property="og:description" content="Tips"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://wener.me/notes/os/linux/network/interfaces"><link data-react-helmet="true" rel="alternate" href="https://wener.me/notes/os/linux/network/interfaces" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://wener.me/notes/os/linux/network/interfaces" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.82b257c7.css">
<link rel="preload" href="/assets/js/runtime~main.b3820f26.js" as="script">
<link rel="preload" href="/assets/js/main.8de25734.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/wener-logo-head.svg" alt="Wener Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/wener-logo-head.svg" alt="Wener Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Wener</b></a><a class="navbar__item navbar__link" href="/notes/java/java">笔记</a><a class="navbar__item navbar__link" href="/story">故事</a><a class="navbar__item navbar__link" href="/notes/howto/network/dns-prevent-spoofing">指南</a><a class="navbar__item navbar__link" href="/notes/tool/network/ip-lookup">工具</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/wenerme/wener" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">🌞</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="searchBox_1Doo"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button" title="Scroll to top"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">自我成长</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Java</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Web</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">语言</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">AlpineLinux</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Docker</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Kubernetes</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Linux</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/linux-awesome">Linux Awesome</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/linux-faq">Linux FAQ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/linux-version">Linux Releases</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">启动</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Init</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">系统</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">网络</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/network/network">Linux 网络</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/network/network-faq">网络常见问题</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/network/bridge">桥接网络</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/network/ifupdown">ifupdown</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/notes/os/linux/network/interfaces">interfaces</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/network/iproute2">IPRoute2</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/network/iptables">IPTables</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/network/iptables-cookbook">IPTables Cookbook</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/network/iptables-ref">iptables 参考</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/network/iptables-rule">iptables 规则</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/network/iwd">IWD</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/network/mitmproxy">MitmProxy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/network/mtu">MTU</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/network/nftables">NFTables</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/network/nftables-cookbook">NFTables Cookbook</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/network/nftables-rule">nftables 规则</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/network/ngrep">ngrep</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/network/nmap">NMap</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/network/socat">socat</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/network/tcpdump">tcpdump</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">设备</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">硬件</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/fs/ext">ext</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/fs/fs-faq">FAQ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/lib/libc">libc</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/lib/musl">musl</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/partition">Partition</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/security/grsecurity">Grsecurity</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/shell/bash">Bash</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/shell/expect">expect</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/shell/shell-awesome">Shell Awesome</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/shell/shell-faq">Shell FAQ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/shell/terminal">Terminal</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">虚拟化</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">操作系统</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">VoIP</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">开发</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">DevOps</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">数据库</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">消息队列</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">安全</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">服务</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">运维</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">指南</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">硬件</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">算法</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">健康</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">参考</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">工具</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="markdown"><header><h1 class="h1Heading_27L5">interfaces</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="tips"></a>Tips<a class="hash-link" href="#tips" title="Direct link to heading">#</a></h2><ul><li>debian <a href="https://manpages.debian.org/stretch/ifupdown/interfaces.5.en.html" target="_blank" rel="noopener noreferrer">interfaces.5</a></li><li>/etc/network/interfaces<ul><li>网络接口配置</li><li>通过 <a href="https://git.busybox.net/busybox/tree/networking/ifupdown.c" target="_blank" rel="noopener noreferrer">ifupdown</a> 操作 - busybox 有提供<ul><li><code>/var/run/ifstate</code> 记录状态 - 有可能在 <code>/etc/network/run/ifstate</code></li><li>inet - manual wvdial ppp static bootp dhcp loopback</li><li>inet6 - static manual loopback v4tunnel</li></ul></li><li>根据提供 ifupdown 的包不同，功能可能不同</li><li>命令可通过其他包扩展</li><li>执行阶段 pre-up up/post-up down/pre-down post-down</li></ul></li><li>参考<ul><li><a href="https://unix.stackexchange.com/questions/346967" target="_blank" rel="noopener noreferrer">Obtain IP from DHCP sever but set DNS servers statically on Debian</a></li><li><a href="https://pkgs.alpinelinux.org/contents?file=&amp;path=%2Fetc%2Fnetwork%2F*&amp;name=&amp;branch=edge&amp;arch=x86_64" target="_blank" rel="noopener noreferrer">/etc/network/*</a><ul><li>interfaces 指令处理脚本</li><li>static-routing tunnel bonding vlan vde2 bridge openvswitch fwsnort sqm-scripts</li></ul></li><li><a href="https://unix.stackexchange.com/questions/128439" target="_blank" rel="noopener noreferrer">Good detailed explanation of /etc/network/interfaces syntax?</a></li></ul></li><li>network-extras</li><li>class<ul><li>auto</li><li>allow-hotplug</li></ul></li></ul><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</h5></div><div class="admonition-content"><ul><li>ifupdown 不同 interfaces 会有些微的不同</li><li>interfaces 本质是将执行的脚本以配置化的方式呈现<ul><li>imperative -&gt; declartive</li></ul></li></ul></div></div><table><thead><tr><th>var</th><th>desc</th></tr></thead><tbody><tr><td>IFACE</td><td>名字 或 <code>--all</code></td></tr><tr><td>LOGICAL</td><td>逻辑名 或 <code>auto</code></td></tr><tr><td>ADDRFAM</td><td>地址类型 或 <code>meta</code></td></tr><tr><td>METHOD</td><td>配置方式 或 <code>none</code></td></tr><tr><td>CLASS</td><td>接口类型 <code>--allow</code> 的值，使用 <code>--all</code> 时为 <code>auto</code></td></tr><tr><td>MODE</td><td><code>start</code>,<code>stop</code></td></tr><tr><td>PHASE</td><td>pre-up, post-up, pre-down, post-down</td></tr><tr><td>VERBOSITY</td><td><code>--verbose</code> 值， 1 或 0</td></tr><tr><td>PATH</td><td><code>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</code></td></tr></tbody></table><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> bonding tunnel static-routing vlan bridge vde2 fwsnort</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 检查 table 是否存</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">ip</span><span class="token plain"> ro li tab mytab </span><span class="token operator file-descriptor important" style="color:rgb(137, 221, 255)">2</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">/dev/null </span><span class="token operator" style="color:rgb(137, 221, 255)">||</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">echo</span><span class="token plain"> NO</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> -Dv /dev/null /etc/udhcpc/udhcpc.conf</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">echo</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">IF_PEER_DNS</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">no </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;&gt;</span><span class="token plain"> /etc/udhcpc/udhcpc.conf</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 不要修改 resolve.conf</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">echo</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">RESOLV_CONF</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">no </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;&gt;</span><span class="token plain"> /etc/udhcpc/udhcpc.conf</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 修改名字</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">rename</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">foo</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">bar</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># [VARIABLE]/VALUE[/[OPTIONS]][=LOGICAL]</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">auto /eth*</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">eth</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">iface eth inet dhcp</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">auto eth0 eth1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 多接口</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># ===================</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># https://www.thomas-krenn.com/en/wiki/Two_Default_Gateways_on_One_System</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># echo &#x27;1 tgbe&#x27; | tee -a /etc/iprpite2/rt_tables</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 适用于多子网</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># ip route add 10.10.0.0/24 如果子网已经存在则会失败</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">iface eth2 inet static</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    address </span><span class="token number" style="color:rgb(247, 140, 108)">10.10</span><span class="token plain">.0.10</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    netmask </span><span class="token number" style="color:rgb(247, 140, 108)">255.255</span><span class="token plain">.255.0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    post-up </span><span class="token function" style="color:rgb(130, 170, 255)">ip</span><span class="token plain"> route </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">10.10</span><span class="token plain">.0.0/24 dev eth1 src </span><span class="token number" style="color:rgb(247, 140, 108)">10.10</span><span class="token plain">.0.10 table tgbe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    post-up </span><span class="token function" style="color:rgb(130, 170, 255)">ip</span><span class="token plain"> route </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> default via </span><span class="token number" style="color:rgb(247, 140, 108)">10.10</span><span class="token plain">.0.1 dev eth1 table tgbe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    post-up </span><span class="token function" style="color:rgb(130, 170, 255)">ip</span><span class="token plain"> rule </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> from </span><span class="token number" style="color:rgb(247, 140, 108)">10.10</span><span class="token plain">.0.10/32 table tgbe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    post-up </span><span class="token function" style="color:rgb(130, 170, 255)">ip</span><span class="token plain"> rule </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> to </span><span class="token number" style="color:rgb(247, 140, 108)">10.10</span><span class="token plain">.0.10/32 table tgbe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 使用相同接口返回 - 适用于默认网关已经存在但想要通过 IP 使用网口时</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 使用这个 IP 则会通过这个接口</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">iface eth2 inet static</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    address </span><span class="token number" style="color:rgb(247, 140, 108)">10.10</span><span class="token plain">.0.10</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    netmask </span><span class="token number" style="color:rgb(247, 140, 108)">255.255</span><span class="token plain">.255.0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 自动添加 table</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># pre-up ip ro li tab tgbe &amp;&gt;/dev/null || echo &#x27;10 tgbe&#x27; &gt;&gt; /etc/iproute2/rt_tables</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    post-up </span><span class="token function" style="color:rgb(130, 170, 255)">ip</span><span class="token plain"> rule </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> from </span><span class="token number" style="color:rgb(247, 140, 108)">10.10</span><span class="token plain">.0.10 table tgbe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    post-up </span><span class="token function" style="color:rgb(130, 170, 255)">ip</span><span class="token plain"> ro </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> default via </span><span class="token number" style="color:rgb(247, 140, 108)">10.10</span><span class="token plain">.0.1 dev eth2 table tgbe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># wireguard</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># ===================</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 依赖 wireguard-vanilla/wireguard-virt wireguard-tools-wg</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">auto wg0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">iface wg0 inet static</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    address </span><span class="token number" style="color:rgb(247, 140, 108)">10.10</span><span class="token plain">.0.1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    netmask </span><span class="token number" style="color:rgb(247, 140, 108)">255.255</span><span class="token plain">.255.0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    pre-up </span><span class="token function" style="color:rgb(130, 170, 255)">ip</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">link</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> dev wg0 </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">type</span><span class="token plain"> wireguard</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    pre-up </span><span class="token function" style="color:rgb(130, 170, 255)">ip</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">link</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">set</span><span class="token plain"> dev wg0 mtu </span><span class="token number" style="color:rgb(247, 140, 108)">1450</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    pre-up wg setconf wg0 /etc/network/wg0.conf</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    post-down </span><span class="token function" style="color:rgb(130, 170, 255)">ip</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">link</span><span class="token plain"> delete dev wg0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># bonding</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># ===================</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Slaves</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">auto eth0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">iface eth0 inet manual</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    bond-master bond0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    bond-primary eth0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    bond-mode active-backup</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">auto wlan0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">iface wlan0 inet manual</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    wpa-conf /etc/network/wpa.conf</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    bond-master bond0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    bond-primary eth0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    bond-mode active-backup</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Master</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">auto bond0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">iface bond0 inet dhcp</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    bond-slaves none</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    bond-primary eth0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    bond-mode active-backup</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    bond-miimon </span><span class="token number" style="color:rgb(247, 140, 108)">100</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># bridge</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># ===================</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">auto br0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">iface br0 inet dhcp</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 有该配置说明是桥接</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 特殊值 none all</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  bridge-ports vnet0 vnet1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 等待端口</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># bridge-waitport 0</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># bridge-ageing 0</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># bridge-bridgeprio 0</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># forward delay - 默认 30s</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># bridge-fd 30</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># bridge-gcint 0</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># bridge-hello 0</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># bridge-maxage 0</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># bridge-pathcost 0</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 0-65535</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># bridge-portprio 0</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 是否开启 STP - 如果不是唯一的 bridge 则需要打开</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># bridge-stp on</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 当前的 mac 信息</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">bridge fdb</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><header><h1 class="h1Heading_27L5">Methods</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="inet"></a>inet<a class="hash-link" href="#inet" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="static"></a>static<a class="hash-link" href="#static" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ini"><pre tabindex="0" class="prism-code language-ini codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Address (dotted quad/netmask) required</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">address address</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Netmask (dotted quad or number of bits) deprecated</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">netmask mask</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Broadcast address (dotted quad, + or -) deprecated. Default value: &quot;+&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">broadcast broadcast_address</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Routing metric for default gateway (integer)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">metric metric</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Default gateway (dotted quad)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">gateway address</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Address of other end point (dotted quad). Note the spelling of &quot;point-to&quot;.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pointopoint address</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Link local address or &quot;random&quot;.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">hwaddress address</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># MTU size</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mtu size</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Address validity scope. Possible values: global, link, host</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">scope</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="manual"></a>manual<a class="hash-link" href="#manual" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ini"><pre tabindex="0" class="prism-code language-ini codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Link local address or &quot;random&quot;.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">hwaddress address</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># MTU size</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mtu size</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="dhcp"></a>dhcp<a class="hash-link" href="#dhcp" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ini"><pre tabindex="0" class="prism-code language-ini codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Hostname to be requested (pump, dhcpcd, udhcpc)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">hostname hostname</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Metric for added routes (dhclient)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">metric metric</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Preferred lease time in hours (pump)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">leasehours leasehours</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Preferred lease time in seconds (dhcpcd)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">leasetime leasetime</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Vendor class identifier (dhcpcd)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">vendor vendor</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Client identifier (dhcpcd)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">client client</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Hardware address.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">hwaddress address</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="bootp"></a>bootp<a class="hash-link" href="#bootp" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ini"><pre tabindex="0" class="prism-code language-ini codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Tell the server to use file as the bootfile.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">bootfile file</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Use the IP address address to communicate with the server.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">server address</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Use addr as the hardware address instead of whatever it really is.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">hwaddr addr</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="tunnel"></a>tunnel<a class="hash-link" href="#tunnel" title="Direct link to heading">#</a></h3><ul><li>This method is used to create GRE or IPIP tunnels. You need to have the ip binary from the iproute package. For GRE tunnels, you will need to load the ip_gre module and the ipip module for IPIP tunnels.</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ini"><pre tabindex="0" class="prism-code language-ini codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Local address (dotted quad) required</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">address address</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Tunnel type (either GRE or IPIP) required</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mode type</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Address of other tunnel endpoint required</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">endpoint address</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Remote address (remote address inside tunnel)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">dstaddr address</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Address of the local endpoint</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">local address</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Routing metric for default gateway (integer)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">metric metric</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Default gateway</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">gateway address</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># TTL setting</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ttl time</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># MTU size</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mtu size</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ppp"></a>ppp<a class="hash-link" href="#ppp" title="Direct link to heading">#</a></h3><p>This method uses pon/poff to configure a PPP interface</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ini"><pre tabindex="0" class="prism-code language-ini codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Use name as the provider (from /etc/ppp/peers).</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">provider name</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Use number as the ppp unit number.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">unit number</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Pass string as additional options to pon.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">options string</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="wvdial"></a>wvdial<a class="hash-link" href="#wvdial" title="Direct link to heading">#</a></h3><p>This method uses wvdial to configure a PPP interface. See that command for more details.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ini"><pre tabindex="0" class="prism-code language-ini codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Use name as the provider (from /etc/wvdial.conf).</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">provider name</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ipv4ll"></a>ipv4ll<a class="hash-link" href="#ipv4ll" title="Direct link to heading">#</a></h3><p>This method uses avahi-autoipd to configure an interface with an IPv4 Link-Layer address (169.254.0.0/16 family). This method is also known as APIPA or IPAC, and often colloquially referred to as &quot;Zeroconf address&quot;.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ipx"></a>ipx<a class="hash-link" href="#ipx" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="static-1"></a>static<a class="hash-link" href="#static-1" title="Direct link to heading">#</a></h3><p>This method may be used to setup an IPX interface. It requires the ipx_interface command.
Options</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ini"><pre tabindex="0" class="prism-code language-ini codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># type of Ethernet frames to use (e.g. 802.2)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">frame type</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Network number</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">netnum id</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="dynamic"></a>dynamic<a class="hash-link" href="#dynamic" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ini"><pre tabindex="0" class="prism-code language-ini codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># type of Ethernet frames to use (e.g. 802.2)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">frame type</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="inet6"></a>inet6<a class="hash-link" href="#inet6" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="auto"></a>auto<a class="hash-link" href="#auto" title="Direct link to heading">#</a></h3><p>This method may be used to define interfaces with automatically assigned IPv6 addresses. Using this method on its own doesn&#x27;t mean that RDNSS options will be applied, too. To make this happen, rdnssd daemon must be installed, properly configured and running. If stateless DHCPv6 support is turned on, then additional network configuration parameters such as DNS and NTP servers will be retrieved from a DHCP server. Please note that on ifdown, the lease is not currently released (a known bug).</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ini"><pre tabindex="0" class="prism-code language-ini codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Privacy extensions (RFC4941) (0=off, 1=assign, 2=prefer)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">privext int</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Accept router advertisements (0=off, 1=on, 2=on+forwarding). Default value: &quot;2&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">accept_ra int</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Use stateless DHCPv6 (0=off, 1=on)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">dhcp int</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Request a prefix through DHCPv6 Prefix Delegation (0=off, 1=on). Default value: &quot;0&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">request_prefix int</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Number of attempts to wait for a link-local address. Default value: &quot;60&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ll-attempts</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Link-local address polling interval in seconds. Default value: &quot;0.1&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ll-interval</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="loopback"></a>loopback<a class="hash-link" href="#loopback" title="Direct link to heading">#</a></h3><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="static-2"></a>static<a class="hash-link" href="#static-2" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ini"><pre tabindex="0" class="prism-code language-ini codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Address (colon delimited/netmask) required</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">address address</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Netmask (number of bits, eg 64) deprecated</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">netmask mask</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Routing metric for default gateway (integer)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">metric metric</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Default gateway (colon delimited)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">gateway address</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Medium type, driver dependent</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">media type</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Hardware address or &quot;random&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">hwaddress address</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># MTU size</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mtu size</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Accept router advertisements (0=off, 1=on, 2=on+forwarding)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">accept_ra int</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Perform stateless autoconfiguration (0=off, 1=on). Default value: &quot;0&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">autoconf int</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Privacy extensions (RFC3041) (0=off, 1=assign, 2=prefer)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">privext int</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Address validity scope. Possible values: global, site, link, host</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">scope</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Time that address remains preferred</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">preferred-lifetime int</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Number of attempts to settle DAD (0 to disable DAD). Default value: &quot;60&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">dad-attempts</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># DAD state polling interval in seconds. Default value: &quot;0.1&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">dad-interval</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="manual-1"></a>manual<a class="hash-link" href="#manual-1" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ini"><pre tabindex="0" class="prism-code language-ini codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Hardware address or &quot;random&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">hwaddress address</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># MTU size</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mtu size</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="dhcp-1"></a>dhcp<a class="hash-link" href="#dhcp-1" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ini"><pre tabindex="0" class="prism-code language-ini codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Hardware address or &quot;random&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">hwaddress address</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Accept router advertisements (0=off, 1=on, 2=on+forwarding). Default value: &quot;1&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">accept_ra int</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Perform stateless autoconfiguration (0=off, 1=on)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">autoconf int</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Request a prefix through DHCPv6 Prefix Delegation (0=off, 1=on). Default value: &quot;0&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">request_prefix int</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Number of attempts to wait for a link-local address. Default value: &quot;60&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ll-attempts</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Link-local address polling interval in seconds. Default value: &quot;0.1&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ll-interval</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="v4tunnel"></a>v4tunnel<a class="hash-link" href="#v4tunnel" title="Direct link to heading">#</a></h3><p>IPv6-over-IPv4 tunnel. It requires the ip command from the iproute package.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ini"><pre tabindex="0" class="prism-code language-ini codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Address (colon delimited/netmask) required</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">address address</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Netmask (number of bits, eg 64) deprecated</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">netmask mask</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Address of other tunnel endpoint (IPv4 dotted quad) required</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">endpoint address</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Address of the local endpoint (IPv4 dotted quad)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">local address</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Routing metric for default gateway (integer)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">metric metric</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Default gateway (colon delimited)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">gateway address</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># TTL setting</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ttl time</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># MTU size</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mtu size</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Time that address remains preferred</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">preferred-lifetime int</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="6to4"></a>6to4<a class="hash-link" href="#6to4" title="Direct link to heading">#</a></h3><p>This method may be used to setup an 6to4 tunnel. It requires the ip command from the iproute package.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ini"><pre tabindex="0" class="prism-code language-ini codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Address of the local endpoint (IPv4 dotted quad) required</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">local address</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Routing metric for default gateway (integer)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">metric metric</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># TTL setting</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ttl time</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># MTU size</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mtu size</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Time that address remains preferred</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">preferred-lifetime int</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="can"></a>can<a class="hash-link" href="#can" title="Direct link to heading">#</a></h3><p>This method may be used to setup an Controller Area Network (CAN) interface. It requires the the ip command from the iproute</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ini"><pre tabindex="0" class="prism-code language-ini codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># bitrate (1..1000000) required</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">bitrate bitrate</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># sample point (0.000..0.999)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">samplepoint samplepoint</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># loop back CAN Messages (on|off)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">loopback loopback</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># listen only mode (on|off)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">listenonly listenonly</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># activate triple sampling (on|off)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">triple triple</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># one shot mode (on|off)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">oneshot oneshot</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># activate berr reporting (on|off)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">berr berr</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="faq"></a>FAQ<a class="hash-link" href="#faq" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="多网口"></a>多网口<a class="hash-link" href="#多网口" title="Direct link to heading">#</a></h3><ul><li>如果多网口，则不要使用相同网段</li><li>如果要使用相同网段则配置多个路由表</li><li>Linux 默认会响应所有本地 IP - 即便对应网口未配置</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ini"><pre tabindex="0" class="prism-code language-ini codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># 调整 arp 配置</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">net.ipv4.conf.all.arp_announce = 2</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">net.ipv4.conf.all.arp_ignore = 1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">net.ipv4.conf.default.accept_source_route = 0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">net.ipv4.conf.default.arp_announce = 2</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">net.ipv4.conf.default.arp_ignore = 1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">net.ipv4.conf.default.rp_filter = 1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">net.ipv4.conf.eth0.arp_announce = 2</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">net.ipv4.conf.eth0.arp_ignore = 1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">net.ipv4.conf.eth1.arp_announce = 2</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">net.ipv4.conf.eth1.arp_ignore = 1</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="macvtap-vs-macvlan"></a>macvtap vs macvlan<a class="hash-link" href="#macvtap-vs-macvlan" title="Direct link to heading">#</a></h3><ul><li>macvlan<ul><li>可以认为是主网卡的子网口 - 例如 eth0.0</li></ul></li><li>macvtap<ul><li>是类似于 macvlan 的 tap 虚拟网络设备</li><li>主要用于 libvirt/KVM</li><li>实现在不需要桥接的情况下直接与底层设备交互实现类似桥接的效果</li></ul></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># macvtap</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">ip</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">link</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">link</span><span class="token plain"> eth2 macvtap2 address 00:22:33:44:55:66 </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">type</span><span class="token plain"> macvtap mode bridge</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">ip</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">link</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">set</span><span class="token plain"> macvtap2 up</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">ip</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">link</span><span class="token plain"> show macvtap2</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ul><li><a href="https://backreference.org/2014/03/20/some-notes-on-macvlanmacvtap/" target="_blank" rel="noopener noreferrer">notes on macvlan/macvtap</a></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="多口"></a>多口<a class="hash-link" href="#多口" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># 从 eth4 10gbe 192.168.1.101 来的就从 10gbe 出</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">auto eth4</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">iface eth4 inet static</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  address 192.168.1.101</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  netmask 255.255.252.0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  mtu 9000</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  pre-up ip ro li tab tgbe &amp;&gt;/dev/null || echo &#x27;10 tgbe&#x27; &gt;&gt; /etc/iproute2/rt_tables</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  post-up ip ru add from 192.168.1.101 table tgbe</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  post-up ip ro add default via 192.168.1.1 dev eth4 table tgbe</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="配置命令映射"></a>配置命令映射<a class="hash-link" href="#配置命令映射" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">auto eth0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">iface eth0 inet dhcp</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  hostname my-host</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">ip</span><span class="token plain"> li </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">set</span><span class="token plain"> eth0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">udhcpc -i eth0 -h my-host</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><hr><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">auto bond0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">iface bond0 inet dhcp</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  bond-member eth0</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">ip</span><span class="token plain"> li </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> bond0 </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">type</span><span class="token plain"> bond</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ifenslave bond0 eth0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">ip</span><span class="token plain"> li </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">set</span><span class="token plain"> eth0 up</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">ip</span><span class="token plain"> li </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">set</span><span class="token plain"> bond0 up</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">udhcpc -i bond0</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/wenerme/wener/edit/master/notes/os/linux/network/interfaces.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/notes/os/linux/network/ifupdown"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« ifupdown</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/notes/os/linux/network/iproute2"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">IPRoute2 »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#tips" class="table-of-contents__link">Tips</a></li><li><a href="#inet" class="table-of-contents__link">inet</a><ul><li><a href="#static" class="table-of-contents__link">static</a></li><li><a href="#manual" class="table-of-contents__link">manual</a></li><li><a href="#dhcp" class="table-of-contents__link">dhcp</a></li><li><a href="#bootp" class="table-of-contents__link">bootp</a></li><li><a href="#tunnel" class="table-of-contents__link">tunnel</a></li><li><a href="#ppp" class="table-of-contents__link">ppp</a></li><li><a href="#wvdial" class="table-of-contents__link">wvdial</a></li><li><a href="#ipv4ll" class="table-of-contents__link">ipv4ll</a></li></ul></li><li><a href="#ipx" class="table-of-contents__link">ipx</a><ul><li><a href="#static-1" class="table-of-contents__link">static</a></li><li><a href="#dynamic" class="table-of-contents__link">dynamic</a></li></ul></li><li><a href="#inet6" class="table-of-contents__link">inet6</a><ul><li><a href="#auto" class="table-of-contents__link">auto</a></li><li><a href="#loopback" class="table-of-contents__link">loopback</a></li><li><a href="#static-2" class="table-of-contents__link">static</a></li><li><a href="#manual-1" class="table-of-contents__link">manual</a></li><li><a href="#dhcp-1" class="table-of-contents__link">dhcp</a></li><li><a href="#v4tunnel" class="table-of-contents__link">v4tunnel</a></li><li><a href="#6to4" class="table-of-contents__link">6to4</a></li><li><a href="#can" class="table-of-contents__link">can</a></li></ul></li><li><a href="#faq" class="table-of-contents__link">FAQ</a><ul><li><a href="#多网口" class="table-of-contents__link">多网口</a></li><li><a href="#macvtap-vs-macvlan" class="table-of-contents__link">macvtap vs macvlan</a></li></ul></li><li><a href="#多口" class="table-of-contents__link">多口</a></li><li><a href="#配置命令映射" class="table-of-contents__link">配置命令映射</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">笔记</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/notes/java/java">Java</a></li><li class="footer__item"><a class="footer__link-item" href="/notes/os/alpine/alpine">AlpineLinux</a></li><li class="footer__item"><a class="footer__link-item" href="/notes/devops/kubernetes/kubernetes">Kubernates</a></li><li class="footer__item"><a class="footer__link-item" href="/notes/voip/voip">VoIP</a></li></ul></div><div class="col footer__col"><div class="footer__title">Projects</div><ul class="footer__items"><li class="footer__item">
              <div>
              <a class="footer__link-item" href="https://github.com/wenerme/wener">Wener</a>
              - <a class="footer__link-item" href="https://github.com/wenerme/wener/actions" title="wenerme/wener - ci">
                <img style="vertical-align: middle;opacity: .4;" src="https://github.com/wenerme/wener/workflows/Build/badge.svg">
                </a>
              </div>
              </li><li class="footer__item"><a href="https://apis.wener.me" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Wener&#x27;s Apis<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/story">Blog</a></li><li class="footer__item"><a href="https://github.com/wenerme" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://twitter.com/wenerme" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/img/wener-logo.svg" alt="Wener Site" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="/img/wener-logo.svg" alt="Wener Site" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></div><div class="footer__copyright">Copyright © 1992-2021 Wener - <img alt="cc-by-sa-4.0" src="https://mirrors.creativecommons.org/presskit/buttons/80x15/svg/by-sa.svg"> - Build @2021-08-19 15:48</div></div></div></footer></div>
<script src="/assets/js/runtime~main.b3820f26.js"></script>
<script src="/assets/js/main.8de25734.js"></script>
</body>
</html>