<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/story/rss.xml" title="Wener Live &amp; Life Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/story/atom.xml" title="Wener Live &amp; Life Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-30404720-1","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-30404720-1"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-30404720-1",{})</script>
<link rel="search" type="application/opensearchdescription+xml" title="Wener Live &amp; Life" href="/opensearch.xml">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css"><title data-react-helmet="true">dracut | Wener Live &amp; Life</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://wener.me/notes/os/linux/boot/dracut"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="dracut | Wener Live &amp; Life"><meta data-react-helmet="true" name="description" content="- 是什么"><meta data-react-helmet="true" property="og:description" content="- 是什么"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://wener.me/notes/os/linux/boot/dracut"><link data-react-helmet="true" rel="alternate" href="https://wener.me/notes/os/linux/boot/dracut" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://wener.me/notes/os/linux/boot/dracut" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.1f8f45d9.css">
<link rel="preload" href="/assets/js/runtime~main.4b23c3f8.js" as="script">
<link rel="preload" href="/assets/js/main.c96d5a9a.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/wener-logo-head.svg" alt="Wener Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/wener-logo-head.svg" alt="Wener Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Wener</b></a><a class="navbar__item navbar__link" href="/notes/note">笔记</a><a class="navbar__item navbar__link" href="/story">故事</a><a class="navbar__item navbar__link" href="/notes/howto/network/dns-prevent-spoofing">指南</a><a class="navbar__item navbar__link" href="/notes/tool/network/ip-lookup">工具</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/wenerme/wener" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">🌞</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="searchBox_1Doo"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">自我成长</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Java</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Web</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">语言</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">AlpineLinux</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Docker</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Kubernetes</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Linux</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/linux-awesome">Linux Awesome</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/linux-faq">Linux FAQ</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/linux-version">Linux Releases</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">启动</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/notes/os/linux/boot/dracut">dracut</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/boot/initramfs">initramfs</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/boot/syslinux">Syslinux</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/boot/uboot">U-Boot</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/boot/uefi">UEFI</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Init</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">系统</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">网络</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">设备</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">硬件</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/fs/ext">ext</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/fs/fs-faq">FAQ</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/lib/libc">libc</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/lib/musl">musl</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/partition">Partition</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/security/grsecurity">Grsecurity</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/shell/bash">Bash</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/shell/expect">expect</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/shell/shell-awesome">Shell Awesome</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/shell/shell-faq">Shell FAQ</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/os/linux/shell/terminal">Terminal</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">虚拟化</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">操作系统</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">VoIP</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">开发</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">DevOps</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">数据库</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">消息队列</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">安全</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">服务</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">运维</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">指南</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">硬件</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">算法</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">健康</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">参考</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">工具</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>dracut</h1></header><ul><li>是什么<ul><li>构建 initramfs</li><li>定位和挂载 rootfs</li><li>支持 btrfs, DM RAID, MD RAID, LVM2, device mapper multipath I/O, dm-crypt, cifs, FCoE, iSCSI, NBD, NFS</li><li>源自 Redhat - 因此 CentOS、Fedora、RHEL 都是</li><li>除了 Redhat 之外默认使用的 - openSUSE、SLES</li></ul></li><li><a href="https://github.com/dracutdevs/dracut" target="_blank" rel="noopener noreferrer">dracutdevs/dracut</a></li><li><a href="https://dracut.wiki.kernel.org" target="_blank" rel="noopener noreferrer">dracut.wiki.kernel.org</a></li><li>模块位于 /usr/lib/dracut/modules.d<ul><li><a href="https://github.com/dracutdevs/dracut/tree/master/modules.d" target="_blank" rel="noopener noreferrer">modules.d</a></li><li>rngd<ul><li>虚拟机环境最好启动 rngd/haveged 否则启动非常慢 200s+</li></ul></li><li>fs-lib<ul><li>ext4</li></ul></li><li><a href="https://github.com/dracutdevs/dracut/blob/master/modules.d/90qemu/module-setup.sh" target="_blank" rel="noopener noreferrer">qemu</a><ul><li>包含 virtio</li></ul></li><li><a href="https://github.com/dracutdevs/dracut/tree/master/modules.d/98dracut-systemd" target="_blank" rel="noopener noreferrer">dracut-systemd</a><ul><li>大部分实际启动脚本逻辑</li></ul></li></ul></li><li><a href="https://mirrors.edge.kernel.org/pub/linux/utils/boot/dracut/dracut.html" target="_blank" rel="noopener noreferrer">文档</a></li><li>参考<ul><li><a href="https://wiki.centos.org/TipsAndTricks/CreateNewInitrd" target="_blank" rel="noopener noreferrer">Creating a New Initial RAM Disk</a></li></ul></li><li><code>rd.luks=0 rd.lvm=0 rd.md=0 rd.dm=0</code> - 不扫描不必要的设备可以加速启动</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 基础包</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">yum </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> -y rng-tools </span><span class="token function" style="color:rgb(130, 170, 255)">nano</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">systemctl </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">enable</span><span class="token plain"> rngd</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">lsinitrd /boot/initrd.img-4.6.0-1-amd64</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">modprobe --show-depends dm-raid</span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token function" style="color:rgb(130, 170, 255)">grep</span><span class="token plain"> crc</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># --hostonly 仅安装主机需要模块</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># --add-drivers 添加内核模块</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">dracut --kver </span><span class="token number" style="color:rgb(247, 140, 108)">4.18</span><span class="token plain">.0-193.19.1.el8_2.x86_64 --no-hostonly --add fs-lib initramfs</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">lsinitrd initramfs</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># rootfs 只安装 kernel-core 用于构建 initrd</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">yum </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> -y yum-utils</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">rpm</span><span class="token plain"> -Uvh --nodeps </span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable" style="color:rgb(191, 199, 213)">repoquery --location kernel-core</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 查看所有模块</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">dracut --kver </span><span class="token number" style="color:rgb(247, 140, 108)">4.18</span><span class="token plain">.0-193.19.1.el8_2.x86_64 --no-hostonly --list-modules</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">dracut -m </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;nfs network base&quot;</span><span class="token plain"> --no-hostonly initramfs-nfs-only.img</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">yum </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> -y rng-tools</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># dracut-systemd systemd-initrd</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># virtio_mmio</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">dracut initramfs --kver </span><span class="token number" style="color:rgb(247, 140, 108)">4.18</span><span class="token plain">.0-193.19.1.el8_2.x86_64 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -f --no-hostonly -v </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -m </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;base bash systemd dracut-systemd systemd-initrd qemu qemu-net fs-lib rngd busybox&quot;</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --kernel-cmdline </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;rd.debug rd.shell rd.udev.debug rd.driver.pre=ext4 rd.driver.pre=virtio_mmio rd.break=cmdline rd.luks=0 rd.lvm=0 rd.md=0&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="modules"></a>modules<a class="hash-link" href="#modules" title="Direct link to heading">#</a></h2><ul><li>05-bash - 安装 bash 作为 /bin/sh</li><li>05-systemd - 安装 systemd 和基础服务</li><li>05-busybox - 安装 /usr/bin/busybox</li><li>06-rngd</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># busybox</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> -o /usr/bin/busybox https://busybox.net/downloads/binaries/1.31.0-defconfig-multiarch-musl/busybox-x86_64</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">chmod</span><span class="token plain"> +x /usr/bin/busybox</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># rngd</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">yum </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> rng-tools -y</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="cmdline"></a>cmdline<a class="hash-link" href="#cmdline" title="Direct link to heading">#</a></h2><ul><li>debug<ul><li>rd.info 日志级别</li><li>rd.debug Shell 执行会 set -x</li><li>rd.shell root 挂载失败进入 shell</li><li>rd.break={cmdline|pre-udev|pre-trigger|initqueue|pre-mount|mount|pre-pivot|cleanup} 进入 shell</li><li>rd.udev.info</li><li>rd.udev.debug</li></ul></li></ul><p>rd.emergency=[reboot|poweroff|halt]
specify, what action to execute in case of a critical failure. rd.shell=0 also be specified.
rd.driver.blacklist=<code>&lt;drivername&gt;[,&lt;drivername&gt;,…]</code>
do not load kernel module <code>&lt;drivername&gt;</code>. This parameter can be specified multiple times.
rd.driver.pre=<code>&lt;drivername&gt;[,&lt;drivername&gt;,…]</code>
force loading kernel module <code>&lt;drivername&gt;</code>. This parameter can be specified multiple times.
rd.driver.post=<code>&lt;drivername&gt;[,&lt;drivername&gt;,…]</code>
force loading kernel module <code>&lt;drivername&gt;</code> after all automatic loading modules have been loaded. This parameter can be specified multiple times.
rd.retry=<code>&lt;seconds&gt;</code>
specify how long dracut should retry the initqueue to configure devices. The default is 30 seconds. After 2/3 of the time, degraded raids are force started. If you have hardware, which takes a very long time to announce its drives, you might want to extend this value.
rd.timeout=<code>&lt;seconds&gt;</code>
specify how long dracut should wait for devices to appear. The default is 0, which means forever. Note that this timeout should be longer than rd.retry to allow for proper configuration.
rd.noverifyssl
accept self-signed certificates for ssl downloads.
rd.ctty=<code>&lt;terminal device&gt;</code>
specify the controlling terminal for the console. This is useful, if you have multiple &quot;console=&quot; arguments.</p><p>cp -r usr/lib/modules/4.18.0-193.19.1.el8_2.x86_64 lib/modules/</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="启动流程"></a>启动流程<a class="hash-link" href="#启动流程" title="Direct link to heading">#</a></h2><ul><li><a href="https://mirrors.edge.kernel.org/pub/linux/utils/boot/dracut/dracut.html#dracutbootup7" target="_blank" rel="noopener noreferrer">dracut.bootup</a></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    systemd-journal.socket</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                               |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                               v</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    dracut-cmdline.service</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                               |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                               v</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    dracut-pre-udev.service</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                               |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                               v</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                     systemd-udevd.service</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                               |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                               v</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">local-fs-pre.target                dracut-pre-trigger.service</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         |                                     |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         v                                     v</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> (various mounts)                systemd-udev-trigger.service</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         |        (swap devices)               |             (various low-level   (various low-level</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         |               |                     |             services: seed,       API VFS mounts:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         v               v                     v             tmpfiles, random     mqueue, configfs,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  local-fs.target   swap.target     dracut-initqueue.service    sysctl, ...)        debugfs, ...)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         |               |                     |                    |                    |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         \_______________|____________________ | ___________________|____________________/</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                              \|/</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                               v</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                        sysinit.target</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                               |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                             _________________/|\___________________</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            /                  |                    \</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            |                  |                    |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            v                  |                    v</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        (various               |              rescue.service</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       sockets...)             |                    |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            |                  |                    v</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            v                  |              rescue.target</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                     sockets.target            |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            |                  |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            \_________________ |                                 emergency.service</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                              \|                                         |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                               v                                         v</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                         basic.target                             emergency.target</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                               |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        ______________________/|</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       /                       |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       |                       v</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       |            dracut-pre-mount.service</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       |                       |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       |                       v</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       |                  sysroot.mount</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       |                       |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       |                       v</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       |             initrd-root-fs.target</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           (custom initrd services)            |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       |                       v</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       |             dracut-mount.service</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       |                       |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       |                       v</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       |            initrd-parse-etc.service</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       |                       |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       |                       v</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       |            (sysroot-usr.mount and</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       |             various mounts marked</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       |               with fstab option</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       |                x-initrd.mount)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       |                       |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       |                       v</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       |                initrd-fs.target</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       \______________________ |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                              \|</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                               v</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                          initrd.target</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                               |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                               v</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    dracut-pre-pivot.service</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                               |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                               v</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                     initrd-cleanup.service</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                          isolates to</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    initrd-switch-root.target</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                               |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                               v</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        ______________________/|</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       /                       |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       |        initrd-udevadm-cleanup-db.service</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       |                       |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           (custom initrd services)            |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       |                       |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       \______________________ |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                              \|</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                               v</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                   initrd-switch-root.target</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                               |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                               v</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                   initrd-switch-root.service</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                               |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                               v</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                          switch-root</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/wenerme/wener/edit/master/notes/os/linux/boot/dracut.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/notes/os/linux/linux-version"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Linux Releases</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/notes/os/linux/boot/initramfs"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">initramfs »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#modules" class="table-of-contents__link">modules</a></li><li><a href="#cmdline" class="table-of-contents__link">cmdline</a></li><li><a href="#启动流程" class="table-of-contents__link">启动流程</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">笔记</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/notes/java/java">Java</a></li><li class="footer__item"><a class="footer__link-item" href="/notes/os/alpine/alpine">AlpineLinux</a></li><li class="footer__item"><a class="footer__link-item" href="/notes/devops/kubernetes/kubernetes">Kubernates</a></li><li class="footer__item"><a class="footer__link-item" href="/notes/voip/voip">VoIP</a></li></ul></div><div class="col footer__col"><div class="footer__title">Projects</div><ul class="footer__items"><li class="footer__item">
              <div>
              <a class="footer__link-item" href="https://github.com/wenerme/wener">Wener</a>
              - <a class="footer__link-item" href="https://github.com/wenerme/wener/actions" title="wenerme/wener - ci">
                <img style="vertical-align: middle;opacity: .4;" src="https://github.com/wenerme/wener/workflows/Build/badge.svg">
                </a>
              </div>
              </li><li class="footer__item"><a href="https://apis.wener.me" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Wener&#x27;s Apis<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/story">Blog</a></li><li class="footer__item"><a href="https://github.com/wenerme" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://twitter.com/wenerme" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/img/wener-logo.svg" alt="Wener Site" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="/img/wener-logo.svg" alt="Wener Site" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></div><div class="footer__copyright">Copyright © 1992-2021 Wener - <img alt="cc-by-sa-4.0" src="https://mirrors.creativecommons.org/presskit/buttons/80x15/svg/by-sa.svg"> - Build @2021-09-18 21:12</div></div></div></footer></div>
<script src="/assets/js/runtime~main.4b23c3f8.js"></script>
<script src="/assets/js/main.c96d5a9a.js"></script>
</body>
</html>