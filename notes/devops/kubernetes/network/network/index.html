<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/story/rss.xml" title="Wener Live &amp; Life Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/story/atom.xml" title="Wener Live &amp; Life Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-30404720-1","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-30404720-1"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-30404720-1",{})</script>
<link rel="search" type="application/opensearchdescription+xml" title="Wener Live &amp; Life" href="/opensearch.xml">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css"><title data-react-helmet="true">Kubernates ç½‘ç»œ | Wener Live &amp; Life</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://wener.me/notes/devops/kubernetes/network/network"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Kubernates ç½‘ç»œ | Wener Live &amp; Life"><meta data-react-helmet="true" name="description" content="ç½‘ç»œè®¾è®¡"><meta data-react-helmet="true" property="og:description" content="ç½‘ç»œè®¾è®¡"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://wener.me/notes/devops/kubernetes/network/network"><link data-react-helmet="true" rel="alternate" href="https://wener.me/notes/devops/kubernetes/network/network" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://wener.me/notes/devops/kubernetes/network/network" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.1f8f45d9.css">
<link rel="preload" href="/assets/js/runtime~main.75e442be.js" as="script">
<link rel="preload" href="/assets/js/main.3db17b1a.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/wener-logo-head.svg" alt="Wener Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/wener-logo-head.svg" alt="Wener Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Wener</b></a><a class="navbar__item navbar__link" href="/notes/note">ç¬”è®°</a><a class="navbar__item navbar__link" href="/story">æ•…äº‹</a><a class="navbar__item navbar__link" href="/notes/howto/network/dns-prevent-spoofing">æŒ‡å—</a><a class="navbar__item navbar__link" href="/notes/tool/network/ip-lookup">å·¥å…·</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/wenerme/wener" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ğŸŒ</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="searchBox_1Doo"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">è‡ªæˆ‘æˆé•¿</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Java</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Web</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">è¯­è¨€</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">AlpineLinux</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Docker</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Kubernetes</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/kubernetes/kubernetes">Kubernetes</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/kubernetes/k8s-awesome">K8S Awesome</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/kubernetes/k8s-dashboard">Kubernates é¢æ¿</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/kubernetes/k8s-faq">K8S å¸¸è§é—®é¢˜</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/kubernetes/k8s-glossary">K8S è¯æ±‡è¡¨</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/kubernetes/k8s-my-practice">æˆ‘çš„ K8S å®è·µ</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/kubernetes/k8s-version">Kubernetes ç‰ˆæœ¬</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">å‘è¡Œç‰ˆ</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">ç½‘ç»œ</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/notes/devops/kubernetes/network/network">Kubernates ç½‘ç»œ</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/kubernetes/network/calico">Calico</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/kubernetes/network/emissary-ingress">emissary-ingress</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/kubernetes/network/flannel">Flannel</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/kubernetes/network/haproxy-ingress">HAProxy Ingress</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/kubernetes/network/k8s-gateway">Gateway</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/kubernetes/network/k8s-ingress">Kubernetes Ingress</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/kubernetes/network/k8s-network-awesome">Networking Awesome</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/kubernetes/network/k8s-network-faq">K8S Network FAQ</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/kubernetes/network/kong-ingress">Kong Ingress</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/kubernetes/network/metallb">MetalLB</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/kubernetes/network/nginx-ingress">Nginx Ingress</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/kubernetes/network/nginx-ingress-faq">Nginx Ingress å¸¸è§é—®é¢˜</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/kubernetes/network/nginx-ingress-version">nginx-ingress version</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/kubernetes/network/traefik-ingress">Traefik Ingress</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">å­˜å‚¨</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">å¹³å°</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">åº”ç”¨</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/kubernetes/dev/dev">Kubernetes å¼€å‘</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/kubernetes/dev/skaffold">skaffold</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/kubernetes/internal/internal">Kubernetes Internal</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/kubernetes/internal/k8s-api">Kubernates æ¥å£</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/kubernetes/internal/k8s-dns">Kubernetes DNS</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/kubernetes/internal/k8s-labels">Kubernetes æ ‡ç­¾</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/kubernetes/internal/k8s-scheduling">Kubernetes è°ƒåº¦</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/kubernetes/k3s-story">K8S ä½¿ç”¨ç»éªŒ</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/kubernetes/kubectl-faq">kubectl FAQ</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/kubernetes/ops/k8s-auth">è®¤è¯æˆæƒ</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/kubernetes/ops/kops">kops</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/kubernetes/ops/kubectl">Kubectl</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/kubernetes/ops/kubectl-faq">kubectl FAQ</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/kubernetes/ops/rke">RKE - å®‰è£…å™¨</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/kubernetes/tool/krew">krew</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/kubernetes/tool/kustomize">kustomize</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Linux</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">è™šæ‹ŸåŒ–</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">æ“ä½œç³»ç»Ÿ</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">VoIP</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">å¼€å‘</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">DevOps</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">æ•°æ®åº“</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">æ¶ˆæ¯é˜Ÿåˆ—</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">å®‰å…¨</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">æœåŠ¡</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">è¿ç»´</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">æŒ‡å—</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">ç¡¬ä»¶</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">ç®—æ³•</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">å¥åº·</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">å‚è€ƒ</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">å·¥å…·</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Kubernates Network</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="ç½‘ç»œè®¾è®¡"></a>ç½‘ç»œè®¾è®¡<a class="hash-link" href="#ç½‘ç»œè®¾è®¡" title="Direct link to heading">#</a></h2><ul><li>ç‰©ç†ç½‘ç»œ - Phycial Net - OS Net<ul><li>èŠ‚ç‚¹ä¹‹é™…ç½‘ç»œé€šä¿¡</li><li>å®¿ä¸»æœºå®é™…ç½‘ç»œ - ä¾‹å¦‚ eth0</li><li>åœ°å€ä¸º node-ip</li></ul></li><li>å®¹å™¨ç½‘ç»œ - Pod Net<ul><li>å®¹å™¨ä¹‹é—´äº’é€šçš„ç½‘ç»œ</li><li>æ¯ä¸ªå®¹å™¨éƒ½æœ‰å”¯ä¸€ç‹¬ç«‹ IP</li><li>é€šå¸¸å®ç°æ˜¯ä¸€ä¸ªèŠ‚ç‚¹ä¸€ä¸ªå­ç½‘ï¼Œè®©ç»™ Pod åˆ†é…å­ç½‘è¿›è¡Œé€šä¿¡</li><li>Pod ç½‘ç»œæµé‡åœ¨ç‰©ç†ç½‘ç»œä¸Šçœ‹ä¸åˆ° - ä¾‹å¦‚ eth0 ä¸Šçœ‹ä¸åˆ°</li><li>CNI - Container Network Interface - å®¹å™¨ç½‘ç»œæ¥å£ - æ ‡å‡†åŒ–äº†å®¹å™¨ä¹‹é—´ç½‘ç»œå®ç°æ¥å£<ul><li>JSON é…ç½® - æ’ä»¶åŒ–</li><li>kubelet åœ¨æ¯æ¬¡å¯åŠ¨ pod å‰éƒ½ä¼šè°ƒç”¨ cni æ’ä»¶</li><li><code>/etc/cni/net.d</code></li><li><code>/opt/cni/bin</code></li><li>å¸¸è§åç«¯<ul><li>linux-bridge</li><li>ipvlan</li><li>macvlan</li><li>Open vSwitch</li></ul></li></ul></li><li>æœ‰éå¸¸å¤šä¸åŒçš„å®ç°<ul><li>flannel - ä¼šåœ¨èŠ‚ç‚¹ä¸Šåˆ›å»º flannel1.1 ç½‘å¡æ¥é€šä¿¡</li></ul></li></ul></li><li>æœåŠ¡ç½‘ç»œ - Service Net<ul><li>é›†ç¾¤å†…éƒ¨æœåŠ¡å‘ç°ã€æµé‡åˆ†å‘</li><li>æœåŠ¡å‘ç° - ä¾‹å¦‚ nginx.default.svc.cluser.local åŸŸå</li><li>æ²¡æœ‰è®¿é—®æ§åˆ¶ã€æ²¡æœ‰æµé‡æ§åˆ¶</li><li>è™šæ‹Ÿåœ°å€ - VIP - Virtual IP</li><li>ä¸‰ç§æ¨¡å¼<ul><li>ClusterIP</li><li>LoadBalancer</li><li>NodePort</li></ul></li><li>kube-proxy - é…ç½® iptables æš´éœ²æœåŠ¡<ul><li>é€šè¿‡ä¿®æ”¹ iptables æ¥å®ç°æµé‡è½¬å‘</li><li>iptables æŒ‡å‘æ¯ä¸ª endpoint</li><li>æ¯ä¸ªåŒ…æ‰“éšæœºæ•°ç”¨æ¥å®ç°è´Ÿè½½ - ä½†ä¸ç²¾ç¡®</li></ul></li><li>iptables-save ä¼šçœ‹åˆ° <code>KUBE-SERVICE</code> ç›¸å…³çš„è§„åˆ™</li><li>service-cird æŒ‡å®šäº† ClusterIP çš„åœ°å€æ®µ</li><li>æœåŠ¡ä¹‹ä¸‹ä¸º Endpoint - é€šå¸¸ä¸º Podï¼Œä¹Ÿå¯ä»¥ç›´æ¥å®šä¹‰ Endpoint</li></ul></li><li>Ingress<ul><li>Kubernates çš„ç½‘ç»œå…¥å£ï¼Œå°†æœåŠ¡æš´éœ²åˆ°å¤–éƒ¨</li><li>ç›´æ¥ä¸ Pod é€šä¿¡è€Œä¸æ˜¯ä¸æœåŠ¡é€šä¿¡</li><li>é€šå¸¸ä¸º 7 å±‚ HTTP - éƒ¨åˆ†æ”¯æŒ 4 å±‚ TCP</li><li>å¤§å¤šå®ç°ä¹Ÿæ”¯æŒ CRD æ–¹å¼ï¼Œæ”¯æŒæ›´å¤æ‚çš„å®šä¹‰é€»è¾‘</li></ul></li><li>Egress - å‡ºå£æµé‡<ul><li>ä½¿ç”¨è¾ƒå°‘ï¼Œç›®å‰ calico æ”¯æŒ</li></ul></li><li>å‚è€ƒ<ul><li><a href="https://www.youtube.com/watch?v=H5Zl_kDOwBU" target="_blank" rel="noopener noreferrer">The Easy--Don&#x27;t Drive Yourself Crazy--Way to Kubernetes Networking [B] - Gerard Hickey</a></li><li><a href="https://itnext.io/an-illustrated-guide-to-kubernetes-networking-part-1-d1ede3322727" target="_blank" rel="noopener noreferrer">An illustrated guide to Kubernetes Networking</a></li></ul></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="èµ„æº"></a>èµ„æº<a class="hash-link" href="#èµ„æº" title="Direct link to heading">#</a></h2><ul><li>ServiceLoadBalancerClass - v1.22 beta<ul><li>spec.loadBalancerClass</li></ul></li><li>IngressClass<ul><li>spec.parameters.scope: Namespace - Namespace çº¬åº¦ IngressClass v1.22 beta</li></ul></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="é›†ç¾¤ç½‘ç»œ"></a>é›†ç¾¤ç½‘ç»œ<a class="hash-link" href="#é›†ç¾¤ç½‘ç»œ" title="Direct link to heading">#</a></h2><ul><li><a href="https://kubernetes.io/docs/concepts/cluster-administration/networking/" target="_blank" rel="noopener noreferrer">Cluster Networking</a></li><li><a href="https://github.com/kubernetes/community/blob/master/contributors/design-proposals/network/networking.md" target="_blank" rel="noopener noreferrer">ç½‘ç»œè®¾è®¡æ–‡æ¡£</a></li><li>å››ç§ç½‘ç»œç±»å‹<ol><li>å®¹å™¨ åˆ° å®¹å™¨</li></ol><ul><li>å¯¹äºå®¹å™¨æœ¬èº«æ¥è¯´å®ƒå°±åƒè¿è¡Œåœ¨åŒä¸€ä¸ªä¸»æœºä¸Š</li></ul><ol start="2"><li>Pod åˆ° Pod</li></ol><ul><li>æ¯ä¸ªéƒ½æœ‰çœŸå®ç‹¬ç«‹ IP</li><li>IP è·¨èŠ‚ç‚¹å”¯ä¸€ã€é€šä¿¡</li></ul><ol start="3"><li>Pod åˆ° Service</li><li>å¤–éƒ¨ åˆ° Service</li></ol></li><li>è¦æ±‚<ul><li>Pod ä¹‹é—´äº’é€š - æ—  NAT</li><li>èŠ‚ç‚¹ä¸Š Agent å’Œ Pod äº’é€š</li><li>æ”¯æŒ Host ç½‘ç»œçš„å¹³å° - Pod åœ¨ä¸»æœºç½‘ç»œä¸‹èƒ½ä¸å…¶ä»– Pod äº’é€š - æ—  NAT</li></ul></li><li>å®ç°<ul><li>Linux L2 å±‚æ¡¥æ¥ç½‘ç»œ<ul><li><a href="https://www.tinc-vpn.org/" target="_blank" rel="noopener noreferrer">Tinc</a></li></ul></li><li><a href="https://github.com/coreos/flannel" target="_blank" rel="noopener noreferrer">coreos/flannel</a></li><li><a href="https://github.com/projectcalico/calico" target="_blank" rel="noopener noreferrer">projectcalico/calico</a></li><li><a href="https://github.com/ovn-org/ovn-kubernetes" target="_blank" rel="noopener noreferrer">ovn-org/ovn-kubernetes</a></li></ul></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="æœåŠ¡å‘ç°"></a>æœåŠ¡å‘ç°<a class="hash-link" href="#æœåŠ¡å‘ç°" title="Direct link to heading">#</a></h2><ul><li><a href="https://github.com/kubernetes/community/blob/master/contributors/design-proposals/network/service-discovery.md" target="_blank" rel="noopener noreferrer">Service Discovery Proposal</a></li></ul><p><strong>æ¨è Annotation</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly json"><pre tabindex="0" class="prism-code language-json codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;api.service.kubernetes.io/protocol&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;REST&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;api.service.kubernetes.io/scheme&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;http&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;api.service.kubernetes.io/path&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;cxfcdi&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;api.service.kubernetes.io/description-path&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;cxfcdi/swagger.json&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;api.service.kubernetes.io/description-language&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;SwaggerJSON&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="resolvconf"></a>resolv.conf<a class="hash-link" href="#resolvconf" title="Direct link to heading">#</a></h2><ul><li><a href="https://github.com/kubernetes/community/blob/master/contributors/design-proposals/network/pod-resolv-conf.md" target="_blank" rel="noopener noreferrer">Custom /etc/resolv.conf</a></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="æœåŠ¡ç½‘ç»œ"></a>æœåŠ¡ç½‘ç»œ<a class="hash-link" href="#æœåŠ¡ç½‘ç»œ" title="Direct link to heading">#</a></h2><ul><li><a href="https://medium.com/google-cloud/922f010849e0" target="_blank" rel="noopener noreferrer">Kubernetes NodePort vs LoadBalancer vs Ingress? When should I use what?</a></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="clusterip"></a>ClusterIP<a class="hash-link" href="#clusterip" title="Direct link to heading">#</a></h3><ul><li>æ— å¤–éƒ¨è®¿é—®</li><li>å¯é€šè¿‡ <code>kubectl proxy --port=8080</code> è¿›è¡Œè®¿é—® - åœ°å€ä¸º <code>http://localhost:8080/api/v1/proxy/namespaces/&lt;NAMESPACE&gt;/services/&lt;SERVICE-NAME&gt;:&lt;PORT-NAME&gt;/</code></li><li>ç”¨äºè°ƒè¯•å’Œæš´éœ²å†…éƒ¨æœåŠ¡</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> v1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Service</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">internal</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">service</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">selector</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">app</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> ClusterIP</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">ports</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> http</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">port</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">80</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">targetPort</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">80</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">protocol</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> TCP</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="nodeport"></a>NodePort<a class="hash-link" href="#nodeport" title="Direct link to heading">#</a></h3><ul><li>æä¾›å¤–éƒ¨è®¿é—®æœ€åŸå§‹çš„æ–¹æ³•</li><li>åœ¨æ‰€æœ‰èŠ‚ç‚¹å¼€å¯ç›¸åŒç«¯å£è¿›è¡Œè½¬å‘</li><li>ç¼ºç‚¹<ul><li>ä¸€ä¸ªæœåŠ¡åªèƒ½æš´éœ²ä¸€ä¸ªç«¯å£</li><li>ç«¯å£é™å®šåœ¨ 30000â€“32767</li><li>éœ€è¦å…³æ³¨èŠ‚ç‚¹åœ°å€å˜åŒ–</li></ul></li><li>åœºæ™¯<ul><li>æ¼”ç¤ºæœåŠ¡</li><li>å•ç«¯å£æœåŠ¡ - ä¾‹å¦‚ DNS</li></ul></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> v1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Service</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">nodeport</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">service</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">selector</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">app</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> NodePort</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">ports</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> http</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">port</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">80</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">targetPort</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">80</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># ä¸æŒ‡å®šåˆ™éšæœºåˆ†é…</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 30000-32767</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">nodePort</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">30036</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">protocol</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> TCP</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="loadbalancer"></a>LoadBalancer<a class="hash-link" href="#loadbalancer" title="Direct link to heading">#</a></h3><ul><li>æ ‡å‡†çš„æš´éœ²æœåŠ¡æ–¹å¼</li><li>æ¯ä¸ªæœåŠ¡éƒ½ä¼šè·å–åˆ°è‡ªå·±çš„ IP - å› æ­¤æ¯ä¸ªæš´éœ²çš„æœåŠ¡éƒ½ä¼šéœ€è¦å¯¹è´Ÿè½½å‡è¡¡ä»˜è´¹</li><li>ç¼ºç‚¹<ul><li>è´Ÿè½½å‡è¡¡æ˜¯ç”±å¹³å°æä¾›ä¸”ä¼´éšè´¹ç”¨</li></ul></li><li>å‚è€ƒ<ul><li><a href="https://github.com/danderson/metallb" target="_blank" rel="noopener noreferrer">danderson/metallb</a> - åŸºäºè·¯ç”±çš„å†…éƒ¨ LB å®ç°</li><li>å¯é€šè¿‡è‡ªå®šä¹‰ <a href="https://kubernetes.io/docs/tasks/administer-cluster/developing-cloud-controller-manager/" target="_blank" rel="noopener noreferrer">Cloud Controller Manager</a> æ¥æä¾› LoadBalancer</li><li><a href="https://kubernetes.io/docs/tasks/access-application-cluster/create-external-load-balancer" target="_blank" rel="noopener noreferrer">Create an External Load Balancer</a></li><li>NGINX Ingress Controller <a href="https://kubernetes.github.io/ingress-nginx/deploy/baremetal" target="_blank" rel="noopener noreferrer">Bare-metal considerations</a></li></ul></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> v1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Service</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> example</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">service</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">selector</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> example</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">ports</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">port</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">8765</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">targetPort</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">9376</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> LoadBalancer</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># å°†æŸä¸ªæœåŠ¡é€šè¿‡è´Ÿè½½å‡è¡¡çš„æ–¹å¼è¿›è¡Œç«¯å£æš´éœ²</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl expose svc web --type</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">LoadBalancer --port</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">80</span><span class="token plain"> --target-port</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">8080</span><span class="token plain"> --external-ip</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">192.168</span><span class="token plain">.1.2 --name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">web-lb</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># æŸ¥çœ‹æœåŠ¡çŠ¶æ€åŒ…å«åœ°å€ä¿¡æ¯</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl describe svc ingress-nginx-ingress-controller</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="ingress"></a>Ingress<a class="hash-link" href="#ingress" title="Direct link to heading">#</a></h3><ul><li>ä¸æ˜¯ä¸€ä¸ªæœåŠ¡</li><li>åº”ç”¨å±‚è·¯ç”± - åˆ†ä¸º Ingress å®šä¹‰å’Œ IngressController æ§åˆ¶å™¨</li><li>å¸¸è§å®ç° Nginxã€Istioã€<a href="https://github.com/containous/traefik" target="_blank" rel="noopener noreferrer">Traefik</a>ã€<a href="https://github.com/projectcontour/contour" target="_blank" rel="noopener noreferrer">Contour</a></li><li>ä¸€èˆ¬éœ€è¦é…å¥— cert-manager ä½¿ç”¨</li><li>èƒ½é™„å¸¦å…¶å®ƒèƒ½åŠ› SSLã€é‰´æƒã€è·¯ç”±ç­‰</li><li>åœºæ™¯<ul><li>ä½¿ç”¨ HTTP åè®®</li><li>ä¸€ä¸ªåç«¯æš´éœ²å¤šä¸ªæœåŠ¡</li></ul></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> extensions/v1beta1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Ingress</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">ingress</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">backend</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">serviceName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> other</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">servicePort</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">8080</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">rules</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">host</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> foo.mydomain.com</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">http</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">paths</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">backend</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              </span><span class="token key atrule">serviceName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> foo</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              </span><span class="token key atrule">servicePort</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">8080</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">host</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> mydomain.com</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">http</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">paths</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> /bar/*</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token key atrule">backend</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              </span><span class="token key atrule">serviceName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> bar</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              </span><span class="token key atrule">servicePort</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">8080</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="externalname"></a>ExternalName<a class="hash-link" href="#externalname" title="Direct link to heading">#</a></h3><ul><li>ä¼šå°† <code>my-service.prod.svc.cluster.local</code> CNAME ä¸º <code>my.database.example.com</code></li><li>å¦‚æœä½¿ç”¨ SSL ä¼šæœ‰è¯ä¹¦é—®é¢˜</li><li>å¦‚æœä½¿ç”¨çš„ç¯å¢ƒ DNS ä¸äº’é€šä¹Ÿä¼šæœ‰é—®é¢˜</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> v1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Service</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">service</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">namespace</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> prod</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> ExternalName</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">externalName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> my.database.example.com</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="externalips"></a>ExternalIPs<a class="hash-link" href="#externalips" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> v1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Service</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">service</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">selector</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> MyApp</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">ports</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> http</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">protocol</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> TCP</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">port</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">80</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">targetPort</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">9376</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">externalIPs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> 80.11.12.10</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="faq"></a>FAQ<a class="hash-link" href="#faq" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="nodeport-vs-hostport-vs-hostnetwork"></a>NodePort vs HostPort vs HostNetwork<a class="hash-link" href="#nodeport-vs-hostport-vs-hostnetwork" title="Direct link to heading">#</a></h3><ul><li>éƒ½æ˜¯ä¸ºäº†åœ¨è™šæ‹ŸèŠ‚ç‚¹ä¸Šæš´éœ²ç«¯å£</li><li>TLS åœºæ™¯å¦‚æœæƒ³è¦è·å–åˆ°å®¢æˆ·ç«¯ IP åˆ™éœ€è¦æš´éœ²ç«¯å£åˆ°ä¸»æœº - å¦åˆ™ä½¿ç”¨ tcp proxy - å¾ˆéº»çƒ¦</li><li>NodePort<ul><li>æ¨èæ–¹å¼</li><li>Kubernetes ç®¡ç† - ç«¯å£èŒƒå›´ 30000â€“32767</li><li>å¯ä»¥è½¬å‘æœåŠ¡ - ä¸éœ€è¦èŠ‚ç‚¹è¿è¡Œ POD</li></ul></li><li>HostPort<ul><li>ä¸æ¨èä½¿ç”¨ - é™¤éä¸å¾—å·² - node daemon</li><li>Kubernetes é¢„ç•™ç«¯å£</li><li>èŠ‚ç‚¹éœ€è¦è¿è¡Œ POD</li><li>å–å†³äº CNI å®ç°</li><li>ä¼šå½±å“ pod è°ƒåº¦ - å› ä¸ºç«¯å£å†²çª</li></ul></li><li>HostNetwork<ul><li>ä¸ä¾èµ– CNI</li><li>åœ¨å®¿ä¸»æœºç½‘ç»œç©ºé—´</li><li>èƒ½è®¿é—® lookback è®¾å¤‡ã€æœåŠ¡ ç­‰</li><li>èƒ½å¤Ÿè·å–èŠ‚ç‚¹ä¸Šçš„ç½‘ç»œæ´»åŠ¨</li><li>DaemonSet æ—¶å¯ä»¥ä½¿ç”¨</li></ul></li><li>å‚è€ƒ<ul><li><a href="https://github.com/kubernetes/kubernetes/issues/23920" target="_blank" rel="noopener noreferrer">https://github.com/kubernetes/kubernetes/issues/23920</a></li></ul></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/wenerme/wener/edit/master/notes/devops/kubernetes/network/README.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/notes/devops/kubernetes/distro/kine"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« kine</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/notes/devops/kubernetes/network/calico"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Calico Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#ç½‘ç»œè®¾è®¡" class="table-of-contents__link">ç½‘ç»œè®¾è®¡</a></li><li><a href="#èµ„æº" class="table-of-contents__link">èµ„æº</a></li><li><a href="#é›†ç¾¤ç½‘ç»œ" class="table-of-contents__link">é›†ç¾¤ç½‘ç»œ</a></li><li><a href="#æœåŠ¡å‘ç°" class="table-of-contents__link">æœåŠ¡å‘ç°</a></li><li><a href="#resolvconf" class="table-of-contents__link">resolv.conf</a></li><li><a href="#æœåŠ¡ç½‘ç»œ" class="table-of-contents__link">æœåŠ¡ç½‘ç»œ</a><ul><li><a href="#clusterip" class="table-of-contents__link">ClusterIP</a></li><li><a href="#nodeport" class="table-of-contents__link">NodePort</a></li><li><a href="#loadbalancer" class="table-of-contents__link">LoadBalancer</a></li><li><a href="#ingress" class="table-of-contents__link">Ingress</a></li><li><a href="#externalname" class="table-of-contents__link">ExternalName</a></li><li><a href="#externalips" class="table-of-contents__link">ExternalIPs</a></li></ul></li><li><a href="#faq" class="table-of-contents__link">FAQ</a><ul><li><a href="#nodeport-vs-hostport-vs-hostnetwork" class="table-of-contents__link">NodePort vs HostPort vs HostNetwork</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">ç¬”è®°</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/notes/java/java">Java</a></li><li class="footer__item"><a class="footer__link-item" href="/notes/os/alpine/alpine">AlpineLinux</a></li><li class="footer__item"><a class="footer__link-item" href="/notes/devops/kubernetes/kubernetes">Kubernates</a></li><li class="footer__item"><a class="footer__link-item" href="/notes/voip/voip">VoIP</a></li></ul></div><div class="col footer__col"><div class="footer__title">Projects</div><ul class="footer__items"><li class="footer__item">
              <div>
              <a class="footer__link-item" href="https://github.com/wenerme/wener">Wener</a>
              - <a class="footer__link-item" href="https://github.com/wenerme/wener/actions" title="wenerme/wener - ci">
                <img style="vertical-align: middle;opacity: .4;" src="https://github.com/wenerme/wener/workflows/Build/badge.svg">
                </a>
              </div>
              </li><li class="footer__item"><a href="https://apis.wener.me" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Wener&#x27;s Apis<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/story">Blog</a></li><li class="footer__item"><a href="https://github.com/wenerme" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://twitter.com/wenerme" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/img/wener-logo.svg" alt="Wener Site" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="/img/wener-logo.svg" alt="Wener Site" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></div><div class="footer__copyright">Copyright Â© 1992-2021 Wener - <img alt="cc-by-sa-4.0" src="https://mirrors.creativecommons.org/presskit/buttons/80x15/svg/by-sa.svg"> - Build @2021-12-04 21:13</div></div></div></footer></div>
<script src="/assets/js/runtime~main.75e442be.js"></script>
<script src="/assets/js/main.3db17b1a.js"></script>
</body>
</html>