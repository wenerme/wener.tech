<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/story/rss.xml" title="Wener Live &amp; Life Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/story/atom.xml" title="Wener Live &amp; Life Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-30404720-1","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-30404720-1"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-30404720-1",{})</script>
<link rel="search" type="application/opensearchdescription+xml" title="Wener Live &amp; Life" href="/opensearch.xml">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css"><title data-react-helmet="true">Docker 常用服务 | Wener Live &amp; Life</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://wener.me/notes/devops/docker/docker-cookbook"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Docker 常用服务 | Wener Live &amp; Life"><meta data-react-helmet="true" name="description" content="常用选项"><meta data-react-helmet="true" property="og:description" content="常用选项"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://wener.me/notes/devops/docker/docker-cookbook"><link data-react-helmet="true" rel="alternate" href="https://wener.me/notes/devops/docker/docker-cookbook" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://wener.me/notes/devops/docker/docker-cookbook" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.1f8f45d9.css">
<link rel="preload" href="/assets/js/runtime~main.448c88fd.js" as="script">
<link rel="preload" href="/assets/js/main.d38cdb4b.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/wener-logo-head.svg" alt="Wener Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/wener-logo-head.svg" alt="Wener Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Wener</b></a><a class="navbar__item navbar__link" href="/notes/note">笔记</a><a class="navbar__item navbar__link" href="/story">故事</a><a class="navbar__item navbar__link" href="/notes/howto/network/dns-prevent-spoofing">指南</a><a class="navbar__item navbar__link" href="/notes/tool/network/ip-lookup">工具</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/wenerme/wener" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">🌞</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="searchBox_1Doo"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">自我成长</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Java</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Web</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">语言</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">AlpineLinux</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Docker</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/notes/devops/docker/docker-cookbook">Docker 常用服务</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/docker/docker-faq">Docker FAQ</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/docker/docker-intro">Docker</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/docker/docker-network">Docker 网络</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/docker/docker-registry">Docker 仓库</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/docker/docker-storage">Docker 存储</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/docker/docker-swarm">Docker Swarm</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/devops/docker/watchtower">Watchtower</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Kubernetes</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Linux</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">虚拟化</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">操作系统</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">VoIP</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">开发</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">DevOps</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">数据库</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">消息队列</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">安全</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">服务</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">运维</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">指南</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">硬件</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">算法</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">健康</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">参考</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">工具</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Run container</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="常用选项"></a>常用选项<a class="hash-link" href="#常用选项" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># docker run</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--restart always</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 调整容器中的时间</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">-v /etc/localtime:/etc/localtime:ro</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 后台运行</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">-d</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="xhyve"></a>xhyve<a class="hash-link" href="#xhyve" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 安装 https://github.com/zchee/docker-machine-driver-xhyve#install</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker-machine create --driver xhyve xhyve</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">eval</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">`</span><span class="token variable" style="color:rgb(191, 199, 213)">docker-machine </span><span class="token variable function" style="color:rgb(130, 170, 255)">env</span><span class="token variable" style="color:rgb(191, 199, 213)"> xhyve</span><span class="token variable" style="color:rgb(191, 199, 213)">`</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker info</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="mysql"></a>MySQL<a class="hash-link" href="#mysql" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token assign-left variable" style="color:rgb(191, 199, 213)">DIR</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">/data/mysql</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 自定义配置</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">mkdir</span><span class="token plain"> -p /data/mysql/conf.d/</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">[mysqld]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">character_set_server=utf8mb4</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">collation_server=utf8mb4_unicode_ci</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> /data/mysql/conf.d/my.cnf</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 自定义数据目录</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">mkdir</span><span class="token plain"> -p /data/mysql/conf.d/datadir</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 使用自定义的配置启动 MySQL</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run -d --restart always -v /etc/localtime:/etc/localtime:ro </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -p </span><span class="token number" style="color:rgb(247, 140, 108)">3306</span><span class="token plain">:3306 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -v /data/mysql/datadir:/var/lib/mysql -v /data/mysql/conf.d:/etc/mysql/conf.d </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -e </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">MYSQL_ROOT_PASSWORD</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">ThisIsPassword </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --name mysql mysql</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="owncloudnextcloud"></a>OwnCloud/Nextcloud<a class="hash-link" href="#owncloudnextcloud" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 需要先创建名为 mysql 的 mysql 容器,如果没有,可去除 --link</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 启动 OwnCloud</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run -d --restart always -v /etc/localtime:/etc/localtime:ro </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -p </span><span class="token number" style="color:rgb(247, 140, 108)">8080</span><span class="token plain">:80 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -v /data/owncloud:/var/www/html </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --link mysql:mysql </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --name owncloud owncloud</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="反向代理"></a>反向代理<a class="hash-link" href="#反向代理" title="Direct link to heading">#</a></h3><p>sudo nano /data/owncloud/config/config.php</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><pre tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;?php</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">/* $CONFIG */</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$EXTRA_CONFIG = array (</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;trusted_proxies&quot;   =&gt; [&#x27;10.0.0.1&#x27;],</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;overwritehost&quot;     =&gt; &quot;ssl-proxy.tld&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;overwriteprotocol&quot; =&gt; &quot;https&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;overwritewebroot&quot;  =&gt; &quot;/domain.tld/owncloud&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;overwritecondaddr&quot; =&gt; &quot;^10\.0\.0\.1$&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$CONFIG = array_merge($CONFIG, $EXTRA_CONFIG)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="jenkins"></a>Jenkins<a class="hash-link" href="#jenkins" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 不用映射, 备份通过 docker cp $ID:/var/jenkins_home</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 设置 JENKINS_OPTS=&quot;--prefix=/jenkins&quot; 来做反向代理</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 如果目录有权限问题可手动设置 mkdir -p /data/jenkins &amp;&amp; chwon 1000:1000 /data/jenkins</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run -d --restart always -v /etc/localtime:/etc/localtime:ro </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -p </span><span class="token number" style="color:rgb(247, 140, 108)">8080</span><span class="token plain">:8080 -p </span><span class="token number" style="color:rgb(247, 140, 108)">50000</span><span class="token plain">:50000 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -v /data/jenkins:/var/jenkins_home </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --name jenkins jenkins</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Jenkins 是离线的,由于 <code>jenkins-ci.org</code> 被墙,所以可能需要使用 HTTP 代理</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="gitea"></a>gitea<a class="hash-link" href="#gitea" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run -d --restart always -v /etc/localtime:/etc/localtime:ro </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -p </span><span class="token number" style="color:rgb(247, 140, 108)">3000</span><span class="token plain">:3000 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -v /data/gitea:/data </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --name gitea gitea/gitea</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="php"></a>PHP<a class="hash-link" href="#php" title="Direct link to heading">#</a></h2><p>官方提供了很多 PHP 版本, 如果需要额外的扩展建议自己 build 一个, 例如</p><p><strong>php.dockerfile</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly dockerfile"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">FROM php:5-apache</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">RUN apt-get update</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">RUN apt-get install -y libcurl4-openssl-dev pkg-config libssl-dev  \</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &amp;&amp; pecl install mongodb \</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &amp;&amp; docker-php-ext-enable mongodb</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">RUN pecl install redis &amp;&amp; docker-php-ext-enabl redis</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker build -t wener/php -f php.dockerfile </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">.</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run -d --restart always -p </span><span class="token number" style="color:rgb(247, 140, 108)">80</span><span class="token plain">:80 -v /data/php/www:/var/www/html --name php wener/php</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 也可以添加自己的配置</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 设置默认时区</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;date.timezone=Asia/Shanghai&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> /data/php/config/php.ini</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run -d --restart always  -p </span><span class="token number" style="color:rgb(247, 140, 108)">80</span><span class="token plain">:80 -v /data/php/www:/var/www/html </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -v /data/php/config/php.ini:/usr/local/etc/php/php.ini  --name php wener/php</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="droneio"></a>Drone.io<a class="hash-link" href="#droneio" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Drone 一般配合 Gogs 使用</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">mkdir</span><span class="token plain"> /opt/apps/drone </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;&amp;</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">cd</span><span class="token plain"> /opt/apps/drone</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 用于存放数据</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">mkdir</span><span class="token plain"> data</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 需要预先在 MySQL 中将 drone 库创建出来</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 需要将数据库修改为具体的</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 配置参考 http://readme.drone.io/setup/settings/</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">REMOTE_DRIVER=gogs</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">REMOTE_CONFIG=https://gogs.hooli.com?open=false</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">DATABASE_DRIVER=mysql</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">DATABASE_CONFIG=root:pa55word@tcp(localhost:3306)/drone?parseTime=true</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)"># HTTPS_PROXY=https://proxy.example.com</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)"># HTTP_PROXY=http://proxy.example.com</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)"># NO_PROXY=.example.com, *.docker.example.com</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> dronerc</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run -d --restart always -v /etc/localtime:/etc/localtime:ro </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -p</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">8080</span><span class="token plain">:8000 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    -v /opt/apps/drone/data:/var/lib/drone </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    -v /var/run/docker.sock:/var/run/docker.sock </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --env-file ./dronerc </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --link mysql:mysql </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">drone drone/drone</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="更新"></a>更新<a class="hash-link" href="#更新" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker stop drone</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker </span><span class="token function" style="color:rgb(130, 170, 255)">rm</span><span class="token plain"> drone</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker pull drone/drone</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run </span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token plain">.</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="安装-go-环境"></a>安装 Go 环境<a class="hash-link" href="#安装-go-环境" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 进入容器执行</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">exec</span><span class="token plain"> -it jenkins </span><span class="token function" style="color:rgb(130, 170, 255)">bash</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 安装 Go 环境</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">mkdir</span><span class="token plain"> /var/jenkins_home/go/root</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">cd</span><span class="token plain"> /var/jenkins_home/go/root</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">GOVERSION</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">1.7</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">wget</span><span class="token plain"> https://storage.googleapis.com/golang/go</span><span class="token variable" style="color:rgb(191, 199, 213)">$GOVERSION</span><span class="token plain">.linux-amd64.tar.gz</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 或者使用代理下载</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># https_proxy=socks://127.0.0.1:8888 curl https://storage.googleapis.com/golang/go$GOVERSION.linux-amd64.tar.gz -o go$GOVERSION.linux-amd64.tar.gz</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">tar</span><span class="token plain"> -C /var/jenkins_home/go/root -xzf go</span><span class="token variable" style="color:rgb(191, 199, 213)">$GOVERSION</span><span class="token plain">.linux-amd64.tar.gz</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 然后在 Jenkins 中添加环境变量</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># GOROOT=/var/jenkins_home/go/root/go</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># GOPATH=/var/jenkins_home/go</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="watchtower"></a>WatchTower<a class="hash-link" href="#watchtower" title="Direct link to heading">#</a></h2><ul><li><a href="https://github.com/v2tec/watchtower" target="_blank" rel="noopener noreferrer">https://github.com/v2tec/watchtower</a></li><li>Docker 无法运行后添加 Label <a href="https://github.com/moby/moby/issues/21721" target="_blank" rel="noopener noreferrer">#21721</a></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 将主机上的 docker 配置授权映射到容器内以便于拉取私有仓库</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># -i 检查间隔</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># --label-enable 监控带 com.centurylinklabs.watchtower.enable=&quot;true&quot; 标记的</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run -d </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --name watchtower </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -v </span><span class="token environment constant" style="color:rgb(130, 170, 255)">$HOME</span><span class="token plain">/.docker/config.json:/config.json </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -v /var/run/docker.sock:/var/run/docker.sock </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  v2tec/watchtower container_to_watch --debug -i </span><span class="token number" style="color:rgb(247, 140, 108)">120</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="redis"></a>Redis<a class="hash-link" href="#redis" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run -d --restart always -v /etc/localtime:/etc/localtime:ro </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -p </span><span class="token number" style="color:rgb(247, 140, 108)">6379</span><span class="token plain">:6379 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -v /data/redis:/data </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --name redis redis redis-server --appendonly </span><span class="token function" style="color:rgb(130, 170, 255)">yes</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 客户端</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run -it --link some-redis:redis --rm redis redis-cli -h redis -p </span><span class="token number" style="color:rgb(247, 140, 108)">6379</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="docker-in-docker"></a>Docker in Docker<a class="hash-link" href="#docker-in-docker" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 使用主机的 Docker</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run -it -v /var/run/docker.sock:/var/run/docker.sock -v /usr/bin/docker:/usr/bin/docker wener/base:bash</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># start dockerd</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run -it --privileged -v /data/docker:/var/lib/docker --name dockerd --rm docker:dind</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 客户端</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># DOCKER_HOST=tcp://docker:2375</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run --rm -it --link dockerd:docker docker info</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="mongodb"></a>MongoDB<a class="hash-link" href="#mongodb" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run -d --restart always -v /etc/localtime:/etc/localtime:ro </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -p </span><span class="token number" style="color:rgb(247, 140, 108)">27017</span><span class="token plain">:27017 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -v /data/mongo:/data/db </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --name mongo mongo</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 客户端</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run -it --link some-mongo:mongo --rm mongo </span><span class="token function" style="color:rgb(130, 170, 255)">sh</span><span class="token plain"> -c </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;exec mongo &quot;</span><span class="token string variable" style="color:rgb(191, 199, 213)">$MONGO_PORT_27017_TCP_ADDR</span><span class="token string" style="color:rgb(195, 232, 141)">:</span><span class="token string variable" style="color:rgb(191, 199, 213)">$MONGO_PORT_27017_TCP_PORT</span><span class="token string" style="color:rgb(195, 232, 141)">/test&quot;&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ul><li>由于 MongoDB 使用的 memmap, 通过 vbox 的映射不能够做共享数据卷, 但可以使用 xhyve 驱动的 docker-machine</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># mongo with mongoclient</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run -d --restart always -v /etc/localtime:/etc/localtime:ro </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --network </span><span class="token function" style="color:rgb(130, 170, 255)">service</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -p </span><span class="token number" style="color:rgb(247, 140, 108)">27017</span><span class="token plain">:27017 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -v </span><span class="token environment constant" style="color:rgb(130, 170, 255)">$HOME</span><span class="token plain">/data/mongo:/data/db </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --name mongo mongo</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run -d --restart always -v /etc/localtime:/etc/localtime:ro </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --network </span><span class="token function" style="color:rgb(130, 170, 255)">service</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    -e </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">MONGO_URL</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">mongodb://mongo:27017 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    -p </span><span class="token number" style="color:rgb(247, 140, 108)">3000</span><span class="token plain">:3000 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --name mongoclient mongoclient/mongoclient</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="rethinkdb"></a>RethinkDB<a class="hash-link" href="#rethinkdb" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 配置参考</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># https://github.com/rethinkdb/rethinkdb/blob/next/packaging/assets/config/default.conf.sample</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run -d --restart always -v /etc/localtime:/etc/localtime:ro </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -p </span><span class="token number" style="color:rgb(247, 140, 108)">8080</span><span class="token plain">:8080 -p </span><span class="token number" style="color:rgb(247, 140, 108)">28015</span><span class="token plain">:28015 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -v /data/rethinkdb:/data </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --name some-rethink rethinkdb</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 管理界面</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token variable" style="color:rgb(191, 199, 213)">$BROWSER</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;http://</span><span class="token string variable" style="color:rgb(191, 199, 213)">$(</span><span class="token string variable" style="color:rgb(191, 199, 213)">docker inspect --format </span><span class="token string variable string" style="color:rgb(195, 232, 141)">&#x27;{{ .NetworkSettings.IPAddress }}&#x27;</span><span class="token string variable" style="color:rgb(191, 199, 213)"> some-rethink</span><span class="token string variable" style="color:rgb(191, 199, 213)">)</span><span class="token string" style="color:rgb(195, 232, 141)">:8080&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 端口转发</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">ssh</span><span class="token plain"> -fNTL localhost:8080:</span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable function" style="color:rgb(130, 170, 255)">ssh</span><span class="token variable" style="color:rgb(191, 199, 213)"> remote </span><span class="token variable string" style="color:rgb(195, 232, 141)">&quot;docker inspect --format &#x27;{{ .NetworkSettings.IPAddress }}&#x27; some-rethink&quot;</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain">:8080 remote</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 在浏览器中打开</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">xdg-open</span><span class="token plain"> http://localhost:8080</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 停止端口转发</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">kill</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable function" style="color:rgb(130, 170, 255)">lsof</span><span class="token variable" style="color:rgb(191, 199, 213)"> -t -i @localhost:8080 -sTCP:listen</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="nexus"></a>Nexus<a class="hash-link" href="#nexus" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># nexus3 支持 docker</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 默认端口为 8081</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run -d --restart always -v /etc/localtime:/etc/localtime:ro </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -e </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">NEXUS_CONTEXT</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">nexus </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -p8004:8004 -p8003:8003 -p8081:8081 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -v /data/nexus:/nexus-data </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --name nexus sonatype/nexus3</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 默认账号密码 admin / admin123</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 测试状态</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> http://localhost:8081/nexus/service/local/status</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="registry"></a>Registry<a class="hash-link" href="#registry" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 确保 /certs 中有 domain.crt 和 domain.key</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 生成密码</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">mkdir</span><span class="token plain"> auth</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run --entrypoint htpasswd registry:2 -Bbn testuser testpassword </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> auth/htpasswd</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 启动</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run -d -p </span><span class="token number" style="color:rgb(247, 140, 108)">5000</span><span class="token plain">:5000 --restart</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">always --name registry </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -v </span><span class="token variable" style="color:rgb(191, 199, 213)">`</span><span class="token variable builtin class-name" style="color:rgb(255, 203, 107)">pwd</span><span class="token variable" style="color:rgb(191, 199, 213)">`</span><span class="token plain">/auth:/auth </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -e </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;REGISTRY_AUTH=htpasswd&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -e </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;REGISTRY_AUTH_HTPASSWD_REALM=Registry Realm&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -e </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">REGISTRY_AUTH_HTPASSWD_PATH</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">/auth/htpasswd </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -v </span><span class="token variable" style="color:rgb(191, 199, 213)">`</span><span class="token variable builtin class-name" style="color:rgb(255, 203, 107)">pwd</span><span class="token variable" style="color:rgb(191, 199, 213)">`</span><span class="token plain">/certs:/certs </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -e </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">REGISTRY_HTTP_TLS_CERTIFICATE</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">/certs/domain.crt </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -e </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">REGISTRY_HTTP_TLS_KEY</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">/certs/domain.key </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  registry:2</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 启动一个简单的不安全的 registry</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run -d -p </span><span class="token number" style="color:rgb(247, 140, 108)">5000</span><span class="token plain">:5000 -v </span><span class="token variable" style="color:rgb(191, 199, 213)">`</span><span class="token variable builtin class-name" style="color:rgb(255, 203, 107)">pwd</span><span class="token variable" style="color:rgb(191, 199, 213)">`</span><span class="token plain">/data:/var/lib/registry --restart</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">always --name registry registry:2</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="odoo"></a>Odoo<a class="hash-link" href="#odoo" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Postgres</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 数据目录 /var/lib/postgresql/data</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run -d -e </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">POSTGRES_USER</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">odoo -e </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">POSTGRES_PASSWORD</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">odoo --name odoo-db postgres</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Odoo</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 配置文件 /etc/odoo/openerp-server.conf</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 扩展路径 /mnt/extra-addons</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># docker run -p 8069:8069 --name odoo --link db:db -t odoo -- 自定义参数</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run -d -p </span><span class="token number" style="color:rgb(247, 140, 108)">8069</span><span class="token plain">:8069 -v /data/odoo/addons:/mnt/extra-addons --name odoo --link odoo-db:db -t odoo</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>默认 openerp-server.conf</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[options]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[options]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">addons_path = /mnt/extra-addons,/usr/lib/python2.7/dist-packages/openerp/addons</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">data_dir = /var/lib/odoo</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">auto_reload = True</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">; admin_passwd = admin</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">; csv_internal_sep = ,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">; db_maxconn = 64</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">; db_name = False</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">; db_template = template1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">; dbfilter = .*</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">; debug_mode = False</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">; email_from = False</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">; limit_memory_hard = 2684354560</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">; limit_memory_soft = 2147483648</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">; limit_request = 8192</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">; limit_time_cpu = 60</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">; limit_time_real = 120</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">; list_db = True</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">; log_db = False</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">; log_handler = [&#x27;:INFO&#x27;]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">; log_level = info</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">; logfile = None</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">; longpolling_port = 8072</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">; max_cron_threads = 2</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">; osv_memory_age_limit = 1.0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">; osv_memory_count_limit = False</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">; smtp_password = False</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">; smtp_port = 25</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">; smtp_server = localhost</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">; smtp_ssl = False</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">; smtp_user = False</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">; workers = 0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">; xmlrpc = True</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">; xmlrpc_interface =</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">; xmlrpc_port = 8069</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">; xmlrpcs = True</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">; xmlrpcs_interface =</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">; xmlrpcs_port = 8071</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="xampp"></a>XAMPP<a class="hash-link" href="#xampp" title="Direct link to heading">#</a></h2><ul><li><a href="https://hub.docker.com/r/tomsik68/xampp/" target="_blank" rel="noopener noreferrer">tomsik68/xampp</a></li><li>mysql<ul><li>/opt/lampp/var/mysql</li></ul></li><li>phpadmin<ul><li>/opt/lampp/phpmyadmin/config.inc.php<ul><li>配置数据库密码等</li></ul></li></ul></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><pre tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// 在网页上输入账号密码</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$cfg[&#x27;Servers&#x27;][$i][&#x27;auth_type&#x27;]    = &#x27;cookie&#x27;;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$cfg[&#x27;Servers&#x27;][$i][&#x27;AllowNoPassword&#x27;]     = false;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run -d --restart always -v /etc/localtime:/etc/localtime:ro </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -p </span><span class="token number" style="color:rgb(247, 140, 108)">22222</span><span class="token plain">:22 -p </span><span class="token number" style="color:rgb(247, 140, 108)">80</span><span class="token plain">:80 -p </span><span class="token number" style="color:rgb(247, 140, 108)">443</span><span class="token plain">:443 -d </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -v/data/xampp/www:/www </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --name xampp  tomsik68/xampp</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 重启 xampp</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">/opt/lampp/lampp restart</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 重启 apache</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">/opt/lampp/bin/httpd -k restart</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="ldap"></a>ldap<a class="hash-link" href="#ldap" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run -d --restart always -v /etc/localtime:/etc/localtime:ro </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -p </span><span class="token number" style="color:rgb(247, 140, 108)">10636</span><span class="token plain">:10636 -p </span><span class="token number" style="color:rgb(247, 140, 108)">10389</span><span class="token plain">:10389 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -v /data/apacheds:/opt/apacheds/instances </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --name apacheds wener/apacheds</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="postgres"></a>Postgres<a class="hash-link" href="#postgres" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run -d --restart always -v /etc/localtime:/etc/localtime:ro </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    -p </span><span class="token number" style="color:rgb(247, 140, 108)">5432</span><span class="token plain">:5432 -e </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">POSTGRES_PASSWORD</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">thisispassword </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    -v /data/pg:/var/lib/postgresql/data </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --name postgres postgres:alpine</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="其他服务"></a>其他服务<a class="hash-link" href="#其他服务" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="cow"></a>cow<a class="hash-link" href="#cow" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> https://github.com/cyfdecyf/cow/releases/download/0.9.8/cow-linux64-0.9.8.gz -Lo cow-linux64-0.9.8.gz</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">gunzip cow-linux64-0.9.8.gz</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">mkdir</span><span class="token plain"> ~/bin</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">mv</span><span class="token plain"> cow-* ~/bin/cow</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">chmod</span><span class="token plain"> +x ~/bin/cow</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">mkdir</span><span class="token plain"> ~/.cow</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">listen = http://127.0.0.1:7777</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">proxy = socks5://127.0.0.1:8888</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> ~/.cow/rc</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">cd</span><span class="token plain"> ~/.cow</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">nohup</span><span class="token plain"> cow </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_2ga9 padding--none margin-left--sm"><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/notes/tags/cookbook">Cookbook</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/wenerme/wener/edit/master/notes/devops/docker/docker-cookbook.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/notes/os/alpine/alpine-version"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« AlpineLinux 版本历史</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/notes/devops/docker/docker-faq"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Docker FAQ »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#常用选项" class="table-of-contents__link">常用选项</a></li><li><a href="#xhyve" class="table-of-contents__link">xhyve</a></li><li><a href="#mysql" class="table-of-contents__link">MySQL</a></li><li><a href="#owncloudnextcloud" class="table-of-contents__link">OwnCloud/Nextcloud</a><ul><li><a href="#反向代理" class="table-of-contents__link">反向代理</a></li></ul></li><li><a href="#jenkins" class="table-of-contents__link">Jenkins</a></li><li><a href="#gitea" class="table-of-contents__link">gitea</a></li><li><a href="#php" class="table-of-contents__link">PHP</a></li><li><a href="#droneio" class="table-of-contents__link">Drone.io</a><ul><li><a href="#更新" class="table-of-contents__link">更新</a></li><li><a href="#安装-go-环境" class="table-of-contents__link">安装 Go 环境</a></li></ul></li><li><a href="#watchtower" class="table-of-contents__link">WatchTower</a></li><li><a href="#redis" class="table-of-contents__link">Redis</a></li><li><a href="#docker-in-docker" class="table-of-contents__link">Docker in Docker</a></li><li><a href="#mongodb" class="table-of-contents__link">MongoDB</a></li><li><a href="#rethinkdb" class="table-of-contents__link">RethinkDB</a></li><li><a href="#nexus" class="table-of-contents__link">Nexus</a></li><li><a href="#registry" class="table-of-contents__link">Registry</a></li><li><a href="#odoo" class="table-of-contents__link">Odoo</a></li><li><a href="#xampp" class="table-of-contents__link">XAMPP</a></li><li><a href="#ldap" class="table-of-contents__link">ldap</a></li><li><a href="#postgres" class="table-of-contents__link">Postgres</a></li><li><a href="#其他服务" class="table-of-contents__link">其他服务</a><ul><li><a href="#cow" class="table-of-contents__link">cow</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">笔记</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/notes/java/java">Java</a></li><li class="footer__item"><a class="footer__link-item" href="/notes/os/alpine/alpine">AlpineLinux</a></li><li class="footer__item"><a class="footer__link-item" href="/notes/devops/kubernetes/kubernetes">Kubernates</a></li><li class="footer__item"><a class="footer__link-item" href="/notes/voip/voip">VoIP</a></li></ul></div><div class="col footer__col"><div class="footer__title">Projects</div><ul class="footer__items"><li class="footer__item">
              <div>
              <a class="footer__link-item" href="https://github.com/wenerme/wener">Wener</a>
              - <a class="footer__link-item" href="https://github.com/wenerme/wener/actions" title="wenerme/wener - ci">
                <img style="vertical-align: middle;opacity: .4;" src="https://github.com/wenerme/wener/workflows/Build/badge.svg">
                </a>
              </div>
              </li><li class="footer__item"><a href="https://apis.wener.me" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Wener&#x27;s Apis<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/story">Blog</a></li><li class="footer__item"><a href="https://github.com/wenerme" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://twitter.com/wenerme" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/img/wener-logo.svg" alt="Wener Site" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="/img/wener-logo.svg" alt="Wener Site" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></div><div class="footer__copyright">Copyright © 1992-2021 Wener - <img alt="cc-by-sa-4.0" src="https://mirrors.creativecommons.org/presskit/buttons/80x15/svg/by-sa.svg"> - Build @2021-12-20 04:32</div></div></div></footer></div>
<script src="/assets/js/runtime~main.448c88fd.js"></script>
<script src="/assets/js/main.d38cdb4b.js"></script>
</body>
</html>