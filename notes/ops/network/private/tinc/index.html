<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.65">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-30404720-1","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-30404720-1"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-30404720-1",{})</script>
<link rel="search" type="application/opensearchdescription+xml" title="Wener Live & Life" href="/opensearch.xml"><title data-react-helmet="true">Tinc | Wener Live &amp; Life</title><meta data-react-helmet="true" name="docsearch:version" content="current,latest"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Tinc | Wener Live &amp; Life"><meta data-react-helmet="true" name="description" content="tinc"><meta data-react-helmet="true" property="og:description" content="tinc"><meta data-react-helmet="true" property="og:url" content="https://wener.me/notes/ops/network/private/tinc"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link data-react-helmet="true" rel="canonical" href="https://wener.me/notes/ops/network/private/tinc"><link rel="stylesheet" href="/styles.98d7e791.css">
<link rel="preload" href="/styles.862535b2.js" as="script">
<link rel="preload" href="/runtime~main.6124d671.js" as="script">
<link rel="preload" href="/main.075d2360.js" as="script">
<link rel="preload" href="/1.a806460f.js" as="script">
<link rel="preload" href="/2.678ad637.js" as="script">
<link rel="preload" href="/3.3ba5c13e.js" as="script">
<link rel="preload" href="/1be78505.c17636e5.js" as="script">
<link rel="preload" href="/620.a1cfc766.js" as="script">
<link rel="preload" href="/935f2afb.fcfb3c7e.js" as="script">
<link rel="preload" href="/17896441.a01940a3.js" as="script">
<link rel="preload" href="/3c07aa29.bcb092fc.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/wener-logo-head.svg" alt="Wener Logo"><strong class="navbar__title">Wener</strong></a><a class="navbar__item navbar__link" href="/notes/java/java">笔记</a><a class="navbar__item navbar__link" href="/story">故事</a><a class="navbar__item navbar__link" href="/notes/howto/network/dns-prevent-spoofing">指南</a><a class="navbar__item navbar__link" href="/notes/tool/network/ip-lookup">工具</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/wenerme/wener" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">🌞</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span><span class="DocSearch-Button-Key">⌘</span><span class="DocSearch-Button-Key">K</span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/wener-logo-head.svg" alt="Wener Logo"><strong class="navbar__title">Wener</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/notes/java/java">笔记</a></li><li class="menu__list-item"><a class="menu__link" href="/story">故事</a></li><li class="menu__list-item"><a href="https://github.com/wenerme/wener" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li><li class="menu__list-item"><a class="menu__link" href="/notes/howto/network/dns-prevent-spoofing">指南</a></li><li class="menu__list-item"><a class="menu__link" href="/notes/tool/network/ip-lookup">工具</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Java</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/java/java">Java</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/java/maven">Maven</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">版本</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/java/version/version">Java版本</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/java/version/java-11">Java 11</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/java/version/java-10">Java 10</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/java/version/java-9">Java 9</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/java/version/java-8">Java 8</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/java/version/java-7">Java 7</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/java/version/java-6">Java 6</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Spring</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/java/spring/spring">Spring</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/java/spring/boot">Spring Boot</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/java/spring/data">Spring Data</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/java/spring/data-rest">Spring Data REST</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/java/spring/security">Spring Security</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/java/spring/security-oauth2">Spring Security OAuth2</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/java/spring/cloud">Spring Cloud</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/java/spring/releases">发布历史</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/java/library/productive">生产力</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/java/library/hazelcast">Hazelcast</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/java/library/hibernate-orm">Hibernate</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/java/library/hibernate-enver">Hibernate Enver</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/java/library/quarkus">Quarkus</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/java/library/guava">Guava</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">前端技术</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">框架</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/web/framework/nextjs">NextJS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/web/framework/nextjs-version">NextJS 版本历史</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/web/framework/nextjs-cookbook">NextJS Cookbook</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/web/framework/electron">Electron</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/web/framework/vue">Vue</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/web/framework/angular">Angular</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/web/framework/riot">Riot</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/web/framework/prisma">Prisma</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">语言</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/languages/languages">语言</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/languages/parsing">语法解析</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/languages/peg">PEG</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/languages/pegjs">PEG.js</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/languages/php">PHP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/languages/zig">Zig</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/languages/lua/lua">Lua</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/languages/lua/lua-version">Lua 版本</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Golang</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/languages/go/go">Golang</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/languages/go/go-template">Go 模板</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/languages/go/go-pkg-net-rpc">Go net/rpc</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/languages/go/go-kit">go-kit</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/languages/go/go-windows">Golang Windows</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">开发运维</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/tracing/tracing">Tracing</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">指标监控</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/metrics/metrics">指标监控</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/metrics/prometheus">Prometheus</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/metrics/promql">PromQL</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/metrics/prometheus-exporter">Prometheus Exporter</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/metrics/statsd_exporter">statsd_exporter</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/metrics/prometheus-k8s">Prometheus K8S</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/metrics/prometheus-storage">Prometheus 存储</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/metrics/grafana">Grafana</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/metrics/thanos">Thanos</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/metrics/cortex">Cortex</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">日志</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/logging/logging">日志</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/logging/syslog">Syslog</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/logging/loki">Loki</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/logging/fluentbit">Fluentbit</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">服务</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/service/microservices">Microservices</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/service/servicemesh">Service Mesh</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/service/linkerd">Linkerd</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/service/kuma">Kuma</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/service/consul">Consul</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/service/consul-conf">Consul 配置</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/service/consul-connect">Consule Connect Mesh</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/service/fabio">fabio</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Web</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/web/nginx">Nginx</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/web/caddy">Caddy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/web/traefik">Traefik</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">平台服务</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/xaas/db-schema">Tenant DB Schema</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/xaas/paas/dokku">Dokku</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">AlpineLinux</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/os/alpine/alpine">Alpine</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/os/alpine/alpine-intro">Alpine 入门</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/os/alpine/alpine-ops">Alpine 运维笔记</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/os/alpine/alpine-pkgs">Alpine 包维护</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/os/alpine/alpine-lbu">Alpine local backup</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/os/alpine/alpine-boot">Alpin Boot</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/os/alpine/alpine-version">版本历史</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/os/alpine/alpine-faq">Alpine FAQ</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Docker</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/docker/docker-intro">Docker</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/docker/docker-network">Docker 网络</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/docker/docker-storage">Docker 存储</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/docker/docker-swarm">Docker Swarm</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/docker/docker-cookbook">Docker 常用服务</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Kubernetes</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/kubernetes/kubernetes">Kubernates</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/kubernetes/k8s-dashboard">Kubernates 面板</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/kubernetes/distro/k3s">K3S</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/kubernetes/distro/k3s-version">K3S Version</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/kubernetes/distro/k3d">K3S in Docker</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/kubernetes/k8s-glossary">K8S 词汇表</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/kubernetes/app/app-cookbook">K8S Apps</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/kubernetes/app/helm">HELM 包管理器</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/kubernetes/app/helm2">HELM2 - 不推荐</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/kubernetes/ops/rke">RKE - 安装器</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/kubernetes/tool/kustomize">kustomize</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/kubernetes/tool/krew">krew</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">网络</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/kubernetes/network/k8s-network">Kubernates 网络</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/kubernetes/network/kong-ingress">Kong Ingress</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/kubernetes/network/nginx-ingress">Nginx Ingress</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/kubernetes/network/traefik-ingress">Traefik Ingress</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/kubernetes/network/metallb">MetalLB</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/kubernetes/network/flannel">Flannel</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">存储</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/kubernetes/storage/k8s-storage">Kubernates 存储</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/kubernetes/storage/longhorn">Longhorn</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/kubernetes/storage/k8s-nfs">NFS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/kubernetes/storage/rook">Rook</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">平台</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/kubernetes/platform/rancher">Rancher UI</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/kubernetes/platform/knative">Knative</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/kubernetes/platform/istio">Istio 服务网格</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">应用</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/kubernetes/app/cert-manager">Cert Manager</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/kubernetes/app/k8s-consul">Consol</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/devops/kubernetes/app/harbor">Harbor</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">操作系统</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Darwin</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/os/darwin/darwin">Darwin</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/os/darwin/macos">macOS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/os/darwin/brew">Brew</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Windows</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/os/windows/windows">Windows</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/os/windows/windows-dc">Windows 域控</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/os/windows/windows-faq">Windows FAQ</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">启动</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/os/linux/boot/syslinux">Syslinux</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/os/linux/boot/uboot">U-Boot</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">虚拟化</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/os/virt/virt">虚拟化</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/os/virt/qemu-doc">QEMU 文档</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/os/virt/qemu-monitor">QEMU监视器</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/os/virt/qemu-version">QEMU Version</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/os/virt/qemu-qmp">QEMU QMP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/os/virt/libvirt">Libvirt</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/os/virt/libvirtd">Libvirt Daemon</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/os/virt/libvirt-faq">Libvirt常见问题</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/os/virt/virsh">Virsh</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/os/virt/haxm">HAXM</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/os/virt/hyperv">HyperV</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/os/virt/vmware">VmWare</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">指南</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">运维</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/howto/ops/alpine-admin-ansible">如何通过 Ansible 来管理 AlpineLinux ？</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">网络</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/howto/network/dns-prevent-spoofing">如何避免 DNS 污染且能正常访问国内域名？</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/howto/network/tinc-get-started">如何部署 TINC 网络？</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/howto/network/tinc-multi-path-failover">如何配置 TINC 实现多路容灾？</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/howto/network/tinc-transparency-proxy">如何基于 TINC 实现透明代理</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">系统管理</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/admin/htop">htop</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/admin/mosh">MOSH</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">基础设施</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/infra/infra">基础设施</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/infra/ansible">Ansible</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/infra/ansible-awx">Ansible AWX</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/infra/ansible-faq">ansible-faq</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/infra/terraform">Terraform</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/infra/terraform-provider">Terraform Provider</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/infra/terraform-cookbook">Terraform 常用脚本</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/infra/packer">Packer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/infra/cloud-init">Cloud Init</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">工具</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">网络</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/tool/network/ip-lookup">常用IP地址段查询</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">数据库</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/db/db">数据库</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">PostgreSQL</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/db/relational/postgresql/postgresql">PostgresSQL</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/db/relational/postgresql/datatype">数据类型</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/db/relational/postgresql/fts">PostgreSQL 全文检索</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/db/relational/postgresql/version">版本历史</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/db/relational/postgresql/faq">常见问题</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/db/relational/postgresql/postgresql-sql-faq">Pg SQL 常见问题</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/db/relational/postgresql/timescale">TimeScale</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/db/relational/postgresql/postgrest-hello">PostREST 入门部署</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/db/relational/postgresql/hasura">Hasura</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">关系型</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/db/relational/mysql">MySQL</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/db/relational/mysql-gtid">MySQL GTID</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/db/relational/sqlite">SQLite</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">文档型</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/db/document/mongodb">MongoDB</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/db/document/rethinkdb">RethinkDB</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/db/document/couchdb">CouchDB</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">键值型</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/db/kv/kv">Key Value</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/db/kv/redis">Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/db/kv/lmdb">LMDB</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/db/kv/leveldb">LevelDB</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">参考</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/reference/words">词汇对比</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">软件</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/reference/software/saas">SaaS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/reference/software/glossary">开发词汇</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">用户增长</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/reference/growth/formula">增长相关公式</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/reference/growth/glossary">增长相关词汇</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">烹饪</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/reference/cook/glossary">烹饪词汇</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">网络</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">应用</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/network/application/dns">DNS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/network/application/http">HTTP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/network/application/ssl">SSL</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">链路</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/network/link/wireless">无线网络</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/network/link/infiniband">InfiniBand</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">私有</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/ops/network/private/intro">私有网络</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/notes/ops/network/private/tinc">Tinc</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/ops/network/private/tinc-conf">Tinc 配置</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/ops/network/private/privoxy">Privoxy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/ops/network/private/privoxy-action">Privoxy Action</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/ops/network/private/ipsec">IPSec</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/ops/network/private/wireguard">WireGuard</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/ops/network/private/vpn-faq">私有虚拟网络常见问题</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">工具</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/network/tool/intro">网络相关工具集</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/network/tool/bonding">Bonding</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/network/tool/dnsmasq">dnsmasq</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/network/tool/ifconfig">ifconfig</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/network/tool/mitmproxy">MitmProxy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/network/tool/nmap">NMap</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/network/tool/powerdns">PowerDNS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/network/tool/wireshark">Wireshark</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/ops/network/standard/ieee-802">IEEE 802</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">存储</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/storage/intro">Storage</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">块存储</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/storage/block/raid">RAID</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/storage/block/mdadm">mdadm</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/storage/block/lvm">LVM</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">文件存储</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/storage/fs/intro">Filesystem</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/storage/fs/zfs">ZFS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/storage/fs/btrfs">Btrfs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/storage/fs/fuse">FUSE</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/storage/fs/nfs">NFS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/storage/fs/smb">Samba</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/storage/fs/ntfs">NTFS</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">网络存储</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/storage/network/share">Share</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/storage/network/sshfs">SSHFS</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">开发服务</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Auth</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/auth/auth">Auth 概念</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/auth/auth-faq">认证授权常见问题</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/auth/keycloak">Keycloak</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/auth/keycloak-dev">Keycloak 开发</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/auth/keycloak-faq">Keycloak 常见问题</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/auth/louketo">Louketo Proxy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/auth/oauth2-proxy">oauth2-proxy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/auth/ldap">LADP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/auth/ldap-schema">LDAP Schema</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/auth/ldif">LDIF</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/auth/apacheds">Apache Directory</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/auth/apacheds-ops">ApacheDS 运维</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/auth/apacheds-kerberos">ApacheDS Kerberos</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/auth/kerberos">Kerberos</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/auth/kerberos-faq">Kerberos FAQ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/auth/oauth">OAuth</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/auth/jwt">JWT</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/auth/auth-protocol">协议</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/auth/auth-glossary">词汇</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">内容管理</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/cms/cms">CMS 概览</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/cms/docusaurus">Docusaurus</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Office</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/office/office">办公套件</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/office/collabora">Collabora Online</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/office/onlyoffice">ONLYOFFICE</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">客户关系管理</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/crm/crm-insight">理解 CRM</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">文件</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/file/nextcloud">NextCloud</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/file/nextcloud-config">Nextcloud 配置</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/file/nextcloud-faq">Nextcloud FAQ</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">存储</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/storage/seaweedfs">seaweedfs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/storage/minio">Minio</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/storage/minio-operator">MinIO Kubernetes Operator</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/storage/ceph">Ceph</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/storage/ceph-glossary">Ceph 术语</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/storage/ceph-k8s">Ceph Kubernetes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/storage/ceph-ubuntu-16-install">Ubuntu 16.04 安装 Ceph</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/storage/distributed-storage">分布式存储</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">仓库</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/service/repository/nexus">Nexus</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">运维</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">服务</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/service/remote-desktop">远程桌面</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/service/matomo">Matomo</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Gitlab</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/service/gitlab-config">GitLab配置</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/service/gitlab-cicd">GitaLab持续集成持续交付</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/ops/service/gitlab-k8s">GitLab K8S 集成</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">硬件</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">硬件</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/hardware/battery/battery">电池</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/hardware/microcontroller/dev/arduino">Arduino</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">算法</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">计算机视觉</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/algorithm/cv/imagemagick">ImageMagick</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">VoIP</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/voip/voip">VoIP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/voip/hardware/intro">硬件设备</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/voip/sip/provider">SIP 提供商</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/voip/glossary">词汇表</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Asterisk</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/voip/asterisk/asterisk">Asterisk</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/voip/asterisk/version">Asterisk 版本</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/voip/asterisk/asterisk-moduls">Asterisk Modules</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/voip/asterisk/dev">开发</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/voip/asterisk/conf">Asterisk 配置</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/voip/asterisk/dialplan">拨号计划</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/voip/asterisk/codec">Asterisk 编码</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/voip/asterisk/chan_dahdi">DAHDi Channel</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/voip/asterisk/chan_dongle">chan_dongle</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/voip/asterisk/reference">参考</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/voip/asterisk/glossory">Asterisk 词汇</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/voip/asterisk/faq">常见问题</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/voip/asterisk/the-definitive-guide-4th">Asterisk 权威指南,第四版</a></li></ul></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">Tinc</h1></header><div class="markdown"><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="tinc"></a>tinc<a aria-hidden="true" tabindex="-1" class="hash-link" href="#tinc" title="Direct link to heading">#</a></h1><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="tips"></a>Tips<a aria-hidden="true" tabindex="-1" class="hash-link" href="#tips" title="Direct link to heading">#</a></h2><ul><li>是什么？<ul><li>2层、3层 NAT 穿透直连组网的 Mesh VPN</li></ul></li><li>什么时候可用<ul><li>基础设施组网 - 管理<ul><li>Tinc 连接性好</li></ul></li><li>业务应用集群<ul><li>Layer 2 方便应用</li></ul></li><li>需要 2 层协议<ul><li>mdns, upnp</li></ul></li></ul></li><li>什么时候不用<ul><li>数据中心 - 考虑使用 wireguard<ul><li>数据量过大，Tinc 不适合</li></ul></li><li>移动设备接入<ul><li>目前没有移动客户端，适用于服务端场景</li></ul></li></ul></li><li>Tiny VPN<ul><li>支持路由模式<ul><li>IP 协议交换</li><li>不支持广播</li></ul></li><li>支持交换模式<ul><li>Ethernet 协议</li><li>支持广播</li></ul></li><li>协议加密</li><li>NAT 穿透</li><li>支持 UDP</li><li>支持网段</li><li>支持转发</li><li>运行在用户空间</li><li><a href="https://www.tinc-vpn.org/platforms/" target="_blank" rel="noopener noreferrer">多台支持</a><ul><li>iOS/Android</li><li>macOS/utun</li><li>Windows/Cygwin/tap64/i386/x86_64</li><li>Windows/MinGW/tap64/i386/x86_64</li><li>Linux</li><li>DragonFlyBSD</li><li>FreeBSD</li><li>OpenBSD</li><li>NetBSD</li><li>Solaris/sparc32</li></ul></li><li>非常小<ul><li>二进制 150k, 内存占用 2m 左右</li></ul></li></ul></li><li>类似<ul><li><a href="https://github.com/meshbird/meshbird" target="_blank" rel="noopener noreferrer">meshbird/meshbird</a></li><li>FreeS/WAN</li><li>IPSeC</li><li>Wireguard</li></ul></li><li>Arch <a href="https://wiki.archlinux.org/index.php/Tinc" target="_blank" rel="noopener noreferrer">Tinc</a></li><li>1.1 后的协议和之前版本的有兼容问题<ul><li>想要兼容, 需要在所有 pre 版本的配置里添加<ul><li><code>ExperimentalProtocol = no</code></li></ul></li><li>目前 ubuntu 想用新版只能自己编译<ul><li><a href="https://nwgat.ninja/quick-easy-tinc-1-1-2/" target="_blank" rel="noopener noreferrer">https://nwgat.ninja/quick-easy-tinc-1-1-2/</a></li></ul></li></ul></li><li><a href="https://www.tinc-vpn.org/documentation-1.1/Simple-Peer_002dto_002dPeer-Security.html" target="_blank" rel="noopener noreferrer">SPTPS</a><ul><li>Simple Peer-to-Peer Security</li><li>based on TLS 1.2, but has been simplified: there is no support for exchanging public keys, and there is no cipher suite negotiation. Instead, SPTPS always uses a very strong cipher suite: peers authenticate each other using 521 bits ECC keys, Diffie-Hellman using ephemeral 521 bits ECC keys is used to provide perfect forward secrecy (PFS), AES-256-CTR is used for encryption, and HMAC-SHA-256 for message authentication.</li></ul></li><li>常用端口 655/tcp 655/udp</li><li>macOS<ul><li><a href="https://www.tinc-vpn.org/pipermail/tinc/2016-January/004336.html" target="_blank" rel="noopener noreferrer">https://www.tinc-vpn.org/pipermail/tinc/2016-January/004336.html</a></li><li><a href="http://tuntaposx.sourceforge.net/" target="_blank" rel="noopener noreferrer">http://tuntaposx.sourceforge.net/</a></li></ul></li><li><a href="https://www.tinc-vpn.org/documentation/tinc.conf.5" target="_blank" rel="noopener noreferrer">https://www.tinc-vpn.org/documentation/tinc.conf.5</a></li><li><a href="https://www.tinc-vpn.org/documentation-1.1/How-connections-work.html" target="_blank" rel="noopener noreferrer">https://www.tinc-vpn.org/documentation-1.1/How-connections-work.html</a></li><li>如果有 NAT 问题, 可以在另外一台上不直接连接外部节点, 先连接内部, 连接上后, 网络都能互通</li><li>工作模式 - Mode<ul><li>router<ul><li>默认</li><li>基于子网信息构建路由表</li><li>支持基于 ip 的单播通讯</li><li>tun 设备<ul><li>mac tun 只支持点对点 - 例如 ifconfig tun0 inet 10.2.1.1 10.2.1.2 up</li><li>其他需要手动添加路由 route add -net 10.2 -interface tun0</li></ul></li></ul></li><li>switch<ul><li>基于 mac 信息构建路由表</li><li>支持基于 ethernet的单播,广播通讯</li><li>tap 设备</li></ul></li><li>hub<ul><li>不维护路由表, 只做转发</li></ul></li></ul></li><li>支持的设备类型 - DeviceType<ul><li>dummy<ul><li>测试</li><li>该节点只负责为其他节点转发包</li></ul></li><li>raw_socket<ul><li>绑定到现有 interface 的 socket.</li><li>所有包从该 interface 读. 从本地节点收到的包会写到 raw socket.</li><li>在 linux 下, os 不会处理目的为本地节点的包</li></ul></li><li>multicast<ul><li>多播 udp socket, 绑定到地址和端口, 空格分割, ttl 参数可选</li><li>包从广播 socket 读写</li><li>可用于连接 UML, QEMU, KVM, 所有实例监听相同的广播地址.</li><li>不要连接多个 tinc 到相同的多播地址, 对导致循环路由</li><li>错误的配置可能会导致加密的 vpn 包发到外网</li></ul></li><li>fd<ul><li>使用文件描述符</li></ul></li><li>uml<ul><li>默认未编译</li><li>unix socket</li><li>如果未指定 Device, 则为 /var/run/NETNAME.umlsocket</li><li>会等待太湖连接该 socket</li></ul></li><li>vde<ul><li>默认未编译</li><li>使用 libvdeplug 连接 vde 交换机, 使用 unix socket 或 /var/run/vde.ctl</li></ul></li><li>tun</li><li>tunnohead<ul><li>没有地址头</li></ul></li><li>tunifhead<ul><li>有地址头</li><li>支持 ipv4 和 ipv6</li></ul></li><li>utun<ul><li>macOS</li><li>支持 ipv4 和 ipv6</li></ul></li><li>tap<ul><li>包带 Ethernet 头</li></ul></li></ul></li><li>参考<ul><li><a href="https://serverfault.com/q/640020/190601" target="_blank" rel="noopener noreferrer">How Do I Reach Local Subnet Behind Tinc VPN</a></li><li><a href="https://www.jianshu.com/p/e030dabafd61" target="_blank" rel="noopener noreferrer">Tinc 配置笔记</a></li><li><a href="https://groverchou.com/blog/2017/07/23/%E4%BD%BF%E7%94%A8-Tinc-%E5%BB%BA%E7%AB%8B-VPN-%E8%BF%9E%E6%8E%A5%E5%B9%B6%E9%85%8D%E7%BD%AE-NAT-%E7%BD%91%E5%85%B3/" target="_blank" rel="noopener noreferrer">使用 Tinc 建立 VPN 连接并配置 NAT 网关</a></li><li><a href="https://serverfault.com/q/418354/190601" target="_blank" rel="noopener noreferrer">How to set up OpenVPN to let the VPN clients to access all the servers inside the server LAN?</a></li><li><a href="https://unix.stackexchange.com/q/91123/47774" target="_blank" rel="noopener noreferrer">How to use two gateways with the same IP address?</a></li><li><a href="https://blog.swineson.me/use-routeros-qemu-as-tinc-tap-vpn-dhcp-server/" target="_blank" rel="noopener noreferrer">用RouterOS/QEMU在Tinc TAP VPN内部实现DHCP</a></li><li><a href="https://www.tinc-vpn.org/faq/" target="_blank" rel="noopener noreferrer">https://www.tinc-vpn.org/faq/</a></li><li><a href="https://www.tinc-vpn.org/pipermail/tinc-devel/2015-September/000790.html" target="_blank" rel="noopener noreferrer">Large scale tinc tests</a></li><li><a href="https://www.tinc-vpn.org/packages/" target="_blank" rel="noopener noreferrer">https://www.tinc-vpn.org/packages/</a></li><li><a href="https://github.com/gsliepen/tinc" target="_blank" rel="noopener noreferrer">https://github.com/gsliepen/tinc</a></li><li><a href="https://git.alpinelinux.org/cgit/aports/tree/community/tinc-pre/APKBUILD" target="_blank" rel="noopener noreferrer">https://git.alpinelinux.org/cgit/aports/tree/community/tinc-pre/APKBUILD</a></li><li><a href="https://github.com/freifunk/icvpn" target="_blank" rel="noopener noreferrer">freifunk/icvpn</a> - InterCity-VPN</li></ul></li></ul><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 推荐使用 tinc-pre 1.1 版本</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 配置更方便使用更简单</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> tinc-pre</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">modprobe tun</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">echo</span><span class="token plain"> tun </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;&gt;</span><span class="token plain"> /etc/modules</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># echo tun &gt;&gt; /etc/modules-load.d/tinc.conf</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 基础配置</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">tinc init first</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">tinc </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">set</span><span class="token plain"> Interface tun0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">tinc </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">set</span><span class="token plain"> AddressFamily ipv4</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 第一个节点可考虑不设置链接节点</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">tinc </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">set</span><span class="token plain"> ConnectTo other</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 变量设置可以指定 host</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">tinc </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">set</span><span class="token plain"> sec.Subnet</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">10.0</span><span class="token plain">.0.2/32</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 在配置单个网络时, 设置个别名会比较方便, 使用不同目录或 pid 也可以这样操作</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">alias</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">tinc</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;tinc -n main&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 操作指定网络名时, 可使用环境变量</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">NETNAME</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">main</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">tinc dump nodes</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 如果执行的命令比较多, 也可以加入交互模式操作</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">tinc -c </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">ADDRESS</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">10.0</span><span class="token plain">.0.1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">NETMASK</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">255.255</span><span class="token plain">.255.0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">cat</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> tinc-up </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;&lt;</span><span class="token string" style="color:rgb(195, 232, 141)">SH</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">#!/bin/sh</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">ifconfig \</span><span class="token string variable" style="color:rgb(191, 199, 213)">$INTERFACE</span><span class="token string" style="color:rgb(195, 232, 141)"> </span><span class="token string variable" style="color:rgb(191, 199, 213)">$ADDRESS</span><span class="token string" style="color:rgb(195, 232, 141)"> netmask </span><span class="token string variable" style="color:rgb(191, 199, 213)">$NETMASK</span><span class="token string" style="color:rgb(195, 232, 141)"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">SH</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">cat</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> tinc-down </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;&lt;</span><span class="token string" style="color:rgb(195, 232, 141)">SH</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">#!/bin/sh</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">ifconfig \</span><span class="token string variable" style="color:rgb(191, 199, 213)">$INTERFACE</span><span class="token string" style="color:rgb(195, 232, 141)"> down</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">SH</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">chmod</span><span class="token plain"> +x tinc-*</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">tincd -Dd4</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 导入别处 export 的配置</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">tinc </span><span class="token function" style="color:rgb(130, 170, 255)">import</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 生成邀请码</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 最简便的配置方式</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">tinc invite 节点名</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 加入</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 会在远程添加主机信息</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 会使用相同的 netname</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># tinc-up 和 tinc-down 需要自己配置</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">tinc </span><span class="token function" style="color:rgb(130, 170, 255)">join</span><span class="token plain"> 邀请码</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">tinc -n main invite thd</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 配置要启动的网络</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># NETWORK: main</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 会使用 /etc/tinc/main 配置</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">nano</span><span class="token plain"> /etc/conf.d/tinc.networks</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">rc-service tincd start</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 自启动</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">rc-update </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> tincd</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 启动后可以查看日志, 1-5</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">tinc -n main log </span><span class="token number" style="color:rgb(247, 140, 108)">5</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Docker</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># ======</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 先在 docker 中进行配置和测试</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">NETNAME</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">name</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker run --rm -it -e </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">NETNAME</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$NETNAME</span><span class="token plain"> --cap-add</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">NET_ADMIN --device</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">/dev/net/tun -v </span><span class="token environment constant" style="color:rgb(130, 170, 255)">$PWD</span><span class="token plain">/tinc:/etc/tinc wener/tinc </span><span class="token function" style="color:rgb(130, 170, 255)">sh</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 导入配置</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker run --rm -it -e </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">NETNAME</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$NETNAME</span><span class="token plain"> -v </span><span class="token environment constant" style="color:rgb(130, 170, 255)">$PWD</span><span class="token plain">/tinc:/etc/tinc wener/tinc tinc </span><span class="token function" style="color:rgb(130, 170, 255)">import</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 启动</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker run -d --restart always </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --net </span><span class="token function" style="color:rgb(130, 170, 255)">host</span><span class="token plain"> --cap-add</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">NET_ADMIN --device</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">/dev/net/tun </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -e </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">NETNAME</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$NETNAME</span><span class="token plain"> -v </span><span class="token environment constant" style="color:rgb(130, 170, 255)">$PWD</span><span class="token plain">/tinc:/etc/tinc </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --name tinc-</span><span class="token variable" style="color:rgb(191, 199, 213)">$NETNAME</span><span class="token plain"> wener/tinc</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div></div></div><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># macOS</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># http://tuntaposx.sourceforge.net/</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 新版没有了 devel 参数</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># https://github.com/Homebrew/homebrew-core/tree/master/Formula/tinc.rb</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> https://raw.githubusercontent.com/wenerme/homebrew-core/tinc-pre/Formula/tinc-pre.rb </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> /usr/local/Homebrew/Library/Taps/homebrew/homebrew-core/Formula/tinc-pre.rb</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">brew </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> tinc-pre</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># utun</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># ===============</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 在 mac 下, tinc 支持 utun, 可能需要 root 权限</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">tinc </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">set</span><span class="token plain"> DeviceType utun</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 确保路径存在, 否则 pid 会存在当前目录</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">mkdir</span><span class="token plain"> -p /usr/local/Cellar/tinc/1.1pre17/var/run/</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># tun/tap</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># ===============</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># tuntap 10.13 会安装失败</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">brew cask </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> tuntap</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># /Library/Extensions/tap.kext</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># /Library/Extensions/tun.kext</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># /Library/StartupItems/tap</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># /Library/StartupItems/tun</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 手动加载</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> kextload /Library/Extensions/tun.kext</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 失败日志</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">dmesg</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># tun: could not register PF_INET protocol family: 17</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Kext net.sf.tuntaposx.tun start failed (result 0x5).</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Kext net.sf.tuntaposx.tun failed to load (0xdc008017).</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Failed to load kext net.sf.tuntaposx.tun (error 0xdc008017).</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 查看现有的</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">kextstat </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">grep</span><span class="token plain"> tun</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 写在</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> kextunload -b 名字</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># https://tunnelblick.net</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 包含了新的 kext</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 查看具体出错信息</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> kextutil /Volumes/Tunnelblick/Tunnelblick.app/Contents/Resources/tun-signed.kext</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> kextutil /Library/Extensions/tun.kext</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Memory allocation failure.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Untrusted kexts are not allowed</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div></div></div><p><strong>tinc-up</strong></p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token shebang important">#!/bin/sh</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">brctl addif br0 </span><span class="token variable" style="color:rgb(191, 199, 213)">$INTERFACE</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">ifconfig</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$INTERFACE</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0.0</span><span class="token plain">.0.0 promisc up</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 该节点作为路由</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># iptables -I FORWARD -i $INTERFACE -j ACCEPT</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># iptables -t nat -A POSTROUTING -d 10.88.0.0/16 -o $INTERFACE -j MASQUERADE</span></div></div></div></div></div><p><strong>tinc-fw</strong></p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token shebang important">#!/bin/sh</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">iptables -I INPUT -p udp --dport </span><span class="token number" style="color:rgb(247, 140, 108)">20656</span><span class="token plain"> -j ACCEPT</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">iptables -I INPUT -p tcp --dport </span><span class="token number" style="color:rgb(247, 140, 108)">20656</span><span class="token plain"> -j ACCEPT</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">iptables -I INPUT -i tinc -j ACCEPT</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">iptables -I FORWARD -i tinc -j ACCEPT</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="完整的网络配置"></a>完整的网络配置<a aria-hidden="true" tabindex="-1" class="hash-link" href="#完整的网络配置" title="Direct link to heading">#</a></h2><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 主节点</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">NETNAME</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">mynet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">NODE</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">mynet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">tinc init </span><span class="token variable" style="color:rgb(191, 199, 213)">$NETNAME</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">cd</span><span class="token plain"> /etc/tinc/</span><span class="token variable" style="color:rgb(191, 199, 213)">$NETNAME</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 配置启动脚本</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">ADDRESS</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">10.66</span><span class="token plain">.1.1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">NETMASK</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">255.255</span><span class="token plain">.0.0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">cat</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> tinc-up </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;&lt;</span><span class="token string" style="color:rgb(195, 232, 141)">SH</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">#!/bin/sh</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">ifconfig \</span><span class="token string variable" style="color:rgb(191, 199, 213)">$INTERFACE</span><span class="token string" style="color:rgb(195, 232, 141)"> </span><span class="token string variable" style="color:rgb(191, 199, 213)">$ADDRESS</span><span class="token string" style="color:rgb(195, 232, 141)"> netmask </span><span class="token string variable" style="color:rgb(191, 199, 213)">$NETMASK</span><span class="token string" style="color:rgb(195, 232, 141)"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">SH</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">cat</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> tinc-down </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;&lt;</span><span class="token string" style="color:rgb(195, 232, 141)">SH</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">#!/bin/sh</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">ifconfig \</span><span class="token string variable" style="color:rgb(191, 199, 213)">$INTERFACE</span><span class="token string" style="color:rgb(195, 232, 141)"> down</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">SH</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">chmod</span><span class="token plain"> +x tinc-*</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 配置主节点地址</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 用于其它节点请求的地址, 如果有外网地址</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">tinc </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">set</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$NODE</span><span class="token plain">.Address</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable function" style="color:rgb(130, 170, 255)">curl</span><span class="token variable" style="color:rgb(191, 199, 213)"> ipv4.icanhazip.com</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 如果不想使用默认端口</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">tinc </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">set</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$NODE</span><span class="token plain">.Port</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">12345</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 私有子网</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">tinc </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">set</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$NODE</span><span class="token plain">.Subnet</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$ADDRESS</span><span class="token plain">/32</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 启动</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">tinc start</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 邀请其它节点</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">tinc invite home</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># home 节点</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># =============</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">NETNAME</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">mynet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">NODE</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">home</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">tinc </span><span class="token function" style="color:rgb(130, 170, 255)">join</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">INVITE</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">cd</span><span class="token plain"> /etc/tinc/</span><span class="token variable" style="color:rgb(191, 199, 213)">$NETNAME</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 配置启动脚本</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">ADDRESS</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">10.66</span><span class="token plain">.1.2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">NETMASK</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">255.255</span><span class="token plain">.0.0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">cat</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> tinc-up </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;&lt;</span><span class="token string" style="color:rgb(195, 232, 141)">SH</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">#!/bin/sh</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">ifconfig \</span><span class="token string variable" style="color:rgb(191, 199, 213)">$INTERFACE</span><span class="token string" style="color:rgb(195, 232, 141)"> </span><span class="token string variable" style="color:rgb(191, 199, 213)">$ADDRESS</span><span class="token string" style="color:rgb(195, 232, 141)"> netmask </span><span class="token string variable" style="color:rgb(191, 199, 213)">$NETMASK</span><span class="token string" style="color:rgb(195, 232, 141)"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">SH</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">cat</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> tinc-down </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;&lt;</span><span class="token string" style="color:rgb(195, 232, 141)">SH</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">#!/bin/sh</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">ifconfig \</span><span class="token string variable" style="color:rgb(191, 199, 213)">$INTERFACE</span><span class="token string" style="color:rgb(195, 232, 141)"> down</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">SH</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">chmod</span><span class="token plain"> +x tinc-*</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 如果不想使用默认端口</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">tinc </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">set</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$NODE</span><span class="token plain">.Port</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">45678</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 私有子网</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">tinc </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">set</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$NODE</span><span class="token plain">.Subnet</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$ADDRESS</span><span class="token plain">/32</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># svr 节点</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># =============</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 如果不能安装 tinc-1.1+ 则可以使用 docker</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">NETNAME</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">mynet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">NODE</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">home</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker run --rm -it -e </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">NODE</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$NODE</span><span class="token plain"> -e </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">NETNAME</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$NETNAME</span><span class="token plain"> --cap-add</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">NET_ADMIN --device</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">/dev/net/tun -v /data/tinc/</span><span class="token variable" style="color:rgb(191, 199, 213)">$NETNAME</span><span class="token plain">/</span><span class="token variable" style="color:rgb(191, 199, 213)">$NODE</span><span class="token plain">:/etc/tinc wener/tinc </span><span class="token function" style="color:rgb(130, 170, 255)">sh</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">tinc </span><span class="token function" style="color:rgb(130, 170, 255)">join</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">INVITE</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">cd</span><span class="token plain"> /etc/tinc/</span><span class="token variable" style="color:rgb(191, 199, 213)">$NETNAME</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 配置启动脚本</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">ADDRESS</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">10.66</span><span class="token plain">.1.3</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">NETMASK</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">255.255</span><span class="token plain">.0.0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">cat</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> tinc-up </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;&lt;</span><span class="token string" style="color:rgb(195, 232, 141)">SH</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">#!/bin/sh</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">ifconfig \</span><span class="token string variable" style="color:rgb(191, 199, 213)">$INTERFACE</span><span class="token string" style="color:rgb(195, 232, 141)"> </span><span class="token string variable" style="color:rgb(191, 199, 213)">$ADDRESS</span><span class="token string" style="color:rgb(195, 232, 141)"> netmask </span><span class="token string variable" style="color:rgb(191, 199, 213)">$NETMASK</span><span class="token string" style="color:rgb(195, 232, 141)"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">SH</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">cat</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> tinc-down </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;&lt;</span><span class="token string" style="color:rgb(195, 232, 141)">SH</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">#!/bin/sh</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">ifconfig \</span><span class="token string variable" style="color:rgb(191, 199, 213)">$INTERFACE</span><span class="token string" style="color:rgb(195, 232, 141)"> down</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">SH</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">chmod</span><span class="token plain"> +x tinc-*</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 如果不想使用默认端口</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">tinc </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">set</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$NODE</span><span class="token plain">.Port</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">45678</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 私有子网</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">tinc </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">set</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$NODE</span><span class="token plain">.Subnet</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$ADDRESS</span><span class="token plain">/32</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 退出配置容器</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">exit</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 运行服务</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker run -d --restart always -v /etc/localtime:/etc/localtime:ro </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --cap-add</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">NET_ADMIN --device</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">/dev/net/tun </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -e </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">NETNAME</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$NETNAME</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -v /data/tinc/</span><span class="token variable" style="color:rgb(191, 199, 213)">$NETNAME</span><span class="token plain">/</span><span class="token variable" style="color:rgb(191, 199, 213)">$NODE</span><span class="token plain">:/etc/tinc </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --name tinc-</span><span class="token variable" style="color:rgb(191, 199, 213)">$NETNAME</span><span class="token plain">-</span><span class="token variable" style="color:rgb(191, 199, 213)">$NODE</span><span class="token plain"> wener/tinc</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="新手教程"></a>新手教程<a aria-hidden="true" tabindex="-1" class="hash-link" href="#新手教程" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="基于容器组件网络"></a>基于容器组件网络<a aria-hidden="true" tabindex="-1" class="hash-link" href="#基于容器组件网络" title="Direct link to heading">#</a></h3><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="faq"></a>FAQ<a aria-hidden="true" tabindex="-1" class="hash-link" href="#faq" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="traps-tincd3995-general-protection-fault-ip7f6ad09944eb-sp7ffda3da5ea8-error0-in-ld-musl-x86_64so17f6ad098b00046000"></a>traps: tincd[3995] general protection fault ip:7f6ad09944eb sp:7ffda3da5ea8 error:0 in ld-musl-x86_64.so.1[7f6ad098b000+46000]<a aria-hidden="true" tabindex="-1" class="hash-link" href="#traps-tincd3995-general-protection-fault-ip7f6ad09944eb-sp7ffda3da5ea8-error0-in-ld-musl-x86_64so17f6ad098b00046000" title="Direct link to heading">#</a></h3><p>TBD</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="failed-to-verify-sig-record-from-infra"></a>Failed to verify SIG record from infra<a aria-hidden="true" tabindex="-1" class="hash-link" href="#failed-to-verify-sig-record-from-infra" title="Direct link to heading">#</a></h3><p>签名验证失败，尝试重新 invite</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="got-req_key-from-node-while-we-already-started-a-sptps-session"></a>Got REQ_KEY from node while we already started a SPTPS session!<a aria-hidden="true" tabindex="-1" class="hash-link" href="#got-req_key-from-node-while-we-already-started-a-sptps-session" title="Direct link to heading">#</a></h3><ul><li><a href="https://github.com/gsliepen/tinc/issues/203" target="_blank" rel="noopener noreferrer">#203</a></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="相同-key-或相同-名字？"></a>相同 key 或相同 名字？<a aria-hidden="true" tabindex="-1" class="hash-link" href="#相同-key-或相同-名字？" title="Direct link to heading">#</a></h3><ul><li>tinc 允许相同 key - 但不建议，存在安全隐患</li><li>tinc 不允许相同 name<ul><li>name 在节点里是唯一标识的</li></ul></li><li><a href="https://www.tinc-vpn.org/pipermail/tinc/2015-May/004137.html" target="_blank" rel="noopener noreferrer">https://www.tinc-vpn.org/pipermail/tinc/2015-May/004137.html</a></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="peer--tries-to-roll-back-protocol-version-to-170"></a>Peer  tries to roll back protocol version to 17.0<a aria-hidden="true" tabindex="-1" class="hash-link" href="#peer--tries-to-roll-back-protocol-version-to-170" title="Direct link to heading">#</a></h3><p>使用 1.0 协议</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">ExperimentalProtocol = no</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="could-not-open-devnettun-no-such-file-or-directory"></a>Could not open /dev/net/tun: No such file or directory<a aria-hidden="true" tabindex="-1" class="hash-link" href="#could-not-open-devnettun-no-such-file-or-directory" title="Direct link to heading">#</a></h3><p>加载 tun 内核模块</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">modprobe tun</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">echo</span><span class="token plain"> tun </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;&gt;</span><span class="token plain"> /etc/modules</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="route"></a>route<a aria-hidden="true" tabindex="-1" class="hash-link" href="#route" title="Direct link to heading">#</a></h3><ul><li><a href="https://wiki.archlinux.org/index.php/Network_bridge" target="_blank" rel="noopener noreferrer">https://wiki.archlinux.org/index.php/Network_bridge</a></li></ul><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sysctl net.ipv4.ip_forward</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">sysctl -w net.ipv4.ip_forward</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 1. 允许包转发, 会将 eth0 子网的转发到 mynet, 需要在网关节点添加 eth0 的子网才能做到互通</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># iptables -L --line-number -nv</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">iptables -I FORWARD -i mynet -j ACCEPT</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">iptables -I FORWARD -i eth0 -j ACCEPT</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 2. NAT 使得 eth0 子网能访问私网</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 如果做了桥接, 这里需要换成桥接网卡</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># iptables -t nat -L --line-number -nv</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">iptables -t nat -A POSTROUTING -s </span><span class="token number" style="color:rgb(247, 140, 108)">192.168</span><span class="token plain">.1.0/24 -o mynet -j MASQUERADE</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 如果有多个私网, 也可以考虑限制目标网段</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># iptables -t nat -A POSTROUTING -s 192.168.1.0/24 -d 10.10.0.0/16 -o mynet -j MASQUERADE</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 创建用于 docker 使用的网络</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 假设当前节点的子网是 10.10.1.0/24 当前节点的地址是 10.10.1.0</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker network create </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --driver</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">bridge </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --subnet</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">10.10</span><span class="token plain">.0.0/16 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --ip-range</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">10.10</span><span class="token plain">.1.0/24 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --gateway</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">10.10</span><span class="token plain">.1.0 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --aux-address</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;my-host=10.10.1.1&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -o com.docker.network.bridge.name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">brmynet </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  brmynet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 允许桥接网卡转发</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">iptables -I FORWARD -i brmynet -j ACCEPT</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 将 tinc 作为该桥接的 slave</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">ip</span><span class="token plain"> li </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">set</span><span class="token plain"> master brmynet dev mynet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 或者在 tinc-up 中设置</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">cat</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> tinc-up </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;&lt;</span><span class="token string" style="color:rgb(195, 232, 141)">SH</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">#!/bin/sh</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">ip li set master br</span><span class="token string variable" style="color:rgb(191, 199, 213)">$INTERFACE</span><span class="token string" style="color:rgb(195, 232, 141)"> dev </span><span class="token string variable" style="color:rgb(191, 199, 213)">$INTERFACE</span><span class="token string" style="color:rgb(195, 232, 141)"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">ip li set dev </span><span class="token string variable" style="color:rgb(191, 199, 213)">$INTERFACE</span><span class="token string" style="color:rgb(195, 232, 141)"> up</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">SH</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 调试</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">tcpdump -nni mynet icmp</span></div></div></div></div></div><p>How can I set my linux box as a router to forward ip packets?
<a href="https://askubuntu.com/q/227369/267103" target="_blank" rel="noopener noreferrer">https://askubuntu.com/q/227369/267103</a></p><p>Linux IP Masquerade HOWTO
<a href="http://tldp.org/HOWTO/IP-Masquerade-HOWTO/" target="_blank" rel="noopener noreferrer">http://tldp.org/HOWTO/IP-Masquerade-HOWTO/</a></p><p>iptables -I FORWARD -i brwenet -j ACCEPT</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/wenerme/wener/edit/master/notes/ops/network/private/tinc.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/notes/ops/network/private/intro"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« 私有网络</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/notes/ops/network/private/tinc-conf"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Tinc 配置 »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#tips" class="table-of-contents__link">Tips</a></li><li><a href="#完整的网络配置" class="table-of-contents__link">完整的网络配置</a></li><li><a href="#新手教程" class="table-of-contents__link">新手教程</a><ul><li><a href="#基于容器组件网络" class="table-of-contents__link">基于容器组件网络</a></li></ul></li><li><a href="#faq" class="table-of-contents__link">FAQ</a><ul><li><a href="#traps-tincd3995-general-protection-fault-ip7f6ad09944eb-sp7ffda3da5ea8-error0-in-ld-musl-x86_64so17f6ad098b00046000" class="table-of-contents__link">traps: tincd3995 general protection fault ip:7f6ad09944eb sp:7ffda3da5ea8 error:0 in ld-musl-x86_64.so.17f6ad098b000+46000</a></li><li><a href="#failed-to-verify-sig-record-from-infra" class="table-of-contents__link">Failed to verify SIG record from infra</a></li><li><a href="#got-req_key-from-node-while-we-already-started-a-sptps-session" class="table-of-contents__link">Got REQ_KEY from node while we already started a SPTPS session!</a></li><li><a href="#相同-key-或相同-名字？" class="table-of-contents__link">相同 key 或相同 名字？</a></li><li><a href="#peer--tries-to-roll-back-protocol-version-to-170" class="table-of-contents__link">Peer  tries to roll back protocol version to 17.0</a></li><li><a href="#could-not-open-devnettun-no-such-file-or-directory" class="table-of-contents__link">Could not open /dev/net/tun: No such file or directory</a></li><li><a href="#route" class="table-of-contents__link">route</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">笔记</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/notes/java/java">Java</a></li><li class="footer__item"><a class="footer__link-item" href="/notes/os/alpine/alpine">AlpineLinux</a></li><li class="footer__item"><a class="footer__link-item" href="/notes/devops/kubernetes/kubernetes">Kubernates</a></li><li class="footer__item"><a class="footer__link-item" href="/notes/voip/voip">VoIP</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Projects</h4><ul class="footer__items"><li class="footer__item">
              <div>
              <a class="footer__link-item" href="https://github.com/wenerme/wener">Wener</a>
              - <a class="footer__link-item" href="https://github.com/wenerme/wener/actions" title="wenerme/wener - ci">
                <img style="vertical-align: middle;opacity: .4;" src="https://github.com/wenerme/wener/workflows/Build/badge.svg">
                </a>
              </div>
              </li><li class="footer__item"><a href="https://apis.wener.me" target="_blank" rel="noopener noreferrer" class="footer__link-item">Wener&#x27;s Apis</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Social</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/story">Blog</a></li><li class="footer__item"><a href="https://github.com/wenerme" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://twitter.com/wenerme" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div></div><div class="text--center"><div class="margin-bottom--sm"><img class="footer__logo" alt="Wener Site" src="/img/wener-logo.svg"></div><div>Copyright © 1992-2020 Wener - 构建时间 2020-11-26 20:56</div></div></div></footer></div>
<script src="/styles.862535b2.js"></script>
<script src="/runtime~main.6124d671.js"></script>
<script src="/main.075d2360.js"></script>
<script src="/1.a806460f.js"></script>
<script src="/2.678ad637.js"></script>
<script src="/3.3ba5c13e.js"></script>
<script src="/1be78505.c17636e5.js"></script>
<script src="/620.a1cfc766.js"></script>
<script src="/935f2afb.fcfb3c7e.js"></script>
<script src="/17896441.a01940a3.js"></script>
<script src="/3c07aa29.bcb092fc.js"></script>
</body>
</html>