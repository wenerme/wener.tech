<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/story/rss.xml" title="Wener Live &amp; Life RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/story/atom.xml" title="Wener Live &amp; Life Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Wener Live &amp; Life" href="/opensearch.xml">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css"><title data-react-helmet="true">gRPC | Wener Live &amp; Life</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://wener.me/notes/service/api/grpc"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="gRPC | Wener Live &amp; Life"><meta data-react-helmet="true" name="description" content="- gRPC"><meta data-react-helmet="true" property="og:description" content="- gRPC"><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://wener.me/notes/service/api/grpc"><link data-react-helmet="true" rel="alternate" href="https://wener.me/notes/service/api/grpc" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://wener.me/notes/service/api/grpc" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.7900c842.css">
<link rel="preload" href="/assets/js/runtime~main.9a31b6fd.js" as="script">
<link rel="preload" href="/assets/js/main.d2805781.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/wener-logo-head.svg" alt="Wener Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/wener-logo-head.svg" alt="Wener Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Wener</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/notes">笔记</a><a class="navbar__item navbar__link" href="/story">故事</a><a class="navbar__item navbar__link" href="/notes/howto/network/dns-prevent-spoofing">指南</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/wenerme/wener" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">🌜</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">🌞</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div><div class="searchBox_Utm0"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/notes/evolve">自我成长</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/notes/java/java-awesome">Java</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/notes/web/web-awesome">Web</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/notes/languages">语言</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/notes/os/alpine/alpine-awesome">AlpineLinux</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/notes/devops/docker/docker-cookbook">Docker</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/notes/devops/kubernetes">Kubernetes</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/notes/os/linux/linux-awesome">Linux</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/notes/os/virt">虚拟化</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/notes/os/os-awesome">操作系统</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/notes/voip">VoIP</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/notes/dev/dev-awesome">开发</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/notes/devops/devops-faq">DevOps</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/notes/db">数据库</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/notes/queue">消息队列</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/notes/security/security-awesome">安全</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" href="/notes/service/service-awesome">服务</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/service-awesome">Service Awesome</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" tabindex="0" href="/notes/service/api/api-awesome">API</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/api/api-awesome">API Awesome</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/api/apollo-federation">Apollo Federation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/api/bramble">bramble</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/api/buf">buf</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/api/cbor">CBOR</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/api/dubbo">Dubbo</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/api/graphql">GraphQL</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/api/graphql-awesome">GraphQL Awesome</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/api/graphql-code-generator">graphql-code-generator</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/api/graphql-faq">GraphQL FAQ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/notes/service/api/grpc">gRPC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/api/grpc-awesome">gRPC Awesome</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/api/grpc-go">gRPC Go</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/api/grpc-web">grpc web</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/api/protobuf">protobuf</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/api/protobuf-faq">Protobuf</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/api/protoc-gen-validate">protoc-gen-validate</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/api/serialization-awesome">Serialization Awesome</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/api/smithy">smithy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/api/urql">URQL</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/notes/service/auth">Auth</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/notes/service/cms">内容管理</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/notes/service/crm/crm-awesome">客户关系管理</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/notes/service/bi/bi-awesome">BI</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/notes/service/analytics/analytics-awesome">Analytics</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/notes/service/workflow">工作流</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/notes/service/office">Office</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/notes/service/file/filebrowser">文件</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/notes/service/storage/storage-awesome">存储</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/notes/service/selfhost/selfhost-awesome">Selfhost</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/notes/service/network/network-faq">网络</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/notes/service/im/im-awesome">即时通讯</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/notes/service/email">电子邮件</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/notes/service/telecom/telecom-awesome">电信</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/notes/service/dns">DNS</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/notes/service/repository">仓库</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/notes/service/forge">Forge</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/notes/service/cn/gb/gb-11643">CN</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/notes/service/data">数据</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/baas/appwrite">AppWrite</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/baas/baas-awesome">BaaS Awesome</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/baas">Backend as a Service</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/collaboration/baserow">baserow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/collaboration">协同软件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/collaboration/collaboration-awesome">Collaboration Awesome</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/collaboration/nocodb">nocodb</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/download/aria2">aria2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/download/transmission">transmission</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/download/youtube-dl">youtube-dl</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/e-commerce">E-Commerce</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/forum/forum-awesome">Forum Awesome</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/low-code/low-code-awesome">Low Code Awesome</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/media/avif">AVIF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/media/butteraugli">butteraugli</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/media/ffmpeg">ffmpeg</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/media/ffmpeg-faq">FFMpeg FAQ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/media/jellyfin">Jellyfin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/media/jpeg-xl">JPEG XL</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/media/m3u8">M3U8</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/media/media-awesome">Media Awesome</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/media/media-faq">Media FAQ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/media/minidlna">MiniDLNA</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/media/mpv">mpv</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/media/vips">vips</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/notion">Notion</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/p2p/p2p-awesome">P2P Awesome</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/p2p/torrent-awesome">Torrent Awesome</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/printing/printing-awesome">Printing Awesome</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/realtime/realtime-awesome">RealTime Awesome</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/resource/resource-awesome">资源站</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/torrent/glossary">Torrent 词汇</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/notes/ops/ops-awesome">运维</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/notes/howto/ops/alpine-admin-ansible">指南</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/notes/hardware/hardware-awesome">硬件</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/notes/algorithm/algorithm-awesome">算法</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/notes/healthcare/disease">健康</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/notes/reference/software/glossary">参考</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/notes/tool">工具</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_eoK2"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_e+kA"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>gRPC</h1></header><ul><li><a href="https://github.com/grpc/" target="_blank" rel="noopener noreferrer">gRPC</a></li><li><a href="https://github.com/grpc-ecosystem" target="_blank" rel="noopener noreferrer">gRPC Ecosystem</a></li><li><a href="https://github.com/google/protobuf/blob/master/docs/third_party.md" target="_blank" rel="noopener noreferrer">Third-Party Add-ons for Protocol Buffers</a></li><li>服务端暂不支持 PHP<ul><li>可以跟踪该帖子 <a href="https://groups.google.com/forum/#!topic/grpc-io/F3IyYaI_6S0" target="_blank" rel="noopener noreferrer">Servers in PHP?</a></li></ul></li><li>google.protobuf<ul><li>默认定义</li><li>api.proto<ul><li>对服务的轻量级定义</li></ul></li></ul></li><li>问题<ul><li><a href="https://github.com/grpc/grpc-go/issues/555" target="_blank" rel="noopener noreferrer">grpc-go#555</a> - ServeHTTP doesn&#x27;t work without TLS<ul><li>Golang 实现可以使用 <code>ServeHTTP</code>, 但必须要 <code>TLS</code></li></ul></li></ul></li><li>相关服务<ul><li><a href="https://github.com/mwitkow/grpc-proxy" target="_blank" rel="noopener noreferrer">mwitkow/grpc-proxy</a><ul><li>grpc 反向代理</li></ul></li><li><a href="https://github.com/improbable-eng/grpc-web" target="_blank" rel="noopener noreferrer">improbable-eng/grpc-web</a><ul><li>gRPC Web implementation for Golang and TypeScript</li></ul></li></ul></li><li>案例参考<ul><li><a href="https://github.com/grpc/grpc-proto" target="_blank" rel="noopener noreferrer">grpc/grpc-proto</a><ul><li>常用协议</li></ul></li><li>k8s 使用 go-to-protobuf 从 go 生成的 proto</li></ul></li><li>参考<ul><li><a href="https://github.com/mfornos/awesome-microservices" target="_blank" rel="noopener noreferrer">mfornos/awesome-microservices</a></li><li><a href="https://goel.io/grpc-100/" target="_blank" rel="noopener noreferrer">gRPC Practical Tutorial - Magic That Generates Code</a></li><li><a href="https://github.com/LogNet/grpc-spring-boot-starter" target="_blank" rel="noopener noreferrer">LogNet/grpc-spring-boot-starter</a></li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="note">Note<a class="hash-link" href="#note" title="Direct link to heading">​</a></h2><ul><li>guides/<a href="https://grpc.io/docs/guides/concepts.html" target="_blank" rel="noopener noreferrer">concepts</a><ul><li>服务定义</li><li>使用方式</li><li>RPC 生命周期<ul><li>单向 RPC</li><li>服务端流</li><li>客户端流</li><li>双向流</li><li>超时</li><li>终端</li><li>取消</li><li>元数据</li><li>通道</li></ul></li></ul></li><li>实现<ul><li>使用 HTTP2 协议</li><li>使用 HTTP2 Trailler 来标识是否还有后续包<ul><li>Web 无法获取到该信息, 所以无法实现和使用 gRPC</li></ul></li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="docker">Docker<a class="hash-link" href="#docker" title="Direct link to heading">​</a></h2><ul class="contains-task-list"><li>避免安装编译等繁杂的过程</li><li><a href="https://github.com/wenerme/dockerfiles/tree/master/grpc" target="_blank" rel="noopener noreferrer">Dockerfile</a></li><li>AlpineLinux Packages <a href="https://github.com/wenerme/statics/tree/master/abuild" target="_blank" rel="noopener noreferrer">grpc</a></li><li>grpc</li><li>grpc-java</li><li>grpc-go<ul><li>protowrap</li></ul></li><li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->grpc-swift</li><li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->grpc-slate</li></ul><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 假设 api 位于当前目录下的 apis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run --rm -it -v </span><span class="token environment constant" style="color:rgb(130, 170, 255)">$PWD</span><span class="token plain">:/host --workdir /host wener/grpc</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 创建目标目录</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 注意: 如果删除了 proto 文件, 目录下之前生成的的文件不会被删除, 此时建议删除目录从新生成</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 注意: 文件生成在了当前目录, 需要同步到项目中. 也可以直接生成到项目中</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">mkdir</span><span class="token plain"> java javanano php go objc js ruby python csharp node slatedoc</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 定义常用参数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 注意: 如果文件列表发生了变化需要从新执行</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">COMMON_ARGS</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;</span><span class="token string variable" style="color:rgb(191, 199, 213)">$(</span><span class="token string variable builtin class-name" style="color:rgb(255, 203, 107)">echo</span><span class="token string variable" style="color:rgb(191, 199, 213)"> -I </span><span class="token string variable builtin class-name" style="color:rgb(255, 203, 107)">.</span><span class="token string variable" style="color:rgb(191, 199, 213)"> apis/**/*.proto</span><span class="token string variable" style="color:rgb(191, 199, 213)">)</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Generate Java</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">protoc </span><span class="token variable" style="color:rgb(191, 199, 213)">$COMMON_ARGS</span><span class="token plain"> --plugin</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable function" style="color:rgb(130, 170, 255)">which</span><span class="token variable" style="color:rgb(191, 199, 213)"> protoc-gen-grpc-java</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain"> --java_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">./java --grpc-java_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">./java</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Generate Java Nano</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">protoc </span><span class="token variable" style="color:rgb(191, 199, 213)">$COMMON_ARGS</span><span class="token plain"> --plugin</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable function" style="color:rgb(130, 170, 255)">which</span><span class="token variable" style="color:rgb(191, 199, 213)"> protoc-gen-grpc-java</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain"> --java_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">nano:./javanano --grpc-java_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">./javanano</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Generate Go by protowrap</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># The last -I apis is required</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">protowrap </span><span class="token variable" style="color:rgb(191, 199, 213)">$COMMON_ARGS</span><span class="token plain"> --go_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">plugins</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">grpc:</span><span class="token environment constant" style="color:rgb(130, 170, 255)">$HOME</span><span class="token plain">/go/src -I apis/</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Generate slate document</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">protowrap </span><span class="token variable" style="color:rgb(191, 199, 213)">$COMMON_ARGS</span><span class="token plain"> --slate_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">./slatedoc -I apis/</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Generate Swift</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">protoc </span><span class="token variable" style="color:rgb(191, 199, 213)">$COMMON_ARGS</span><span class="token plain"> --swift_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">./swift --swiftgrpc_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">./swift</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Generate PHP</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">protoc </span><span class="token variable" style="color:rgb(191, 199, 213)">$COMMON_ARGS</span><span class="token plain"> --plugin</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">protoc-gen-grpc</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable function" style="color:rgb(130, 170, 255)">which</span><span class="token variable" style="color:rgb(191, 199, 213)"> grpc_php_plugin</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain"> --php_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">./php --grpc_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">./php</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Generate CXX</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">protoc </span><span class="token variable" style="color:rgb(191, 199, 213)">$COMMON_ARGS</span><span class="token plain"> --plugin</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">protoc-gen-grpc</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable function" style="color:rgb(130, 170, 255)">which</span><span class="token variable" style="color:rgb(191, 199, 213)"> grpc_cpp_plugin</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain"> --cpp_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">./cpp --grpc_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">./cpp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Generate C#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">protoc </span><span class="token variable" style="color:rgb(191, 199, 213)">$COMMON_ARGS</span><span class="token plain"> --plugin</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">protoc-gen-grpc</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable function" style="color:rgb(130, 170, 255)">which</span><span class="token variable" style="color:rgb(191, 199, 213)"> grpc_csharp_plugin</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain"> --csharp_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">./csharp --grpc_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">./csharp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Generate ObjC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">protoc </span><span class="token variable" style="color:rgb(191, 199, 213)">$COMMON_ARGS</span><span class="token plain"> --plugin</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">protoc-gen-grpc</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable function" style="color:rgb(130, 170, 255)">which</span><span class="token variable" style="color:rgb(191, 199, 213)"> grpc_objective_c_plugin</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain"> --objc_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">./objc --grpc_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">./objc</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Generate Ruby</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">protoc </span><span class="token variable" style="color:rgb(191, 199, 213)">$COMMON_ARGS</span><span class="token plain"> --plugin</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">protoc-gen-grpc</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable function" style="color:rgb(130, 170, 255)">which</span><span class="token variable" style="color:rgb(191, 199, 213)"> grpc_ruby_plugin</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain"> --ruby_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">./ruby --grpc_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">./ruby</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Generate Python</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">protoc </span><span class="token variable" style="color:rgb(191, 199, 213)">$COMMON_ARGS</span><span class="token plain"> --plugin</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">protoc-gen-grpc</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable function" style="color:rgb(130, 170, 255)">which</span><span class="token variable" style="color:rgb(191, 199, 213)"> grpc_python_plugin</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain"> --python_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">./objc --grpc_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">./python</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Generate Node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">protoc </span><span class="token variable" style="color:rgb(191, 199, 213)">$COMMON_ARGS</span><span class="token plain"> --plugin</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">protoc-gen-grpc</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable function" style="color:rgb(130, 170, 255)">which</span><span class="token variable" style="color:rgb(191, 199, 213)"> grpc_node_plugin</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain">  --js_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">import_style</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">commonjs,binary:./node --grpc_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">./node</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="安装">安装<a class="hash-link" href="#安装" title="Direct link to heading">​</a></h2><ul><li><a href="https://github.com/grpc/grpc/blob/master/INSTALL.md" target="_blank" rel="noopener noreferrer">https://github.com/grpc/grpc/blob/master/INSTALL.md</a></li><li><a href="https://hub.docker.com/u/grpc/" target="_blank" rel="noopener noreferrer">https://hub.docker.com/u/grpc/</a></li><li>生成主要依赖插件<ul><li>protoc-gen-go</li><li>protoc-gen-grpc-gateway</li><li>protoc-gen-swagger</li><li>protoc-gen-grpc-java</li></ul></li><li><a href="https://github.com/Juniper/grpc-c" target="_blank" rel="noopener noreferrer">Juniper/grpc-c</a><ul><li>支持 C</li></ul></li><li><a href="https://github.com/grpc/grpc-java/tree/master/compiler" target="_blank" rel="noopener noreferrer">https://github.com/grpc/grpc-java/tree/master/compiler</a></li></ul><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># grpc_cli</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># grpc_cpp_plugin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># grpc_csharp_plugin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># grpc_node_plugin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># grpc_objective_c_plugin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># grpc_php_plugin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># grpc_python_plugin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># grpc_ruby_plugin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">brew </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> grpc</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 不 link 则使用绝对路径</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">brew </span><span class="token function" style="color:rgb(130, 170, 255)">link</span><span class="token plain"> grpc</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 变量定义简化操作</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># =========</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 安装 gRPC 后会包含很多插件</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># # 生成 cpp, node, php, c#, ruby, python, objc 的方式是一样的</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">GRPC_BIN</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable" style="color:rgb(191, 199, 213)">brew --prefix grpc</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain">/bin</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 定义 pb 路径</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">PROTO_PATH</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">./apis/</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 对路径进行展开</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">PROTO_FILES</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">apis/**/*.proto</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">PROTO_ARGS</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;-I </span><span class="token string variable" style="color:rgb(191, 199, 213)">$PROTO_PATH</span><span class="token string" style="color:rgb(195, 232, 141)">  </span><span class="token string variable" style="color:rgb(191, 199, 213)">${PROTO_FILES</span><span class="token string variable punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string variable" style="color:rgb(191, 199, 213)">*</span><span class="token string variable punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token string variable" style="color:rgb(191, 199, 213)">}</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 覆盖 protoc</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">alias</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">protoc</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;protoc </span><span class="token string variable" style="color:rgb(191, 199, 213)">$PROTO_ARGS</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># gRPC 生成</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># =========</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># --js_out=./node 生成 protobuf</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># --grpc_out=./node 生成 grpc</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># --plugin=protoc-gen-grpc=$GRPC_BIN/grpc_node_plugin 使用 grpc_node_plugin 来生成 node 的 grpc</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># -I . 包从当前目录查找</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># apis/**/*.proto 生成所有 apis 下的 proto</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">protoc --js_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">./node --grpc_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">./node --plugin</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">protoc-gen-grpc</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$GRPC_BIN</span><span class="token plain">/grpc_node_plugin -I </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">.</span><span class="token plain"> apis/**/*.proto</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Golang</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># =========</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 不支持一次性生成多个包</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># https://github.com/golang/protobuf/pull/40</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 可以使用 https://github.com/square/goprotowrap 规避</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">go get -u github.com/golang/protobuf/</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">proto,protoc-gen-go</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">go get -u google.golang.org/grpc</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Golang 可直接生成 gRPC 和 Protobuf</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">protoc --go_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">plugins</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">grpc:</span><span class="token environment constant" style="color:rgb(130, 170, 255)">$HOME</span><span class="token plain">/go/src -I </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">.</span><span class="token plain"> apis/**/*.proto</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 使用 protowrap</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">go get -u github.com/square/goprotowrap/cmd/protowrap</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># -I apis/ 是必须的, 要有有一个前缀</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">protowrap --go_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">plugins</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">grpc:</span><span class="token environment constant" style="color:rgb(130, 170, 255)">$HOME</span><span class="token plain">/go/src -I </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">.</span><span class="token plain"> -I apis/ apis/**/*.proto</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># https://github.com/gogo/protobuf</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># gogoprotobuf is a fork of golang/protobuf with extra code generation features.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 扩展 https://github.com/gogo/protobuf/blob/master/extensions.md</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># protoc-gen-gogofast (same as gofast, but imports gogoprotobuf)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># protoc-gen-gogofaster (same as gogofast, without XXX_unrecognized, less pointer fields)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># protoc-gen-gogoslick (same as gogofaster, but with generated string, gostring and equal methods)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">go get -u github.com/gogo/protobuf/protoc-gen-gofast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">protowrap --gofast_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">plugins</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">grpc:</span><span class="token environment constant" style="color:rgb(130, 170, 255)">$HOME</span><span class="token plain">/go/src -I </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">.</span><span class="token plain"> -I apis/ apis/**/*.proto</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Java</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># =========</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Java 插件需要自己编译</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> clone https://github.com/grpc/grpc-java</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">cd</span><span class="token plain"> grpc-java/compiler</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token plain">/gradlew java_pluginExecutable</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 插件完整路径</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">realpath build/exe/java_plugin/protoc-gen-grpc-java</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">GEN_JAVA</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;</span><span class="token string variable" style="color:rgb(191, 199, 213)">$(</span><span class="token string variable" style="color:rgb(191, 199, 213)">realpath build/exe/java_plugin/protoc-gen-grpc-java</span><span class="token string variable" style="color:rgb(191, 199, 213)">)</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 生成 gRPC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">protoc --plugin</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">protoc-gen-grpc-java</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$GEN_JAVA</span><span class="token plain"> --grpc-java_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token environment constant" style="color:rgb(130, 170, 255)">$PWD</span><span class="token plain">/java -I </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">.</span><span class="token plain"> proto/**/*.proto</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 生成 protobuf</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">protoc -I </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">.</span><span class="token plain"> --java_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">./java proto/**/*.proto</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 生成 nano 的 pb</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">protoc -I </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">.</span><span class="token plain"> --javanano_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">./java proto/**/*.proto</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 生成 gRPC lite</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">protoc --plugin</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">protoc-gen-grpc-java</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$GEN_JAVA</span><span class="token plain"> --grpc-java_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">lite:</span><span class="token environment constant" style="color:rgb(130, 170, 255)">$PWD</span><span class="token plain">/java -I </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">.</span><span class="token plain"> proto/**/*.proto</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 生成 gRPC nano</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">protoc --plugin</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">protoc-gen-grpc-java</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$GEN_JAVA</span><span class="token plain"> --grpc-java_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">nano:</span><span class="token environment constant" style="color:rgb(130, 170, 255)">$PWD</span><span class="token plain">/java -I </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">.</span><span class="token plain"> proto/**/*.proto</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Swift</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># =========</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># https://github.com/grpc/grpc-swift</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> clone https://github.com/grpc/grpc-swift</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">cd</span><span class="token plain"> grpc-swift/Plugin</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">make</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">GEN_SWIFT</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable" style="color:rgb(191, 199, 213)">realpath </span><span class="token variable builtin class-name" style="color:rgb(255, 203, 107)">.</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 生成 pb 和 grpc</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">protoc --plugin</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$GEN_SWIFT</span><span class="token plain">/protoc-gen-swift --swift_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">./swift -I </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">.</span><span class="token plain"> proto/**/*.proto</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">protoc --plugin</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$GEN_SWIFT</span><span class="token plain">/protoc-gen-swiftgrpc --swiftgrpc_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">./swift -I </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">.</span><span class="token plain"> proto/**/*.proto</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># =========</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">protoc --js_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">./node --grpc_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">./node --plugin</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">protoc-gen-grpc</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$GRPC_BIN</span><span class="token plain">/grpc_node_plugin -I </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">.</span><span class="token plain"> proto/**/*.proto</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 使用 grpc-tools 生成</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">yarn</span><span class="token plain"> global </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> grpc-tools</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">protoc -I</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">. ./protos/product.proto </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --js_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">import_style</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">commonjs,binary:./server </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --grpc_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">./server </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --plugin</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">protoc-gen-grpc</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">`</span><span class="token variable function" style="color:rgb(130, 170, 255)">which</span><span class="token variable" style="color:rgb(191, 199, 213)"> grpc_tools_node_protoc_plugin</span><span class="token variable" style="color:rgb(191, 199, 213)">`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># ts-protoc-gen</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># =========</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># https://github.com/improbable-eng/ts-protoc-gen</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 生成 Typescript 定义 .d.ts</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Gateway</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># =========</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Web &lt;-&gt; gRPC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 生成网关代码和 Swagger 配置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">go get -u github.com/grpc-ecosystem/grpc-gateway/protoc-gen-grpc-gateway</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">go get -u github.com/grpc-ecosystem/grpc-gateway/protoc-gen-swagger</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 生成 stub</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">protoc --go_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">plugins</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">grpc:. -I proto/ proto/hello.proto</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 生成反向代理</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">protoc --grpc-gateway_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">logtostderr</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">true:. -I proto/ proto/hello.proto</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 生成 swagger</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">protoc --swagger_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">logtostderr</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">true:. -I proto/ proto/hello.proto</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># prototools</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># =========</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 生成文档, json, dump</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># https://github.com/sourcegraph/prototools</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">go get -u sourcegraph.com/sourcegraph/prototools/cmd/protoc-gen-doc</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 如果找不到文件可以考虑指定 filemap=./tmpl/filemap.xml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">protowrap --doc_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">./apidoc -I </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">.</span><span class="token plain"> -I apis/ apis/**/*.proto</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># pseudomuto/protoc-gen-doc</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># =========</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 生成文档, 支持生成 HTML, JSON, DocBook, Markdown</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 默认模板比 prototools 好看</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># https://github.com/pseudomuto/protoc-gen-doc</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">go get -u github.com/pseudomuto/protoc-gen-doc/cmd/</span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token plain">.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="java">Java<a class="hash-link" href="#java" title="Direct link to heading">​</a></h2><ul><li><a href="https://github.com/grpc/grpc-java/issues/3458" target="_blank" rel="noopener noreferrer">grpc/grpc-java#3458</a> - FR: Port sharing with traditional HTTP services<ul><li><a href="https://github.com/netty/netty/issues/3667" target="_blank" rel="noopener noreferrer">netty/netty#3667</a> - h2childchan: Model streams in HTTP/2 as child channels</li></ul></li></ul><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">class Tests{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  // TLS 服务端</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  public void testTLSSvr() throws IOException, InterruptedException {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    java.security.Security.addProvider(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        new org.bouncycastle.jce.provider.BouncyCastleProvider()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    int port = 8443;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Server server = NettyServerBuilder</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        .forPort(port)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        .sslContext(GrpcSslContexts</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .forServer(new File(&quot;localhost.pem&quot;),new File(&quot;localhost-key.pem&quot;))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .trustManager(new File(&quot;ca.pem&quot;))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 要求客户端认证</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .clientAuth(ClientAuth.REQUIRE).build())</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        .addService(new MyServiceImpl())</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        .build();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    log.info(&quot;Server started, listening on &quot; + port);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    server.start().awaitTermination();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  // TLS 客户端</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  public void testTLSCli() throws Exception {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    java.security.Security.addProvider(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        new org.bouncycastle.jce.provider.BouncyCastleProvider()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // 使用 Netty 实现, 也可以使用 OkHttp 实现</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ManagedChannel channel = NettyChannelBuilder</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        .forAddress(&quot;localhost&quot;, 8443)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        .sslContext(GrpcSslContexts</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .forClient()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .trustManager(new File(&quot;ca.pem&quot;))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // 双向认证才需要</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .keyManager(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                new File(&quot;cli.pem&quot;),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                new File(&quot;cli-key.pem&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .build())</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        .build();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // 创建阻塞客户端</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    MyServiceGrpcBlockingStub stub = MyServiceGrpc.newBlockingStub(channel);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    GetInfoResponse info = stub.getInfo(GetInfoRequest.newBuilder().build());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    System.out.println(info.getName());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="php">PHP<a class="hash-link" href="#php" title="Direct link to heading">​</a></h2><div class="codeBlockContainer_J+bg language-php theme-code-block"><div class="codeBlockContent_csEI php"><pre tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;?php</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">require __DIR__ . &#x27;/vendor/autoload.php&#x27;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$creds =</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  // 无 TLS</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Grpc\ChannelCredentials::createInsecure()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  // 只配置 CA 如果服务端不要求客户端认证</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  // \Grpc\ChannelCredentials::createSsl(file_get_contents(&quot;ca.pem&quot;))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  // 双向认证, 服务端要求客户端认证</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  // \Grpc\ChannelCredentials::createSsl(file_get_contents(&quot;ca.pem&quot;),file_get_contents(&quot;cli-key.pem&quot;),file_get_contents(&quot;cli.pem&quot;))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$client = new \Wener\Service\V1\InfoServiceClient(&quot;localhost:5002&quot;, [</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &#x27;credentials&#x27; =&gt; $creds,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">]);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> * @var \Wener\Service\V1\GetInfoResponse $reply</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> * @var \Wener\Api\GrpcStatus $status Customized type for ide to hint type</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">list($reply, $status) = $client-&gt;GetInfo(new \Wener\Service\V1\GetInfoRequest())-&gt;wait();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">echo $status-&gt;code . PHP_EOL;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">echo $reply-&gt;getName() . PHP_EOL;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// All Status</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">print_r($status);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// JSON</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// 再次解码编码是为了方便调试</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">echo json_encode(json_decode($reply-&gt;serializeToJsonString()), JSON_PRETTY_PRINT | JSON_UNESCAPED_UNICODE) . PHP_EOL;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="node">Node<a class="hash-link" href="#node" title="Direct link to heading">​</a></h2><ul><li><a href="https://github.com/grpc/grpc/issues/8233" target="_blank" rel="noopener noreferrer">#8233 Typescript typings for node package</a></li></ul><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 最基本的只需要这两个依赖</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">yarn</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> google-protobuf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">yarn</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> grpc</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 调试相关的环境变量</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">GRPC_TRACE</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">all</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">GRPC_VERBOSITY</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">DEBUG</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="codeBlockContainer_J+bg language-js theme-code-block"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> grpc </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;grpc&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> fs </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;fs&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 生成的 pb 对象</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> messages </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;./service_pb&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 生成 grpc 客户端和服务端</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> services </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;./service_grpc_pb&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">let</span><span class="token plain"> client </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">services</span><span class="token class-name punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token class-name" style="color:rgb(255, 203, 107)">ServiceClient</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;service.wener.me:443&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 无 TLS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// grpc.credentials.createInsecure(),</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 使用 self-signed 证书</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  grpc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">credentials</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">createSsl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">fs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">readFileSync</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;ca.pem&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> fs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">readFileSync</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;cli-key.pem&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> fs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">readFileSync</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;cli.pem&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 发起请求</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">let</span><span class="token plain"> request </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">messages</span><span class="token class-name punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token class-name" style="color:rgb(255, 203, 107)">GetInfoRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">client</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">getInfo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">err</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> response</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;Service name&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> response</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">getName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="golang">Golang<a class="hash-link" href="#golang" title="Direct link to heading">​</a></h2><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># http2 相关的环境变量</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">GODEBUG</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">http2client</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># disable HTTP/2 client support</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">GODEBUG</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">http2server</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># disable HTTP/2 server support</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">GODEBUG</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">http2debug</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># enable verbose HTTP/2 debug logs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">GODEBUG</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">http2debug</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># ... even more verbose, with frame dumps</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="client">Client<a class="hash-link" href="#client" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_J+bg language-golang theme-code-block"><div class="codeBlockContent_csEI golang"><pre tabindex="0" class="prism-code language-golang codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">package main</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">func main(){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="server">Server<a class="hash-link" href="#server" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_J+bg language-golang theme-code-block"><div class="codeBlockContent_csEI golang"><pre tabindex="0" class="prism-code language-golang codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">package main</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">var (</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ServerCert string</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ServerKey  string</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    RootCA     string</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Addr       string</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">func main() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    flag.StringVar(&amp;ServerCert, &quot;cert&quot;, &quot;&quot;, &quot;&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    flag.StringVar(&amp;ServerKey, &quot;key&quot;, &quot;&quot;, &quot;&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    flag.StringVar(&amp;RootCA, &quot;ca&quot;, &quot;&quot;, &quot;&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    flag.StringVar(&amp;Addr, &quot;addr&quot;, &quot;&quot;, &quot;&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    flag.Parse()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    var srv *grpc.Server</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    lis, err := net.Listen(&quot;tcp&quot;, Addr)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if err != nil {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        panic(fmt.Errorf(&quot;could not list on %s: %s&quot;, Addr, err))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if ServerCert == &quot;&quot; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        srv = grpc.NewServer()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    } else {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        logrus.WithField(&quot;cert&quot;, ServerCert).Info(&quot;With TLS&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // 读取证书信息</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        certificate, err := tls.LoadX509KeyPair(ServerCert, ServerKey)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if err != nil {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            panic(fmt.Errorf(&quot;could not load client key pair: %s&quot;, err))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // Create a certificate pool from the certificate authority</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        certPool := x509.NewCertPool()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ca, err := ioutil.ReadFile(RootCA)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if err != nil {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            panic(fmt.Errorf(&quot;could not read ca certificate: %s&quot;, err))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // Append the certificates from the CA</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if ok := certPool.AppendCertsFromPEM(ca); !ok {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            panic(errors.New(&quot;failed to append ca certs&quot;))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        creds := credentials.NewTLS(&amp;tls.Config{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      // 如何对客户端进行认证, 可进行双向认证</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ClientAuth:   tls.VerifyClientCertIfGiven,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Certificates: []tls.Certificate{certificate},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ClientCAs:    certPool,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        })</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        srv = grpc.NewServer(grpc.Creds(creds))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // Create the gRPC server with the credentials</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    service.RegisterInfoServiceServer(srv, &amp;DemoStatus{})</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    logrus.WithField(&quot;addr&quot;, Addr).Info(&quot;Serving&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // Serve and Listen</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if err := srv.Serve(lis); err != nil {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        panic(fmt.Errorf(&quot;grpc serve error: %s&quot;, err))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">type DemoStatus struct {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    service.InfoServiceServer</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">func (DemoStatus) GetInfo(context.Context, *service.GetInfoRequest) (*service.GetInfoResponse, error) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    logrus.Info(&quot;Handle request&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return &amp;service.GetInfoResponse{Name: &quot;Demo Service&quot;}, nil</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="web">Web<a class="hash-link" href="#web" title="Direct link to heading">​</a></h2><ul><li><a href="https://github.com/grpc/grpc/blob/master/doc/PROTOCOL-WEB.md" target="_blank" rel="noopener noreferrer">gRPC Web</a></li><li><a href="https://github.com/dcodeIO/ProtoBuf.js/" target="_blank" rel="noopener noreferrer">https://github.com/dcodeIO/ProtoBuf.js/</a></li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="typescript">Typescript<a class="hash-link" href="#typescript" title="Direct link to heading">​</a></h2><p><a href="https://www.npmjs.com/package/ts-protoc-gen" target="_blank" rel="noopener noreferrer">https://www.npmjs.com/package/ts-protoc-gen</a></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="grpc-gateway">grpc-gateway<a class="hash-link" href="#grpc-gateway" title="Direct link to heading">​</a></h2><ul><li><a href="https://github.com/grpc-ecosystem/grpc-gateway" target="_blank" rel="noopener noreferrer">grpc-gateway</a><ul><li>gRPC to JSON proxy generator</li></ul></li><li>支持 googleapis 中的 http 定义</li><li>Features<ul><li>Generating JSON API handlers</li><li>Method parameters in request body</li><li>Method parameters in request path</li><li>Method parameters in query string</li><li>Enum fields in path parameter (including repeated enum fields).</li><li>Mapping streaming APIs to newline-delimited JSON streams</li><li>Mapping HTTP headers with Grpc-Metadata- prefix to gRPC metadata (prefixed with grpcgateway-)</li><li>Optionally emitting API definition for Swagger.</li><li>Setting gRPC timeouts through inbound HTTP Grpc-Timeout header.</li></ul></li><li>可以只拷贝需要的导入文件<ul><li><code>google/api/annotations.proto</code></li><li><code>google/api/http.proto</code></li></ul></li><li>然后在 rpc 中添加 http 定义即可</li></ul><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">rpc SayHello (HelloRequest) returns (HelloReply) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  option (google.api.http) = {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      post:&quot;/v1/greeter/hello&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      body:&quot;*&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  };</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 安装</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">go get -u github.com/grpc-ecosystem/grpc-gateway/protoc-gen-grpc-gateway</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">go get -u github.com/grpc-ecosystem/grpc-gateway/protoc-gen-swagger</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">go get -u github.com/golang/protobuf/protoc-gen-go</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 生成 stub</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">protoc --go_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">plugins</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">grpc:. -I proto/ proto/hello.proto</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 生成反向代理</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">protoc --grpc-gateway_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">logtostderr</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">true:. -I proto/ proto/hello.proto</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 生成 swagger</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">protoc --swagger_out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">logtostderr</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">true:. -I proto/ proto/hello.proto</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 拉取相关依赖</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">go get </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 添加 main, 启动时调用注册</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="auth">Auth<a class="hash-link" href="#auth" title="Direct link to heading">​</a></h2><ul><li><a href="https://github.com/grpc/grpc-java/blob/master/SECURITY.md" target="_blank" rel="noopener noreferrer">grpc/grpc-java/SECURITY.md</a></li><li>guides/<a href="https://grpc.io/docs/guides/auth.html" target="_blank" rel="noopener noreferrer">auth</a><ul><li>SSL/TLS 双向认证</li><li>基于 Token</li></ul></li><li>授权分为整个通道和单次请求</li><li>gRPC 可以自带元数据头, 因此也可以自定义授权</li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="案例">案例<a class="hash-link" href="#案例" title="Direct link to heading">​</a></h2><ul><li><a href="https://github.com/cockroachdb/cockroach/tree/master/pkg/roachpb" target="_blank" rel="noopener noreferrer">cockroachdb/cockroach</a></li><li><a href="https://github.com/docker/swarmkit/tree/master/api" target="_blank" rel="noopener noreferrer">docker/swarmkit</a></li><li><a href="https://github.com/gogo/protobuf#users" target="_blank" rel="noopener noreferrer">https://github.com/gogo/protobuf#users</a></li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="gcp">GCP<a class="hash-link" href="#gcp" title="Direct link to heading">​</a></h3><ul><li><p><a href="https://github.com/googleapis/googleapis" target="_blank" rel="noopener noreferrer">googleapis/googleapis</a></p></li><li><p><a href="https://github.com/googleapis/toolkit" target="_blank" rel="noopener noreferrer">googleapis/toolkit</a></p></li><li><p><a href="https://github.com/googleapis/artman" target="_blank" rel="noopener noreferrer">googleapis/artman</a></p></li><li><p>GAPIC</p></li><li><p>selector</p><ul><li>逗号分隔</li><li>可以使用 <code>*</code> 做匹配, 但是只能放在最后<ul><li>例如 <code>foo.*</code>, 但不能写 <code>foo.*b</code>, <code>foo.*.abc</code></li><li>可以使用 <code>*</code> 匹配所有</li></ul></li></ul></li><li><p>服务结构</p><ul><li>api<ul><li>接口相关的定义</li><li>backend.proto<ul><li>定义服务的后端</li></ul></li><li>service.proto<ul><li>对服务的定义</li></ul></li><li>servicecontrol<ul><li>服务控制</li><li>对服务的检查报告</li></ul></li><li>servicemanagement<ul><li>服务管理</li><li>对服务的 CRUD, 启用停用</li></ul></li></ul></li><li>appengine</li></ul></li></ul><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># artman</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 包含了 grpc 生成个个语言的环境</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker pull googleapis/artman</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run -it --rm -v </span><span class="token environment constant" style="color:rgb(130, 170, 255)">$PWD</span><span class="token plain">/googleapis:/googleapis -v </span><span class="token environment constant" style="color:rgb(130, 170, 255)">$PWD</span><span class="token plain">/artman:/artman -w /googleapis googleapis/artman</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># artman --api pubsub --language python</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="service-control">Service Control<a class="hash-link" href="#service-control" title="Direct link to heading">​</a></h4><ul><li><a href="https://cloud.google.com/service-control/overview" target="_blank" rel="noopener noreferrer">Google Service Control</a></li><li>How to control access to your service.</li><li>How to validate API keys.</li><li>How to send logging and monitoring data to both consumers and producers.</li><li>How to create and manage dashboards to visualize such data.</li><li>How to scale the control plane components with your service.</li></ul><p><img src="https://cloud.google.com/service-control/images/arch.svg" alt="Architecture"></p><ul><li>Managed services<ul><li>Google Service Management 管理每个服务和其配置, 用于定制化 Google Service Control 的行为. 服务配置也被用于 Google Cloud Platform Console 显示其配置, 启用/禁用 等.</li><li>For example:<ul><li>Google Cloud Pub/Sub (pubsub.googleapis.com)</li><li>Google Cloud Vision (vision.googleapis.com)</li><li>Google Cloud Bigtable (bigtable.googleapis.com)</li><li>Google Cloud Datastore (datastore.googleapis.com)</li></ul></li></ul></li><li>Operations<ul><li>表示被管理服务的活动, 例如接口调用或资源使用</li><li>每个操作都关联一个被管理的服务,和调用者, 也包含调用的相关信息, 例如调用方法, 资源使用量等</li></ul></li><li>Check<ul><li>Check if the consumer is still active.</li><li>Check if the consumer has enabled the service.</li><li>Check if the API key is still valid.</li><li>对接口进行检测以保证更好的性能, 更高的可用性</li></ul></li><li>Report</li></ul><h4 class="anchor anchorWithStickyNavbar_y2LR" id="service-management">Service Management<a class="hash-link" href="#service-management" title="Direct link to heading">​</a></h4><ul><li>Google <a href="https://cloud.google.com/service-management/overview" target="_blank" rel="noopener noreferrer">Service Management</a></li><li>Service producer<ul><li>由谷歌开发者负责发布维护被管理的服务. 每个被管理的服务都由一个服务生产者所有</li></ul></li><li>Service consumers<ul><li>启用了接口调用的管理服务, 一个被管理的服务可以有很多服务消费者</li></ul></li><li>Service configurations<ul><li>每个被管理的服务都有自己的配置描述, 包括名字, 标题, RPC 接口定义, REST 接口定义, 文档, 授权等</li></ul></li><li>Service rollouts<ul><li>流量控制</li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="源码和使用分析">源码和使用分析<a class="hash-link" href="#源码和使用分析" title="Direct link to heading">​</a></h2><ul><li>PB 附带了所有解析后的消息格式定义</li><li>PB 3 增加了 java-util, 可以进行 JSON 序列化<ul><li><code>JsonFormat</code> 打印时需要使用 <code>com.google.protobuf.util.JsonFormat.TypeRegistry</code> 来反查具体类</li></ul></li><li>优化模式<ul><li>SPEED<ul><li>Generate complete code for parsing, serialization, etc.</li></ul></li><li>CODE_SIZE<ul><li>Use ReflectionOps to implement these methods.</li></ul></li><li>LITE_RUNTIME<ul><li>Generate code using MessageLite and the lite runtime.</li></ul></li></ul></li><li>命名空间<ul><li>与 Java 命名空间的概念相似</li><li>生成的类的包名可以不同于 proto 的包</li><li>所有定义的消息都有自己的类型和命名空间</li><li>因此 Any 消息才能根据一个 url 和数据来还原消息</li><li>类型的引用也是基于该命名空间</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="java-1">Java<a class="hash-link" href="#java-1" title="Direct link to heading">​</a></h3><ul><li>服务端支持 Netty</li><li>客户端支持 OkHttp 和 Netty</li><li>传输层解析出请求的方法<ul><li>方法名实际包含了请求类 <code>foo.bar.Greeter/SayHello</code></li></ul></li><li>实际方法触发位置为 <code>io.grpc.ServerCall.Listener</code> 的不同实现</li><li><code>ServerServiceDefinition</code><ul><li>服务定义</li></ul></li><li><code>ServiceDescriptor</code><ul><li>服务描述</li></ul></li><li><code>MethodDescriptor</code><ul><li>方法描述</li><li>类型<ul><li>UNARY - 请求 -&gt; 响应</li><li>CLIENT_STREAMING - 流请求 -&gt; 响应</li><li>SERVER_STREAMING - 请求 -&gt; 流响应</li><li>BIDI_STREAMING - 流请求 -&gt; 流响应</li></ul></li></ul></li><li><code>HandlerRegistry</code><ul><li>服务注册中心</li></ul></li><li><code>ServerInterceptor</code><ul><li>服务端拦截器</li><li>常见用例<ul><li>授权认证</li><li>日志监控</li><li>代理</li></ul></li></ul></li><li><code>ServerCallHandler</code><ul><li>实际请求处理的方法</li></ul></li><li><code>Stream</code><ul><li>客户端和服务端的通讯流</li></ul></li><li><code>io.grpc.Context</code><ul><li>跨线程的处理上下文</li></ul></li><li>速度优化<ul><li>会生成 <code>MethodHandlers</code></li><li>统一方法调用</li><li>实现所有类型的方法调用接口<ul><li><code>io.grpc.stub.ServerCalls.UnaryMethod</code></li><li><code>io.grpc.stub.ServerCalls.ServerStreamingMethod</code></li><li><code>io.grpc.stub.ServerCalls.ClientStreamingMethod</code></li><li><code>io.grpc.stub.ServerCalls.BidiStreamingMethod</code></li></ul></li><li>实际调用时使用 <code>switch</code> 和事先给定的方法 id 进行请求, 避免使用反射</li></ul></li><li><code>io.grpc.Server</code><ul><li>服务端</li><li><code>InternalServer</code><ul><li>用于不同链接层实现的接口</li><li>建立新的链接时回调 <code>ServerListener#transportCreated</code></li></ul></li></ul></li><li><code>io.grpc.Status</code><ul><li>表达异常和状态</li></ul></li><li>基础<ul><li><code>Stream</code></li><li><code>StreamListener</code></li><li>基本流程<ul><li>方法 -&gt; Call -&gt; Stream</li><li>生成 Call 时会创建对应的 Feature</li><li>同步请求是循环等待 Feature 完成</li></ul></li><li>完整方法名的命名规则为<ul><li><code>完整的服务名/方法名</code></li><li><code>wener.scel.v1.Scel/Search</code></li></ul></li></ul></li><li>客户端<ul><li><code>ClientCall</code><ul><li><code>ClientCall.Listener</code><ul><li><code>onHeaders(Metadata)</code></li><li><code>onMessage(RespT)</code></li><li><code>onClose(Status,Metadata)</code></li></ul></li><li>处理流程</li><li>职责</li></ul></li><li><code>ManagedChannelBuilder</code></li><li><code>ClientTransport</code><ul><li><code>ManagedClientTransport</code><ul><li>有生命周期管理</li><li><code>ConnectionClientTransport</code><ul><li>基于链接</li><li>有属性</li></ul></li></ul></li></ul></li><li><code>ClientStream</code></li><li><code>ClientStreamListener</code></li><li>生成的客户端分为三种类型<ul><li>Stub<ul><li>有所有的方法</li><li>响应均为 <code>io.grpc.stub.StreamObserver</code></li></ul></li><li>BlockingStub<ul><li>阻塞接口</li><li>响应为直接的对象</li><li>流响应为 Iterator</li><li>不生成流请求</li></ul></li><li>FeatureStub<ul><li>以 Feature 作为返回状态</li></ul></li></ul></li></ul></li><li>服务端<ul><li><code>ServerCall</code><ul><li>处理流程<ul><li><code>ServerStream</code> -&gt; <code>ServerStreamListener</code></li><li><code>ServerStreamListener#messageRead</code><ul><li>会对请求对象进行解析</li></ul></li><li><code>ServerCall.Listener#onMessage</code><ul><li>拦截处理在这一层发生</li><li><code>ServerCallHandler</code> 负责从 <code>ServerCall</code> 创建 <code>ServerCall.Listener</code></li><li>即实际的方法处理发生在这里</li></ul></li></ul></li><li><code>ServerCalls</code><ul><li>提供 <code>ServerCall</code> 到 <code>ServerCallHandler</code> 的适配</li><li>主要用于简化实现</li><li><code>ServerCall</code> -&gt; <code>ServerCall.Listener</code></li><li>一个方法 <code>MethodDescriptor</code> 对应一个 <code>ServerCallHandler</code></li></ul></li><li>职责<ul><li><code>ServerCall.Listener</code> 用于接收消息</li><li><code>ServerCall</code> 用于发送和向客户端请求消息</li><li><code>ServerCallHandler</code> 方法处理</li></ul></li></ul></li><li><code>ServerBuilder</code></li><li><code>ServerTransport</code></li><li><code>ServerStream</code></li><li><code>ServerStreamListener</code></li></ul></li><li>Netty<ul><li><code>NettyServerProvider</code></li><li><code>NettyChannelProvider</code></li><li><code>NettyServer</code></li><li><code>NettyServerHandler</code><ul><li>服务端 GRPC 处理</li><li>执行上下文</li></ul></li><li>服务端<ul><li><code>NettyServerTransport</code></li><li><code>NettyServerStream</code></li></ul></li><li>客户端<ul><li><code>NettyClientTransport</code></li><li><code>NettyClientStream</code></li></ul></li></ul></li></ul><p><strong>protoc --help</strong></p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ protoc --help</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Usage: protoc [OPTION] PROTO_FILES</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Parse PROTO_FILES and generate output based on the options given:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -IPATH, --proto_path=PATH   Specify the directory in which to search for</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              imports.  May be specified multiple times;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              directories will be searched in order.  If not</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              given, the current working directory is used.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --version                   Show version info and exit.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -h, --help                  Show this text and exit.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --encode=MESSAGE_TYPE       Read a text-format message of the given type</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              from standard input and write it in binary</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              to standard output.  The message type must</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              be defined in PROTO_FILES or their imports.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --decode=MESSAGE_TYPE       Read a binary message of the given type from</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              standard input and write it in text format</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              to standard output.  The message type must</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              be defined in PROTO_FILES or their imports.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --decode_raw                Read an arbitrary protocol message from</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              standard input and write the raw tag/value</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              pairs in text format to standard output.  No</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              PROTO_FILES should be given when using this</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              flag.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -oFILE,                     Writes a FileDescriptorSet (a protocol buffer,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --descriptor_set_out=FILE defined in descriptor.proto) containing all of</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              the input files to FILE.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --include_imports           When using --descriptor_set_out, also include</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              all dependencies of the input files in the</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              set, so that the set is self-contained.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --include_source_info       When using --descriptor_set_out, do not strip</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              SourceCodeInfo from the FileDescriptorProto.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              This results in vastly larger descriptors that</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              include information about the original</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              location of each decl in the source file as</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              well as surrounding comments.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --dependency_out=FILE       Write a dependency output file in the format</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              expected by make. This writes the transitive</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              set of input file paths to FILE</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --error_format=FORMAT       Set the format in which to print errors.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              FORMAT may be &#x27;gcc&#x27; (the default) or &#x27;msvs&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              (Microsoft Visual Studio format).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --print_free_field_numbers  Print the free field numbers of the messages</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              defined in the given proto files. Groups share</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              the same field number space with the parent</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              message. Extension ranges are counted as</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              occupied fields numbers.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --plugin=EXECUTABLE         Specifies a plugin executable to use.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              Normally, protoc searches the PATH for</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              plugins, but you may specify additional</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              executables not in the path using this flag.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              Additionally, EXECUTABLE may be of the form</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              NAME=PATH, in which case the given plugin name</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              is mapped to the given executable even if</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              the executable&#x27;s own name differs.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --cpp_out=OUT_DIR           Generate C++ header and source.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --csharp_out=OUT_DIR        Generate C# source file.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --java_out=OUT_DIR          Generate Java source file.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --javanano_out=OUT_DIR      Generate Java Nano source file.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --js_out=OUT_DIR            Generate JavaScript source.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --objc_out=OUT_DIR          Generate Objective C header and source.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --php_out=OUT_DIR           Generate PHP source file.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --python_out=OUT_DIR        Generate Python source file.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --ruby_out=OUT_DIR          Generate Ruby source file.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="聊天">聊天<a class="hash-link" href="#聊天" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">syntax = &quot;proto3&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// https://github.com/yafithekid/grpc-chat/blob/master/src/main/proto/rpcchat.proto</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">option java_package = &quot;com.if4031.proto&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">option objc_class_prefix = &quot;HLW&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">service ChatService {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    rpc join (JoinRequest) returns (Response);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    rpc leave (LeaveRequest) returns (Response);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    rpc send (SendRequest) returns (Response);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    rpc sendAll (SendAllRequest) returns (Response);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    rpc recvAll (RecvAllRequest) returns (ChatResponse);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">message Message {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    string nickname = 1;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    string channel = 2;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    string content = 3;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    int64 timestamp = 4;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">message Response {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    string status = 1;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    string message = 2;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">message ChatResponse {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    string status = 1;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    string message = 2;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    repeated Message chats = 3;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">message JoinRequest {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    string nickname = 1;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    string channel = 2;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">message LeaveRequest {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    string nickname = 1;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    string channel = 2;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">message SendRequest {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    string nickname = 1;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    string channel = 2;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    string message = 3;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">message SendAllRequest {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    string nickname = 1;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    string message = 2;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">message RecvAllRequest {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    string nickname = 1;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">syntax = &quot;proto3&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">service Chat {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  rpc Authorize(RequestAuthorize) returns (ResponseAuthorize);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  rpc Connect(RequestConnect) returns (stream Event);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  rpc Say(CommandSay) returns (None);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">message None {}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">message RequestAuthorize {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  string name = 1;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">message ResponseAuthorize {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  bytes session_id = 1;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">message RequestConnect {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  bytes session_id = 1;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">message CommandSay {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  bytes session_id = 1;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  string message = 2;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">message Event {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  oneof event {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    EventNone none = 1;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    EventJoin join = 2;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    EventLeave leave = 3;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    EventLog log = 4;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">message EventNone {}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">message EventJoin {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  string name = 1;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">message EventLeave {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  string name = 1;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">message EventLog {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  string name = 1;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  string message = 2;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">syntax = &quot;proto3&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">option java_package = &quot;com.chat&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">package Chat;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">service MyChat{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    rpc login (Username) returns (LoginSuccess){}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    rpc join (ChannelName) returns (IsSuccess){}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    rpc leave (ChannelName) returns (IsSuccess){}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    rpc sendMessage (Message) returns (IsSuccess) {}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    rpc broadcastMessage (BroadcastMsg) returns (IsSuccess) {}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    rpc getMessages (Username) returns (Messages) {}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">message Username {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    string username = 1;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">message LoginSuccess{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    bool success = 1;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    string username = 2;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">message ChannelName {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    string username = 1;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    string channel = 2;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">message IsSuccess {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    bool success = 1;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">message Message {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    string username = 1;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    string channel = 2;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    string msg = 3;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">message Messages {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    bool success = 1;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    repeated string messages = 2;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">message BroadcastMsg {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    string username = 1;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    string msg = 2;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="faq">FAQ<a class="hash-link" href="#faq" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="all-subconns-are-in-transientfailure">all SubConns are in TransientFailure<a class="hash-link" href="#all-subconns-are-in-transientfailure" title="Direct link to heading">​</a></h3><ul><li><a href="https://groups.google.com/forum/#!topic/grpc-io/yCUwuHycNWk" target="_blank" rel="noopener noreferrer">https://groups.google.com/forum/#!topic/grpc-io/yCUwuHycNWk</a></li><li>超时后会恢复</li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/wenerme/wener/edit/master/notes/service/api/grpc.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/notes/service/api/graphql-faq"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">GraphQL FAQ</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/notes/service/api/grpc-awesome"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">gRPC Awesome</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#note" class="table-of-contents__link toc-highlight">Note</a></li><li><a href="#docker" class="table-of-contents__link toc-highlight">Docker</a></li><li><a href="#安装" class="table-of-contents__link toc-highlight">安装</a></li><li><a href="#java" class="table-of-contents__link toc-highlight">Java</a></li><li><a href="#php" class="table-of-contents__link toc-highlight">PHP</a></li><li><a href="#node" class="table-of-contents__link toc-highlight">Node</a></li><li><a href="#golang" class="table-of-contents__link toc-highlight">Golang</a><ul><li><a href="#client" class="table-of-contents__link toc-highlight">Client</a></li><li><a href="#server" class="table-of-contents__link toc-highlight">Server</a></li></ul></li><li><a href="#web" class="table-of-contents__link toc-highlight">Web</a></li><li><a href="#typescript" class="table-of-contents__link toc-highlight">Typescript</a></li><li><a href="#grpc-gateway" class="table-of-contents__link toc-highlight">grpc-gateway</a></li><li><a href="#auth" class="table-of-contents__link toc-highlight">Auth</a></li><li><a href="#案例" class="table-of-contents__link toc-highlight">案例</a><ul><li><a href="#gcp" class="table-of-contents__link toc-highlight">GCP</a></li></ul></li><li><a href="#源码和使用分析" class="table-of-contents__link toc-highlight">源码和使用分析</a><ul><li><a href="#java-1" class="table-of-contents__link toc-highlight">Java</a></li><li><a href="#聊天" class="table-of-contents__link toc-highlight">聊天</a></li></ul></li><li><a href="#faq" class="table-of-contents__link toc-highlight">FAQ</a><ul><li><a href="#all-subconns-are-in-transientfailure" class="table-of-contents__link toc-highlight">all SubConns are in TransientFailure</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">笔记</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/notes/java">Java</a></li><li class="footer__item"><a class="footer__link-item" href="/notes/os/alpine">AlpineLinux</a></li><li class="footer__item"><a class="footer__link-item" href="/notes/devops/kubernetes">Kubernates</a></li><li class="footer__item"><a class="footer__link-item" href="/notes/voip">VoIP</a></li></ul></div><div class="col footer__col"><div class="footer__title">Projects</div><ul class="footer__items"><li class="footer__item">
              <div>
              <a class="footer__link-item" href="https://github.com/wenerme/wener">Wener</a>
              - <a class="footer__link-item" href="https://github.com/wenerme/wener/actions" title="wenerme/wener - ci">
                <img style="vertical-align: middle;opacity: .4;" src="https://github.com/wenerme/wener/workflows/Build/badge.svg">
                </a>
              </div>
              </li><li class="footer__item"><a href="https://apis.wener.me" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Wener&#x27;s Apis<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/story">Blog</a></li><li class="footer__item"><a href="https://github.com/wenerme" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://twitter.com/wenerme" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/img/wener-logo.svg" alt="Wener Site" class="themedImage_TMUO themedImage--light_4Vu1 footer__logo"><img src="/img/wener-logo.svg" alt="Wener Site" class="themedImage_TMUO themedImage--dark_uzRr footer__logo"></div><div class="footer__copyright">Copyright © 1992-2022 Wener - <img alt="cc-by-sa-4.0" src="https://mirrors.creativecommons.org/presskit/buttons/80x15/svg/by-sa.svg"> - Build @2022-01-21 20:24</div></div></div></footer></div>
<script src="/assets/js/runtime~main.9a31b6fd.js"></script>
<script src="/assets/js/main.d2805781.js"></script>
</body>
</html>