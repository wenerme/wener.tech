<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/story/rss.xml" title="Wener Live &amp; Life Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/story/atom.xml" title="Wener Live &amp; Life Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-30404720-1","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-30404720-1"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-30404720-1",{})</script>
<link rel="search" type="application/opensearchdescription+xml" title="Wener Live &amp; Life" href="/opensearch.xml">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css"><title data-react-helmet="true">Samba | Wener Live &amp; Life</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://wener.me/notes/service/file/samba"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Samba | Wener Live &amp; Life"><meta data-react-helmet="true" name="description" content="* Samba3 by Example"><meta data-react-helmet="true" property="og:description" content="* Samba3 by Example"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://wener.me/notes/service/file/samba"><link data-react-helmet="true" rel="alternate" href="https://wener.me/notes/service/file/samba" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://wener.me/notes/service/file/samba" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.1f8f45d9.css">
<link rel="preload" href="/assets/js/runtime~main.b13495bb.js" as="script">
<link rel="preload" href="/assets/js/main.2db18e17.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/wener-logo-head.svg" alt="Wener Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/wener-logo-head.svg" alt="Wener Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Wener</b></a><a class="navbar__item navbar__link" href="/notes/note">ç¬”è®°</a><a class="navbar__item navbar__link" href="/story">æ•…äº‹</a><a class="navbar__item navbar__link" href="/notes/howto/network/dns-prevent-spoofing">æŒ‡å—</a><a class="navbar__item navbar__link" href="/notes/tool/network/ip-lookup">å·¥å…·</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/wenerme/wener" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ğŸŒ</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="searchBox_1Doo"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">è‡ªæˆ‘æˆé•¿</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Java</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Web</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">è¯­è¨€</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">AlpineLinux</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Docker</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Kubernetes</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Linux</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">è™šæ‹ŸåŒ–</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">æ“ä½œç³»ç»Ÿ</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">VoIP</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">å¼€å‘</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">DevOps</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">æ•°æ®åº“</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">æ¶ˆæ¯é˜Ÿåˆ—</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">å®‰å…¨</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">æœåŠ¡</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/service-awesome">Service Awesome</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">API</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Auth</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">å†…å®¹ç®¡ç†</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">å®¢æˆ·å…³ç³»ç®¡ç†</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Office</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">æ–‡ä»¶</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/file/filebrowser">filebrowser</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/file/nextcloud">NextCloud</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/file/nextcloud-config">Nextcloud é…ç½®</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/file/nextcloud-dev">Nextcloud å¼€å‘</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/file/nextcloud-faq">Nextcloud FAQ</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/file/nextcloud-version">Nextcloud ç‰ˆæœ¬</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/notes/service/file/samba">Samba</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">å­˜å‚¨</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">ç½‘ç»œ</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">ç”µä¿¡</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">DNS</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">ä»“åº“</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Forge</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">CN</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">æ•°æ®</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/analytics/analytics-awesome">Analytics Awesome</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/analytics/matomo">Matomo</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/baas/appwrite">AppWrite</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/baas/README">Backend as a Service</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/bi/apache-superset">Apache Superset</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/bi/bi-awesome">BI Awesome</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/bi/bi-faq">BI FAQ</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/download/aria2">aria2</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/download/transmission">transmission</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/download/youtube-dl">youtube-dl</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/e-commerce/e-commerce">E-Commerce</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/email/email">é‚®ä»¶</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/im/im-awesome">IM Awesome</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/im/zulip">zulip</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/low-code/low-code-awesome">Low Code Awesome</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/media/avif">AVIF</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/media/butteraugli">butteraugli</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/media/ffmpeg">ffmpeg</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/media/jpeg-xl">JPEG XL</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/media/m3u8">M3U8</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/media/media-awesome">Media Awesome</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/media/media-faq">Media FAQ</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/media/minidlna">MiniDLNA</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/media/mpv">mpv</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/media/vips">vips</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/p2p/p2p-awesome">P2P Awesome</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/p2p/torrent-awesome">Torrent Awesome</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/printing/printing-awesome">Printing Awesome</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/realtime/realtime-awesome">RealTime Awesome</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/resource/resource-awesome">èµ„æºç«™</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/selfhost/bitwarden">bitwarden</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/selfhost/photoprism">PhotoPrism</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/selfhost/selfhost-awesome">Selfhost Awesome</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/selfhost/stash">stash</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/torrent/glossary">Torrent è¯æ±‡</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/workflow/cadance">Cadence</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/workflow/flogo">flogo</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/workflow/n8n">n8n</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/workflow/workflow-awesome">Flow Awesome</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">è¿ç»´</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">æŒ‡å—</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">ç¡¬ä»¶</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">ç®—æ³•</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">å¥åº·</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">å‚è€ƒ</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">å·¥å…·</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Samba</h1></header><ul><li><a href="https://www.samba.org/samba/docs/Samba3-ByExample.pdf" target="_blank" rel="noopener noreferrer">Samba3 by Example</a></li><li><a href="https://www.samba.org/samba/docs/Samba3-HOWTO.pdf" target="_blank" rel="noopener noreferrer">Samba3 How to</a></li><li><a href="https://en.wikipedia.org/wiki/Server_Message_Block" target="_blank" rel="noopener noreferrer">Server Message Block</a></li><li><a href="https://en.wikipedia.org/wiki/CIFSD" target="_blank" rel="noopener noreferrer">CIFSD</a> - in-kernel CIFS/SMB server<ul><li><a href="https://github.com/namjaejeon/cifsd" target="_blank" rel="noopener noreferrer">namjaejeon/cifsd</a></li></ul></li><li>Wikipedia <a href="https://en.wikipedia.org/wiki/Samba_(software)" target="_blank" rel="noopener noreferrer">Samba</a></li><li>æ·»åŠ çš„ç”¨æˆ·åå¿…é¡»è¦å…ˆå­˜åœ¨äºç³»ç»Ÿä¸­,å³éœ€è¦å…ˆ <code>useradd</code></li><li>ç¦ç”¨æ‰“å°æœºæœåŠ¡</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ini"><pre tabindex="0" class="prism-code language-ini codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">load printers = no</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">printing = bsd</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">printcap name = /dev/null</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ul><li>å…è®¸è®¿å®¢ç™»é™†<ul><li><code>guest ok = yes</code></li><li><code>smbclient  //127.0.0.1/public -U guest</code></li></ul></li><li>smb.conf<ul><li><a href="https://www.samba.org/samba/docs/using_samba/ch06.html" target="_blank" rel="noopener noreferrer">Using samba ch06</a></li><li>man <a href="https://www.samba.org/samba/docs/man/manpages/smb.conf.5.html" target="_blank" rel="noopener noreferrer">smb.conf</a></li></ul></li><li>é»˜è®¤ç«¯å£<ul><li>137 netbios-ns NETBIOS Name Service</li><li>138 netbios-dgm NETBIOS Datagram Service</li><li>139/udp/tcp netbios-ssn NETBIOS Session Service</li><li>445/tcp NetBIOS was moved to 445 after 2000 and beyond, (CIFS)</li></ul></li><li>ç›¸å…³ç«¯å£<ul><li>901 SWAT service (not related to client communication)</li><li>445 microsoft-ds åŸŸæ§</li></ul></li><li>ç»„ä»¶<ul><li>smbd</li><li>nmbd</li></ul></li><li>å·¥å…·<ul><li>smbstatus - æŸ¥çœ‹æœåŠ¡çŠ¶æ€<ul><li>å½“å‰æ–‡ä»¶é”</li></ul></li><li>eventlogadm</li></ul></li><li>samba-dc<ul><li>samba-tool</li><li>samba - gpupdate dnsupdate downgrade_db kcc spnupdate upgradedns</li></ul></li><li>samba-winbind<ul><li>winbindd</li></ul></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># å¸¦ samba çš„é•œåƒ</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run --rm -it -p </span><span class="token number" style="color:rgb(247, 140, 108)">139</span><span class="token plain">:139 -p </span><span class="token number" style="color:rgb(247, 140, 108)">445</span><span class="token plain">:445 -v </span><span class="token environment constant" style="color:rgb(130, 170, 255)">$PWD</span><span class="token plain">:/share -w /share wener/samba </span><span class="token function" style="color:rgb(130, 170, 255)">sh</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># æˆ–è€… APK å®‰è£…</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">apk </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> samba samba-dc</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Linux</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">mount</span><span class="token plain"> -t cifs -o </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">username</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">username,password</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">password,uid</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">33</span><span class="token plain">,gid</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">33</span><span class="token plain">,rw,nounix,iocharset</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">utf8,file_mode</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">0777,dir_mode</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">0777 //192.168.1.120/storage /mnt/storage</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">mount</span><span class="token plain"> -t cifs -o </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">credentials</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">/root/.the-creds-file,uid</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">33</span><span class="token plain">,gid</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">33</span><span class="token plain">,rw,nounix,iocharset</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">utf8,file_mode</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">0777,dir_mode</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">0777 //192.168.1.120/storage /mnt/storage</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># this-creds-file</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># username=winuser</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># password=winpass</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># fstab</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># //192.168.1.120/storage /mnt/storage        cifs    credentials=/root/.smbcredentials,uid=33,gid=33,rw,nounix,iocharset=utf8,file_mode=0777,dir_mode=0777 0 0</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Windows</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">net use Z: </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain">computer_name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain">share_name /PERSISTENT:YES</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># æ–­å¼€è¿æ¥</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">net use  Z: /delete</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">smbcontrol all reload-config</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># killall -HUP smbd nmbd</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="quick-start"></a>Quick start<a class="hash-link" href="#quick-start" title="Direct link to heading">#</a></h2><ul><li>guest éœ€è¦ <code>map to guest = Bad User</code></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Debian: apt-get install samba samba-client</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">mkdir</span><span class="token plain"> -p ~/temp/share </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;&amp;</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">cd</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$_</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">mkdir</span><span class="token plain"> private state usershare public</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">chmod</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">755</span><span class="token plain"> public</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">cat</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;&lt;</span><span class="token string" style="color:rgb(195, 232, 141)">CONF</span><span class="token string bash punctuation" style="color:rgb(199, 146, 234)"> </span><span class="token string bash punctuation operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token string bash punctuation" style="color:rgb(199, 146, 234)"> smbd.ini</span><span class="token string" style="color:rgb(195, 232, 141)"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">[global]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">log file = </span><span class="token string environment constant" style="color:rgb(130, 170, 255)">$PWD</span><span class="token string" style="color:rgb(195, 232, 141)">/log.%m</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">idmap config * : backend = tdb</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">state directory = </span><span class="token string environment constant" style="color:rgb(130, 170, 255)">$PWD</span><span class="token string" style="color:rgb(195, 232, 141)">/state</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">usershare path = </span><span class="token string environment constant" style="color:rgb(130, 170, 255)">$PWD</span><span class="token string" style="color:rgb(195, 232, 141)">/usershare</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">private dir = </span><span class="token string environment constant" style="color:rgb(130, 170, 255)">$PWD</span><span class="token string" style="color:rgb(195, 232, 141)">/private</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">smb passwd file = </span><span class="token string environment constant" style="color:rgb(130, 170, 255)">$PWD</span><span class="token string" style="color:rgb(195, 232, 141)">/private/smbpasswd</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="display:inline-block;color:rgb(195, 232, 141)">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">[public]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">comment = Public share</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">path = </span><span class="token string environment constant" style="color:rgb(130, 170, 255)">$PWD</span><span class="token string" style="color:rgb(195, 232, 141)">/public</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">valid users = wener</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">read only = No</span></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">CONF</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># æ–°å»ºç”¨æˆ·, å¯†ç ä¸éœ€è¦å’Œç³»ç»Ÿå¯†ç ç›¸åŒ, ä½†éœ€è¦å­˜åœ¨è¯¥ç”¨æˆ·</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># -s /sbin/nologin -d /dev/null</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># é»˜è®¤ state è·¯å¾„ä¸º /var/lib/samba/ åç«¯é»˜è®¤ä¸º tdb</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">adduser wener -DH</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">smbpasswd -L -c smbd.ini -a wener</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># æ£€æµ‹é…ç½®æ­£ç¡®</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">testparm smbd.ini</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># è¾“å‡ºæœ€ç»ˆé…ç½®</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">testparm -v smbd.ini</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># å¯åŠ¨æœåŠ¡</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">smbd -s smbd.ini</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># ä¾‹ä¸¾æ‰€æœ‰å…±äº«</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">smbclient  -L //127.0.0.1/public -U wener</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># è¿æ¥</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">smbclient  //127.0.0.1/public -U wener</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Linux: smb://&lt;HOST_IP_OR_NAME&gt;/&lt;folder_name&gt;/</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Windows: \\&lt;HOST_IP_OR_NAME&gt;\&lt;folder_name&gt;\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># æŒ‚è½½ smb, ä¿®æ”¹å¯†ç ä¸ºä¹‹å‰è¾“å…¥çš„å¯†ç </span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">mount</span><span class="token plain"> -t smbfs //wener:wener@localhost/public ~/mnt/smb/</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">mount</span><span class="token plain"> â€“t smbfs //localhost/public ~/mnt/smb/ â€“o </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">username</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">wener</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">mount</span><span class="token plain"> -t cifs -o </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">user</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">luke //192.168.1.1/share /mnt</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><a href="https://www.samba.org/samba/docs/current/man-html/smb.conf.5.html" target="_blank" rel="noopener noreferrer">https://www.samba.org/samba/docs/current/man-html/smb.conf.5.html</a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="smbconf"></a>smb.conf<a class="hash-link" href="#smbconf" title="Direct link to heading">#</a></h2><ul><li><a href="https://www.samba.org/samba/docs/current/man-html/smb.conf.5.html" target="_blank" rel="noopener noreferrer">smb.conf.5</a></li><li>ç‰¹æ®Š section<ul><li>global<ul><li>å…¨å±€é…ç½®æˆ–é»˜è®¤é…ç½®</li></ul></li><li>homes<ul><li>å¦‚æœé…ç½®äº†ï¼Œåˆ™æ”¯æŒè‡ªåŠ¨åˆ›å»º HOME ç›®å½•</li><li><code>%S</code> ç”¨æˆ·å® <code>path = /data/users/%S</code></li></ul></li><li>printers<ul><li>ç±»ä¼¼äº homesï¼Œä½†æ˜¯ç”¨äºæ‰“å°æœº</li></ul></li></ul></li></ul><p>tdb (idmap_tdb(8)), tdb2 (idmap_tdb2(8)), ldap (idmap_ldap(8)), rid (idmap_rid(8)), hash (idmap_hash(8)), autorid (idmap_autorid(8)), ad (idmap_ad(8)), nss (idmap_nss(8)), and rfc2307 (idmap_rfc2307(8)).</p><p>idmap_tdb
Samba&#x27;s idmap_tdb Backend for Winbind</p><p>The idmap_tdb plugin is the default backend used by winbindd for storing SID/uid/gid mapping tables.</p><p>In contrast to read only backends like idmap_rid, it is an allocating backend: This means that it needs to allocate new user and group IDs in order to create new mappings.</p><p>range = low - high
Defines the available matching uid and gid range for which the backend is authoritative.</p><p>idmap_tdb2 â€” Samba&#x27;s idmap_tdb2 Backend for Winbind
The idmap_tdb2 plugin is a substitute for the default idmap_tdb backend used by winbindd for storing SID/uid/gid mapping tables in clustered environments with Samba and CTDB.</p><p>script
This option can be used to configure an external program for performing id mappings instead of using the tdb counter. The mappings are then stored int tdb2 idmap database. For details see the section on IDMAP SCRIPT below.</p><p>idmap config * : script = /usr/local/samba/bin/idmap_script.sh</p><p>ä¸å»ºè®®ä½¿ç”¨ hash</p><p>The idmap_ad plugin provides a way for Winbind to read id mappings from an AD server that uses RFC2307/SFU schema extensions.</p><p>&quot;map to guest = Bad User&quot; will reject a user if that user is in the server&#x27;s samba password database but has the wrong password. But if the client user name doesn&#x27;t exist in the samba password database he is converted to the guest account and then it&#x27;s up to a given share definition to determine if he can gain access.</p><p>&quot;map to guest = Never&quot; makes the exact same comparison to the database but if it doesn&#x27;t find that user it doesn&#x27;t convert the user to the guest account it just rejects him and that user isn&#x27;t even allowed to view the share list.</p><p>Don&#x27;t pass a username and the &quot;map to guest&quot; logic is never used at the browse level and that&#x27;s what a Linux client does unless you force it..</p><p>Starting with v4.0, Samba is (or can be):</p><p>a file server
a DNS server
an LDAP server
a Kerberos server
an AD server</p><p><a href="https://wiki.samba.org/index.php/Setting_up_Samba_as_an_Active_Directory_Domain_Controller" target="_blank" rel="noopener noreferrer">https://wiki.samba.org/index.php/Setting_up_Samba_as_an_Active_Directory_Domain_Controller</a></p><p>Create an Active Directory Infrastructure with Samba4 on Ubuntu
<a href="https://www.tecmint.com/install-samba4-active-directory-ubuntu/" target="_blank" rel="noopener noreferrer">https://www.tecmint.com/install-samba4-active-directory-ubuntu/</a></p><p>Windows 7 Service Pack 1 (SP1) è¿œç¨‹æœåŠ¡å™¨ç®¡ç†å·¥å…·
<a href="https://www.microsoft.com/zh-cn/download/details.aspx?id=7887" target="_blank" rel="noopener noreferrer">https://www.microsoft.com/zh-cn/download/details.aspx?id=7887</a></p><p>Alpine Linux based container (aka Docker) for Samba 4 Active Directory
<a href="https://github.com/tkaefer/alpine-samba-ad-container" target="_blank" rel="noopener noreferrer">https://github.com/tkaefer/alpine-samba-ad-container</a></p><p><a href="https://github.com/dperson/samba" target="_blank" rel="noopener noreferrer">https://github.com/dperson/samba</a></p><p><a href="https://github.com/cptactionhank/docker-netatalk" target="_blank" rel="noopener noreferrer">https://github.com/cptactionhank/docker-netatalk</a></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ini"><pre tabindex="0" class="prism-code language-ini codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># å…¨å±€é…ç½®</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># å…¶ä»– sestion çš„é»˜è®¤é…ç½®</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[global]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">security = domain</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">workgroup = MAIN</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">state directory = ${prefix}/var/locks</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">usershare path = ${prefix}/var/locks/usershares</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># æœåŠ¡è¿”å›ä¿¡æ¯</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">server string = server %h</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># ä¸èµ·ååŒ¿å</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">map to guest = never</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">idmap config * : backend        = tdb</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">idmap config * : range          = 1000000-1999999</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">idmap config MAIN : backend     = rid</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">idmap config MAIN : range       = 5000000-5999999</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">idmap config TRUSTED : backend  = rid</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">idmap config TRUSTED : range    = 6000000-6999999</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># æœåŠ¡ä¼šåœ¨é“¾æ¥æ˜¯åˆ›å»ºä¸»ç›®å½•</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[homes]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">path = /data/pchome/%S</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># å’Œ [homes] ç±»ä¼¼, ä½†æ˜¯é’ˆå¯¹æ‰“å°æœºçš„</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[printers]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">path = /usr/spool/public</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">guest ok = yes</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">printable = yes</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[foo]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># å¤‡æ³¨</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">comment = Public share</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># è·¯å¾„</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">path = /data/share/public</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># ç”¨æˆ·</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">valid users = wener</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># æ˜¯å¦åªè¯»</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">read only = No</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>socket options = TCP_NODELAY IPTOS_LOWDELAY SO_RCVBUF=65536 SO_SNDBUF=65536</p><p>docker run --rm -it --cap-add SYS_ADMIN --cap-add DAC_READ_SEARCH -v $PWD:/share -w /share wener/samba sh</p><p>mount -t cifs //10.88.2.202/share $PWD/mnt -o user=user,password=pass</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ini"><pre tabindex="0" class="prism-code language-ini codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[global]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">workgroup = MYGROUP</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">server string = Samba Server</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">server role = standalone server</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">log file = /usr/local/samba/var/log.%m</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max log size = 50</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">dns proxy = no</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">idmap config * : backend = tdb</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">hosts allow = 192.168.0.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[public]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">comment = Public share</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">path = /data/share</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">read only = No</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">valid users = share</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">browsable = yes</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">writable = yes</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">create mask = 0775</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">directory mask = 0755</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="smbd---help"></a>smbd --help<a class="hash-link" href="#smbd---help" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Usage: smbd [OPTION...]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -D, --daemon                            Become a daemon (default)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -i, --interactive                       Run interactive (not a daemon) and log to stdout</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -F, --foreground                        Run daemon in foreground (for daemontools, etc.)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      --no-process-group                  Don&#x27;t create a new process group</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -S, --log-stdout                        Log to stdout</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -b, --build-options                     Print build options</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -p, --port=STRING                       Listen on the specified ports</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -P, --profiling-level=PROFILE_LEVEL     Set profiling level</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Help options:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -?, --help                              Show this help message</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      --usage                             Display brief usage message</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Common samba options:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -d, --debuglevel=DEBUGLEVEL             Set debug level</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -s, --configfile=CONFIGFILE             Use alternate configuration file</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -l, --log-basename=LOGFILEBASE          Base name for log files</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -V, --version                           Print version</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      --option=name=value                 Set smb.conf option from command line</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="faq"></a>FAQ<a class="hash-link" href="#faq" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="nt_status_bad_network_name"></a>NT_STATUS_BAD_NETWORK_NAME<a class="hash-link" href="#nt_status_bad_network_name" title="Direct link to heading">#</a></h3><p>å¯èƒ½æ˜¯å› ä¸ºç›®å½•æ²¡æœ‰æƒé™</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="macos-ä¸‹æ— æ³•ä½¿ç”¨"></a>MacOS ä¸‹æ— æ³•ä½¿ç”¨<a class="hash-link" href="#macos-ä¸‹æ— æ³•ä½¿ç”¨" title="Direct link to heading">#</a></h3><p><a href="https://community.spiceworks.com/topic/2085366-can-samba-active-directory-and-afp-run-simultaneously" target="_blank" rel="noopener noreferrer">https://community.spiceworks.com/topic/2085366-can-samba-active-directory-and-afp-run-simultaneously</a></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="nt_status_invalid_network_response"></a>NT_STATUS_INVALID_NETWORK_RESPONSE<a class="hash-link" href="#nt_status_invalid_network_response" title="Direct link to heading">#</a></h3><p>å¯èƒ½æ˜¯ min protocol å¯¼è‡´çš„
<a href="https://www.linuxquestions.org/questions/linux-networking-3/samba-min-protocol-%3D-smb2-causes-protocol-negotiation-failed-nt_status_invalid_network_response-4175597669/" target="_blank" rel="noopener noreferrer">https://www.linuxquestions.org/questions/linux-networking-3/samba-min-protocol-%3D-smb2-causes-protocol-negotiation-failed-nt_status_invalid_network_response-4175597669/</a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="ntlmv1-nt_status_wrong_password"></a>NTLMv1 NT_STATUS_WRONG_PASSWORD<a class="hash-link" href="#ntlmv1-nt_status_wrong_password" title="Direct link to heading">#</a></h2><ul><li>Samba é»˜è®¤åªå…è®¸ NTLMv2<ul><li>ä¿®æ”¹ä¸ºå…è®¸ v1 <code>ntlm auth = ntlmv1-permitted</code></li></ul></li><li>æˆ–è€… Windows ä¿®æ”¹ä¸ºä½¿ç”¨ v2<ul><li><code>secpol.msc</code></li><li>NTLMv2 response only/refuse LM and NTLM.</li></ul></li><li>Windows 7 å¼€å§‹é»˜è®¤ NTLMv2 ä½†æœ‰å¯èƒ½å¼€å¯å…±äº«æ—¶è¢«é…ç½®æˆäº† v1</li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/wenerme/wener/edit/master/notes/service/file/samba.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/notes/service/file/nextcloud-version"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Nextcloud ç‰ˆæœ¬</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/notes/service/storage/storage-awesome"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Storage Awesome Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#quick-start" class="table-of-contents__link">Quick start</a></li><li><a href="#smbconf" class="table-of-contents__link">smb.conf</a></li><li><a href="#smbd---help" class="table-of-contents__link">smbd --help</a></li><li><a href="#faq" class="table-of-contents__link">FAQ</a><ul><li><a href="#nt_status_bad_network_name" class="table-of-contents__link">NT_STATUS_BAD_NETWORK_NAME</a></li><li><a href="#macos-ä¸‹æ— æ³•ä½¿ç”¨" class="table-of-contents__link">MacOS ä¸‹æ— æ³•ä½¿ç”¨</a></li><li><a href="#nt_status_invalid_network_response" class="table-of-contents__link">NT_STATUS_INVALID_NETWORK_RESPONSE</a></li></ul></li><li><a href="#ntlmv1-nt_status_wrong_password" class="table-of-contents__link">NTLMv1 NT_STATUS_WRONG_PASSWORD</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">ç¬”è®°</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/notes/java/java">Java</a></li><li class="footer__item"><a class="footer__link-item" href="/notes/os/alpine/alpine">AlpineLinux</a></li><li class="footer__item"><a class="footer__link-item" href="/notes/devops/kubernetes/kubernetes">Kubernates</a></li><li class="footer__item"><a class="footer__link-item" href="/notes/voip/voip">VoIP</a></li></ul></div><div class="col footer__col"><div class="footer__title">Projects</div><ul class="footer__items"><li class="footer__item">
              <div>
              <a class="footer__link-item" href="https://github.com/wenerme/wener">Wener</a>
              - <a class="footer__link-item" href="https://github.com/wenerme/wener/actions" title="wenerme/wener - ci">
                <img style="vertical-align: middle;opacity: .4;" src="https://github.com/wenerme/wener/workflows/Build/badge.svg">
                </a>
              </div>
              </li><li class="footer__item"><a href="https://apis.wener.me" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Wener&#x27;s Apis<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/story">Blog</a></li><li class="footer__item"><a href="https://github.com/wenerme" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://twitter.com/wenerme" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/img/wener-logo.svg" alt="Wener Site" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="/img/wener-logo.svg" alt="Wener Site" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></div><div class="footer__copyright">Copyright Â© 1992-2021 Wener - <img alt="cc-by-sa-4.0" src="https://mirrors.creativecommons.org/presskit/buttons/80x15/svg/by-sa.svg"> - Build @2021-10-15 00:16</div></div></div></footer></div>
<script src="/assets/js/runtime~main.b13495bb.js"></script>
<script src="/assets/js/main.2db18e17.js"></script>
</body>
</html>