<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-service/auth/ldap/openldap">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.1">
<link rel="alternate" type="application/rss+xml" href="/story/rss.xml" title="Wener Live &amp; Life RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/story/atom.xml" title="Wener Live &amp; Life Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-30404720-1","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-30404720-1"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-30404720-1",{})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Wener Live &amp; Life" href="/opensearch.xml">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css"><title data-rh="true">OpenLDAP | Wener Live &amp; Life</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://wener.me/notes/service/auth/ldap/openldap"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="OpenLDAP | Wener Live &amp; Life"><meta data-rh="true" name="description" content="- openldap/openldap"><meta data-rh="true" property="og:description" content="- openldap/openldap"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://wener.me/notes/service/auth/ldap/openldap"><link data-rh="true" rel="alternate" href="https://wener.me/notes/service/auth/ldap/openldap" hreflang="en"><link data-rh="true" rel="alternate" href="https://wener.me/notes/service/auth/ldap/openldap" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://37P8DMWBKF-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.a5b87add.css">
<link rel="preload" href="/assets/js/runtime~main.07b4d16f.js" as="script">
<link rel="preload" href="/assets/js/main.92dfd685.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_WawS">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/wener-logo-head.svg" alt="Wener Logo" class="themedImage_sWQn themedImage--light_HlbN"><img src="/img/wener-logo-head.svg" alt="Wener Logo" class="themedImage_sWQn themedImage--dark__4Lo"></div><b class="navbar__title text--truncate">Wener</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/notes">笔记</a><a class="navbar__item navbar__link" href="/story">故事</a><a class="navbar__item navbar__link" href="/notes/howto/network/dns-prevent-spoofing">指南</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/wenerme/wener" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_pUOn"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_N_jk colorModeToggle_wwB5"><button class="clean-btn toggleButton_gcuK toggleButtonDisabled_AJhd" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_Eiwc"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_a3UO"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_Ymm7"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_uXRe docsWrapper_AGYY"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_aXSw" type="button"></button><div class="docPage_Q_rn"><aside class="theme-doc-sidebar-container docSidebarContainer_GlFK"><div class="sidebar_ogDj"><nav class="menu thin-scrollbar menu_fqy9"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes">笔记</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/notes/algorithm">算法</a><button aria-label="Toggle the collapsible sidebar category &#x27;算法&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/notes/blockchain">区块链</a><button aria-label="Toggle the collapsible sidebar category &#x27;区块链&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/notes/culture/anime/anime-awesome">culture</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/notes/db">数据库</a><button aria-label="Toggle the collapsible sidebar category &#x27;数据库&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/notes/design/ip">design</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/notes/dev/build/bazel">dev</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/notes/devops">DevOps</a><button aria-label="Toggle the collapsible sidebar category &#x27;DevOps&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/notes/economics">经济学</a><button aria-label="Toggle the collapsible sidebar category &#x27;经济学&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/notes/elastic/elasticsearch-v2">elastic</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/notes/electrical/multimeter">electrical</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/notes/embedded/embedded-awesome">embedded</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/notes/evolve">自我成长</a><button aria-label="Toggle the collapsible sidebar category &#x27;自我成长&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/notes/game/mhr">game</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/notes/hardware/arm">hardware</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/notes/healthcare">健康</a><button aria-label="Toggle the collapsible sidebar category &#x27;健康&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/notes/howto/network/dns-prevent-spoofing">howto</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/notes/java">Java</a><button aria-label="Toggle the collapsible sidebar category &#x27;Java&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/notes/languages">语言</a><button aria-label="Toggle the collapsible sidebar category &#x27;语言&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/notes/mgmt/pm-awesome">mgmt</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/notes/network/application/dns">network</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/notes/ops/admin/augeas">ops</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/notes/os/alpine">os</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/notes/photography/camera-awesome">photography</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/notes/platform">平台</a><button aria-label="Toggle the collapsible sidebar category &#x27;平台&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/notes/queue">Queue</a><button aria-label="Toggle the collapsible sidebar category &#x27;Queue&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/notes/reference/cook/glossary">reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/notes/security/acme-awesome">security</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/notes/service/analytics/analytics-awesome">service</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/notes/service/analytics/analytics-awesome">analytics</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/notes/service/api/api-awesome">api</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/notes/service/auth">Auth</a><button aria-label="Toggle the collapsible sidebar category &#x27;Auth&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/auth/auth-awesome">Auth Awesome</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/auth/auth-faq">认证授权常见问题</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/auth/auth-glossary">词汇</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/auth/auth-protocol">协议</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/notes/service/auth/authn/2fa">authn</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/notes/service/auth/authz/casbin">authz</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/auth/dex">Dex</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/auth/hydra">Hydra</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/notes/service/auth/kerberos">Kerberos</a><button aria-label="Toggle the collapsible sidebar category &#x27;Kerberos&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/notes/service/auth/keycloak">Keycloak</a><button aria-label="Toggle the collapsible sidebar category &#x27;Keycloak&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/auth/kratos">Kratos</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/notes/service/auth/ldap">LADP</a><button aria-label="Toggle the collapsible sidebar category &#x27;LADP&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/auth/ldap/apacheds-kerberos">ApacheDS Kerberos</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/auth/ldap/apacheds-ops">ApacheDS 运维</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/auth/ldap/apacheds">Apache Directory</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/auth/ldap/ldap-awesome">LDAP Awesome</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/auth/ldap/ldap-cli">LDAP Command line</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/auth/ldap/ldap-faq">LDAP FAQ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/auth/ldap/ldap-glossary">LDAP Glossary</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/auth/ldap/ldap-ldif">LDIF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/auth/ldap/ldap-macos">LDAP on macOS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/auth/ldap/ldap-schema">LDAP Schema</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/notes/service/auth/ldap/openldap">OpenLDAP</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/notes/service/auth/oauth">OAuth</a><button aria-label="Toggle the collapsible sidebar category &#x27;OAuth&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/auth/oauth2-proxy">oauth2-proxy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/auth/ory">Ory</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/auth/saml">SAML</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/auth/sso">SSO</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/auth/uma">UMA</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/notes/service/baas">Backend as a Service</a><button aria-label="Toggle the collapsible sidebar category &#x27;Backend as a Service&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/notes/service/bi/apache-superset">bi</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/notes/service/cms">CMS 概览</a><button aria-label="Toggle the collapsible sidebar category &#x27;CMS 概览&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/notes/service/cn">CN</a><button aria-label="Toggle the collapsible sidebar category &#x27;CN&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/notes/service/collaboration">协同软件</a><button aria-label="Toggle the collapsible sidebar category &#x27;协同软件&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/notes/service/crm/crm-awesome">crm</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/notes/service/data">数据</a><button aria-label="Toggle the collapsible sidebar category &#x27;数据&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/notes/service/dns">DNS Service</a><button aria-label="Toggle the collapsible sidebar category &#x27;DNS Service&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/notes/service/download">下载器</a><button aria-label="Toggle the collapsible sidebar category &#x27;下载器&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/e-commerce">E-Commerce</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/notes/service/email">EMail</a><button aria-label="Toggle the collapsible sidebar category &#x27;EMail&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/notes/service/file/filebrowser">file</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/notes/service/forge">Forge</a><button aria-label="Toggle the collapsible sidebar category &#x27;Forge&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/notes/service/forum/forum-awesome">forum</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/notes/service/im/im-awesome">im</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/notes/service/media/audio-codec">media</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/notes/service/network">网络服务</a><button aria-label="Toggle the collapsible sidebar category &#x27;网络服务&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/notion">Notion</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/notes/service/observability">可观察性</a><button aria-label="Toggle the collapsible sidebar category &#x27;可观察性&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/notes/service/office">办公套件</a><button aria-label="Toggle the collapsible sidebar category &#x27;办公套件&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/notes/service/printing/printing-awesome">printing</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/notes/service/realtime/realtime-awesome">realtime</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/notes/service/selfhost">SelfHost</a><button aria-label="Toggle the collapsible sidebar category &#x27;SelfHost&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/service-awesome">Service Awesome</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/notes/service/storage/ceph">storage</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/notes/service/telecom/device">telecom</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/notes/service/torrent">Torrent</a><button aria-label="Toggle the collapsible sidebar category &#x27;Torrent&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/notes/service/workflow">Workflow</a><button aria-label="Toggle the collapsible sidebar category &#x27;Workflow&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/notes/service/xaas/xaas-awesome">xaas</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/notes/tool">工具</a><button aria-label="Toggle the collapsible sidebar category &#x27;工具&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/notes/voip">VoIP</a><button aria-label="Toggle the collapsible sidebar category &#x27;VoIP&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/notes/web">Web</a><button aria-label="Toggle the collapsible sidebar category &#x27;Web&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_BKoE"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_EYvA"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_RaEK"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_nrhp"><div class="docItemContainer_EkVX"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_GKCt" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OL5o"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">service</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/notes/service/auth"><span itemprop="name">Auth</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/notes/service/auth/ldap"><span itemprop="name">LADP</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">OpenLDAP</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_oqr9 theme-doc-toc-mobile tocMobile_5aMT"><button type="button" class="clean-btn tocCollapsibleButton_CjyO">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>OpenLDAP</h1></header><ul><li><a href="https://github.com/openldap/openldap">openldap/openldap</a><ul><li>支持 SQL 后端 - PostgreSQL</li></ul></li><li>使用场景 - 用户联邦, 数据存储<ul><li>Linux PAM</li><li>SSH PAM</li><li>Keycloak user federation</li><li>Kerberos database</li><li>PowerDNS database</li><li>Serive user - Gitea, Gitlab, Nextcloud</li></ul></li><li>参考<ul><li><a href="https://www.openldap.org/doc/">文档</a></li><li>archlinux <a href="https://wiki.archlinux.org/index.php/OpenLDAP">OpenLDAP</a></li><li><a href="https://github.com/leenooks/phpLDAPadmin">leenooks/phpLDAPadmin</a><ul><li><a href="http://demo.phpldapadmin.org/">demo</a></li></ul></li><li><a href="https://stackoverflow.com/questions/22606811">OpenLDAP multi-tenant like ACL</a><ul><li><a href="https://www.openldap.org/faq/data/cache/1133.html">Sets in Access Controls</a></li></ul></li><li><a href="https://github.com/osixia/docker-openldap">osixia/docker-openldap</a></li><li><a href="https://github.com/jp-gouin/helm-openldap">jp-gouin/helm-openldap</a></li><li><a href="https://github.com/ltb-project/self-service-password">ltb-project/self-service-password</a><ul><li>GPLv3, PHP</li><li>change and reset password in an LDAP</li></ul></li></ul></li></ul><admonition type="caution"><ul><li>sql backend 需要自行维护 表 与 ObjectClass 的关系<ul><li>并不是直接可用 - 初期有一定工作量</li></ul></li><li>不支持 reload - 直接重启</li></ul></admonition><pre><code class="language-bash"># macOS
/usr/libexec/slapd -VVV # 自带 v2.4

brew install openldap
export PATH=&quot;/usr/local/opt/openldap/bin:$PATH&quot;
export PATH=&quot;/usr/local/opt/openldap/sbin:$PATH&quot;
/usr/local/opt/openldap/libexec/slapd -VVV # 最新版 v2.6

# AlpineLinux
apk add openldap
# 添加后端 - 生产用 sql 测试用 mdb
apk add openldap-back-sql openldap-back-mdb
# 添加 overlay - openldap-overlay-all 为所有
apk add openldap-overlay-{accesslog,memberof,otp}
apk add openldap-passwd-{pbkdf2,argon2,sha2}
# /etc/openldap/slapd.conf
service slapd checkconfig
</code></pre><h2 id="note">Note</h2><ul><li>overlay<ul><li>前后端之间的中间层</li><li>作为扩展添加其他功能</li></ul></li><li>配置<ul><li>/etc/openldap/slapd.conf</li><li>/etc/openldap/slapd.ldif</li></ul></li><li>后端 - bdb, dnssrv, hdb, ldap, mdb, meta, monitor, null, passwd, relay, shell, sock, sql</li></ul><table><thead><tr><th>cli</th><th>desc</th></tr></thead><tbody><tr><td><strong>SBIN</strong></td><td></td></tr><tr><td>slapacl</td><td>校验 slapd 目录权限</td></tr><tr><td>slapadd</td><td></td></tr><tr><td>slapauth</td><td></td></tr><tr><td>slapcat</td><td></td></tr><tr><td>slapd</td><td>独立 LDAP 守护进程</td></tr><tr><td>slapdn</td><td></td></tr><tr><td>slapindex</td><td></td></tr><tr><td>slappasswd</td><td></td></tr><tr><td>slapschema</td><td></td></tr><tr><td>slaptest</td><td></td></tr><tr><td>slapmodify</td><td></td></tr><tr><td><strong>BIN</strong></td><td></td></tr><tr><td>ldapadd</td><td></td></tr><tr><td>ldapdelete</td><td></td></tr><tr><td>ldapmodify</td><td></td></tr><tr><td>ldappasswd</td><td></td></tr><tr><td>ldapurl</td><td></td></tr><tr><td>ldapwhoami</td><td></td></tr><tr><td>ldapcompare</td><td></td></tr><tr><td>ldapexop</td><td></td></tr><tr><td>ldapmodrdn</td><td></td></tr><tr><td>ldapsearch</td><td></td></tr><tr><td>ldapvc</td><td></td></tr><tr><td><strong>MISC</strong></td><td></td></tr><tr><td>lloadd</td><td>负载均衡代理服务</td></tr></tbody></table><table><thead><tr><th>slapd</th><th>for</th></tr></thead><tbody><tr><td>-h URLs</td><td>监听</td></tr><tr><td>-u user</td><td></td></tr><tr><td>-g group</td><td></td></tr><tr><td>-r dir</td><td>chroot</td></tr><tr><td>-c cookie</td><td>cookie for syncrepl</td></tr><tr><td>-o option=value</td><td></td></tr><tr><td>-d debug-level</td><td></td></tr><tr><td>-f slapd.conf</td><td></td></tr><tr><td>-F slapd.d</td><td>ldif 配置目录</td></tr><tr><td>-T</td><td>工具</td></tr></tbody></table><ul><li>-T - acl, a/add, auth, c/cat, d/dn, i/index, p/passwd, s/schema, t/test</li><li>-h <code>ldap:/// ldaps:/// ldapi:///</code><ul><li>ldap - 默认 389</li><li>ldaps - 默认 636 - LDAP over TLS</li><li>ldapi - LDAP over IPC<ul><li>x-mod 可指定权限</li></ul></li><li>PLDAP, PLDAPS - HAProxy proxy protocol version 2</li></ul></li><li>-c cookie<ul><li>rid, sid, csn</li></ul></li><li>-o option<ul><li>slp</li></ul></li></ul><pre><code class="language-bash">slapd -d ?                 # 显示所有的 debug level
slapd -Tt -f slapd.conf    # 校验配置 - slaptest
slapd -f slapd.conf -d 255 # 启动

chown -R ldap:ldap slapd.d # 确保权限正确
# 存在 slapd.d/cn=config.ldif
slapd -F slapd.d -u ldap -g ldap # 推荐使用 ldif 配置

# 配置转换
slaptest -f slapd.conf -F slapd.d

slapcat -F /usr/local/etc/openldap/slapd.d -n0 -l extracted_config.ldif
slapadd -F /usr/local/etc/openldap/slapd.d -l updated_config.ldif

# -b DN
# -U authcID
# [attr[/access][:value]]
# 检测 wener 用户是否能读取 dc=wener,dc=me 的 name 属性
slapacl -f slapd.conf -v -U wener -b &quot;dc=wener,dc=me&quot; &quot;name/read:wener&quot;
</code></pre><h2 id="overlay">Overlay</h2><table><thead><tr><th>overlay</th><th>desc</th></tr></thead><tbody><tr><td>accesslog</td><td>存储访问日志到 DB - 也会用于 delta-syncrepl</td></tr><tr><td>auditlog</td><td>修改日志</td></tr><tr><td>chain</td><td></td></tr><tr><td>collect</td><td></td></tr><tr><td>constraint</td><td>用 regex 限定属性值</td></tr><tr><td>dds</td><td>dynamicObject,ttl</td></tr><tr><td>deref</td><td></td></tr><tr><td>dynlist</td><td></td></tr><tr><td>homedir</td><td></td></tr><tr><td>lastbind</td><td></td></tr><tr><td>memberof</td><td>维护反向分组关系</td></tr><tr><td>mqtt</td><td></td></tr><tr><td>pcache</td><td>Proxy Cache</td></tr><tr><td>ppolicy</td><td>Password Policy</td></tr><tr><td>proxycache</td><td></td></tr><tr><td>refint</td><td>Referential Integrity</td></tr><tr><td>remoteauth</td><td></td></tr><tr><td>retcode</td><td>Return Code</td></tr><tr><td>rwm</td><td>Rewrite/Remap</td></tr><tr><td>seqmod</td><td></td></tr><tr><td>sssvlv</td><td></td></tr><tr><td>syncprov</td><td>Sync Provider</td></tr><tr><td>translucent</td><td>Translucent Proxy</td></tr><tr><td>unique</td><td>唯一限定</td></tr><tr><td>valsort</td><td>Value Sorting</td></tr><tr><td><del>dyngroup</del></td><td>使用 dynlist</td></tr></tbody></table><ul><li>多个 overlay 是反序执行的</li><li>dds - Dynamic Directory Services - rfc2859<ul><li>CRP - Client Refresh Period<ul><li>刷新 ttl - ldapexop</li></ul></li></ul></li><li>memberof<ul><li>为 groupOfNames 的 member 对象生成 memberof 反向引用属性</li></ul></li><li>rwm <a href="https://www.openldap.org/software/man.cgi?query=slapo-rwm&amp;apropos=0&amp;sektion=5&amp;manpath=OpenLDAP+2.6-Release&amp;arch=default&amp;format=html">slapo-rwm</a><ul><li>为远程 ldap 或 relay 提供虚拟字段</li></ul></li><li>translucent<ul><li>存储部分代理数据的到本地</li></ul></li><li>unique<ul><li>unique_uri - <code>ldap:///ou=users,dc=example,dc=com?mail?sub?(objectClass=inetOrgPerson)</code></li></ul></li><li>valsort<ul><li>valsort-attr - <code>memberUid ou=groups,dc=wener,dc=me alpha-ascend</code></li></ul></li></ul><p><strong>refint</strong></p><ul><li>支持 rename</li><li>如果 user 被删除，对应的 member 关系也被删除</li><li>如果没有任何 member 则使用 refint_nothing</li></ul><pre><code class="language-conf">overlay refint
refint_attributes member
refint_nothing &quot;cn=admin,dc=example,dc=com&quot;
</code></pre><h3 id="dynlist">dynlist</h3><pre><code class="language-conf">overlay dynlist
# dynlist-attrset &lt;group-oc&gt; &lt;URL-ad&gt; [member-ad]
# member-ad - 存在则为 dyngroup - 需要包含 dyngroup.schema

# 将查询结果的单一属性返回
dynlist-attrset nisMailAlias labeledURI

# 将查询结果作为 member 属性返回
dynlist-attrset groupOfURLs labeledURI member
</code></pre><pre><code class="language-ldif">cn=all,ou=aliases,dc=example,dc=com
cn: all
objectClass: nisMailAlias
labeledURI: ldap:///ou=People,dc=example,dc=com?mail?one?(objectClass=inetOrgPerson)
</code></pre><ul><li>查询该对象时实际返回 labeledURI 查询结果</li></ul><h2 id="schema">Schema</h2><table><thead><tr><th>schema</th><th>note</th></tr></thead><tbody><tr><td>collective</td><td>Collective attributes (experimental)</td></tr><tr><td>corba</td><td></td></tr><tr><td>core</td><td>OpenLDAP core</td></tr><tr><td>cosine</td><td>COSINE Pilot</td></tr><tr><td>dsee</td><td>Sun DSEE</td></tr><tr><td>duaconf</td><td>Client Configuration - WIP</td></tr><tr><td>dyngroup</td><td>Dynamic Group (experimental)</td></tr><tr><td>inetorgperson</td><td>InetOrgPerson</td></tr><tr><td>java</td><td>Java Object</td></tr><tr><td>misc</td><td>Miscellaneous Schema (experimental)</td></tr><tr><td>msuser</td><td>Microsoft&#x27;s Active Directory schema for replication</td></tr><tr><td>namedobject</td><td>namedObject draft schema - WIP</td></tr><tr><td>nis</td><td>Network Information Service (experimental)</td></tr><tr><td>openldap</td><td></td></tr><tr><td>pmi</td><td>ITU X.509 PMI support (experimental)</td></tr></tbody></table><ul><li><a href="https://github.com/openldap/openldap/tree/master/contrib">https://github.com/openldap/openldap/tree/master/contrib</a><ul><li>额外模块<ul><li>passwd/pbkdf2</li><li>passwd/sha2</li></ul></li></ul></li></ul><h3 id="password">Password</h3><ul><li>argon2</li><li>pbkdf2<ul><li>PBKDF2 -&gt; PBKDF2-SHA1</li><li>PBKDF2-SHA1</li><li>PBKDF2-SHA256</li><li>PBKDF2-SHA512</li></ul></li><li>sha2<ul><li>SHA512</li><li>SHA384</li><li>SHA256</li><li>SSHA512</li><li>SSHA384</li><li>SSHA256</li><li>S 前缀 Salted</li></ul></li><li>totp - RFC 6238 Time-based One Time Passwords<ul><li>TOTP1 - SHA-1</li><li>TOTP256 - SHA-256</li><li>TOTP512 - SHA-512</li><li>TOTP1ANDPW</li><li>TOTP256ANDPW</li><li>TOTP512ANDPW<ul><li>TOTP+password</li></ul></li></ul></li><li>kerberos</li><li>netscape</li><li>apr1</li><li>radius</li></ul><pre><code class="language-txt" metastring="title=&quot;password&quot;" title="&quot;password&quot;"># password=secret salt=saltsalt
userPassword: {ARGON2}$argon2i$v=19$m=4096,t=3,p=1$c2FsdHNhbHQ$DKlexoEJUoZTmkAAC3SaMWk30El9/RvVhlqGo6afIng
</code></pre><pre><code class="language-bash"># 默认支持 SHA
slappasswd -o module-load=pw-sha2.so -h {SHA} -s secret

echo -n &quot;secret&quot; | argon2 &quot;salt&quot; -e
slappasswd -o module-load=argon2.so -h {ARGON2} -s secret

slappasswd -o module-load=pw-pbkdf2.so -h {PBKDF2} -s secret

slappasswd -o module-load=pw-sha2.so -h {SHA256} -s secret
echo -n &quot;secret&quot; | openssl dgst -sha256 -binary | openssl enc -base64
</code></pre><ul><li>passwd - <a href="https://github.com/openldap/openldap/tree/master/servers/slapd/pwmods">servers/slapd/pwmods</a></li></ul><h2 id="slapd-config">slapd-config</h2><p>使用 ldif 配置</p><ul><li>cn=config 0 olcGlobal<ul><li>olcIdleTimeout</li><li>olcLogLevel</li><li>olcReferral</li><li>cn=module<ul><li>olcModuleLoad</li><li>olcModulePath</li></ul></li><li>cn=schema - olcSchemaConfig - System schema<ul><li>olcAttributeTypes</li><li>olcObjectClasses</li><li>cn={0}core - CoreSchema<ul><li>olcAttributeTypes</li><li>olcObjectClasses</li></ul></li></ul></li><li>olcBackend</li><li>olcDatabase={1}mdb - olcBackendConfig<ul><li>index 用于区分多个同类型的不同 db<ul><li>不指定会自动创建</li></ul></li><li><code>olcAccess: to &lt;what&gt; [ by &lt;who&gt; [&lt;accesslevel&gt;] [&lt;control&gt;] ]+</code></li><li>olcReadonly</li><li>olcRootDN</li><li>olcRootPW</li><li>olcSizeLimit</li><li>olcSuffix</li><li>olcSyncrepl</li><li>olcTimeLimit: 3600</li><li>olcUpdateref</li></ul></li><li>olcDatabase=frontend<ul><li>olcAccess</li></ul></li></ul></li><li>mdb<ul><li>backend<ul><li>olcBkMdbIdlExp: 16</li></ul></li><li>database<ul><li>olcDbDirectory: /usr/local/var/openldap-data</li><li>olcDbCheckpoint: 1024 10</li><li>olcDbEnvFlags</li><li>olcDbIndex</li><li>olcDbMaxEntrySize: 0</li><li>olcDbMaxReaders: 126</li><li>olcDbMaxSize: 10485760 - 10MB</li><li>olcDbMode: 0600</li><li>olcDbMultival</li><li>olcDbRtxnsize</li><li>olcDbSearchStack: 16</li><li>olcDbNosync</li></ul></li></ul></li></ul><h3 id="基础配置">基础配置</h3><pre><code class="language-ldif">dn: cn=config
objectClass: olcGlobal
cn: config

olcArgsFile: /var/lib/openldap/run/slapd.args
olcPidFile: /var/lib/openldap/run/slapd.pid

# 模块加载
dn: cn=module,cn=config
objectClass: olcModuleList
cn: module
olcModulepath:  /usr/lib/openldap
olcModuleload:  back_mdb.so

dn: cn=schema,cn=config
objectClass: olcSchemaConfig
cn: schema

include: file:///etc/openldap/schema/core.ldif

# 前端
#
dn: olcDatabase=frontend,cn=config
objectClass: olcDatabaseConfig
objectClass: olcFrontendConfig
olcDatabase: frontend
# 访问控制策略
#   Other DSEs:
#       Allow self write access
#       Allow authenticated users read access
#       Allow anonymous users to authenticate
#
#olcAccess: to dn.base=&quot;&quot; by * read
#olcAccess: to dn.base=&quot;cn=Subschema&quot; by * read
#olcAccess: to *
#   by self write
#   by users read
#   by anonymous auth
#
# if no access controls are present, the default policy
# allows anyone and everyone to read anything but restricts
# updates to rootdn.  (e.g., &quot;access to * by * read&quot;)
#
# rootdn can always read and write EVERYTHING!
#

# 数据库配置
dn: olcDatabase=mdb,cn=config
objectClass: olcDatabaseConfig
objectClass: olcMdbConfig
olcDatabase: mdb
olcDbMaxSize: 1073741824
olcSuffix: dc=wener,dc=me
olcRootDN: cn=admin,dc=wener,dc=me
olcRootPW: secret
olcDbDirectory: /var/lib/openldap/openldap-data
olcDbIndex: objectClass eq

dn: olcDatabase=monitor,cn=config
objectClass: olcDatabaseConfig
olcDatabase: monitor
olcRootDN: cn=config
olcMonitoring: FALSE
</code></pre><h2 id="slapdconf">slapd.conf</h2><admonition type="caution"><ul><li>该配置方式已废弃，推荐使用 slapd-config 配置</li></ul></admonition><ul><li>全局配置+数据库配置</li><li>行开头为空白则为 续 行</li><li><code>backend &lt;type&gt;</code><ul><li>asyncmeta, config, dnssrv, ldap, ldif, mdb, meta, monitor, null, passwd, perl, relay, sock, sql, wt</li><li>wt - WiredTiger</li></ul></li><li><code>overlay &lt;name&gt;</code></li></ul><hr><ul><li><a href="https://www.openldap.org/doc/admin26/slapdconf2.html">https://www.openldap.org/doc/admin26/slapdconf2.html</a></li><li><a href="https://man7.org/linux/man-pages/man5/slapd.conf.5.html">https://man7.org/linux/man-pages/man5/slapd.conf.5.html</a></li></ul><h3 id="基础配置-1">基础配置</h3><pre><code class="language-conf">include     /etc/openldap/schema/core.schema

pidfile     /var/lib/openldap/run/slapd.pid
argsfile    /var/lib/openldap/run/slapd.args

# 加载模块
modulepath  /usr/lib/openldap
moduleload  back_mdb.la

attributeoptions x-hidden lang-
access to attrs=name;x-hidden by * =cs
access to attrs=userPassword  by * auth
access to * by * read

database config
# 开启后可 bind cn=config 直接修改配置 - 不过配置修改不会保存
# rootpw secret

# mdb 配置
database    mdb
maxsize     1073741824
suffix      &quot;dc=wener,dc=me&quot;
rootdn      &quot;cn=admin,dc=wener,dc=me&quot;
# 避免密码明文 - 使用 slappasswd 生成
rootpw      secret
# chmod 700
directory   /var/lib/openldap/openldap-data
# 需要维护的索引
index   objectClass eq
index cn,sn,mail pres,eq,approx,sub

database monitor
</code></pre><h2 id="backend-sql">backend sql</h2><ul><li>使用 odbc 连接</li><li>需要自行维护 表 与 ObjectClass 的关系</li></ul><pre><code class="language-ini" metastring="title=&quot;/etc/odbc.ini&quot;" title="&quot;/etc/odbc.ini&quot;">[example]
Description         = OpenLDAP back-sql
Driver              = PostgreSQL
Trace               = No
Database            = example
Servername          = localhost
UserName            = manager
Password            = secret
Port                = 5432
;Protocol            = 6.4
ReadOnly            = No
RowVersioning       = No
ShowSystemTables    = No
ShowOidColumn       = No
FakeOidIndex        = No
ConnSettings        =
</code></pre><pre><code class="language-ini" metastring="title=&quot;/etc/odbcinst.ini&quot;" title="&quot;/etc/odbcinst.ini&quot;">[PostgreSQL]
Description     = ODBC for PostgreSQL
Driver          = /usr/lib/libodbcpsql.so
Setup           = /usr/lib/libodbcpsqlS.so
FileUsage       = 1
</code></pre><pre><code class="language-conf">database    sql
suffix      &quot;o=sql,c=RU&quot;
rootdn      &quot;cn=root,o=sql,c=RU&quot;
rootpw      secret
dbname      PostgreSQL
dbuser      postgres
dbpasswd    postgres
insentry_stmt   &quot;insert into ldap_entries (id,dn,oc_map_id,parent,keyval) values ((select max(id)+1 from ldap_entries),?,?,?,?)&quot;
upper_func  &quot;upper&quot;
strcast_func    &quot;text&quot;
concat_pattern  &quot;?||?&quot;
has_ldapinfo_dn_ru  no
</code></pre><p><strong>PostgreSQL</strong></p><ul><li>ldap_oc_mappings</li><li>ldap_attr_mappings</li><li>ldap_entries</li><li>ldap_entry_objclasses</li></ul><pre><code class="language-sql">create table
  ldap_oc_mappings (
    id serial not null primary key,
    -- objectClass name
    name varchar(64) not null,
    -- 映射的表名
    keytbl varchar(64) not null,
    -- pk 列
    keycol varchar(64) not null,
    -- 创建 SQL
    create_proc varchar(255),
    -- 删除 SQL
    delete_proc varchar(255),
    expect_return int not null
  );

create table
  ldap_attr_mappings (
    id serial not null primary key,
    oc_map_id integer not null references ldap_oc_mappings(id),
    name varchar(255) not null,
    sel_expr varchar(255) not null,
    sel_expr_u varchar(255),
    from_tbls varchar(255) not null,
    join_where varchar(255),
    add_proc varchar(255),
    delete_proc varchar(255),
    param_order int not null,
    expect_return int not null
  );

create table
  ldap_entries (
    id serial not null primary key,
    dn varchar(255) not null,
    oc_map_id integer not null references ldap_oc_mappings(id),
    parent int NOT NULL,
    keyval int NOT NULL,
    UNIQUE (oc_map_id, keyval),
    UNIQUE (dn)
  );

create table
  ldap_entry_objclasses (
    entry_id integer not null references ldap_entries(id),
    oc_name varchar(64)
  );
</code></pre><ul><li><a href="https://github.com/openldap/openldap/tree/master/servers/slapd/back-sql/rdbms_depend/pgsql">https://github.com/openldap/openldap/tree/master/servers/slapd/back-sql/rdbms_depend/pgsql</a></li></ul><h2 id="backend-monitor">backend monitor</h2><ul><li>由 slapd 维护，提供系统健康信息</li><li>cn=Monitor<ul><li>cn=Backends<ul><li>monitoredInfo</li><li>cn=Backend 0</li></ul></li><li>cn=Connections<ul><li>cn=Total</li><li>cn=Current</li></ul></li><li>cn=Databases<ul><li>cn=Database 0</li></ul></li><li>cn=Listeners</li><li>cn=Overlays<ul><li>monitoredInfo</li></ul></li><li>cn=Statistics<ul><li>cn=Entries<ul><li>monitorCounter</li></ul></li></ul></li><li>cn=Threads<ul><li>cn=Max<ul><li>monitoredInfo</li></ul></li></ul></li><li>cn=Time<ul><li>cn=Current<ul><li>monitorTimestamp</li></ul></li><li>cn=Start</li></ul></li><li>cn=Waiters<ul><li>cn=Read<ul><li>monitorCounter</li></ul></li><li>cn=Write</li></ul></li></ul></li></ul><pre><code class="language-conf">database monitor
access to * by dn.exact=&quot;cn=admin,dc=wener,dc=me&quot; by * none
</code></pre><pre><code class="language-bash">ldapsearch -x -D &#x27;cn=admin,dc=wener,dc=me&#x27; -W -b &#x27;cn=Monitor&#x27; -s base 1.1
ldapsearch -x -D &#x27;cn=admin,dc=wener,dc=me&#x27; -W -b &#x27;cn=Monitor&#x27; -s base &#x27;(objectClass=*)&#x27; &#x27;*&#x27; &#x27;+&#x27;
</code></pre><h2 id="access-control">Access Control</h2><pre><code>&lt;access directive&gt; ::= to &lt;what&gt;
    [by &lt;who&gt; [&lt;access&gt;] [&lt;control&gt;] ]+
&lt;what&gt; ::= * |
    [dn[.&lt;basic-style&gt;]=&lt;regex&gt; | dn.&lt;scope-style&gt;=&lt;DN&gt;]
    [filter=&lt;ldapfilter&gt;] [attrs=&lt;attrlist&gt;]
&lt;basic-style&gt; ::= regex | exact
&lt;scope-style&gt; ::= base | one | subtree | children
&lt;attrlist&gt; ::= &lt;attr&gt; [val[.&lt;basic-style&gt;]=&lt;regex&gt;] | &lt;attr&gt; , &lt;attrlist&gt;
&lt;attr&gt; ::= &lt;attrname&gt; | entry | children
&lt;who&gt; ::= * | [anonymous | users | self
        | dn[.&lt;basic-style&gt;]=&lt;regex&gt; | dn.&lt;scope-style&gt;=&lt;DN&gt;]
    [dnattr=&lt;attrname&gt;]
    [group[/&lt;objectclass&gt;[/&lt;attrname&gt;][.&lt;basic-style&gt;]]=&lt;regex&gt;]
    [peername[.&lt;basic-style&gt;]=&lt;regex&gt;]
    [sockname[.&lt;basic-style&gt;]=&lt;regex&gt;]
    [domain[.&lt;basic-style&gt;]=&lt;regex&gt;]
    [sockurl[.&lt;basic-style&gt;]=&lt;regex&gt;]
    [set=&lt;setspec&gt;]
    [aci=&lt;attrname&gt;]
&lt;access&gt; ::= [self]{&lt;level&gt;|&lt;priv&gt;}
&lt;level&gt; ::= none | disclose | auth | compare | search | read | write | manage
&lt;priv&gt; ::= {=|+|-}{m|w|r|s|c|x|d|0}+
&lt;control&gt; ::= [stop | continue | break]
</code></pre><ul><li>what<ul><li><code>*</code></li><li><code>dn[.&lt;basic-style&gt;]=&lt;regex&gt; | dn.&lt;scope-style&gt;=&lt;DN&gt;</code><ul><li>basic-style - regex, exact</li><li>scope-style - base, one, subtree, children</li></ul></li><li><code>filter=&lt;ldapfilter&gt;] [attrs=&lt;attrlist&gt;</code></li></ul></li><li>who<ul><li><code>*</code></li><li>anonymous</li><li>users - 认证用户</li><li>self - 用户所在 entry</li><li><code>dn[.&lt;basic-style&gt;]=&lt;regex&gt; | dn.&lt;scope-style&gt;=&lt;DN&gt;]</code></li><li>dnattr=</li><li>group=</li><li>peername=</li><li>sockname=</li><li>domain=</li><li>sockurl=</li><li>set=</li><li>aci=</li></ul></li><li>access<ul><li>self</li><li>level<ul><li>none | disclose | auth | compare | search | read | write | manage</li><li>下级包含上级</li></ul></li><li>priv<ul><li><code>{=|+|-}{m|w|r|s|c|x|d|0}+</code></li></ul></li></ul></li><li>control<ul><li>stop - 默认</li><li>continue - 继续处理 who</li><li>break - 跳出当前 access 继续处理下一条</li></ul></li><li>隐含规则 <code>by * none stop</code></li></ul><p><strong>权限组合</strong></p><pre><code>access to *
    by peername.ip=&quot;127.0.0.1&quot; =w continue
    by dn.exact=&quot;cn=foo&quot; +rcsx
    by * auth
</code></pre><ul><li>127.0.0.1 权限为 <code>w</code><ul><li>如果 cn=foo 则添加更多权限</li></ul></li></ul><table><thead><tr><th>who</th><th>desc</th></tr></thead><tbody><tr><td><code>*</code></td><td>所有</td></tr><tr><td>anonymous</td><td>匿名/未授权 用户</td></tr><tr><td>users</td><td>授权用户</td></tr><tr><td>self</td><td>User associated with target entry</td></tr><tr><td><code>dn[.&lt;basic-style&gt;]=&lt;regex&gt;</code></td><td>Users matching a regular expression</td></tr><tr><td><code>dn.&lt;scope-style&gt;=&lt;DN&gt;</code></td><td>Users within scope of a DN</td></tr></tbody></table><table><thead><tr><th>level</th><th>priv</th><th>desc</th></tr></thead><tbody><tr><td>none</td><td>=0</td><td>不能访问</td></tr><tr><td>disclose</td><td>=d</td><td>needed for information disclosure on error</td></tr><tr><td>auth</td><td>=dx</td><td>需要认证 - bind</td></tr><tr><td>compare</td><td>=cdx</td><td>needed to compare</td></tr><tr><td>search</td><td>=scdx</td><td>needed to apply search filters</td></tr><tr><td>read</td><td>=rscdx</td><td>needed to read search results</td></tr><tr><td>write</td><td>=wrscdx</td><td>needed to modify/rename</td></tr><tr><td>manage</td><td>=mwrscdx</td><td>needed to manage</td></tr></tbody></table><ul><li><a href="https://www.openldap.org/faq/data/cache/454.html">https://www.openldap.org/faq/data/cache/454.html</a></li><li><a href="https://uit.stanford.edu/service/directory/aclexamples">https://uit.stanford.edu/service/directory/aclexamples</a></li></ul><h2 id="off-line">Off-line</h2><pre><code class="language-ldif">dn: dc=wener,dc=me
objectClass: dcObject
objectClass: organization
dc: wener
o: Wener&#x27;s Website
description: A blog full of notes

dn: cn=admin,dc=example,dc=com
objectClass: organizationalRole
cn: admin
description: Directory Administrator
</code></pre><pre><code class="language-bash"># 使用 directory 的 可以加
slapd -Ta -F slapd.d -l demo.ldif
</code></pre><h2 id="备份">备份</h2><pre><code class="language-bash">slapcat -f slapd.conf -b &quot;dc=example,dc=com&quot;
</code></pre><h2 id="lloadd">lloadd</h2><ul><li>负载均衡</li></ul><pre><code class="language-conf">feature proxyauthz

bindconf bindmethod=simple
        binddn=&quot;cn=Manager,dc=example,dc=com&quot;
        credentials=secret

tier roundrobin
backend-server uri=ldap://server1.example.com
              numconns=5 bindconns=5
              max-pending-ops=10 conn-max-pending=3
              retry=5000
backend-server uri=ldap://server2.example.com
              numconns=5 bindconns=5
              max-pending-ops=10 conn-max-pending=3
              retry=5000
</code></pre><h1 id="faq">FAQ</h1><h2 id="不支持-sha256-sha512">不支持 sha256, sha512</h2><pre><code>At present there is no need to change anything in the core since SHA-2 support
can be dynamically loaded. Don&#x27;t fix what isn&#x27;t broken.
</code></pre><ul><li>参考<ul><li><a href="https://www.openldap.org/lists/openldap-bugs/201205/msg00055.html">https://www.openldap.org/lists/openldap-bugs/201205/msg00055.html</a></li><li><a href="https://www.openldap.org/faq/data/cache/1467.html">https://www.openldap.org/faq/data/cache/1467.html</a></li></ul></li></ul><h2 id="no-passwd-entry-for-user-ldap">No passwd entry for user ldap</h2><pre><code class="language-bash">getent passwd ldap
</code></pre><h2 id="slapdldif">slapd.ldif</h2><p>默认只能 slapd.conf 单文件配置，可以通过一定的方式实现 ldif 配置。</p><pre><code class="language-bash">slapd -f slapd.conf.init -F slapd.d -h &#x27;ldap:// ldaps:// ldapi://&#x27;

# slapd.ldif 包含所有配置
ldapadd -Y EXTERNAL -H ldapi:// -f slapd.ldif
</code></pre><pre><code class="language-conf" metastring="title=&quot;slapd.conf.init&quot;" title="&quot;slapd.conf.init&quot;">pidfile /var/lib/openldap/run/slapd.pid

database config
# 允许通过 sock 管理
access to * by dn.base=&quot;gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth&quot; manage
</code></pre><pre><code class="language-ldif" metastring="title=&quot;slapd.ldif&quot;" title="&quot;slapd.ldif&quot;">dn: cn=module,cn=config
objectClass: olcModuleList
cn: module
olcModulePath: /usr/lib/openldap
olcModuleLoad: back_mdb.so

dn: olcDatabase=mdb,cn=config
objectClass: olcDatabaseConfig
objectClass: olcMdbConfig
olcDatabase: mdb
olcSuffix: dc=example,dc=com
olcRootDN: cn=manager,dc=example,dc=com
olcRootPW:: c2VjcmV0
olcDbDirectory: /var/lib/openldap/example.com
olcAccess: to * by dn.base=&quot;gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth&quot; manage
</code></pre><h2 id="daemon-bind7-failed-errno2-no-such-file-or-directory">daemon: bind(7) failed errno=2 (No such file or directory)</h2><pre><code class="language-bash">install -d -m 700 -o ldap -g ldap /var/lib/openldap/run
chown -R ldap:ldap /var/lib/openldap
</code></pre></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/wenerme/wener/edit/master/notes/service/auth/ldap/openldap.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_icZ1" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_IDPb"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/notes/service/auth/ldap/ldap-schema"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">LDAP Schema</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/notes/service/auth/oauth"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">OAuth</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_Rbtr thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#note" class="table-of-contents__link toc-highlight">Note</a></li><li><a href="#overlay" class="table-of-contents__link toc-highlight">Overlay</a><ul><li><a href="#dynlist" class="table-of-contents__link toc-highlight">dynlist</a></li></ul></li><li><a href="#schema" class="table-of-contents__link toc-highlight">Schema</a><ul><li><a href="#password" class="table-of-contents__link toc-highlight">Password</a></li></ul></li><li><a href="#slapd-config" class="table-of-contents__link toc-highlight">slapd-config</a><ul><li><a href="#基础配置" class="table-of-contents__link toc-highlight">基础配置</a></li></ul></li><li><a href="#slapdconf" class="table-of-contents__link toc-highlight">slapd.conf</a><ul><li><a href="#基础配置-1" class="table-of-contents__link toc-highlight">基础配置</a></li></ul></li><li><a href="#backend-sql" class="table-of-contents__link toc-highlight">backend sql</a></li><li><a href="#backend-monitor" class="table-of-contents__link toc-highlight">backend monitor</a></li><li><a href="#access-control" class="table-of-contents__link toc-highlight">Access Control</a></li><li><a href="#off-line" class="table-of-contents__link toc-highlight">Off-line</a></li><li><a href="#备份" class="table-of-contents__link toc-highlight">备份</a></li><li><a href="#lloadd" class="table-of-contents__link toc-highlight">lloadd</a></li><li><a href="#不支持-sha256-sha512" class="table-of-contents__link toc-highlight">不支持 sha256, sha512</a></li><li><a href="#no-passwd-entry-for-user-ldap" class="table-of-contents__link toc-highlight">No passwd entry for user ldap</a></li><li><a href="#slapdldif" class="table-of-contents__link toc-highlight">slapd.ldif</a></li><li><a href="#daemon-bind7-failed-errno2-no-such-file-or-directory" class="table-of-contents__link toc-highlight">daemon: bind(7) failed errno=2 (No such file or directory)</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">笔记</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/notes/java">Java</a></li><li class="footer__item"><a class="footer__link-item" href="/notes/os/alpine">AlpineLinux</a></li><li class="footer__item"><a class="footer__link-item" href="/notes/devops/kubernetes">Kubernates</a></li><li class="footer__item"><a class="footer__link-item" href="/notes/voip">VoIP</a></li></ul></div><div class="col footer__col"><div class="footer__title">Projects</div><ul class="footer__items clean-list"><li class="footer__item">
              <div>
              <a class="footer__link-item" href="https://github.com/wenerme/wener">Wener</a>
              - <a class="footer__link-item" href="https://github.com/wenerme/wener/actions" title="wenerme/wener - ci">
                <img style="vertical-align: middle;opacity: .4;" src="https://github.com/wenerme/wener/workflows/Build/badge.svg">
                </a>
              </div>
              </li><li class="footer__item"><a href="https://apis.wener.me" target="_blank" rel="noopener noreferrer" class="footer__link-item">Wener&#x27;s Apis<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_pUOn"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/story">Blog</a></li><li class="footer__item"><a href="https://github.com/wenerme" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://twitter.com/wenerme" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/img/wener-logo.svg" alt="Wener Site" class="themedImage_sWQn themedImage--light_HlbN footer__logo"><img src="/img/wener-logo.svg" alt="Wener Site" class="themedImage_sWQn themedImage--dark__4Lo footer__logo"></div><div class="footer__copyright">Copyright © 1992-2022 Wener - <img alt="cc-by-sa-4.0" src="https://mirrors.creativecommons.org/presskit/buttons/80x15/svg/by-sa.svg"> - Build @2022-09-22 04:38</div></div></div></footer></div>
<script src="/assets/js/runtime~main.07b4d16f.js"></script>
<script src="/assets/js/main.92dfd685.js"></script>
</body>
</html>