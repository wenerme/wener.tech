<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-service/storage/ceph/README">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.1">
<link rel="alternate" type="application/rss+xml" href="/story/rss.xml" title="Wener Live &amp; Life RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/story/atom.xml" title="Wener Live &amp; Life Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-30404720-1","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-30404720-1"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-30404720-1",{})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Wener Live &amp; Life" href="/opensearch.xml">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css"><title data-rh="true">Ceph | Wener Live &amp; Life</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://wener.me/notes/service/storage/ceph"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Ceph | Wener Live &amp; Life"><meta data-rh="true" name="description" content="- 适用场景"><meta data-rh="true" property="og:description" content="- 适用场景"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://wener.me/notes/service/storage/ceph"><link data-rh="true" rel="alternate" href="https://wener.me/notes/service/storage/ceph" hreflang="en"><link data-rh="true" rel="alternate" href="https://wener.me/notes/service/storage/ceph" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://37P8DMWBKF-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.a5b87add.css">
<link rel="preload" href="/assets/js/runtime~main.07b4d16f.js" as="script">
<link rel="preload" href="/assets/js/main.92dfd685.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_WawS">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/wener-logo-head.svg" alt="Wener Logo" class="themedImage_sWQn themedImage--light_HlbN"><img src="/img/wener-logo-head.svg" alt="Wener Logo" class="themedImage_sWQn themedImage--dark__4Lo"></div><b class="navbar__title text--truncate">Wener</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/notes">笔记</a><a class="navbar__item navbar__link" href="/story">故事</a><a class="navbar__item navbar__link" href="/notes/howto/network/dns-prevent-spoofing">指南</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/wenerme/wener" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_pUOn"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_N_jk colorModeToggle_wwB5"><button class="clean-btn toggleButton_gcuK toggleButtonDisabled_AJhd" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_Eiwc"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_a3UO"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_Ymm7"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_uXRe docsWrapper_AGYY"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_aXSw" type="button"></button><div class="docPage_Q_rn"><aside class="theme-doc-sidebar-container docSidebarContainer_GlFK"><div class="sidebar_ogDj"><nav class="menu thin-scrollbar menu_fqy9"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes">笔记</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/notes/algorithm">算法</a><button aria-label="Toggle the collapsible sidebar category &#x27;算法&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/notes/blockchain">区块链</a><button aria-label="Toggle the collapsible sidebar category &#x27;区块链&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/notes/culture/anime/anime-awesome">culture</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/notes/db">数据库</a><button aria-label="Toggle the collapsible sidebar category &#x27;数据库&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/notes/design/ip">design</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/notes/dev/build/bazel">dev</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/notes/devops">DevOps</a><button aria-label="Toggle the collapsible sidebar category &#x27;DevOps&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/notes/economics">经济学</a><button aria-label="Toggle the collapsible sidebar category &#x27;经济学&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/notes/elastic/elasticsearch-v2">elastic</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/notes/electrical/multimeter">electrical</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/notes/embedded/embedded-awesome">embedded</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/notes/evolve">自我成长</a><button aria-label="Toggle the collapsible sidebar category &#x27;自我成长&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/notes/game/mhr">game</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/notes/hardware/arm">hardware</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/notes/healthcare">健康</a><button aria-label="Toggle the collapsible sidebar category &#x27;健康&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/notes/howto/network/dns-prevent-spoofing">howto</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/notes/java">Java</a><button aria-label="Toggle the collapsible sidebar category &#x27;Java&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/notes/languages">语言</a><button aria-label="Toggle the collapsible sidebar category &#x27;语言&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/notes/mgmt/pm-awesome">mgmt</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/notes/network/application/dns">network</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/notes/ops/admin/augeas">ops</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/notes/os/alpine">os</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/notes/photography/camera-awesome">photography</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/notes/platform">平台</a><button aria-label="Toggle the collapsible sidebar category &#x27;平台&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/notes/queue">Queue</a><button aria-label="Toggle the collapsible sidebar category &#x27;Queue&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/notes/reference/cook/glossary">reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/notes/security/acme-awesome">security</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/notes/service/analytics/analytics-awesome">service</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/notes/service/analytics/analytics-awesome">analytics</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/notes/service/api/api-awesome">api</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/notes/service/auth">Auth</a><button aria-label="Toggle the collapsible sidebar category &#x27;Auth&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/notes/service/baas">Backend as a Service</a><button aria-label="Toggle the collapsible sidebar category &#x27;Backend as a Service&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/notes/service/bi/apache-superset">bi</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/notes/service/cms">CMS 概览</a><button aria-label="Toggle the collapsible sidebar category &#x27;CMS 概览&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/notes/service/cn">CN</a><button aria-label="Toggle the collapsible sidebar category &#x27;CN&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/notes/service/collaboration">协同软件</a><button aria-label="Toggle the collapsible sidebar category &#x27;协同软件&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/notes/service/crm/crm-awesome">crm</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/notes/service/data">数据</a><button aria-label="Toggle the collapsible sidebar category &#x27;数据&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/notes/service/dns">DNS Service</a><button aria-label="Toggle the collapsible sidebar category &#x27;DNS Service&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/notes/service/download">下载器</a><button aria-label="Toggle the collapsible sidebar category &#x27;下载器&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/e-commerce">E-Commerce</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/notes/service/email">EMail</a><button aria-label="Toggle the collapsible sidebar category &#x27;EMail&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/notes/service/file/filebrowser">file</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/notes/service/forge">Forge</a><button aria-label="Toggle the collapsible sidebar category &#x27;Forge&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/notes/service/forum/forum-awesome">forum</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/notes/service/im/im-awesome">im</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/notes/service/media/audio-codec">media</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/notes/service/network">网络服务</a><button aria-label="Toggle the collapsible sidebar category &#x27;网络服务&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/notion">Notion</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/notes/service/observability">可观察性</a><button aria-label="Toggle the collapsible sidebar category &#x27;可观察性&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/notes/service/office">办公套件</a><button aria-label="Toggle the collapsible sidebar category &#x27;办公套件&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/notes/service/printing/printing-awesome">printing</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/notes/service/realtime/realtime-awesome">realtime</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/notes/service/selfhost">SelfHost</a><button aria-label="Toggle the collapsible sidebar category &#x27;SelfHost&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/service-awesome">Service Awesome</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/notes/service/storage/ceph">storage</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible menu__list-item-collapsible--active"><a class="menu__link menu__link--sublist menu__link--active" aria-current="page" aria-expanded="true" tabindex="0" href="/notes/service/storage/ceph">Ceph</a><button aria-label="Toggle the collapsible sidebar category &#x27;Ceph&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/storage/ceph/ceph-awesome">Ceph Awesome</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/storage/ceph/ceph-conf">Ceph 配置</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/storage/ceph/ceph-glossary">Ceph 术语</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/storage/ceph/ceph-k8s">Ceph Kubernetes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/storage/ceph/ceph-ubuntu-16-install">Ubuntu 16.04 安装 Ceph</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/storage/compress-awesome">Compress</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/storage/cyberduck">cyberduck</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/storage/distributed-storage">分布式存储</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/storage/gluster">Gluster</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/storage/juicefs">juicefs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/storage/minio-acl">Minio ACL</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/storage/minio-faq">Minio FAQ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/storage/minio-operator">MinIO Operator</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/storage/minio">MinIO</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/storage/seaweedfs">seaweedfs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/storage/storage-awesome">Storage Awesome</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/storage/storage-glossary">Storage Glossary</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/storage/webdav-spec">WebDAV Spec</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/service/storage/webdav">WebDAV</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/notes/service/telecom/device">telecom</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/notes/service/torrent">Torrent</a><button aria-label="Toggle the collapsible sidebar category &#x27;Torrent&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/notes/service/workflow">Workflow</a><button aria-label="Toggle the collapsible sidebar category &#x27;Workflow&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/notes/service/xaas/xaas-awesome">xaas</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/notes/tool">工具</a><button aria-label="Toggle the collapsible sidebar category &#x27;工具&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/notes/voip">VoIP</a><button aria-label="Toggle the collapsible sidebar category &#x27;VoIP&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/notes/web">Web</a><button aria-label="Toggle the collapsible sidebar category &#x27;Web&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_BKoE"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_EYvA"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_RaEK"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_nrhp"><div class="docItemContainer_EkVX"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_GKCt" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OL5o"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">service</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">storage</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Ceph</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_oqr9 theme-doc-toc-mobile tocMobile_5aMT"><button type="button" class="clean-btn tocCollapsibleButton_CjyO">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Ceph</h1></header><ul><li>适用场景<ul><li>单独存储集群</li><li>大存储集群 - 100TB+ PB+</li></ul></li><li>不适用场景<ul><li>不太适合于直接部署到 k8s 小集群作为微服务存储使用</li><li>简单的分布式文件系统</li></ul></li><li><a href="https://github.com/ceph/ceph">ceph/ceph</a><ul><li>LGPL-2.1+LGPL-3.0, C++</li></ul></li><li>imixs <a href="https://github.com/imixs/imixs-cloud/blob/master/doc/CEPH.md">Ceph</a></li><li>默认日志路径为 <code>/var/lib/ceph/osd/$cluster-$id/journal</code>, 可将该文件挂在到其它磁盘以增加性能</li><li>Ceph 使用副本或 EC 来保护数据</li><li>CephFS 默认端口为 6789</li><li>参考<ul><li><a href="https://www.youtube.com/watch?v=VFeDB7PQHZ4">Bluestore vs. Filestore: A Functional Comparison and a Benchmark</a></li><li><a href="http://docs.ceph.com/docs/master/">文档</a></li></ul></li></ul><p><strong>最佳实践</strong></p><ul><li>每个 OSD 预留 2G 内存,每个 OSD 一个磁盘,冗余 NIC</li><li>如果有 SSD, 可将 SSD 作为日志磁盘, 使用机械盘作为存储磁盘, 如果 SSD 较少,可多个 OSD 共用一个 SSD(一个 SSD 损坏影响多个 OSD)</li><li>使用 SSD 前最好事先测试出顺序和随机读写的性能</li><li>MON 位于单独服务器, 不需要太多的 RAM 和磁盘,冗余 NIC</li><li>如果单个主机上 OSD 较多(例如 &gt;20),建议增大系统线程数 <code>kernel.pid_max = 4194303</code></li><li><a href="http://docs.ceph.com/docs/master/start/hardware-recommendations/">推荐硬件</a><ul><li>不推荐和计算集群一起部署 - k8s</li><li>ceph-mds - metadata<ul><li>4 CPU+</li><li>1GB+</li></ul></li><li>ceph-osd<ul><li>2 CPU+</li><li>默认 4GB， 2-4GB 可用，不推荐小于 2GB</li><li>小文件多建议 4GB+，大数据传输建议 256GB+</li><li>磁盘推荐 1TB+</li><li>不推荐 1硬盘 1OSD 1MSD，不推荐 1硬盘多OSD</li><li>分离 日志、数据、系统 盘</li><li>推荐使用 SSD 作为 日志 盘</li><li>确保网络带宽大于总磁盘带宽</li><li>10Gbps+ - 1T 副本 20分钟</li></ul></li><li>ceph-mgr<ul><li>1-2 GB 小集群，5-10 GB 大集群 - 随集群扩容 - 基本 1G/1T</li></ul></li><li>ceph-mon - monitor<ul><li>CPU 要求不高</li><li>1-2 GB 小集群，5-10 GB 大集群 - 同 ceph-mgr</li></ul></li></ul></li><li>参考 <a href="http://docs.ceph.com/docs/master/start/os-recommendations/">推荐操作系统</a></li></ul><table><thead><tr><th><strong>对象存储/rados</strong></th><th><strong>块设备/RBD</strong></th><th><strong>文件系统/CephFS</strong></th></tr></thead><tbody><tr><td>REST 接口</td><td>Thin-provisioned</td><td>符合 POSIX 语义</td></tr><tr><td>S3、Swift 兼容接口</td><td>16 EB</td><td>元数据数据分离</td></tr><tr><td>S3 子域名</td><td>Configurable striping</td><td>Configurable striping</td></tr><tr><td>S3、Swift 命名空间</td><td>内存缓存</td><td>动态平衡</td></tr><tr><td>用户管理</td><td>快照</td><td>子目录快照</td></tr><tr><td>使用跟踪</td><td>COW 克隆</td><td>FUSE 支持</td></tr><tr><td>Striped objects</td><td>内核驱动支持</td><td>内核驱动支持</td></tr><tr><td>云集成</td><td>KVM/libvirt 支持</td><td>可部署 NFS/CIFS</td></tr><tr><td>多站点部署</td><td>后端云方案集成</td><td>可配合 Hadoop - 替代 HDFS</td></tr><tr><td>多站点副本</td><td>增量备份</td><td></td></tr><tr><td></td><td>灾难恢复 - 多站点异步副本</td><td></td></tr></tbody></table><p><strong>所有的命令</strong></p><pre><code>ceph                   ceph-create-keys       ceph-detect-init       ceph-fuse              ceph-post-file
ceph-authtool          ceph-crush-location    ceph-disk              ceph-mds               ceph-rbdnamer
ceph-bluefs-tool       ceph-debugpack         cephfs-data-scan       ceph-mon               ceph-rest-api
ceph-clsinfo           ceph-dencoder          cephfs-journal-tool    ceph-objectstore-tool  ceph-run
ceph-conf              ceph-deploy            cephfs-table-tool      ceph-osd               ceph-syn
</code></pre><pre><code class="language-bash"># 查看磁盘类型
file -sL /dev/vda1
df -T

# XFS 测试
apt-get install xfsprogs
# 使用文件创建 xfs
truncate -s 2G data.vol
# 也可挂载为设备
# losetup /dev/loop5 data.vol

# 格式化 n 创建分区 p 主分区 w 写入
fdisk data.vol
# 格式化为 xfs
mkfs.xfs -f data.vol
# 挂载
mkdir /storage
mount -t xfs data.vol /storage
# 查看文件系统
df -Th /storage

##########
# RADOS
##########
rados mkpool data # 创建 Pool
echo Test-data &gt; testfile.txt
rados put tf.txt testfile.txt -p data # 放入文件
rados -p data ls # 查看对象
ceph osd map data tf.txt # 找到存储的对象映射

rados df # 查看使用量

rados lspools # 查看所有的 rados pool
rados -p metadata ls # 查看某个 pool 中的对象

# 获取 pg pgp 数量
ceph osd pool get data pgp_num
ceph osd pool get data pg_num
# 查看副本数量
ceph osd dump | grep size


##########
# RDB
##########
# 挂载 RBD
# 尽量使用 3.5+ 内核版本
uname -r
modprobe rbd

rbd create rbd-1
rbd info rbd-1
rbd map rbd/rbd-1
# 查看映射的设备
rbd showmapped
# 挂载文件系统
mkfs.btrfs /dev/rbd0
mkdir -p /mnt/rbd/rbd-1
mount /dev/rbd0 /mnt/rbd/rbd-1
# 然后就可以使用了
# docker run --name redis -v /mnt/rbd/rbd-1:/data -d redis redis-server --appendonly yes
# docker exec -it redis redis-cli set a 1
# docker exec -it redis redis-cli keys *
# cat /mnt/rbd/rbd-1/appendonly.aof

# 映射可能会出现由于 krbd 不支持 ceph rbd 特性的错误
# 查看 Ceph 打开的特性
ceph --show-config|grep rbd|grep features
# layering      | 1
# striping      | 2
# exclusive-lock| 3
# object-map    | 8
# fast-diff     | 16
# deep-flatten  | 32

# 关闭相关特性
rbd feature disable rbd/rbd-1 deep-flatten
rbd feature disable rbd/rbd-1 fast-diff
rbd feature disable rbd/rbd-1 object-map
rbd feature disable rbd/rbd-1 exclusive-lock
# 也可以使用
# for i in deep-flatten fast-diff object-map exclusive-lock; do rbd feature disable rbd/rbd-1 $i; done

# 可以在配置中添加 rbd_default_features = 3 以修改创建出的 rbd 特性
# 到 4.6 为止,依然只支持 1+2

# CephFS
ceph-deploy mds create ceph-node1

ceph osd pool create fs_data 128 128
ceph osd pool create fs_metadata 128 128

ceph fs new cephfs fs_data fs_metadata
ceph fs ls
ceph mds stat

mkdir -p /mnt/cfs
# 查看 secret 值
cat ceph.client.admin.keyring
mount -t ceph 地址:6789:/ /mnt/cfs -o name=admin,secret=上面的secret值
# 也可以将 secret 放在文件中
# mount -t ceph 地址:6789:/ /mnt/cfs -o name=admin,secretfile=文件路径

</code></pre><h2 id="troubleshooting">Troubleshooting</h2><ul><li>日志目录 <code>/var/log/ceph</code></li><li>Admin Socket <code>/var/run/ceph</code><ul><li>使用上述的 socket 来操作</li><li><code>ceph daemon mon.node-2 help</code></li><li><code>ceph daemon /var/run/ceph/ceph-mon.hd2-2.asok help</code></li></ul></li><li>查看 systemd 操作日志 <code>journalctl -xe</code></li><li>配置数据存储目录 <code>/var/lib/ceph/</code></li></ul><pre><code></code></pre><p><a href="http://docs.ceph.com/docs/jewel/rados/troubleshooting/troubleshooting-osd/">http://docs.ceph.com/docs/jewel/rados/troubleshooting/troubleshooting-osd/</a></p><h2 id="技术比较">技术比较</h2><h3 id="vs-hdfs">vs HDFS</h3><ul><li>HDFS<ul><li>Name Node 会造成单点,且是整个系统中的瓶颈</li></ul></li><li>Ceph<ul><li>集群为 AA 模式, 无单点</li><li>CRUSH 使得对象存储不会存在中心服务,架构中无瓶颈</li></ul></li></ul><h2 id="命令行">命令行</h2><pre><code>$ rbd create -h
usage: rbd &lt;command&gt; ...

Command-line interface for managing Ceph RBD images.

Positional arguments:
  &lt;command&gt;
    bench-write                 Simple write benchmark.
    children                    Display children of snapshot.
    clone                       Clone a snapshot into a COW child image.
    copy (cp)                   Copy src image to dest.
    create                      Create an empty image.
    diff                        Print extents that differ since a previous
                                snap, or image creation.
    disk-usage (du)             Show disk usage stats for pool, image or
                                snapshot
    export                      Export image to file.
    export-diff                 Export incremental diff to file.
    feature disable             Disable the specified image feature.
    feature enable              Enable the specified image feature.
    flatten                     Fill clone with parent data (make it
                                independent).
    image-meta get              Image metadata get the value associated with
                                the key.
    image-meta list             Image metadata list keys with values.
    image-meta remove           Image metadata remove the key and value
                                associated.
    image-meta set              Image metadata set key with value.
    import                      Import image from file.
    import-diff                 Import an incremental diff.
    info                        Show information about image size, striping,
                                etc.
    journal export              Export image journal.
    journal import              Import image journal.
    journal info                Show information about image journal.
    journal inspect             Inspect image journal for structural errors.
    journal reset               Reset image journal.
    journal status              Show status of image journal.
    list (ls)                   List rbd images.
    lock add                    Take a lock on an image.
    lock list (lock ls)         Show locks held on an image.
    lock remove (lock rm)       Release a lock on an image.
    map                         Map image to a block device using the kernel.
    merge-diff                  Merge two diff exports together.
    mirror image demote         Demote an image to non-primary for RBD
                                mirroring.
    mirror image disable        Disable RBD mirroring for an image.
    mirror image enable         Enable RBD mirroring for an image.
    mirror image promote        Promote an image to primary for RBD mirroring.
    mirror image resync         Force resync to primary image for RBD mirroring.
    mirror image status         Show RDB mirroring status for an image.
    mirror pool disable         Disable RBD mirroring by default within a pool.
    mirror pool enable          Enable RBD mirroring by default within a pool.
    mirror pool info            Show information about the pool mirroring
                                configuration.
    mirror pool peer add        Add a mirroring peer to a pool.
    mirror pool peer remove     Remove a mirroring peer from a pool.
    mirror pool peer set        Update mirroring peer settings.
    mirror pool status          Show status for all mirrored images in the pool.
    nbd list (nbd ls)           List the nbd devices already used.
    nbd map                     Map image to a nbd device.
    nbd unmap                   Unmap a nbd device.
    object-map rebuild          Rebuild an invalid object map.
    remove (rm)                 Delete an image.
    rename (mv)                 Rename image within pool.
    resize                      Resize (expand or shrink) image.
    showmapped                  Show the rbd images mapped by the kernel.
    snap create (snap add)      Create a snapshot.
    snap list (snap ls)         Dump list of image snapshots.
    snap protect                Prevent a snapshot from being deleted.
    snap purge                  Deletes all snapshots.
    snap remove (snap rm)       Deletes a snapshot.
    snap rename                 Rename a snapshot.
    snap rollback (snap revert) Rollback image to snapshot.
    snap unprotect              Allow a snapshot to be deleted.
    status                      Show the status of this image.
    unmap                       Unmap a rbd device that was used by the kernel.
    watch                       Watch events on image.

Optional arguments:
  -c [ --conf ] arg     path to cluster configuration
  --cluster arg         cluster name
  --id arg              client id (without &#x27;client.&#x27; prefix)
  --user arg            client id (without &#x27;client.&#x27; prefix)
  -n [ --name ] arg     client name
  -m [ --mon_host ] arg monitor host
  --secret arg          path to secret key (deprecated)
  -K [ --keyfile ] arg  path to secret key
  -k [ --keyring ] arg  path to keyring

See &#x27;rbd help &lt;command&gt;&#x27; for help on a specific command.
</code></pre><pre><code>$ ceph -h

 General usage:
 ==============
usage: ceph [-h] [-c CEPHCONF] [-i INPUT_FILE] [-o OUTPUT_FILE]
            [--id CLIENT_ID] [--name CLIENT_NAME] [--cluster CLUSTER]
            [--admin-daemon ADMIN_SOCKET] [--admin-socket ADMIN_SOCKET_NOPE]
            [-s] [-w] [--watch-debug] [--watch-info] [--watch-sec]
            [--watch-warn] [--watch-error] [--version] [--verbose] [--concise]
            [-f {json,json-pretty,xml,xml-pretty,plain}]
            [--connect-timeout CLUSTER_TIMEOUT]

Ceph administration tool

optional arguments:
  -h, --help            request mon help
  -c CEPHCONF, --conf CEPHCONF
                        ceph configuration file
  -i INPUT_FILE, --in-file INPUT_FILE
                        input file
  -o OUTPUT_FILE, --out-file OUTPUT_FILE
                        output file
  --id CLIENT_ID, --user CLIENT_ID
                        client id for authentication
  --name CLIENT_NAME, -n CLIENT_NAME
                        client name for authentication
  --cluster CLUSTER     cluster name
  --admin-daemon ADMIN_SOCKET
                        submit admin-socket commands (&quot;help&quot; for help
  --admin-socket ADMIN_SOCKET_NOPE
                        you probably mean --admin-daemon
  -s, --status          show cluster status
  -w, --watch           watch live cluster changes
  --watch-debug         watch debug events
  --watch-info          watch info events
  --watch-sec           watch security events
  --watch-warn          watch warn events
  --watch-error         watch error events
  --version, -v         display version
  --verbose             make verbose
  --concise             make less verbose
  -f {json,json-pretty,xml,xml-pretty,plain}, --format {json,json-pretty,xml,xml-pretty,plain}
  --connect-timeout CLUSTER_TIMEOUT
                        set a timeout for connecting to the cluster

 Monitor commands:
 =================
[Contacting monitor, timeout after 5 seconds]
auth add &lt;entity&gt; {&lt;caps&gt; [&lt;caps&gt;...]}   add auth info for &lt;entity&gt; from input
                                          file, or random key if no input is
                                          given, and/or any caps specified in
                                          the command
auth caps &lt;entity&gt; &lt;caps&gt; [&lt;caps&gt;...]    update caps for &lt;name&gt; from caps
                                          specified in the command
auth del &lt;entity&gt;                        delete all caps for &lt;name&gt;
auth export {&lt;entity&gt;}                   write keyring for requested entity, or
                                          master keyring if none given
auth get &lt;entity&gt;                        write keyring file with requested key
auth get-key &lt;entity&gt;                    display requested key
auth get-or-create &lt;entity&gt; {&lt;caps&gt;      add auth info for &lt;entity&gt; from input
 [&lt;caps&gt;...]}                             file, or random key if no input given,
                                          and/or any caps specified in the
                                          command
auth get-or-create-key &lt;entity&gt; {&lt;caps&gt;  get, or add, key for &lt;name&gt; from
 [&lt;caps&gt;...]}                             system/caps pairs specified in the
                                          command.  If key already exists, any
                                          given caps must match the existing
                                          caps for that key.
auth import                              auth import: read keyring file from -i
                                          &lt;file&gt;
auth list                                list authentication state
auth print-key &lt;entity&gt;                  display requested key
auth print_key &lt;entity&gt;                  display requested key
auth rm &lt;entity&gt;                         remove all caps for &lt;name&gt;
compact                                  cause compaction of monitor&#x27;s leveldb
                                          storage (DEPRECATED)
config-key del &lt;key&gt;                     delete &lt;key&gt;
config-key exists &lt;key&gt;                  check for &lt;key&gt;&#x27;s existence
config-key get &lt;key&gt;                     get &lt;key&gt;
config-key list                          list keys
config-key put &lt;key&gt; {&lt;val&gt;}             put &lt;key&gt;, value &lt;val&gt;
config-key rm &lt;key&gt;                      rm &lt;key&gt;
df {detail}                              show cluster free space stats
fs add_data_pool &lt;fs_name&gt; &lt;pool&gt;        add data pool &lt;pool&gt;
fs dump {&lt;int[0-]&gt;}                      dump all CephFS status, optionally
                                          from epoch
fs flag set enable_multiple &lt;val&gt; {--    Set a global CephFS flag
 yes-i-really-mean-it}
fs get &lt;fs_name&gt;                         get info about one filesystem
fs ls                                    list filesystems
fs new &lt;fs_name&gt; &lt;metadata&gt; &lt;data&gt;       make new filesystem using named pools
                                          &lt;metadata&gt; and &lt;data&gt;
fs reset &lt;fs_name&gt; {--yes-i-really-mean- disaster recovery only: reset to a
 it}                                      single-MDS map
fs rm &lt;fs_name&gt; {--yes-i-really-mean-it} disable the named filesystem
fs rm_data_pool &lt;fs_name&gt; &lt;pool&gt;         remove data pool &lt;pool&gt;
fs set &lt;fs_name&gt; max_mds|max_file_size|  set mds parameter &lt;var&gt; to &lt;val&gt;
 allow_new_snaps|inline_data|cluster_
 down|allow_multimds|allow_dirfrags
 &lt;val&gt; {&lt;confirm&gt;}
fs set_default &lt;fs_name&gt;                 set the default to the named filesystem
fsid                                     show cluster FSID/UUID
health {detail}                          show cluster health
heap dump|start_profiler|stop_profiler|  show heap usage info (available only
 release|stats                            if compiled with tcmalloc)
injectargs &lt;injected_args&gt; [&lt;injected_   inject config arguments into monitor
 args&gt;...]
log &lt;logtext&gt; [&lt;logtext&gt;...]             log supplied text to the monitor log
mds add_data_pool &lt;pool&gt;                 add data pool &lt;pool&gt;
mds cluster_down                         take MDS cluster down
mds cluster_up                           bring MDS cluster up
mds compat rm_compat &lt;int[0-]&gt;           remove compatible feature
mds compat rm_incompat &lt;int[0-]&gt;         remove incompatible feature
mds compat show                          show mds compatibility settings
mds deactivate &lt;who&gt;                     stop mds
mds dump {&lt;int[0-]&gt;}                     dump legacy MDS cluster info,
                                          optionally from epoch
mds fail &lt;who&gt;                           force mds to status failed
mds getmap {&lt;int[0-]&gt;}                   get MDS map, optionally from epoch
mds metadata &lt;who&gt;                       fetch metadata for mds &lt;who&gt;
mds newfs &lt;int[0-]&gt; &lt;int[0-]&gt; {--yes-i-  make new filesystem using pools
 really-mean-it}                          &lt;metadata&gt; and &lt;data&gt;
mds remove_data_pool &lt;pool&gt;              remove data pool &lt;pool&gt;
mds repaired &lt;rank&gt;                      mark a damaged MDS rank as no longer
                                          damaged
mds rm &lt;int[0-]&gt;                         remove nonactive mds
mds rm_data_pool &lt;pool&gt;                  remove data pool &lt;pool&gt;
mds rmfailed &lt;who&gt; {&lt;confirm&gt;}           remove failed mds
mds set max_mds|max_file_size|allow_new_ set mds parameter &lt;var&gt; to &lt;val&gt;
 snaps|inline_data|allow_multimds|allow_
 dirfrags &lt;val&gt; {&lt;confirm&gt;}
mds set_max_mds &lt;int[0-]&gt;                set max MDS index
mds set_state &lt;int[0-]&gt; &lt;int[0-20]&gt;      set mds state of &lt;gid&gt; to &lt;numeric-
                                          state&gt;
mds stat                                 show MDS status
mds stop &lt;who&gt;                           stop mds
mds tell &lt;who&gt; &lt;args&gt; [&lt;args&gt;...]        send command to particular mds
mon add &lt;name&gt; &lt;IPaddr[:port]&gt;           add new monitor named &lt;name&gt; at &lt;addr&gt;
mon compact                              cause compaction of monitor&#x27;s leveldb
                                          storage
mon dump {&lt;int[0-]&gt;}                     dump formatted monmap (optionally from
                                          epoch)
mon getmap {&lt;int[0-]&gt;}                   get monmap
mon metadata &lt;id&gt;                        fetch metadata for mon &lt;id&gt;
mon remove &lt;name&gt;                        remove monitor named &lt;name&gt;
mon rm &lt;name&gt;                            remove monitor named &lt;name&gt;
mon scrub                                scrub the monitor stores
mon stat                                 summarize monitor status
mon sync force {--yes-i-really-mean-it}  force sync of and clear monitor store
 {--i-know-what-i-am-doing}
mon_status                               report status of monitors
node ls {all|osd|mon|mds}                list all nodes in cluster [type]
osd blacklist add|rm &lt;EntityAddr&gt;        add (optionally until &lt;expire&gt; seconds
 {&lt;float[0.0-]&gt;}                          from now) or remove &lt;addr&gt; from
                                          blacklist
osd blacklist clear                      clear all blacklisted clients
osd blacklist ls                         show blacklisted clients
osd blocked-by                           print histogram of which OSDs are
                                          blocking their peers
osd create {&lt;uuid&gt;} {&lt;int[0-]&gt;}          create new osd (with optional UUID and
                                          ID)
osd crush add &lt;osdname (id|osd.id)&gt;      add or update crushmap position and
 &lt;float[0.0-]&gt; &lt;args&gt; [&lt;args&gt;...]         weight for &lt;name&gt; with &lt;weight&gt; and
                                          location &lt;args&gt;
osd crush add-bucket &lt;name&gt; &lt;type&gt;       add no-parent (probably root) crush
                                          bucket &lt;name&gt; of type &lt;type&gt;
osd crush create-or-move &lt;osdname (id|   create entry or move existing entry
 osd.id)&gt; &lt;float[0.0-]&gt; &lt;args&gt; [&lt;args&gt;..  for &lt;name&gt; &lt;weight&gt; at/to location
 .]                                       &lt;args&gt;
osd crush dump                           dump crush map
osd crush get-tunable straw_calc_version get crush tunable &lt;tunable&gt;
osd crush link &lt;name&gt; &lt;args&gt; [&lt;args&gt;...] link existing entry for &lt;name&gt; under
                                          location &lt;args&gt;
osd crush move &lt;name&gt; &lt;args&gt; [&lt;args&gt;...] move existing entry for &lt;name&gt; to
                                          location &lt;args&gt;
osd crush remove &lt;name&gt; {&lt;ancestor&gt;}     remove &lt;name&gt; from crush map (
                                          everywhere, or just at &lt;ancestor&gt;)
osd crush rename-bucket &lt;srcname&gt;        rename bucket &lt;srcname&gt; to &lt;dstname&gt;
 &lt;dstname&gt;
osd crush reweight &lt;name&gt; &lt;float[0.0-]&gt;  change &lt;name&gt;&#x27;s weight to &lt;weight&gt; in
                                          crush map
osd crush reweight-all                   recalculate the weights for the tree
                                          to ensure they sum correctly
osd crush reweight-subtree &lt;name&gt;        change all leaf items beneath &lt;name&gt;
 &lt;float[0.0-]&gt;                            to &lt;weight&gt; in crush map
osd crush rm &lt;name&gt; {&lt;ancestor&gt;}         remove &lt;name&gt; from crush map (
                                          everywhere, or just at &lt;ancestor&gt;)
osd crush rule create-erasure &lt;name&gt;     create crush rule &lt;name&gt; for erasure
 {&lt;profile&gt;}                              coded pool created with &lt;profile&gt; (
                                          default default)
osd crush rule create-simple &lt;name&gt;      create crush rule &lt;name&gt; to start from
 &lt;root&gt; &lt;type&gt; {firstn|indep}             &lt;root&gt;, replicate across buckets of
                                          type &lt;type&gt;, using a choose mode of
                                          &lt;firstn|indep&gt; (default firstn; indep
                                          best for erasure pools)
osd crush rule dump {&lt;name&gt;}             dump crush rule &lt;name&gt; (default all)
osd crush rule list                      list crush rules
osd crush rule ls                        list crush rules
osd crush rule rm &lt;name&gt;                 remove crush rule &lt;name&gt;
osd crush set                            set crush map from input file
osd crush set &lt;osdname (id|osd.id)&gt;      update crushmap position and weight
 &lt;float[0.0-]&gt; &lt;args&gt; [&lt;args&gt;...]         for &lt;name&gt; to &lt;weight&gt; with location
                                          &lt;args&gt;
osd crush set-tunable straw_calc_        set crush tunable &lt;tunable&gt; to &lt;value&gt;
 version &lt;int&gt;
osd crush show-tunables                  show current crush tunables
osd crush tree                           dump crush buckets and items in a tree
                                          view
osd crush tunables legacy|argonaut|      set crush tunables values to &lt;profile&gt;
 bobtail|firefly|hammer|jewel|optimal|
 default
osd crush unlink &lt;name&gt; {&lt;ancestor&gt;}     unlink &lt;name&gt; from crush map (
                                          everywhere, or just at &lt;ancestor&gt;)
osd deep-scrub &lt;who&gt;                     initiate deep scrub on osd &lt;who&gt;
osd df {plain|tree}                      show OSD utilization
osd down &lt;ids&gt; [&lt;ids&gt;...]                set osd(s) &lt;id&gt; [&lt;id&gt;...] down
osd dump {&lt;int[0-]&gt;}                     print summary of OSD map
osd erasure-code-profile get &lt;name&gt;      get erasure code profile &lt;name&gt;
osd erasure-code-profile ls              list all erasure code profiles
osd erasure-code-profile rm &lt;name&gt;       remove erasure code profile &lt;name&gt;
osd erasure-code-profile set &lt;name&gt;      create erasure code profile &lt;name&gt;
 {&lt;profile&gt; [&lt;profile&gt;...]}               with [&lt;key[=value]&gt; ...] pairs. Add a
                                          --force at the end to override an
                                          existing profile (VERY DANGEROUS)
osd find &lt;int[0-]&gt;                       find osd &lt;id&gt; in the CRUSH map and
                                          show its location
osd getcrushmap {&lt;int[0-]&gt;}              get CRUSH map
osd getmap {&lt;int[0-]&gt;}                   get OSD map
osd getmaxosd                            show largest OSD id
osd in &lt;ids&gt; [&lt;ids&gt;...]                  set osd(s) &lt;id&gt; [&lt;id&gt;...] in
osd lost &lt;int[0-]&gt; {--yes-i-really-mean- mark osd as permanently lost. THIS
 it}                                      DESTROYS DATA IF NO MORE REPLICAS
                                          EXIST, BE CAREFUL
osd ls {&lt;int[0-]&gt;}                       show all OSD ids
osd lspools {&lt;int&gt;}                      list pools
osd map &lt;poolname&gt; &lt;objectname&gt;          find pg for &lt;object&gt; in &lt;pool&gt; with
 {&lt;nspace&gt;}                               [namespace]
osd metadata {&lt;int[0-]&gt;}                 fetch metadata for osd {id} (default
                                          all)
osd out &lt;ids&gt; [&lt;ids&gt;...]                 set osd(s) &lt;id&gt; [&lt;id&gt;...] out
osd pause                                pause osd
osd perf                                 print dump of OSD perf summary stats
osd pg-temp &lt;pgid&gt; {&lt;id&gt; [&lt;id&gt;...]}      set pg_temp mapping pgid:[&lt;id&gt; [&lt;id&gt;...
                                          ]] (developers only)
osd pool create &lt;poolname&gt; &lt;int[0-]&gt;     create pool
 {&lt;int[0-]&gt;} {replicated|erasure}
 {&lt;erasure_code_profile&gt;} {&lt;ruleset&gt;}
 {&lt;int&gt;}
osd pool delete &lt;poolname&gt; {&lt;poolname&gt;}  delete pool
 {--yes-i-really-really-mean-it}
osd pool get &lt;poolname&gt; size|min_size|   get pool parameter &lt;var&gt;
 crash_replay_interval|pg_num|pgp_num|
 crush_ruleset|hashpspool|nodelete|
 nopgchange|nosizechange|write_fadvise_
 dontneed|noscrub|nodeep-scrub|hit_set_
 type|hit_set_period|hit_set_count|hit_
 set_fpp|auid|target_max_objects|target_
 max_bytes|cache_target_dirty_ratio|
 cache_target_dirty_high_ratio|cache_
 target_full_ratio|cache_min_flush_age|
 cache_min_evict_age|erasure_code_
 profile|min_read_recency_for_promote|
 all|min_write_recency_for_promote|fast_
 read|hit_set_grade_decay_rate|hit_set_
 search_last_n|scrub_min_interval|scrub_
 max_interval|deep_scrub_interval|
 recovery_priority|recovery_op_priority|
 scrub_priority
osd pool get-quota &lt;poolname&gt;            obtain object or byte limits for pool
osd pool ls {detail}                     list pools
osd pool mksnap &lt;poolname&gt; &lt;snap&gt;        make snapshot &lt;snap&gt; in &lt;pool&gt;
osd pool rename &lt;poolname&gt; &lt;poolname&gt;    rename &lt;srcpool&gt; to &lt;destpool&gt;
osd pool rm &lt;poolname&gt; {&lt;poolname&gt;} {--  remove pool
 yes-i-really-really-mean-it}
osd pool rmsnap &lt;poolname&gt; &lt;snap&gt;        remove snapshot &lt;snap&gt; from &lt;pool&gt;
osd pool set &lt;poolname&gt; size|min_size|   set pool parameter &lt;var&gt; to &lt;val&gt;
 crash_replay_interval|pg_num|pgp_num|
 crush_ruleset|hashpspool|nodelete|
 nopgchange|nosizechange|write_fadvise_
 dontneed|noscrub|nodeep-scrub|hit_set_
 type|hit_set_period|hit_set_count|hit_
 set_fpp|use_gmt_hitset|debug_fake_ec_
 pool|target_max_bytes|target_max_
 objects|cache_target_dirty_ratio|cache_
 target_dirty_high_ratio|cache_target_
 full_ratio|cache_min_flush_age|cache_
 min_evict_age|auid|min_read_recency_
 for_promote|min_write_recency_for_
 promote|fast_read|hit_set_grade_decay_
 rate|hit_set_search_last_n|scrub_min_
 interval|scrub_max_interval|deep_scrub_
 interval|recovery_priority|recovery_op_
 priority|scrub_priority &lt;val&gt; {--yes-i-
 really-mean-it}
osd pool set-quota &lt;poolname&gt; max_       set object or byte limit on pool
 objects|max_bytes &lt;val&gt;
osd pool stats {&lt;name&gt;}                  obtain stats from all pools, or from
                                          specified pool
osd primary-affinity &lt;osdname (id|osd.   adjust osd primary-affinity from 0.0 &lt;=
 id)&gt; &lt;float[0.0-1.0]&gt;                     &lt;weight&gt; &lt;= 1.0
osd primary-temp &lt;pgid&gt; &lt;id&gt;             set primary_temp mapping pgid:&lt;id&gt;|-1 (
                                          developers only)
osd repair &lt;who&gt;                         initiate repair on osd &lt;who&gt;
osd reweight &lt;int[0-]&gt; &lt;float[0.0-1.0]&gt;  reweight osd to 0.0 &lt; &lt;weight&gt; &lt; 1.0
osd reweight-by-pg {&lt;int&gt;} {&lt;float&gt;}     reweight OSDs by PG distribution
 {&lt;int&gt;} {&lt;poolname&gt; [&lt;poolname&gt;...]}     [overload-percentage-for-
                                          consideration, default 120]
osd reweight-by-utilization {&lt;int&gt;}      reweight OSDs by utilization [overload-
 {&lt;float&gt;} {&lt;int&gt;} {--no-increasing}      percentage-for-consideration, default
                                          120]
osd rm &lt;ids&gt; [&lt;ids&gt;...]                  remove osd(s) &lt;id&gt; [&lt;id&gt;...] in
osd scrub &lt;who&gt;                          initiate scrub on osd &lt;who&gt;
osd set full|pause|noup|nodown|noout|    set &lt;key&gt;
 noin|nobackfill|norebalance|norecover|
 noscrub|nodeep-scrub|notieragent|
 sortbitwise
osd setcrushmap                          set crush map from input file
osd setmaxosd &lt;int[0-]&gt;                  set new maximum osd value
osd stat                                 print summary of OSD map
osd test-reweight-by-pg {&lt;int&gt;}          dry run of reweight OSDs by PG
 {&lt;float&gt;} {&lt;int&gt;} {&lt;poolname&gt;            distribution [overload-percentage-for-
 [&lt;poolname&gt;...]}                         consideration, default 120]
osd test-reweight-by-utilization         dry run of reweight OSDs by
 {&lt;int&gt;} {&lt;float&gt;} {&lt;int&gt;} {--no-         utilization [overload-percentage-for-
 increasing}                              consideration, default 120]
osd thrash &lt;int[0-]&gt;                     thrash OSDs for &lt;num_epochs&gt;
osd tier add &lt;poolname&gt; &lt;poolname&gt; {--   add the tier &lt;tierpool&gt; (the second
 force-nonempty}                          one) to base pool &lt;pool&gt; (the first
                                          one)
osd tier add-cache &lt;poolname&gt;            add a cache &lt;tierpool&gt; (the second one)
 &lt;poolname&gt; &lt;int[0-]&gt;                     of size &lt;size&gt; to existing pool
                                          &lt;pool&gt; (the first one)
osd tier cache-mode &lt;poolname&gt; none|     specify the caching mode for cache
 writeback|forward|readonly|readforward|  tier &lt;pool&gt;
 proxy|readproxy {--yes-i-really-mean-
 it}
osd tier remove &lt;poolname&gt; &lt;poolname&gt;    remove the tier &lt;tierpool&gt; (the second
                                          one) from base pool &lt;pool&gt; (the first
                                          one)
osd tier remove-overlay &lt;poolname&gt;       remove the overlay pool for base pool
                                          &lt;pool&gt;
osd tier rm &lt;poolname&gt; &lt;poolname&gt;        remove the tier &lt;tierpool&gt; (the second
                                          one) from base pool &lt;pool&gt; (the first
                                          one)
osd tier rm-overlay &lt;poolname&gt;           remove the overlay pool for base pool
                                          &lt;pool&gt;
osd tier set-overlay &lt;poolname&gt;          set the overlay pool for base pool
 &lt;poolname&gt;                               &lt;pool&gt; to be &lt;overlaypool&gt;
osd tree {&lt;int[0-]&gt;}                     print OSD tree
osd unpause                              unpause osd
osd unset full|pause|noup|nodown|noout|  unset &lt;key&gt;
 noin|nobackfill|norebalance|norecover|
 noscrub|nodeep-scrub|notieragent|
 sortbitwise
osd utilization                          get basic pg distribution stats
pg debug unfound_objects_exist|degraded_ show debug info about pgs
 pgs_exist
pg deep-scrub &lt;pgid&gt;                     start deep-scrub on &lt;pgid&gt;
pg dump {all|summary|sum|delta|pools|    show human-readable versions of pg map
 osds|pgs|pgs_brief [all|summary|sum|     (only &#x27;all&#x27; valid with plain)
 delta|pools|osds|pgs|pgs_brief...]}
pg dump_json {all|summary|sum|pools|     show human-readable version of pg map
 osds|pgs [all|summary|sum|pools|osds|    in json only
 pgs...]}
pg dump_pools_json                       show pg pools info in json only
pg dump_stuck {inactive|unclean|stale|   show information about stuck pgs
 undersized|degraded [inactive|unclean|
 stale|undersized|degraded...]} {&lt;int&gt;}
pg force_create_pg &lt;pgid&gt;                force creation of pg &lt;pgid&gt;
pg getmap                                get binary pg map to -o/stdout
pg ls {&lt;int&gt;} {active|clean|down|replay| list pg with specific pool, osd, state
 splitting|scrubbing|scrubq|degraded|
 inconsistent|peering|repair|recovering|
 backfill_wait|incomplete|stale|
 remapped|deep_scrub|backfill|backfill_
 toofull|recovery_wait|undersized|
 activating|peered [active|clean|down|
 replay|splitting|scrubbing|scrubq|
 degraded|inconsistent|peering|repair|
 recovering|backfill_wait|incomplete|
 stale|remapped|deep_scrub|backfill|
 backfill_toofull|recovery_wait|
 undersized|activating|peered...]}
pg ls-by-osd &lt;osdname (id|osd.id)&gt;       list pg on osd [osd]
 {&lt;int&gt;} {active|clean|down|replay|
 splitting|scrubbing|scrubq|degraded|
 inconsistent|peering|repair|recovering|
 backfill_wait|incomplete|stale|
 remapped|deep_scrub|backfill|backfill_
 toofull|recovery_wait|undersized|
 activating|peered [active|clean|down|
 replay|splitting|scrubbing|scrubq|
 degraded|inconsistent|peering|repair|
 recovering|backfill_wait|incomplete|
 stale|remapped|deep_scrub|backfill|
 backfill_toofull|recovery_wait|
 undersized|activating|peered...]}
pg ls-by-pool &lt;poolstr&gt; {active|clean|   list pg with pool = [poolname | poolid]
 down|replay|splitting|scrubbing|scrubq|
 degraded|inconsistent|peering|repair|
 recovering|backfill_wait|incomplete|
 stale|remapped|deep_scrub|backfill|
 backfill_toofull|recovery_wait|
 undersized|activating|peered [active|
 clean|down|replay|splitting|scrubbing|
 scrubq|degraded|inconsistent|peering|
 repair|recovering|backfill_wait|
 incomplete|stale|remapped|deep_scrub|
 backfill|backfill_toofull|recovery_
 wait|undersized|activating|peered...]}
pg ls-by-primary &lt;osdname (id|osd.id)&gt;   list pg with primary = [osd]
 {&lt;int&gt;} {active|clean|down|replay|
 splitting|scrubbing|scrubq|degraded|
 inconsistent|peering|repair|recovering|
 backfill_wait|incomplete|stale|
 remapped|deep_scrub|backfill|backfill_
 toofull|recovery_wait|undersized|
 activating|peered [active|clean|down|
 replay|splitting|scrubbing|scrubq|
 degraded|inconsistent|peering|repair|
 recovering|backfill_wait|incomplete|
 stale|remapped|deep_scrub|backfill|
 backfill_toofull|recovery_wait|
 undersized|activating|peered...]}
pg map &lt;pgid&gt;                            show mapping of pg to osds
pg repair &lt;pgid&gt;                         start repair on &lt;pgid&gt;
pg scrub &lt;pgid&gt;                          start scrub on &lt;pgid&gt;
pg send_pg_creates                       trigger pg creates to be issued
pg set_full_ratio &lt;float[0.0-1.0]&gt;       set ratio at which pgs are considered
                                          full
pg set_nearfull_ratio &lt;float[0.0-1.0]&gt;   set ratio at which pgs are considered
                                          nearly full
pg stat                                  show placement group status.
quorum enter|exit                        enter or exit quorum
quorum_status                            report status of monitor quorum
report {&lt;tags&gt; [&lt;tags&gt;...]}              report full status of cluster,
                                          optional title tag strings
scrub                                    scrub the monitor stores (DEPRECATED)
status                                   show cluster status
sync force {--yes-i-really-mean-it} {--  force sync of and clear monitor store (
 i-know-what-i-am-doing}                  DEPRECATED)
tell &lt;name (type.id)&gt; &lt;args&gt; [&lt;args&gt;...] send a command to a specific daemon
version                                  show mon daemon version
</code></pre><h2 id="faq">FAQ</h2><h3 id="health_err-64-pgs-are-stuck-inactive-for-more-than-300-seconds-64-pgs-stuck-inactive">HEALTH_ERR 64 pgs are stuck inactive for more than 300 seconds; 64 pgs stuck inactive</h3><p>这个是有可能由很多问题引起的,可分别查看其它服务上的日志来判断 <code>cat /var/log/ceph/ceph*</code></p><h3 id="error-osd-init-failed-36-file-name-too-long">ERROR: osd init failed: (36) File name too long</h3><p>文件名太长,可能是由于文件系统类型导致的 <code>df -T</code>,一般建议使用 XFS 或 Btrfs, 但大多数情况下是 ext4, 文件名不能超过 1024b.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/wenerme/wener/edit/master/notes/service/storage/ceph/README.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_icZ1" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_IDPb"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/notes/service/service-awesome"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Service Awesome</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/notes/service/storage/ceph/ceph-awesome"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Ceph Awesome</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_Rbtr thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#troubleshooting" class="table-of-contents__link toc-highlight">Troubleshooting</a></li><li><a href="#技术比较" class="table-of-contents__link toc-highlight">技术比较</a><ul><li><a href="#vs-hdfs" class="table-of-contents__link toc-highlight">vs HDFS</a></li></ul></li><li><a href="#命令行" class="table-of-contents__link toc-highlight">命令行</a></li><li><a href="#faq" class="table-of-contents__link toc-highlight">FAQ</a><ul><li><a href="#health_err-64-pgs-are-stuck-inactive-for-more-than-300-seconds-64-pgs-stuck-inactive" class="table-of-contents__link toc-highlight">HEALTH_ERR 64 pgs are stuck inactive for more than 300 seconds; 64 pgs stuck inactive</a></li><li><a href="#error-osd-init-failed-36-file-name-too-long" class="table-of-contents__link toc-highlight">ERROR: osd init failed: (36) File name too long</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">笔记</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/notes/java">Java</a></li><li class="footer__item"><a class="footer__link-item" href="/notes/os/alpine">AlpineLinux</a></li><li class="footer__item"><a class="footer__link-item" href="/notes/devops/kubernetes">Kubernates</a></li><li class="footer__item"><a class="footer__link-item" href="/notes/voip">VoIP</a></li></ul></div><div class="col footer__col"><div class="footer__title">Projects</div><ul class="footer__items clean-list"><li class="footer__item">
              <div>
              <a class="footer__link-item" href="https://github.com/wenerme/wener">Wener</a>
              - <a class="footer__link-item" href="https://github.com/wenerme/wener/actions" title="wenerme/wener - ci">
                <img style="vertical-align: middle;opacity: .4;" src="https://github.com/wenerme/wener/workflows/Build/badge.svg">
                </a>
              </div>
              </li><li class="footer__item"><a href="https://apis.wener.me" target="_blank" rel="noopener noreferrer" class="footer__link-item">Wener&#x27;s Apis<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_pUOn"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/story">Blog</a></li><li class="footer__item"><a href="https://github.com/wenerme" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://twitter.com/wenerme" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/img/wener-logo.svg" alt="Wener Site" class="themedImage_sWQn themedImage--light_HlbN footer__logo"><img src="/img/wener-logo.svg" alt="Wener Site" class="themedImage_sWQn themedImage--dark__4Lo footer__logo"></div><div class="footer__copyright">Copyright © 1992-2022 Wener - <img alt="cc-by-sa-4.0" src="https://mirrors.creativecommons.org/presskit/buttons/80x15/svg/by-sa.svg"> - Build @2022-09-22 04:38</div></div></div></footer></div>
<script src="/assets/js/runtime~main.07b4d16f.js"></script>
<script src="/assets/js/main.92dfd685.js"></script>
</body>
</html>