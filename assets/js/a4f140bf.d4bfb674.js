/*! For license information please see a4f140bf.d4bfb674.js.LICENSE.txt */
"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[67012],{82680:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>i,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>l,toc:()=>c});var t=r(2488),s=r(62780);const o={title:"Local Path Provisioner"},a="Local Path",l={id:"devops/kubernetes/storage/local-path-provisioner",title:"Local Path Provisioner",description:"- rancher/local-path-provisioner",source:"@site/../notes/devops/kubernetes/storage/local-path-provisioner.md",sourceDirName:"devops/kubernetes/storage",slug:"/devops/kubernetes/storage/local-path-provisioner",permalink:"/notes/devops/kubernetes/storage/local-path-provisioner",draft:!1,unlisted:!1,editUrl:"https://github.com/wenerme/wener/edit/master/notes/../notes/devops/kubernetes/storage/local-path-provisioner.md",tags:[],version:"current",lastUpdatedBy:"wener",lastUpdatedAt:1686920980,formattedLastUpdatedAt:"Jun 16, 2023",frontMatter:{title:"Local Path Provisioner"},sidebar:"docs",previous:{title:"Kubernetest \u5b58\u50a8\u5e38\u89c1\u95ee\u9898",permalink:"/notes/devops/kubernetes/storage/k8s-storage-faq"},next:{title:"Local PV",permalink:"/notes/devops/kubernetes/storage/local-pv"}},i={},c=[{value:"\u914d\u7f6e",id:"\u914d\u7f6e",level:2}];function p(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.M)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"local-path",children:"Local Path"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://github.com/rancher/local-path-provisioner",children:"rancher/local-path-provisioner"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"storageClassName: local-path"})}),"\n",(0,t.jsxs)(n.li,{children:["\u81ea\u52a8\u521b\u5efa\u76ee\u5f55 - /var/lib/rancher/k3s/storage\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"pvc-<UUID>_<NAMESPACE>_<PVC_NAME>"})}),"\n",(0,t.jsx)(n.li,{children:"UUID=pvc.uid"}),"\n",(0,t.jsxs)(n.li,{children:["PVC_NAME=",(0,t.jsx)(n.code,{children:"<VOLUME_NAME>_<POD_NAME>"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["helper-pod-create-pvc\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"rancher/mirrored-library-busybox:1.34.1"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\u6ce8\u610f\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\u5f02\u5e38\u540e PVC \u4e22\u5931\uff0cStatefulSet \u65e0\u6cd5\u542f\u52a8\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"\u5220\u9664 Pod \u4ece\u65b0\u90e8\u7f72\u53ef\u6062\u590d"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\u53c2\u8003\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["zfs example ",(0,t.jsx)(n.a,{href:"https://github.com/rancher/local-path-provisioner/issues/162",children:"#162"})]}),"\n",(0,t.jsxs)(n.li,{children:["\u6062\u590d pv ",(0,t.jsx)(n.a,{href:"https://github.com/rancher/local-path-provisioner/issues/144",children:"#144"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"k3s \u9ed8\u8ba4\u914d\u7f6e"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "nodePathMap": [\n    {\n      "node": "DEFAULT_PATH_FOR_NON_LISTED_NODES",\n      "paths": ["/var/lib/rancher/k3s/storage"]\n    }\n  ]\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"\u914d\u7f6e",children:"\u914d\u7f6e"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'kind: ConfigMap\napiVersion: v1\nmetadata:\n  name: local-path-config\n  namespace: local-path-storage\ndata:\n  # paths \u8bbe\u7f6e\u4e3a\u7a7a\u6570\u7ec4\u5219\u4f1a\u62d2\u7edd\n  # paths \u8bbe\u7f6e\u591a\u4e2a\u4f1a\u968f\u673a\u9009\u62e9\n  config.json: |-\n    {\n      "nodePathMap":[\n        {\n          "node":"DEFAULT_PATH_FOR_NON_LISTED_NODES",\n          "paths":["/opt/local-path-provisioner"]\n        },\n        {\n          "node":"yasker-lp-dev1",\n          "paths":["/opt/local-path-provisioner", "/data1"]\n        },\n        {\n          "node":"yasker-lp-dev3",\n          "paths":[]\n        }\n      ]\n    }\n  setup: |-\n    #!/bin/sh\n    path=$1\n    mkdir -m 0777 -p ${path}\n  teardown: |-\n    #!/bin/sh\n    path=$1\n    rm -rf ${path}\n'})})]})}function h(e={}){const{wrapper:n}={...(0,s.M)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(p,{...e})}):p(e)}},38088:(e,n,r)=>{var t=r(96651),s=Symbol.for("react.element"),o=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,l=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function c(e,n,r){var t,o={},c=null,p=null;for(t in void 0!==r&&(c=""+r),void 0!==n.key&&(c=""+n.key),void 0!==n.ref&&(p=n.ref),n)a.call(n,t)&&!i.hasOwnProperty(t)&&(o[t]=n[t]);if(e&&e.defaultProps)for(t in n=e.defaultProps)void 0===o[t]&&(o[t]=n[t]);return{$$typeof:s,type:e,key:c,ref:p,props:o,_owner:l.current}}n.Fragment=o,n.jsx=c,n.jsxs=c},2488:(e,n,r)=>{e.exports=r(38088)},62780:(e,n,r)=>{r.d(n,{I:()=>l,M:()=>a});var t=r(96651);const s={},o=t.createContext(s);function a(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);