"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[47793],{3905:function(e,t,n){n.d(t,{Zo:function(){return m},kt:function(){return b}});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),s=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},m=function(e){var t=s(e.components);return a.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,m=p(e,["components","mdxType","originalType","parentName"]),u=s(n),b=r,k=u["".concat(l,".").concat(b)]||u[b]||c[b]||i;return n?a.createElement(k,o(o({ref:t},m),{},{components:n})):a.createElement(k,o({ref:t},m))}));function b(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=u;var p={};for(var l in t)hasOwnProperty.call(t,l)&&(p[l]=t[l]);p.originalType=e,p.mdxType="string"==typeof e?e:r,o[1]=p;for(var s=2;s<i;s++)o[s]=n[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},17078:function(e,t,n){n.r(t),n.d(t,{assets:function(){return m},contentTitle:function(){return l},default:function(){return b},frontMatter:function(){return p},metadata:function(){return s},toc:function(){return c}});var a=n(87462),r=n(63366),i=(n(67294),n(3905)),o=["components"],p={title:"bit"},l=void 0,s={unversionedId:"web/react/bit",id:"web/react/bit",title:"bit",description:"bit \u4f1a\u4e3a\u6bcf\u4e2a\u7ec4\u4ef6\u5efa\u7acb git \u201c\u4ed3\u5e93\u201d\uff0c\u7ef4\u62a4\u6bcf\u4e2a\u7ec4\u4ef6\u7684\u751f\u547d\u5468\u671f\u3002",source:"@site/notes/web/react/bit.md",sourceDirName:"web/react",slug:"/web/react/bit",permalink:"/notes/web/react/bit",draft:!1,editUrl:"https://github.com/wenerme/wener/edit/master/notes/web/react/bit.md",tags:[],version:"current",frontMatter:{title:"bit"},sidebar:"docs",previous:{title:"React",permalink:"/notes/web/react/"},next:{title:"BlueprinrJS",permalink:"/notes/web/react/blueprint"}},m={},c=[{value:"bit server",id:"bit-server",level:2},{value:"\u73af\u5883",id:"\u73af\u5883",level:2},{value:"\u5e94\u7528",id:"\u5e94\u7528",level:2},{value:"PKG",id:"pkg",level:2},{value:"\u901a\u8fc7\u4ee3\u7801\u83b7\u53d6\u7ec4\u4ef6\u4fe1\u606f",id:"\u901a\u8fc7\u4ee3\u7801\u83b7\u53d6\u7ec4\u4ef6\u4fe1\u606f",level:2}],u={toc:c};function b(e){var t=e.components,n=(0,r.Z)(e,o);return(0,i.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"bit \u4f1a\u4e3a\u6bcf\u4e2a\u7ec4\u4ef6\u5efa\u7acb git \u201c\u4ed3\u5e93\u201d\uff0c\u7ef4\u62a4\u6bcf\u4e2a\u7ec4\u4ef6\u7684\u751f\u547d\u5468\u671f\u3002"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/teambit/bit"},"teambit/bit")),(0,i.kt)("li",{parentName:"ul"},"BVM - bit version manager"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@<owner>/<scope>.<namespace>.<component-name>")),(0,i.kt)("li",{parentName:"ul"},"my-org.my-scope/ui/inputs/button",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"ID: my-org.my-scope/ui/inputs/button"),(0,i.kt)("li",{parentName:"ul"},"Scope: my-org.my-scope"),(0,i.kt)("li",{parentName:"ul"},"Name: ui/inputs/button"),(0,i.kt)("li",{parentName:"ul"},"Package: ",(0,i.kt)("inlineCode",{parentName:"li"},"@my-org/my-scope.ui.inputs.button")),(0,i.kt)("li",{parentName:"ul"},"\u4e00\u822c\u4e3a organization.team - \u4f8b\u5982: teambit.docs"))),(0,i.kt)("li",{parentName:"ul"},"bit",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Git \u76f8\u5173: tag, untag, add, untrack, diff, lane, snap, export, import, checkout, artifacts, remote",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"lane = branch"),(0,i.kt)("li",{parentName:"ul"},"export = push"),(0,i.kt)("li",{parentName:"ul"},"import = pull"),(0,i.kt)("li",{parentName:"ul"},".git/bit/scope.json = .git/config"))),(0,i.kt)("li",{parentName:"ul"},"pnpm \u76f8\u5173: install, link"),(0,i.kt)("li",{parentName:"ul"},"scope fork = fork \u4ed3\u5e93"),(0,i.kt)("li",{parentName:"ul"},"start, compile, test, lint, format, build"))),(0,i.kt)("li",{parentName:"ul"},"\u53c2\u8003",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/bit-demos/base-ui"},"bit-demos/base-ui"))))),(0,i.kt)("admonition",{type:"caution"},(0,i.kt)("ul",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ul"},"react 18 ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/teambit/bit/issues/5751"},"#5751")))),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'# \u4e0b\u8f7d\u7f13\u5b58 ~/.bvm/temp/bit-0.0.762.tar.gz\n# \u5b89\u88c5\u4f4d\u7f6e \uff5e/.bvm/versions/0.0.762\n# \u975e\u5e38\u5927 - \u7ea6 1.2G node_modules\n# https://bvm.bit.dev/\n# https://bvm.bit.dev/versions/dev/Darwin/0.0.762/bit-0.0.762.tar.gz\nnpx @teambit/bvm install\n\n# \u65b0\u9879\u76ee\n# ==========\n# \u9ed8\u8ba4 \u4f7f\u7528 pnpm\n# bit templates\n# --default-scope my-org.my-scope\nbit new react my-ui\ncd my-ui\nbit start\n\n# my-scope/ui/my-welcome\nbit create react ui/my-welcome              #  \u521b\u5efa\u7ec4\u4ef6\nbit show ui/my-welcome                      # \u67e5\u770b\u7ec4\u4ef6\u72b6\u6001\nbit tag ui/my-welcome -v 1.0.0 -m "initial" # tag \u672c\u5730\u7248\u672c\nbit diff ui/my-welcome                      # \u4fee\u6539\u540e\u53ef\u67e5\u770b\u53d8\u5316\nbit log ui/my-welcome                       # \u5386\u53f2\u4fee\u6539\nbit artifacts ui/my-welcome                 #\u6587\u4ef6\u5185\u5bb9\nbit dependencies ui/my-welcome              # \u67e5\u770b\u7ec4\u4ef6\u4f9d\u8d56\n\n# \u5feb\u7167\u4f1a\u751f\u6210 hash - \u7528\u4e8e\u534f\u4f5c\n# \u672c\u8d28\u7c7b\u4f3c tag\nbit snap ui/my-welcome --message "demo snapshot"\n\n# bit export [collection]\n# bit import\n# bit checkout latest --all\n# bit untag\n\nbit status\n\n# \u5df2\u6709\u9879\u76ee\n# ==========\n# --bare \u7528\u4e8e\u81ea\u5efa server\n# monorepo \u9700\u8981\u5728 root \u4f4d\u7f6e init\nbit init --bare\n\n# \u5e38\u7528\u64cd\u4f5c\n# ==========\nnpx @teambit/bvm upgrade          # \u5347\u7ea7 bit\nbit add src/components/button     # \u6dfb\u52a0\u7ec4\u4ef6\nbit untrack src/components/button #\u53d6\u6d88\u8ddf\u8e2a\u7ec4\u4ef6\n\nbit move ui/my-component design/my-component # \u8c03\u6574\u7ec4\u4ef6\u4f4d\u7f6e\n\nbit eject teambit.design/ui/buttons/button  # \u8c03\u6574\u7ec4\u4ef6\u4ed3\u5e93\nbit import teambit.design/ui/buttons/button # \u5728\u65b0\u7684\u4ed3\u5e93\u5bfc\u5165\n\nbit install "classnames@^2" -u # \u5b89\u88c5\u5347\u7ea7\u4f9d\u8d56\n\n# \u91cd\u547d\u540d\u7ec4\u4ef6\n# --refactor \u4f1a\u8c03\u6574\u73b0\u6709\u4ee3\u7801\nbit rename loaders/skeleton placeholders/skeleton --refactor\n\nbit show ui/my-welcome # \u67e5\u770b\u7ec4\u4ef6\u4fe1\u606f\n# \u83b7\u53d6\u7ec4\u4ef6 \u5143\u4fe1\u606f\n# \u53ef\u4ee5\u662f remote\nbit aspect get my-org.my-scope/ui/my-welcome\n\nbit cat-scope # \u67e5\u770b\u7528\u5230\u7684 scope\nbit insights  # \u5206\u6790\u5faa\u73af\u4f9d\u8d56\nbit env       # \u7ec4\u4ef6\u73af\u5883\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},".bitmap - \u81ea\u52a8\u751f\u6210 - \u7ec4\u4ef6\u5230\u76ee\u5f55\u6620\u5c04"),(0,i.kt)("li",{parentName:"ul"},"workspace.jsonc"),(0,i.kt)("li",{parentName:"ul"},".git/bit - Local Scope",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"cache,components,objects,scope.json")))),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="workspace.jsonc"',title:'"workspace.jsonc"'},'{\n  "teambit.workspace/workspace": {\n    "name": "my-ui",\n    // icon: ""\n\n    // <root>/{scope}/{name}/button/index.ts\n    "defaultDirectory": "{scope}/{name}",\n    "defaultScope": "my-org.my-scope"\n  },\n  "teambit.dependencies/dependency-resolver": {\n    "packageManager": "teambit.dependencies/pnpm",\n    "policy": {\n      "dependencies": {},\n      "peerDependencies": {}\n    }\n  },\n  "teambit.workspace/variants": {\n    "{ui/**}": {\n      "teambit.dependencies/dependency-resolver": {\n        "policy": {\n          "dependencies": {\n            "classnames": "^2"\n          }\n        }\n      }\n    }\n  }\n}\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"ui/my-button - \u7ec4\u4ef6\u76ee\u5f55",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"index.tsx - entry"),(0,i.kt)("li",{parentName:"ul"},"my-button.tsx - main"),(0,i.kt)("li",{parentName:"ul"},"my-button.spec.tsx - test"),(0,i.kt)("li",{parentName:"ul"},"my-button.composition.tsx"),(0,i.kt)("li",{parentName:"ul"},"my-button.docs.mdx"),(0,i.kt)("li",{parentName:"ul"},"component.json"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://bit.dev/docs/workspace/workspace-json"},"workspace.jsonc"))),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("ul",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ul"},"\u6bcf\u4e2a\u7ec4\u4ef6\u90fd\u4f4d\u4e8e\u4e00\u4e2a\u201c\u5c0f\u4ed3\u5e93\u201d",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"\u56e0\u6b64\u7248\u672c\u548c\u4fee\u6539\u90fd\u662f\u72ec\u7acb\u7684"))),(0,i.kt)("li",{parentName:"ul"},"capsules - \u7ec4\u4ef6\u7684\u4e34\u65f6\u5de5\u4f5c\u7a7a\u95f4 - bit build",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"capsules_root_base_dir"),(0,i.kt)("li",{parentName:"ul"},"macOS ",(0,i.kt)("inlineCode",{parentName:"li"},"~/Library/Caches/Bit/capsules/")),(0,i.kt)("li",{parentName:"ul"},"Windows ",(0,i.kt)("inlineCode",{parentName:"li"},"%LOCALAPPDATA%\\Bit\\capsules\\")))))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"component.json")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"# eject \u540e\u4f1a\u5f97\u5230 component.json\nbit eject-conf ui/my-button\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "componentId": {\n    "name": "ui/button",\n    "version": "0.0.1",\n    "scope": "company.scope"\n  },\n  "propagate": true,\n  "extensions": {\n    "teambit.dependencies/dependency-resolver": {\n      "policy": {\n        "dependencies": {\n          "lodash": "^14.17.21"\n        }\n      }\n    }\n  }\n}\n')),(0,i.kt)("h2",{id:"bit-server"},"bit server"),(0,i.kt)("p",null,"\u672c\u8d28\u548c git bare \u4ed3\u5e93\u7c7b\u4f3c\uff0c"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"docker run -it --rm \\\n  -v $PWD/remote-scope:/root/remote-scope \\\n  -p 3030:3000 \\\n  --name bit-server bitcli/bit-server:latest\n\nbit remote add http://localhost:3030\n\n# \u4e0d\u540c scope \u4e4b\u95f4\u4e92\u901a\n# docker exec -it bit-server bit remote add http://192.168.1.110:3000\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"/root/Library/Caches/Bit/logs"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/teambit/bit/blob/master/scripts/docker-teambit-bit/README.md"},"scripts/docker-teambit-bit")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/teambit/bit-docker"},"teambit/bit-docker")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/teambit/bit/discussions/4707"},"How to self host components and publish to npm"))),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-dockerfile"},"FROM node:12.22.0\nUSER root\n\nRUN npm i @teambit/bvm -g\nRUN bvm upgrade\nENV PATH=$PATH:/root/bin\n\n# increase memory to avoid 137 error code\nENV NODE_OPTIONS=--max_old_space_size=4096\n\nRUN bit config set analytics_reporting false\nRUN bit config set no_warnings false\nRUN bit config set interactive false\nRUN bit config set error_reporting true\n\nARG SCOPE_PATH=/root/remote-scope\nWORKDIR ${SCOPE_PATH}\nRUN bit init --bare\nCMD bit start\n")),(0,i.kt)("h2",{id:"\u73af\u5883"},"\u73af\u5883"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"builder, generator, compiler, tester, docs, compositions, preview, linter, formatter")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'bit env\nbit env get teambit.react/react\nbit show teambit.react/react\n# \u4fee\u6539\u7ec4\u4ef6 env\nbit env set acme.demo/welcome acme.envs/react\n# \u6279\u91cf\u4fee\u6539\nbit env set "acme.demo/ui/*" acme.envs/react\nbit env replace teambit.react/react acme.envs/react\n\n# \u81ea\u5b9a\u4e49 env\nbit create react-env envs/my-env\n')),(0,i.kt)("h2",{id:"\u5e94\u7528"},"\u5e94\u7528"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"bit fork learnbit.apps/node-app\nbit app list\nbit run hello-node-app\nbit build company.scope/apps/my-app\nbit tag company.scope/apps/my-app\n")),(0,i.kt)("h2",{id:"pkg"},"PKG"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u4fee\u6539\u7ec4\u4ef6")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="component.json"',title:'"component.json"'},'{\n  "teambit.pkg/pkg": {\n    "packageJson": {\n      "main": "dist/{main}.js"\n    }\n  }\n}\n')),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u4fee\u6539\u5168\u90e8")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "teambit.workspace/variants": {\n    "{ui/*}": {\n      "teambit.pkg/pkg": {\n        "packageJson": {\n          "private": false,\n          "main": "dist/{main}.js",\n          "custom-prop": "value"\n        }\n      }\n    }\n  }\n}\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="my-env.env.ts"',title:'"my-env.env.ts"'},"import { PackageEnv } from '@teambit/envs';\n\nexport class MyEnv implements PackageEnv {\n  getPackageJsonProps() {\n    return {\n      main: 'dist/{main}.js',\n      types: '{main}.ts',\n    };\n  }\n}\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"my-env.main.runtime.ts",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"provider - \u5408\u5e76 pkg"))),(0,i.kt)("li",{parentName:"ul"},"\u7ef4\u62a4\u7ec4\u4ef6\u7684 package.json"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://bit.dev/teambit/pkg/pkg"},"https://bit.dev/teambit/pkg/pkg"))),(0,i.kt)("h2",{id:"\u901a\u8fc7\u4ee3\u7801\u83b7\u53d6\u7ec4\u4ef6\u4fe1\u606f"},"\u901a\u8fc7\u4ee3\u7801\u83b7\u53d6\u7ec4\u4ef6\u4fe1\u606f"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"import { Workspace, WorkspaceAspect } from '@teambit/workspace';\n// ...\nexport class MetadataRetrieval {\n  // ...\n  static dependencies = [WorkspaceAspect];\n  static async provider([workspace]: [Workspace]) {\n    // scope.get(componentId)\n    // component.getHost().get(componentId)\n    const component = await this.workspace.get(componentId);\n    /* retrieve the custom metadata provided by this aspect */\n    const componentCustomMetadata = component.state.aspects.get(MetadataRetrievalAspect.id).data;\n    return new CustomMetadataMain();\n  }\n}\n")))}b.isMDXComponent=!0}}]);