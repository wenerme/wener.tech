/*! For license information please see 1696b415.f3c2ebf7.js.LICENSE.txt */
"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[80008],{1244:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>i,default:()=>d,frontMatter:()=>s,metadata:()=>a,toc:()=>c});var r=t(2488),o=t(62780);const s={tags:["Tuning"]},i="HAProxy Tuning",a={id:"devops/web/haproxy/haproxy-tuning",title:"HAProxy Tuning",description:"- maxconn",source:"@site/../notes/devops/web/haproxy/haproxy-tuning.md",sourceDirName:"devops/web/haproxy",slug:"/devops/web/haproxy/tuning",permalink:"/notes/devops/web/haproxy/tuning",draft:!1,unlisted:!1,editUrl:"https://github.com/wenerme/wener/edit/master/notes/../notes/devops/web/haproxy/haproxy-tuning.md",tags:[{label:"Tuning",permalink:"/notes/tags/tuning"}],version:"current",lastUpdatedBy:"wener",lastUpdatedAt:1688543048,formattedLastUpdatedAt:"Jul 5, 2023",frontMatter:{tags:["Tuning"]},sidebar:"docs",previous:{title:"SPOE",permalink:"/notes/devops/web/haproxy/spoe"},next:{title:"HAProxy Version",permalink:"/notes/devops/web/haproxy/version"}},p={},c=[];function l(e){const n={a:"a",code:"code",h1:"h1",li:"li",pre:"pre",ul:"ul",...(0,o.M)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"haproxy-tuning",children:"HAProxy Tuning"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'haproxy -vv\necho "show info" | socat stdio /run/haproxy-runtime-api.sock\n'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"maxconn"}),"\n",(0,r.jsxs)(n.li,{children:["CPU Pinning\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"nbproc"}),"\n",(0,r.jsx)(n.li,{children:"nbthread"}),"\n",(0,r.jsx)(n.li,{children:"cpu-map"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ini",metastring:'title="/etc/sysctl.d/30-haproxy.conf"',children:"net.ipv4.tcp_rmem            = 4096 16060 262144\nnet.ipv4.tcp_wmem            = 4096 16384 262144\nnet.ipv4.tcp_tw_reuse        = 1\nnet.ipv4.ip_local_port_range = 1024 65023\nnet.ipv4.tcp_max_syn_backlog = 60000\n#net.ipv4.tcp_fin_timeout     = 30\nnet.ipv4.tcp_synack_retries  = 3\nnet.core.somaxconn           = 60000\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.haproxy.com/documentation/hapee/latest/getting-started/system-tuning/",children:"https://www.haproxy.com/documentation/hapee/latest/getting-started/system-tuning/"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# CPU Pinning\nnbproc 2\ncpu-map 1 0\ncpu-map 2 1\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.haproxy.com/blog/multithreading-in-haproxy",children:"https://www.haproxy.com/blog/multithreading-in-haproxy"})}),"\n"]})]})}function d(e={}){const{wrapper:n}={...(0,o.M)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},38088:(e,n,t)=>{var r=t(96651),o=Symbol.for("react.element"),s=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p={key:!0,ref:!0,__self:!0,__source:!0};function c(e,n,t){var r,s={},c=null,l=null;for(r in void 0!==t&&(c=""+t),void 0!==n.key&&(c=""+n.key),void 0!==n.ref&&(l=n.ref),n)i.call(n,r)&&!p.hasOwnProperty(r)&&(s[r]=n[r]);if(e&&e.defaultProps)for(r in n=e.defaultProps)void 0===s[r]&&(s[r]=n[r]);return{$$typeof:o,type:e,key:c,ref:l,props:s,_owner:a.current}}n.Fragment=s,n.jsx=c,n.jsxs=c},2488:(e,n,t)=>{e.exports=t(38088)},62780:(e,n,t)=>{t.d(n,{I:()=>a,M:()=>i});var r=t(96651);const o={},s=r.createContext(o);function i(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);