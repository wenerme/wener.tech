/*! For license information please see ad3d0857.488575b5.js.LICENSE.txt */
"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[9149],{6512:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>s,default:()=>m,frontMatter:()=>t,metadata:()=>a,toc:()=>c});var l=i(11527),r=i(47214);const t={title:"magefile"},s="mega",a={id:"dev/build/mage",title:"magefile",description:"- \u4f18\u52bf",source:"@site/../notes/dev/build/mage.md",sourceDirName:"dev/build",slug:"/dev/build/mage",permalink:"/notes/dev/build/mage",draft:!1,unlisted:!1,editUrl:"https://github.com/wenerme/wener/edit/master/notes/../notes/dev/build/mage.md",tags:[],version:"current",lastUpdatedBy:"wener",lastUpdatedAt:1627915171,formattedLastUpdatedAt:"Aug 2, 2021",frontMatter:{title:"magefile"},sidebar:"docs",previous:{title:"LLVM IR",permalink:"/notes/dev/build/llvm"},next:{title:"make",permalink:"/notes/dev/build/make"}},o={},c=[];function d(e){const n={a:"a",code:"code",h1:"h1",li:"li",pre:"pre",ul:"ul",...(0,r.a)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.h1,{id:"mega",children:"mega"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u4f18\u52bf\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u6709 Makefile \u7c7b\u4f3c\u7684\u8bed\u4e49\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Target\u3001\u4f9d\u8d56\u3001\u6587\u4ef6\u53d8\u5316\u68c0\u6d4b"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"\u901a\u8fc7 Go \u7f16\u7801"}),"\n",(0,l.jsx)(n.li,{children:"\u53ef\u4ee5\u4f7f\u7528\u4efb\u610f\u5e93"}),"\n",(0,l.jsx)(n.li,{children:"\u53ef\u4ee5\u7f16\u8bd1"}),"\n",(0,l.jsx)(n.li,{children:"\u65b9\u4fbf\u4f9d\u8d56\u5176\u4ed6\u5730\u65b9\u7684 Target"}),"\n",(0,l.jsx)(n.li,{children:"\u53ef\u4ee5\u4e0d\u7528\u5b89\u88c5\uff0c\u53ea\u9700\u8981 Go"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\u52a3\u52bf\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u975e\u9759\u6001\u7f16\u8bd1\u5219\u4f9d\u8d56 Go"}),"\n",(0,l.jsx)(n.li,{children:"\u9759\u6001\u9700\u8981\u4ea4\u53c9\u7f16\u8bd1\u591a\u5e73\u53f0 - \u5176\u4ed6\u7684 task runner \u7531\u5b98\u65b9\u63d0\u4f9b\u7f16\u8bd1\u597d\u7684"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\u573a\u666f\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u4f8b\u5982 \u5b9a\u4e49\u4e00\u4e2a Yaml \u8868\u793a\u8981\u505a\u7684 Task\uff0c\u901a\u8fc7 Go \u89e3\u6790\u7136\u540e\u6267\u884c\u4f1a\u5f88\u5bb9\u6613"}),"\n",(0,l.jsx)(n.li,{children:"\u590d\u6742\u7684\u81ea\u5b9a\u4e49\u4efb\u52a1\u903b\u8f91"}),"\n",(0,l.jsxs)(n.li,{children:["\u805a\u5408\u5176\u4ed6\u5305\u4f5c\u4e3a\u547d\u4ee4\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u4f8b\u5982 shfmt\u3001sprig - \u7c7b\u4f3c\u4e8e busybox"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"\u9a8c\u8bc1\u6d4b\u8bd5 Go \u4ee3\u7801"}),"\n",(0,l.jsxs)(n.li,{children:["\u81ea\u5b9a\u4e49\u547d\u4ee4\u5de5\u5177\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u7c7b\u4f3c\u4e8e cobra - \u4f46\u53ef\u6dfb\u52a0 go \u81ea\u5b9a\u4e49"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\u6ce8\u610f\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Target \u4e0d\u652f\u6301 flag\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/magefile/mage/issues/24",children:"magefile/mage#24"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\u53c2\u8003\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://magefile.org/environment/",children:"ENVIRONMENT VARIABLES"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"go get -u -d github.com/magefile/mage\ncd $GOPATH/src/github.com/magefile/mage\ngit pull\ngo run bootstrap.go\n\nmage -init\nmage -l\n\n# \u7f16\u8bd1\u4e3a\u53ef\u6267\u884c\u6587\u4ef6 - \u4f1a\u5ffd\u7565 GOOS GOARCH\n# \u4f7f\u7528 -goos -goarch \u4ea4\u53c9\u7f16\u8bd1\nmage -compile ./builder\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-go",children:'// magefile \u9700\u8981\u8be5 Tag\n// +build mage\n\nimport "github.com/magefile/mage/mg"\nimport "github.com/magefile/mage/sh"\n// Dir Glob Path\n// import "github.com/magefile/mage/target"\n\nvar Default = Build\nvar Aliases = map[string]interface{} {\n  "i":     Install,\n  "build": Build,\n  "ls":    List,\n}\n\n// \u652f\u6301\u7684 Target \u51fd\u6570\u7b7e\u540d\nfunc Install(){}\nfunc Deploy() error {return nil}\nfunc List(context.Context)\nfunc Build(context.Context) error {\n  // \u4f9d\u8d56\n  mg.Deps(Install)\n  return nil\n}\n\n// \u547d\u540d\u7a7a\u95f4\n// mage build:site\ntype Build mg.Namespace\nfunc (Build) Site() error {\n  return nil\n}\nfunc (Build) Docs() {}\n\n\n// \u5bfc\u5165\u5176\u4ed6 Target\n// \u4f1a\u5ffd\u7565 default \u548c alias\nimport (\n  // \u6ce8\u91ca\u662f\u5fc5\u987b\u7684 - \u5bfc\u5165\u5230\u6839\u547d\u540d\u7a7a\u95f4\n  // mage:import\n  _ "example.com/me/foobar"\n  // \u5bfc\u5165\u5230 build \u547d\u540d\u7a7a\u95f4 - mage build:deploy\n  // mage:import build\n  "example.com/me/builder"\n)\n\n// \u53ef\u76f4\u63a5\u4f7f\u7528 go build -tags mage \u6765\u7f16\u8bd1 \u6216 go run main.go -l \u6765\u6267\u884c\n// +build ignore\npackage main\nimport (\n\t"os"\n\t"github.com/magefile/mage/mage"\n)\nfunc main() {\n\tos.Exit(mage.Main())\n}\n'})})]})}function m(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}},3354:(e,n,i)=>{var l=i(50959),r=Symbol.for("react.element"),t=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,a=l.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function c(e,n,i){var l,t={},c=null,d=null;for(l in void 0!==i&&(c=""+i),void 0!==n.key&&(c=""+n.key),void 0!==n.ref&&(d=n.ref),n)s.call(n,l)&&!o.hasOwnProperty(l)&&(t[l]=n[l]);if(e&&e.defaultProps)for(l in n=e.defaultProps)void 0===t[l]&&(t[l]=n[l]);return{$$typeof:r,type:e,key:c,ref:d,props:t,_owner:a.current}}n.Fragment=t,n.jsx=c,n.jsxs=c},11527:(e,n,i)=>{e.exports=i(3354)},47214:(e,n,i)=>{i.d(n,{Z:()=>a,a:()=>s});var l=i(50959);const r={},t=l.createContext(r);function s(e){const n=l.useContext(t);return l.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),l.createElement(t.Provider,{value:n},e.children)}}}]);