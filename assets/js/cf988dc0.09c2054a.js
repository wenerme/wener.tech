"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[20413],{49613:function(e,t,r){r.d(t,{Zo:function(){return m},kt:function(){return k}});var n=r(59496);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var s=n.createContext({}),p=function(e){var t=n.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):l(l({},t),e)),r},m=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},c="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},g=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,o=e.originalType,s=e.parentName,m=i(e,["components","mdxType","originalType","parentName"]),c=p(r),g=a,k=c["".concat(s,".").concat(g)]||c[g]||u[g]||o;return r?n.createElement(k,l(l({ref:t},m),{},{components:r})):n.createElement(k,l({ref:t},m))}));function k(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=r.length,l=new Array(o);l[0]=g;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i[c]="string"==typeof e?e:a,l[1]=i;for(var p=2;p<o;p++)l[p]=r[p];return n.createElement.apply(null,l)}return n.createElement.apply(null,r)}g.displayName="MDXCreateElement"},26387:function(e,t,r){r.r(t),r.d(t,{assets:function(){return h},contentTitle:function(){return f},default:function(){return y},frontMatter:function(){return k},metadata:function(){return d},toc:function(){return v}});var n=r(49613),a=Object.defineProperty,o=Object.defineProperties,l=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,p=Object.prototype.propertyIsEnumerable,m=(e,t,r)=>t in e?a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,c=(e,t)=>{for(var r in t||(t={}))s.call(t,r)&&m(e,r,t[r]);if(i)for(var r of i(t))p.call(t,r)&&m(e,r,t[r]);return e},u=(e,t)=>o(e,l(t)),g=(e,t)=>{var r={};for(var n in e)s.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&i)for(var n of i(e))t.indexOf(n)<0&&p.call(e,n)&&(r[n]=e[n]);return r};const k={title:"Logging Format"},f="\u65e5\u5fd7\u683c\u5f0f",d={unversionedId:"service/observability/logging/logging-format",id:"service/observability/logging/logging-format",title:"Logging Format",description:"- \u7528\u4e8e\u53c2\u8003\u8bbe\u8ba1 - \u8f93\u51fa\u201c\u53cb\u597d\u201d\u7684\u65e5\u5fd7",source:"@site/../notes/service/observability/logging/logging-format.md",sourceDirName:"service/observability/logging",slug:"/service/observability/logging/format",permalink:"/notes/service/observability/logging/format",draft:!1,editUrl:"https://github.com/wenerme/wener/edit/master/notes/../notes/service/observability/logging/logging-format.md",tags:[],version:"current",lastUpdatedBy:"wener",lastUpdatedAt:1701580433,formattedLastUpdatedAt:"Dec 3, 2023",frontMatter:{title:"Logging Format"},sidebar:"docs",previous:{title:"Logging Awesome",permalink:"/notes/service/observability/logging/awesome"},next:{title:"logging-operator",permalink:"/notes/service/observability/logging/operator"}},h={},v=[{value:"\u7ed3\u6784\u5316",id:"structured",level:2},{value:"APISIX",id:"apisix",level:3},{value:"\u53c2\u8003",id:"reference",level:2},{value:"UserAgent",id:"useragent",level:2}],N={toc:v},b="wrapper";function y(e){var t=e,{components:r}=t,a=g(t,["components"]);return(0,n.kt)(b,u(c(c({},N),a),{components:r,mdxType:"MDXLayout"}),(0,n.kt)("h1",c({},{id:"\u65e5\u5fd7\u683c\u5f0f"}),"\u65e5\u5fd7\u683c\u5f0f"),(0,n.kt)("admonition",c({},{title:"\u5b66\u4e60\u548c\u68b3\u7406\u73b0\u6709\u7684\u65e5\u5fd7\u683c\u5f0f",type:"tip"}),(0,n.kt)("ul",{parentName:"admonition"},(0,n.kt)("li",{parentName:"ul"},"\u7528\u4e8e\u53c2\u8003\u8bbe\u8ba1 - \u8f93\u51fa\u201c\u53cb\u597d\u201d\u7684\u65e5\u5fd7"),(0,n.kt)("li",{parentName:"ul"},"\u7528\u4e8e\u786e\u5b9a\u9700\u8981\u5728\u65e5\u5fd7\u91cc\u5305\u542b\u4ec0\u4e48\u5185\u5bb9"),(0,n.kt)("li",{parentName:"ul"},"\u7528\u4e8e\u89e3\u6790\u65e5\u5fd7"))),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Apache Log"),(0,n.kt)("li",{parentName:"ul"},"Common Log - CLF - Common Log Format ",(0,n.kt)("a",c({parentName:"li"},{href:"https://httpd.apache.org/docs/current/logs.html#common"}),"https://httpd.apache.org/docs/current/logs.html#common"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"NCSA Common Log Format"))),(0,n.kt)("li",{parentName:"ul"},"CEF - Common Event Format"),(0,n.kt)("li",{parentName:"ul"},"glog - Google Logging Library"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",c({parentName:"li"},{href:"https://github.com/kubernetes/klog"}),"klog")," - Kubernetes Log"),(0,n.kt)("li",{parentName:"ul"},"syslog",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"authorization",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"/var/log/auth.log - Debian"),(0,n.kt)("li",{parentName:"ul"},"/var/log/secure - RHEL"))))),(0,n.kt)("li",{parentName:"ul"},"logfmt",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",c({parentName:"li"},{href:"https://brandur.org/logfmt"}),"https://brandur.org/logfmt")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",c({parentName:"li"},{href:"https://pkg.go.dev/github.com/kr/logfmt#section-documentation"}),"https://pkg.go.dev/github.com/kr/logfmt#section-documentation")))),(0,n.kt)("li",{parentName:"ul"},"nginx log - nginx access log"),(0,n.kt)("li",{parentName:"ul"},"ruby hash - ",(0,n.kt)("inlineCode",{parentName:"li"},'{"key" => "value"}')),(0,n.kt)("li",{parentName:"ul"},"Graylog Extended Log Format - GELF",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",c({parentName:"li"},{href:"https://graylog.org/features/gelf/"}),"https://graylog.org/features/gelf/")))),(0,n.kt)("li",{parentName:"ul"},"Windows Event Log - ",(0,n.kt)("a",c({parentName:"li"},{href:"https://docs.microsoft.com/en-us/windows/win32/wes/windows-event-log"}),"https://docs.microsoft.com/en-us/windows/win32/wes/windows-event-log")),(0,n.kt)("li",{parentName:"ul"},"IIS Log File Format - ",(0,n.kt)("a",c({parentName:"li"},{href:"https://docs.microsoft.com/en-us/previous-versions/iis/6.0-sdk/ms525807(v=vs.90)"}),"https://docs.microsoft.com/en-us/previous-versions/iis/6.0-sdk/ms525807(v=vs.90)"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"Timestamp"),(0,n.kt)("li",{parentName:"ul"},"Client IP"),(0,n.kt)("li",{parentName:"ul"},"Server IP"),(0,n.kt)("li",{parentName:"ul"},"URI-Stem"),(0,n.kt)("li",{parentName:"ul"},"HTTP Status Code"),(0,n.kt)("li",{parentName:"ul"},"Bytes Sent"),(0,n.kt)("li",{parentName:"ul"},"Bytes Received"),(0,n.kt)("li",{parentName:"ul"},"Time Taken"),(0,n.kt)("li",{parentName:"ul"},"Version"))),(0,n.kt)("li",{parentName:"ul"},"ODBC"),(0,n.kt)("li",{parentName:"ul"},"W3C Extended Log File Format"),(0,n.kt)("li",{parentName:"ul"},"NestJS - ",(0,n.kt)("a",c({parentName:"li"},{href:"https://github.com/nestjs/nest/blob/master/packages/common/services/console-logger.service.ts"}),"https://github.com/nestjs/nest/blob/master/packages/common/services/console-logger.service.ts"))),(0,n.kt)("pre",null,(0,n.kt)("code",c({parentName:"pre"},{}),"[Nest] 4262  - 2023/12/03 00:20:23     DEBUG [InstanceLoader] MikroOrmModule dependencies initialized +0ms\n[Nest] %PID  - %Timestamp %Level [%Context] %Message %TimeDiff\n")),(0,n.kt)("h2",c({},{id:"structured"}),"\u7ed3\u6784\u5316"),(0,n.kt)("h3",c({},{id:"apisix"}),"APISIX"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",c({parentName:"li"},{href:"https://apisix.apache.org/docs/apisix/plugins/elasticsearch-logger/"}),"https://apisix.apache.org/docs/apisix/plugins/elasticsearch-logger/"))),(0,n.kt)("pre",null,(0,n.kt)("code",c({parentName:"pre"},{className:"language-json"}),'{\n  "apisix_latency": 0,\n  "route_id": "1",\n  "server": {\n    "version": "2.15.0",\n    "hostname": "apisix"\n  },\n  "request": {\n    "size": 102,\n    "uri": "/elasticsearch.do?q=hello",\n    "querystring": {\n      "q": "hello"\n    },\n    "headers": {\n      "user-agent": "curl/7.29.0",\n      "host": "127.0.0.1:9080",\n      "accept": "*/*"\n    },\n    "url": "http://127.0.0.1:9080/elasticsearch.do?q=hello",\n    "method": "GET"\n  },\n  "service_id": "",\n  "latency": 0,\n  "upstream": "127.0.0.1:1980",\n  "upstream_latency": 1,\n  "client_ip": "127.0.0.1",\n  "start_time": 1661170929107,\n  "response": {\n    "size": 192,\n    "headers": {\n      "date": "Mon, 22 Aug 2022 12:22:09 GMT",\n      "server": "APISIX/2.15.0",\n      "content-type": "text/plain; charset=utf-8",\n      "connection": "close",\n      "transfer-encoding": "chunked"\n    },\n    "status": 200\n  }\n}\n')),(0,n.kt)("h2",c({},{id:"reference"}),"\u53c2\u8003"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"syntax",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"re2"),(0,n.kt)("li",{parentName:"ul"},"kv"),(0,n.kt)("li",{parentName:"ul"},"CSV"),(0,n.kt)("li",{parentName:"ul"},"JSON"),(0,n.kt)("li",{parentName:"ul"},"grok - ",(0,n.kt)("a",c({parentName:"li"},{href:"https://github.com/daschl/grok/tree/master/patterns"}),"https://github.com/daschl/grok/tree/master/patterns")),(0,n.kt)("li",{parentName:"ul"},"xml"),(0,n.kt)("li",{parentName:"ul"},"timestamp"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",c({parentName:"li"},{href:"https://vector.dev/docs/reference/vrl/functions/#parse_syslog"}),"https://vector.dev/docs/reference/vrl/functions/#parse_syslog"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"vrl ",(0,n.kt)("inlineCode",{parentName:"li"},"parse_*")))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",c({parentName:"li"},{href:"https://graylog.org/post/log-formats-a-complete-guide/"}),"https://graylog.org/post/log-formats-a-complete-guide/")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",c({parentName:"li"},{href:"https://www.crowdstrike.com/cybersecurity-101/observability/log-file-formats/"}),"https://www.crowdstrike.com/cybersecurity-101/observability/log-file-formats/"))),(0,n.kt)("h2",c({},{id:"useragent"}),"UserAgent"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"\u6d4f\u89c8\u5668 UserAgen \u5305\u542b\u76f8\u5f53\u591a\u7684\u4fe1\u606f\uff0c\u683c\u5f0f\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u53c2\u8003"),(0,n.kt)("li",{parentName:"ul"},"\u5982\u679c\u4f7f\u7528\u76f8\u540c\u7684\u683c\u5f0f\uff0c\u89e3\u6790\u5de5\u5177\u53ef\u4ee5\u590d\u7528"),(0,n.kt)("li",{parentName:"ul"},"\u5d4c\u5165\u5f0f WebView \u7684\u65f6\u5019\u901a\u5e38\u4e5f\u5305\u542b\u81ea\u5df1\u7684\u4fe1\u606f",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"\u4f8b\u5982: \u5fae\u4fe1\u3001\u4f01\u4e1a\u5fae\u4fe1 \u7b49")))),(0,n.kt)("pre",null,(0,n.kt)("code",c({parentName:"pre"},{}),"Mozilla Firefox 1.0.1 Mozilla/5.0 (X11; U; Linux i686; de-DE; rv:1.7.6) Gecko/20050223 Firefox/1.0.1\n")),(0,n.kt)("pre",null,(0,n.kt)("code",c({parentName:"pre"},{className:"language-json"}),'{\n  "browser": {\n    "family": "Internet Explorer",\n    "version": "7.66"\n  },\n  "device": {\n    "category": "pc"\n  },\n  "os": {\n    "family": "Windows XP",\n    "version": "NT 5.1"\n  }\n}\n')),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"\u8fdb\u4e00\u6b65\u89e3\u6790")),(0,n.kt)("pre",null,(0,n.kt)("code",c({parentName:"pre"},{}),"Opera/9.80 (J2ME/MIDP; Opera Mini/4.3.24214; iPhone; CPU iPhone OS 4_2_1 like Mac OS X; AppleWebKit/24.783; U; en) Presto/2.5.25 Version/10.54\n")),(0,n.kt)("pre",null,(0,n.kt)("code",c({parentName:"pre"},{className:"language-json"}),'{\n  "browser": {\n    "family": "Opera Mini",\n    "major": "4",\n    "minor": "3",\n    "patch": "24214",\n    "version": "10.54"\n  },\n  "device": {\n    "brand": "Apple",\n    "category": "smartphone",\n    "family": "iPhone",\n    "model": "iPhone"\n  },\n  "os": {\n    "family": "iOS",\n    "major": "4",\n    "minor": "2",\n    "patch": "1",\n    "patch_minor": null,\n    "version": "4.2.1"\n  }\n}\n')))}y.isMDXComponent=!0}}]);