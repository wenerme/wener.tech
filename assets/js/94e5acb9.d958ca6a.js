/*! For license information please see 94e5acb9.d958ca6a.js.LICENSE.txt */
"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[12144],{19948:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>i,default:()=>h,frontMatter:()=>l,metadata:()=>o,toc:()=>c});var r=s(2488),t=s(62780);const l={title:"Lens"},i="Lens",o={id:"devops/kubernetes/app/lens",title:"Lens",description:"- MuhammedKalkan/OpenLens",source:"@site/../notes/devops/kubernetes/app/lens.md",sourceDirName:"devops/kubernetes/app",slug:"/devops/kubernetes/app/lens",permalink:"/notes/devops/kubernetes/app/lens",draft:!1,unlisted:!1,editUrl:"https://github.com/wenerme/wener/edit/master/notes/../notes/devops/kubernetes/app/lens.md",tags:[],version:"current",lastUpdatedBy:"wener",lastUpdatedAt:1669789233,formattedLastUpdatedAt:"Nov 30, 2022",frontMatter:{title:"Lens"},sidebar:"docs",previous:{title:"KubeVirt",permalink:"/notes/devops/kubernetes/app/kubevirt"},next:{title:"MinIO Kubernetes Operator",permalink:"/notes/devops/kubernetes/app/minio-operator"}},a={},c=[{value:"extensions/metrics-cluster-feature",id:"extensionsmetrics-cluster-feature",level:2},{value:"kube-prometheus",id:"kube-prometheus",level:3},{value:"features/user-mode",id:"featuresuser-mode",level:2}];function u(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",pre:"pre",ul:"ul",...(0,t.M)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"lens",children:"Lens"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://github.com/MuhammedKalkan/OpenLens",children:"MuhammedKalkan/OpenLens"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u4e0d\u8981\u6c42\u767b\u9646"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://github.com/lensapp/lens",children:"lensapp/lens"})," - Lens - The Kubernetes IDE"]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/lensapp/lens/tree/master/extensions/metrics-cluster-feature",children:"extensions/metrics-cluster-feature"})}),"\n",(0,r.jsxs)(n.li,{children:["src/features/user-mode\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["ClusterRole lens-user\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"LIST namespace"}),"\n",(0,r.jsx)(n.li,{children:"system:authenticated"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"\u5141\u8bb8\u975e\u7ba1\u7406\u5458\u80fd\u8bbf\u95ee\u6709\u6743\u9650\u8bbf\u95ee\u7684\u7a7a\u95f4"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.admonition,{type:"caution",children:(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u65e0\u6cd5\u4f7f\u7528\u5916\u90e8 prometheus - ",(0,r.jsx)(n.a,{href:"https://github.com/lensapp/lens/issues/909",children:"#909"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u53ef\u4ee5\u7528 promxy \u4ee3\u7406\u73b0\u6709\u7684\u5916\u90e8 prometheus - \u5728\u5185\u90e8\u4f7f\u7528"}),"\n"]}),"\n"]}),"\n"]})}),"\n",(0,r.jsx)(n.h2,{id:"extensionsmetrics-cluster-feature",children:"extensions/metrics-cluster-feature"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Namespace lens-metrics\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["StatefulSet prometheus\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["prometheus\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"--storage.tsdb.retention.time=2d"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"--storage.tsdb.retention.size=5GB"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"ServiceAccount prometheus"}),"\n",(0,r.jsxs)(n.li,{children:["Service prometheus\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"80 -> 9090"}),"\n",(0,r.jsx)(n.li,{children:"prometheus.io/scrape: 'true'"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["ConfigMap prometheus-config\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"prometheus.yaml"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["ConfigMap prometheus-rules\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"alertmanager.rules.yaml"}),"\n",(0,r.jsx)(n.li,{children:"etcd3.rules.yaml"}),"\n",(0,r.jsx)(n.li,{children:"general.rules.yaml"}),"\n",(0,r.jsx)(n.li,{children:"kube-state-metrics.rules.yaml"}),"\n",(0,r.jsx)(n.li,{children:"kubelet.rules.yaml"}),"\n",(0,r.jsx)(n.li,{children:"kubernetes.rules.yaml"}),"\n",(0,r.jsx)(n.li,{children:"node.rules.yaml"}),"\n",(0,r.jsx)(n.li,{children:"prometheus.rules.yaml"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["ClusterRole - lens-prometheus\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"ServiceAccount prometheus"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["DaemonSet - node-exporter\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Service 80 -> 9100"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"Deployment - kube-state-metrics"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/lensapp/lens/blob/master/troubleshooting/custom-prometheus.md",children:"Using Custom Prometheus"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u53ef\u4ee5\u4f7f\u7528 HELM \u5b89\u88c5\u7684 - \u9700\u8981\u6293\u53d6\u65f6\u95f4\u5c0f\u4e8e 1 \u5206\u949f\nhelm upgrade --set server.global.scrape_interval=30s prometheus stable/prometheus\n"})}),"\n",(0,r.jsx)(n.h3,{id:"kube-prometheus",children:"kube-prometheus"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u652f\u6301\u9700\u8981 ",(0,r.jsx)(n.a,{href:"https://github.com/lensapp/lens/blob/master/troubleshooting/custom-prometheus.md#kube-prometheus",children:"relabel"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u8be5\u8bf4\u660e\u6709\u95ee\u9898"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\u9009\u62e9 helm \u5b89\u88c5\uff0c\u6307\u5b9a ",(0,r.jsx)(n.code,{children:"monitoring/kube-prometheus-prometheus:9090"})]}),"\n"]}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://github.com/lensapp/lens/issues/180",children:"#180"})," - Documentation is incorrect for Prometheus troubleshooting"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://github.com/lensapp/lens/issues/656",children:"#656"})," - What are the requirements to make my prometheus deployment compatible with Lens?"]}),"\n"]})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",metastring:'title="bitnam/kube-prometheus/values.yaml"',children:"# Lens\n# ====\nnode-exporter:\n  serviceMonitor:\n    # interval: 10s\n    relabelings:\n      - action: replace\n        regex: (.*)\n        replacement: $1\n        sourceLabels:\n          - __meta_kubernetes_pod_node_name\n        targetLabel: kubernetes_node\n\nkubelet:\n  serviceMonitor:\n    # interval: 15s\n    metricRelabelings:\n      - action: replace\n        sourceLabels:\n          - node\n        targetLabel: instance\n\n# limit & request works\nkube-state-metrics:\n  serviceMonitor:\n    honorLabels: true\n"})}),"\n",(0,r.jsx)(n.h2,{id:"featuresuser-mode",children:"features/user-mode"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"apiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n  name: lens-user\nrules:\n  - verbs:\n      - list\n    apiGroups:\n      - ''\n    resources:\n      - namespaces\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRoleBinding\nmetadata:\n  name: lens-user\nsubjects:\n  - kind: Group\n    apiGroup: rbac.authorization.k8s.io\n    name: 'system:authenticated'\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: ClusterRole\n  name: lens-user\n"})})]})}function h(e={}){const{wrapper:n}={...(0,t.M)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}},38088:(e,n,s)=>{var r=s(96651),t=Symbol.for("react.element"),l=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function c(e,n,s){var r,l={},c=null,u=null;for(r in void 0!==s&&(c=""+s),void 0!==n.key&&(c=""+n.key),void 0!==n.ref&&(u=n.ref),n)i.call(n,r)&&!a.hasOwnProperty(r)&&(l[r]=n[r]);if(e&&e.defaultProps)for(r in n=e.defaultProps)void 0===l[r]&&(l[r]=n[r]);return{$$typeof:t,type:e,key:c,ref:u,props:l,_owner:o.current}}n.Fragment=l,n.jsx=c,n.jsxs=c},2488:(e,n,s)=>{e.exports=s(38088)},62780:(e,n,s)=>{s.d(n,{I:()=>o,M:()=>i});var r=s(96651);const t={},l=r.createContext(t);function i(e){const n=r.useContext(l);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),r.createElement(l.Provider,{value:n},e.children)}}}]);