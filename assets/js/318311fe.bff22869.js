/*! For license information please see 318311fe.bff22869.js.LICENSE.txt */
"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[16199],{99554:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>d,contentTitle:()=>t,default:()=>h,frontMatter:()=>r,metadata:()=>c,toc:()=>a});var s=i(11527),l=i(47214);const r={title:"Asterisk AMI"},t="Asterisk AMI",c={id:"voip/asterisk/asterisk-ami",title:"Asterisk AMI",description:"- AMI - Asterisk Manager Interface",source:"@site/../notes/voip/asterisk/asterisk-ami.md",sourceDirName:"voip/asterisk",slug:"/voip/asterisk/ami",permalink:"/notes/voip/asterisk/ami",draft:!1,unlisted:!1,editUrl:"https://github.com/wenerme/wener/edit/master/notes/../notes/voip/asterisk/asterisk-ami.md",tags:[],version:"current",lastUpdatedBy:"wener",lastUpdatedAt:1621756378,formattedLastUpdatedAt:"May 23, 2021",frontMatter:{title:"Asterisk AMI"},sidebar:"docs",previous:{title:"Asterisk AGI",permalink:"/notes/voip/asterisk/agi"},next:{title:"ARI",permalink:"/notes/voip/asterisk/air"}},d={},a=[{value:"AMI \u534f\u8bae",id:"ami-\u534f\u8bae",level:2},{value:"\u4e00\u6b21\u547c\u53eb\u8fc7\u7a0b\u4ea7\u751f\u7684\u4e8b\u4ef6",id:"\u4e00\u6b21\u547c\u53eb\u8fc7\u7a0b\u4ea7\u751f\u7684\u4e8b\u4ef6",level:2}];function o(n){const e={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.a)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.h1,{id:"asterisk-ami",children:"Asterisk AMI"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"AMI - Asterisk Manager Interface"}),"\n",(0,s.jsxs)(e.li,{children:["\u914d\u7f6e\u6587\u4ef6 ",(0,s.jsx)(e.code,{children:"manager.conf"})]}),"\n",(0,s.jsx)(e.li,{children:"\u9ed8\u8ba4\u7aef\u53e3 5038"}),"\n",(0,s.jsxs)(e.li,{children:["\u670d\u52a1\u7aef\u4f1a\u4e3b\u52a8\u53d1\u9001\u5934 ",(0,s.jsx)(e.code,{children:"Asterisk Call Manager/3.2.0"})]}),"\n",(0,s.jsx)(e.li,{children:"\u54cd\u5e94\u5747\u4e3a\u5f02\u6b65\u4e8b\u4ef6"}),"\n",(0,s.jsx)(e.li,{children:"\u5305\u7c7b\u578b\u5206\u4e3a: \u4e8b\u4ef6, \u54cd\u5e94, \u548c\u53d1\u9001\u7684\u64cd\u4f5c"}),"\n",(0,s.jsx)(e.li,{children:"\u683c\u5f0f\u7c7b\u4f3c\u4e8e HTTP \u5934"}),"\n",(0,s.jsx)(e.li,{children:"Action,Response,Event \u5fc5\u987b\u5728\u7b2c\u4e00\u884c"}),"\n",(0,s.jsx)(e.li,{children:"\u8bf7\u6c42\u901a\u8fc7 ActionID, \u670d\u52a1\u7aef\u8fd4\u56de ActionID \u6765\u8bc6\u522b\u54cd\u5e94"}),"\n",(0,s.jsxs)(e.li,{children:["\u4e00\u6b21\u8bf7\u6c42\u9664\u4e86\u4f1a\u8fd4\u56de\u4e00\u4e2a\u54cd\u5e94\u4ee5\u5916, \u53ef\u80fd\u8fd8\u4f1a\u8303\u56f4\u4e00\u5217\u6570\u636e, \u6b64\u65f6\u5217\u6570\u636e\u662f\u901a\u8fc7\u4e8b\u4ef6\u53d1\u9001\u7684, \u6ca1\u6709 ActionID\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\u4f8b\u5982: \u4ee5 ",(0,s.jsx)(e.code,{children:"EndpointDetail"})," \u5f00\u59cb, \u4ee5 ",(0,s.jsx)(e.code,{children:"EndpointDetailComplete"})," \u7ed3\u675f"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["Action\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"CLIENT -> Asterisk"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["Response\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"CLIENT -> Asterisk -Response-> CLIENT"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["Event\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Asterisk -> CLIENT"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\u53c2\u8003\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.a,{href:"https://wiki.asterisk.org/wiki/display/AST/AMI+v2+Specification",children:"AMI v2 Specification"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"asterisk 12+"}),"\n",(0,s.jsx)(e.li,{children:"\u7248\u672c\u53f7\u4e3a 2.0.0 - asterisk 1.8 \u662f 1.1"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.admonition,{type:"caution",children:(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"AMI v1 \u53ef\u80fd\u5185\u5bb9\u5305\u542b\u6362\u884c"}),"\n",(0,s.jsx)(e.li,{children:"UTF8 \u5305\u542b BOM - EF BB BF"}),"\n"]})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"# \u547d\u4ee4\u6587\u6863\nasterisk -rx 'manager show commands'\n# \u4e8b\u4ef6\u6587\u6863\nasterisk -rx 'manager show events'\n"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"manager.conf"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"https://github.com/asterisk/asterisk/blob/1.8/configs/manager.conf.sample",children:"1.8/configs/manager.conf.sample"})}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"ami-\u534f\u8bae",children:"AMI \u534f\u8bae"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\u521d\u59cb\u670d\u52a1\u7aef\u4f1a\u53d1\u9001\u4e00\u6761\u4fe1\u606f\u5305\u542b\u7248\u672c\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.code,{children:"Asterisk Call Manager/1.1"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.li,{children:"\u5ba2\u6237\u7aef\u4f1a\u63a5\u6536\u5230 FullyBooted \u8868\u793a\u542f\u52a8\u5b8c\u6210"}),"\n",(0,s.jsx)(e.li,{children:"\u65b0\u7248\u672c\u4f1a\u8fd4\u56de SuccessfulAuth - \u5305\u542b\u8d26\u53f7\u6743\u9650\u3001\u94fe\u63a5\u7b49\u4fe1\u606f"}),"\n",(0,s.jsx)(e.li,{children:"\u670d\u52a1\u9000\u51fa\u6216\u91cd\u542f\u4f1a\u53d1\u9001 Shutdown"}),"\n",(0,s.jsxs)(e.li,{children:["Newchannel - \u901a\u9053\u5efa\u7acb\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u5305\u542b Uniqueid \u53ef\u7528\u4e8e\u6301\u7eed\u8ddf\u8e2a\u901a\u9053"}),"\n",(0,s.jsx)(e.li,{children:"\u7136\u540e\u4f1a\u6709\u5f88\u591a VarSet - SIPURI"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"\u4e00\u6b21\u547c\u53eb\u8fc7\u7a0b\u4ea7\u751f\u7684\u4e8b\u4ef6",children:"\u4e00\u6b21\u547c\u53eb\u8fc7\u7a0b\u4ea7\u751f\u7684\u4e8b\u4ef6"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"Event: Newchannel\nPrivilege: call,all\nChannelState: 0\nCallerIDNum: 6003\nAccountCode:\nChannel: SIP/6003-000000de\nChannelStateDesc: Down\nCallerIDName:\nExten: 10085\nContext: sipinbound\nUniqueid: 1621433208.393\n"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"SIPURI=sip:6003@192.168.1.2"}),"\n",(0,s.jsx)(e.li,{children:"SIPDOMAIN=192.168.1.2"}),"\n",(0,s.jsx)(e.li,{children:"SIPCALLID=NKEVsn22tE"}),"\n",(0,s.jsx)(e.li,{children:"SIPROUTE=sip-6003 - \u5e94\u7528\u81ea\u5b9a\u4e49"}),"\n",(0,s.jsx)(e.li,{children:"Newstate - Ring"}),"\n",(0,s.jsx)(e.li,{children:"Newexten - \u6267\u884c\u7684 extension \u5e8f\u5217"}),"\n",(0,s.jsxs)(e.li,{children:["Macro \u5305\u542b\u7684\u53d8\u91cf\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"MACRO_EXTEN"}),"\n",(0,s.jsx)(e.li,{children:"MACRO_CONTEXT"}),"\n",(0,s.jsx)(e.li,{children:"MACRO_PRIORITY"}),"\n",(0,s.jsx)(e.li,{children:"MACRO_DEPTH"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["Newchannel - EXTRA/7-1 \u5bf9\u65b9\u901a\u9053\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"DIALEDPEERNUMBER=7/10086"}),"\n",(0,s.jsx)(e.li,{children:"NewCallerid EXTRA/7-1"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.li,{children:"Newstate - Dialing"}),"\n",(0,s.jsx)(e.li,{children:"Dial"}),"\n",(0,s.jsx)(e.li,{children:"RTCPReceived"}),"\n",(0,s.jsx)(e.li,{children:"RTCPSent"}),"\n",(0,s.jsx)(e.li,{children:"Newstate - Up"}),"\n",(0,s.jsx)(e.li,{children:"DIALSTATUS=ANSWER"}),"\n",(0,s.jsx)(e.li,{children:"DIALEDPEERNAME=EXTRA/7-1"}),"\n",(0,s.jsx)(e.li,{children:"BRIDGEPEER=EXTRA/7-1 - \u4e24\u4e2a\u901a\u8fbe\u8bbe\u7f6e\u5bf9\u65b9\u4e3a peer"}),"\n",(0,s.jsx)(e.li,{children:"BRIDGEPEER=SIP/6003-000000de"}),"\n",(0,s.jsx)(e.li,{children:"Bridge"}),"\n",(0,s.jsx)(e.li,{children:"BRIDGEPVTCALLID=NKEVsn22tE"}),"\n",(0,s.jsx)(e.li,{children:"Unlink - \u65ad\u5f00 bridge"}),"\n",(0,s.jsx)(e.li,{children:"ANSWEREDTIME=16"}),"\n",(0,s.jsx)(e.li,{children:"ExtraUp - \u677f\u5361 Board=1"}),"\n",(0,s.jsx)(e.li,{children:"Hangup - EXTRA/7-1"}),"\n",(0,s.jsxs)(e.li,{children:["RTPAUDIOQOS=ssrc=1662980482;themssrc=2301022491;lp=0;rxjitter=0.014852;rxcount=1238;txjitter=0.000000;txcount=1238;rlp=0;rtt=0.005000\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"RTP QOS \u4fe1\u606f"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["Hangup - SIP/6003-000000de\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"CallerIDNum: 6003"}),"\n",(0,s.jsx)(e.li,{children:"Uniqueid: 1621433208.393"}),"\n"]}),"\n"]}),"\n"]})]})}function h(n={}){const{wrapper:e}={...(0,l.a)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(o,{...n})}):o(n)}},3354:(n,e,i)=>{var s=i(50959),l=Symbol.for("react.element"),r=Symbol.for("react.fragment"),t=Object.prototype.hasOwnProperty,c=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,d={key:!0,ref:!0,__self:!0,__source:!0};function a(n,e,i){var s,r={},a=null,o=null;for(s in void 0!==i&&(a=""+i),void 0!==e.key&&(a=""+e.key),void 0!==e.ref&&(o=e.ref),e)t.call(e,s)&&!d.hasOwnProperty(s)&&(r[s]=e[s]);if(n&&n.defaultProps)for(s in e=n.defaultProps)void 0===r[s]&&(r[s]=e[s]);return{$$typeof:l,type:n,key:a,ref:o,props:r,_owner:c.current}}e.Fragment=r,e.jsx=a,e.jsxs=a},11527:(n,e,i)=>{n.exports=i(3354)},47214:(n,e,i)=>{i.d(e,{Z:()=>c,a:()=>t});var s=i(50959);const l={},r=s.createContext(l);function t(n){const e=s.useContext(r);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(l):n.components||l:t(n.components),s.createElement(r.Provider,{value:e},n.children)}}}]);