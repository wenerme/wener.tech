/*! For license information please see fd0576d5.185ca087.js.LICENSE.txt */
"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[79520],{89884:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>r,default:()=>h,frontMatter:()=>i,metadata:()=>a,toc:()=>d});var l=n(2488),s=n(62780);const i={title:"SQLite FAQ",tags:["FAQ"]},r="SQLite FAQ",a={id:"db/relational/sqlite/sqlite-faq",title:"SQLite FAQ",description:"attempt to write a readonly database",source:"@site/../notes/db/relational/sqlite/sqlite-faq.md",sourceDirName:"db/relational/sqlite",slug:"/db/relational/sqlite/faq",permalink:"/notes/db/relational/sqlite/faq",draft:!1,unlisted:!1,editUrl:"https://github.com/wenerme/wener/edit/master/notes/../notes/db/relational/sqlite/sqlite-faq.md",tags:[{label:"FAQ",permalink:"/notes/tags/faq"}],version:"current",lastUpdatedBy:"wener",lastUpdatedAt:1678453938,formattedLastUpdatedAt:"Mar 10, 2023",frontMatter:{title:"SQLite FAQ",tags:["FAQ"]},sidebar:"docs",previous:{title:"sqlar",permalink:"/notes/db/relational/sqlite/sqlar"},next:{title:"TiDB",permalink:"/notes/db/relational/tidb"}},o={},d=[{value:"attempt to write a readonly database",id:"attempt-to-write-a-readonly-database",level:2},{value:"\u5220\u9664\u4e0d\u652f\u6301 WHERE \u548c ORDER",id:"\u5220\u9664\u4e0d\u652f\u6301-where-\u548c-order",level:2},{value:"Golang database is locked (5) (SQLITE_BUSY)",id:"golang-database-is-locked-5-sqlite_busy",level:2},{value:"sqlite \u4fee\u590d",id:"sqlite-\u4fee\u590d",level:2},{value:"35% faster than fs",id:"35-faster-than-fs",level:2},{value:"BLOB or Hex TEXT",id:"blob-or-hex-text",level:2},{value:"cannot drop UNIQUE column",id:"cannot-drop-unique-column",level:2},{value:"count slow",id:"count-slow",level:2}];function c(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.M)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(t.h1,{id:"sqlite-faq",children:"SQLite FAQ"}),"\n",(0,l.jsx)(t.h2,{id:"attempt-to-write-a-readonly-database",children:"attempt to write a readonly database"}),"\n",(0,l.jsx)(t.p,{children:"\u53ef\u80fd\u662f\u6743\u9650\u4e0d\u8db3"}),"\n",(0,l.jsx)(t.h2,{id:"\u5220\u9664\u4e0d\u652f\u6301-where-\u548c-order",children:"\u5220\u9664\u4e0d\u652f\u6301 WHERE \u548c ORDER"}),"\n",(0,l.jsxs)(t.ul,{children:["\n",(0,l.jsxs)(t.li,{children:["\u9700\u8981\u4ece\u6e90\u7801\u7f16\u8bd1 ",(0,l.jsx)(t.a,{href:"https://www.sqlite.org/compile.html#enable_update_delete_limit",children:"SQLITE_ENABLE_UPDATE_DELETE_LIMIT"})]}),"\n"]}),"\n",(0,l.jsx)(t.h2,{id:"golang-database-is-locked-5-sqlite_busy",children:"Golang database is locked (5) (SQLITE_BUSY)"}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-go",children:"db.SetMaxOpenConns(1)\n"})}),"\n",(0,l.jsxs)(t.ul,{children:["\n",(0,l.jsx)(t.li,{children:"\u5982\u679c\u9700\u8981\u4e0d\u540c\u8868\u5e76\u884c\u64cd\u4f5c\uff0c\u8003\u8651\u4f7f\u7528\u591a\u4e2a sqlite \u6587\u4ef6"}),"\n",(0,l.jsx)(t.li,{children:(0,l.jsx)(t.a,{href:"https://github.com/mattn/go-sqlite3/issues/274#issuecomment-191597862",children:"https://github.com/mattn/go-sqlite3/issues/274#issuecomment-191597862"})}),"\n"]}),"\n",(0,l.jsx)(t.h2,{id:"sqlite-\u4fee\u590d",children:"sqlite \u4fee\u590d"}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-bash",children:'echo ".dump" | sqlite old.db | sqlite new.db\n'})}),"\n",(0,l.jsx)(t.h2,{id:"35-faster-than-fs",children:"35% faster than fs"}),"\n",(0,l.jsxs)(t.ul,{children:["\n",(0,l.jsxs)(t.li,{children:["read\n",(0,l.jsxs)(t.ul,{children:["\n",(0,l.jsx)(t.li,{children:"avg 10KB"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(t.li,{children:["write\n",(0,l.jsxs)(t.ul,{children:["\n",(0,l.jsx)(t.li,{children:"wal"}),"\n",(0,l.jsx)(t.li,{children:"synchronous=NORMAL"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(t.li,{children:(0,l.jsx)(t.a,{href:"https://www.sqlite.org/fasterthanfs.html",children:"https://www.sqlite.org/fasterthanfs.html"})}),"\n"]}),"\n",(0,l.jsx)(t.h2,{id:"blob-or-hex-text",children:"BLOB or Hex TEXT"}),"\n",(0,l.jsxs)(t.ul,{children:["\n",(0,l.jsxs)(t.li,{children:["BLOB - \u5b58\u50a8\u66f4\u5c11\u5185\u5bb9\n",(0,l.jsxs)(t.ul,{children:["\n",(0,l.jsx)(t.li,{children:"\u4f7f\u7528\u8c03\u8bd5\u4e0d\u65b9\u4fbf"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(t.li,{children:["Hex TEXT - \u5b58\u50a8\u66f4\u591a\u5185\u5bb9\n",(0,l.jsxs)(t.ul,{children:["\n",(0,l.jsx)(t.li,{children:"\u66f4\u591a IO\uff0c\u66f4\u6162"}),"\n",(0,l.jsx)(t.li,{children:"\u4f7f\u7528\u8c03\u8bd5\u53cb\u597d"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(t.h2,{id:"cannot-drop-unique-column",children:"cannot drop UNIQUE column"}),"\n",(0,l.jsx)(t.p,{children:"SQLite \u4e0d\u652f\u6301 drop unique \u5217\uff0c\u53ea\u6709\u5c1d\u8bd5 rename \u8868\uff0c\u5efa\u7acb\u65b0\u8868\u89e3\u51b3\u3002"}),"\n",(0,l.jsx)(t.h2,{id:"count-slow",children:"count slow"}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-sql",children:"-- \u5982\u679c\u6ca1\u8fdb\u884c\u8fc7\u5220\u9664\uff0c\u90a3 max(rowid)=count\nselect max(rowid) from tab;\n-- \u907f\u514d count(*) - expain \u4f1a\u53d1\u73b0\u6267\u884c\u903b\u8f91\u4e0d\u540c\nselect count(rowid) from tab;\n"})})]})}function h(e={}){const{wrapper:t}={...(0,s.M)(),...e.components};return t?(0,l.jsx)(t,{...e,children:(0,l.jsx)(c,{...e})}):c(e)}},38088:(e,t,n)=>{var l=n(96651),s=Symbol.for("react.element"),i=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,a=l.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function d(e,t,n){var l,i={},d=null,c=null;for(l in void 0!==n&&(d=""+n),void 0!==t.key&&(d=""+t.key),void 0!==t.ref&&(c=t.ref),t)r.call(t,l)&&!o.hasOwnProperty(l)&&(i[l]=t[l]);if(e&&e.defaultProps)for(l in t=e.defaultProps)void 0===i[l]&&(i[l]=t[l]);return{$$typeof:s,type:e,key:d,ref:c,props:i,_owner:a.current}}t.Fragment=i,t.jsx=d,t.jsxs=d},2488:(e,t,n)=>{e.exports=n(38088)},62780:(e,t,n)=>{n.d(t,{I:()=>a,M:()=>r});var l=n(96651);const s={},i=l.createContext(s);function r(e){const t=l.useContext(i);return l.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),l.createElement(i.Provider,{value:t},e.children)}}}]);