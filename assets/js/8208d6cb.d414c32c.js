"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[63731],{49613:function(t,e,n){n.d(e,{Zo:function(){return m},kt:function(){return g}});var r=n(59496);function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function p(t,e){if(null==t)return{};var n,r,a=function(t,e){if(null==t)return{};var n,r,a={},l=Object.keys(t);for(r=0;r<l.length;r++)n=l[r],e.indexOf(n)>=0||(a[n]=t[n]);return a}(t,e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(r=0;r<l.length;r++)n=l[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}var o=r.createContext({}),u=function(t){var e=r.useContext(o),n=e;return t&&(n="function"==typeof t?t(e):i(i({},e),t)),n},m=function(t){var e=u(t.components);return r.createElement(o.Provider,{value:e},t.children)},d="mdxType",s={inlineCode:"code",wrapper:function(t){var e=t.children;return r.createElement(r.Fragment,{},e)}},c=r.forwardRef((function(t,e){var n=t.components,a=t.mdxType,l=t.originalType,o=t.parentName,m=p(t,["components","mdxType","originalType","parentName"]),d=u(n),c=a,g=d["".concat(o,".").concat(c)]||d[c]||s[c]||l;return n?r.createElement(g,i(i({ref:e},m),{},{components:n})):r.createElement(g,i({ref:e},m))}));function g(t,e){var n=arguments,a=e&&e.mdxType;if("string"==typeof t||a){var l=n.length,i=new Array(l);i[0]=c;var p={};for(var o in e)hasOwnProperty.call(e,o)&&(p[o]=e[o]);p.originalType=t,p[d]="string"==typeof t?t:a,i[1]=p;for(var u=2;u<l;u++)i[u]=n[u];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}c.displayName="MDXCreateElement"},6086:function(t,e,n){n.r(e),n.d(e,{assets:function(){return b},contentTitle:function(){return k},default:function(){return y},frontMatter:function(){return g},metadata:function(){return N},toc:function(){return f}});var r=n(49613),a=Object.defineProperty,l=Object.defineProperties,i=Object.getOwnPropertyDescriptors,p=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable,m=(t,e,n)=>e in t?a(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,d=(t,e)=>{for(var n in e||(e={}))o.call(e,n)&&m(t,n,e[n]);if(p)for(var n of p(e))u.call(e,n)&&m(t,n,e[n]);return t},s=(t,e)=>l(t,i(e)),c=(t,e)=>{var n={};for(var r in t)o.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&p)for(var r of p(t))e.indexOf(r)<0&&u.call(t,r)&&(n[r]=t[r]);return n};const g={title:"Spring Boot"},k="Spring Boot",N={unversionedId:"java/spring/boot/README",id:"java/spring/boot/README",title:"Spring Boot",description:"- https://docs.spring.io/spring-boot/docs/current/reference/html/application-properties.html",source:"@site/../notes/java/spring/boot/README.md",sourceDirName:"java/spring/boot",slug:"/java/spring/boot/",permalink:"/notes/java/spring/boot/",draft:!1,editUrl:"https://github.com/wenerme/wener/edit/master/notes/../notes/java/spring/boot/README.md",tags:[],version:"current",lastUpdatedBy:"wener",lastUpdatedAt:1691332314,formattedLastUpdatedAt:"Aug 6, 2023",frontMatter:{title:"Spring Boot"},sidebar:"docs",previous:{title:"Spring",permalink:"/notes/java/spring/"},next:{title:"Spring Boot Properties",permalink:"/notes/java/spring/boot/conf"}},b={},f=[{value:"\u53c2\u8003",id:"\u53c2\u8003",level:2},{value:"\u4f7f\u7528 Jetty \u800c\u4e0d\u4f7f\u7528 Tomcat",id:"\u4f7f\u7528-jetty-\u800c\u4e0d\u4f7f\u7528-tomcat",level:2},{value:"\u5e38\u91cf",id:"\u5e38\u91cf",level:2},{value:"\u91cd\u8981\u7684\u5904\u7406\u63a5\u53e3",id:"\u91cd\u8981\u7684\u5904\u7406\u63a5\u53e3",level:2},{value:"Tips",id:"tips",level:3},{value:"Actuator",id:"actuator",level:2},{value:"\u5e38\u7528\u7ec8\u7aef",id:"\u5e38\u7528\u7ec8\u7aef",level:3},{value:"\u914d\u7f6e",id:"\u914d\u7f6e",level:3},{value:"Remote shell",id:"remote-shell",level:2},{value:"\u914d\u7f6e",id:"\u914d\u7f6e-1",level:3},{value:"Metrics",id:"metrics",level:2},{value:"\u76d1\u63a7\u4fe1\u606f",id:"\u76d1\u63a7\u4fe1\u606f",level:3},{value:"\u81ea\u5b9a\u4e49",id:"\u81ea\u5b9a\u4e49",level:3},{value:"\u8f93\u51fa\u76d1\u63a7\u4fe1\u606f",id:"\u8f93\u51fa\u76d1\u63a7\u4fe1\u606f",level:3},{value:"\u8f93\u51fa\u5230 Redis",id:"\u8f93\u51fa\u5230-redis",level:4},{value:"\u8f93\u51fa\u5230 statd",id:"\u8f93\u51fa\u5230-statd",level:4},{value:"\u5bfc\u51fa\u5230 JMX",id:"\u5bfc\u51fa\u5230-jmx",level:4},{value:"\u83b7\u53d6 XmlMapper",id:"\u83b7\u53d6-xmlmapper",level:3},{value:"\u83b7\u53d6\u8bf7\u6c42\u4f53\u6587\u672c",id:"\u83b7\u53d6\u8bf7\u6c42\u4f53\u6587\u672c",level:3},{value:"\u53bb\u9664\u9519\u8bef\u767d\u677f\u9875",id:"\u53bb\u9664\u9519\u8bef\u767d\u677f\u9875",level:3},{value:"\u521b\u5efa\u81ea\u5b9a\u4e49\u7684\u81ea\u52a8\u914d\u7f6e",id:"\u521b\u5efa\u81ea\u5b9a\u4e49\u7684\u81ea\u52a8\u914d\u7f6e",level:2}],h={toc:f},v="wrapper";function y(t){var e=t,{components:n}=e,a=c(e,["components"]);return(0,r.kt)(v,s(d(d({},h),a),{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",d({},{id:"spring-boot"}),"Spring Boot"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",d({parentName:"li"},{href:"https://docs.spring.io/spring-boot/docs/current/reference/html/application-properties.html"}),"https://docs.spring.io/spring-boot/docs/current/reference/html/application-properties.html")),(0,r.kt)("li",{parentName:"ul"},"\u65b9\u4fbf\u67e5\u770b\u6bcf\u4e2a\u7248\u672c\u7684\u4f9d\u8d56\u7248\u672c",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",d({parentName:"li"},{href:"http://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-parent/2.0.0.RELEASE"}),"org.springframework.boot/spring-boot-starter-parent"))))),(0,r.kt)("pre",null,(0,r.kt)("code",d({parentName:"pre"},{className:"language-bash"}),"# \u5b89\u88c5\u547d\u4ee4\u884c\u5de5\u5177\nbrew tap pivotal/tap\nbrew install springboot\n# \u5b89\u88c5 Spring Cloud \u6269\u5c55\n# https://cloud.spring.io/spring-cloud-cli/\nspring install org.springframework.cloud:spring-cloud-cli:1.3.2.RELEASE\n\n# \u5982\u679c\u60f3\u7528\u52a0\u5bc6\u7684\u529f\u80fd\u8fd8\u9700\u8981\u5b89\u88c5 jce\n# http://www.oracle.com/technetwork/java/javase/downloads/jce8-download-2133166.html\n")),(0,r.kt)("h2",d({},{id:"\u53c2\u8003"}),"\u53c2\u8003"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",d({parentName:"li"},{href:"http://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/"}),"\u6700\u65b0\u6587\u6863")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",d({parentName:"li"},{href:"http://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#common-application-properties"}),"\u6240\u6709\u7684\u914d\u7f6e\u5c5e\u6027"))),(0,r.kt)("h2",d({},{id:"\u4f7f\u7528-jetty-\u800c\u4e0d\u4f7f\u7528-tomcat"}),"\u4f7f\u7528 Jetty \u800c\u4e0d\u4f7f\u7528 Tomcat"),(0,r.kt)("pre",null,(0,r.kt)("code",d({parentName:"pre"},{className:"language-xml"}),"<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-web</artifactId>\n    <exclusions>\n        <exclusion>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-tomcat</artifactId>\n        </exclusion>\n    </exclusions>\n</dependency>\n<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-jetty</artifactId>\n</dependency>\n")),(0,r.kt)("h2",d({},{id:"\u5e38\u91cf"}),"\u5e38\u91cf"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"org.springframework.http.HttpHeaders"),(0,r.kt)("li",{parentName:"ul"},"org.springframework.http.HttpStatus")),(0,r.kt)("h2",d({},{id:"\u91cd\u8981\u7684\u5904\u7406\u63a5\u53e3"}),"\u91cd\u8981\u7684\u5904\u7406\u63a5\u53e3"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"org.springframework.util.PathMatcher\n\u8def\u5f84\u7684\u5339\u914d\u683c\u5f0f,\u6bd4\u5982 cors \u914d\u7f6e"),(0,r.kt)("li",{parentName:"ul"},"org.springframework.boot.logging.LoggingSystem",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u7528\u4e8e\u63a7\u5236\u65e5\u5fd7\u7ea7\u522b"),(0,r.kt)("li",{parentName:"ul"},"\u8fd0\u884c\u65f6\u4f1a\u66b4\u9732 logger endpoint, \u53ef\u67e5\u770b\u548c\u4fee\u6539\u65e5\u5fd7\u7ea7\u522b",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"org.springframework.boot.actuate.endpoint.LoggersEndpoint"))),(0,r.kt)("li",{parentName:"ul"},"\u65e5\u5fd7\u7ea7\u522b",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"TRACE, DEBUG, INFO, WARN, ERROR, FATAL, OFF"))),(0,r.kt)("li",{parentName:"ul"},"\u65e5\u5fd7\u5c5e\u6027\u5206\u4e3a configuredLevel \u548c effectiveLevel",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u4fee\u6539\u65f6\u4f7f\u7528 configuredLevel"))),(0,r.kt)("li",{parentName:"ul"},"Spring Boot \u81ea\u5e26\u4e86\u8f83\u591a\u7684 Logback \u914d\u7f6e",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"org.springframework.boot.logging.logback")))))),(0,r.kt)("h3",d({},{id:"tips"}),"Tips"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u53ef\u81ea\u5b9a\u4e49\u6570\u636e\u7c7b\u578b\u8f6c\u6362 ",(0,r.kt)("a",d({parentName:"li"},{href:"https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-features-external-config-conversion"}),"Properties conversion")),(0,r.kt)("li",{parentName:"ul"},"\u53ef\u4f7f\u7528 ",(0,r.kt)("inlineCode",{parentName:"li"},"javax.validation")," \u5bf9\u914d\u7f6e\u7684\u5c5e\u6027\u8fdb\u884c\u6821\u9a8c"),(0,r.kt)("li",{parentName:"ul"},"\u53ef\u901a\u8fc7 ",(0,r.kt)("inlineCode",{parentName:"li"},"spring-boot-actuator")," \u6a21\u5757\u5728 ",(0,r.kt)("inlineCode",{parentName:"li"},"/configprops")," \u67e5\u770b\u5c5e\u6027\u914d\u7f6e")),(0,r.kt)("h2",d({},{id:"actuator"}),"Actuator"),(0,r.kt)("h3",d({},{id:"\u5e38\u7528\u7ec8\u7aef"}),"\u5e38\u7528\u7ec8\u7aef"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",d({parentName:"tr"},{align:null}),"ID"),(0,r.kt)("th",d({parentName:"tr"},{align:null}),"\u63cf\u8ff0"),(0,r.kt)("th",d({parentName:"tr"},{align:null}),"\u9ed8\u8ba4\u654f\u611f"),(0,r.kt)("th",d({parentName:"tr"},{align:null})))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",d({parentName:"tr"},{align:null}),"actuator"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"\u63d0\u4f9b\u57fa\u4e8e\u8d85\u5a92\u4f53\u7684\u53d1\u73b0\u9875,\u9700\u8981 Spring HATEOAS."),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"true"),(0,r.kt)("td",d({parentName:"tr"},{align:null}))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",d({parentName:"tr"},{align:null}),"autoconfig"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"\u663e\u793a\u81ea\u52a8\u914d\u7f6e\u7684\u6c47\u62a5,\u663e\u793a\u6240\u6709\u81ea\u52a8\u914d\u7f6e\u7684\u5019\u9009\u548c\u4e3a\u4ec0\u4e48\u6ca1\u6709\u88ab\u4f7f\u7528"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"true"),(0,r.kt)("td",d({parentName:"tr"},{align:null}))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",d({parentName:"tr"},{align:null}),"beans"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"\u663e\u793a\u7a0b\u5e8f\u4e2d\u7684 beans \u5217\u8868"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"true"),(0,r.kt)("td",d({parentName:"tr"},{align:null}))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",d({parentName:"tr"},{align:null}),"configprops"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"\u663e\u793a\u6240\u6709 ",(0,r.kt)("inlineCode",{parentName:"td"},"@ConfigurationProperties")),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"true"),(0,r.kt)("td",d({parentName:"tr"},{align:null}))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",d({parentName:"tr"},{align:null}),"docs"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"\u663e\u793a\u6587\u6863,\u5305\u62ec\u8bf7\u6c42\u548c\u76f8\u5e94\u7684\u4f8b\u5b50,\u9700\u8981 ",(0,r.kt)("inlineCode",{parentName:"td"},"spring-boot-actuator-docs")),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"false"),(0,r.kt)("td",d({parentName:"tr"},{align:null}))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",d({parentName:"tr"},{align:null}),"dump"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"\u6267\u884c\u7ebf\u7a0b\u8f6c\u50a8"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"true"),(0,r.kt)("td",d({parentName:"tr"},{align:null}))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",d({parentName:"tr"},{align:null}),"env"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"\u66b4\u9732 ",(0,r.kt)("inlineCode",{parentName:"td"},"ConfigurableEnvironment")," \u7684\u5c5e\u6027"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"true"),(0,r.kt)("td",d({parentName:"tr"},{align:null}))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",d({parentName:"tr"},{align:null}),"flyway"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"\u663e\u793a Flyway \u6570\u636e\u5e93\u7684\u8fc1\u79fb\u72b6\u6001"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"true"),(0,r.kt)("td",d({parentName:"tr"},{align:null}))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",d({parentName:"tr"},{align:null}),"health"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"\u663e\u793a\u5e94\u7528\u7684\u76d1\u63a7\u4fe1\u606f,\u6388\u6743\u540e\u8bf7\u6c42\u8fd4\u56de\u8be6\u7ec6\u4fe1\u606f"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"false"),(0,r.kt)("td",d({parentName:"tr"},{align:null}))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",d({parentName:"tr"},{align:null}),"info"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"\u663e\u793a\u4efb\u4f55\u4fe1\u606f"),(0,r.kt)("td",d({parentName:"tr"},{align:null})),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"false")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",d({parentName:"tr"},{align:null}),"liquibase"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"\u663e\u793a liquibase \u6570\u636e\u5e93\u8fc1\u79fb\u72b6\u6001"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"true"),(0,r.kt)("td",d({parentName:"tr"},{align:null}))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",d({parentName:"tr"},{align:null}),"logfile"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"\u8fd4\u56de logfile \u4e2d\u7684\u5185\u5bb9(\u5982\u679c\u8bbe\u7f6e\u4e86 logging.file \u6216 logging.path \u5c5e\u6027).\u9700\u8981 MVC \u652f\u6301.\u652f\u6301 HTTP \u5934\u7684\u8303\u56f4\u8bf7\u6c42."),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"true"),(0,r.kt)("td",d({parentName:"tr"},{align:null}))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",d({parentName:"tr"},{align:null}),"metrics"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"\u663e\u793a\u5f53\u524d\u5e94\u7528\u7684 metrices \u4fe1\u606f"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"true"),(0,r.kt)("td",d({parentName:"tr"},{align:null}))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",d({parentName:"tr"},{align:null}),"mappings"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"\u663e\u793a\u6240\u6709 ",(0,r.kt)("inlineCode",{parentName:"td"},"@RequestMapping")," \u8def\u5f84"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"true"),(0,r.kt)("td",d({parentName:"tr"},{align:null}))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",d({parentName:"tr"},{align:null}),"shutdown"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"\u505c\u6b62\u5e94\u7528(\u9ed8\u8ba4\u672a\u5f00\u542f)"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"true"),(0,r.kt)("td",d({parentName:"tr"},{align:null}))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",d({parentName:"tr"},{align:null}),"trace"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"\u663e\u793a\u8ddf\u8e2a\u4fe1\u606f(\u9ed8\u8ba4\u53ea\u663e\u793a\u524d\u51e0\u4e2a HTTP \u8bf7\u6c42)"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"true"),(0,r.kt)("td",d({parentName:"tr"},{align:null}))))),(0,r.kt)("h3",d({},{id:"\u914d\u7f6e"}),"\u914d\u7f6e"),(0,r.kt)("pre",null,(0,r.kt)("code",d({parentName:"pre"},{className:"language-yaml"}),"# \u4fee\u6539\u4e00\u4e2a\u7ec8\u7aef\u7684\u654f\u611f\u503c\nendpoints.beans.id=springbeans\nendpoints.beans.sensitive=false\n# \u63a7\u5236\u662f\u5426\u542f\u7528\u7ec8\u7aef\nendpoints.enabled=false\nendpoints.info.enabled=true\nendpoints.shutdown.enabled=true\n# \u63a7\u5236\u662f\u5426\u542f\u7528\u654f\u611f\nendpoints.sensitive=true\nendpoints.info.sensitive=false\n# \u63a7\u5236 CORS\nendpoints.cors.allowed-origins: http://example.com\nendpoints.cors.allowed-methods: GET,POST\n# \u63a7\u5236\u662f\u5426\u542f\u7528\u76d1\u63a7\u68c0\u67e5\nmanagement.health.defaults.enabled=false\n# \u63a7\u5236\u8def\u5f84\u548c\u7aef\u53e3\u5730\u5740\nmanagement.context-path: /manage\nmanagement.port=8081\nmanagement.address=127.0.0.1\n# \u5b9a\u5236\u5316\u901a\u8fc7 info \u7ec8\u7aef\u66b4\u9732\u7684\u4fe1\u606f\ninfo.app.name=MyService\ninfo.app.description=My awesome service\ninfo.app.version=1.0.0\n# \u901a\u8fc7 Maven \u81ea\u52a8\u5c55\u5f00\u5c5e\u6027\n# spring boot parent \u4f7f\u7528 git \u63d2\u4ef6\u63d0\u4f9b\u4e86 git.properties \u6587\u4ef6\nproject.artifactId=myproject\nproject.name=Demo\nproject.version=X.X.X.X\nproject.description=Demo project for info endpoint\ninfo.build.artifact=@project.artifactId@\ninfo.build.name=@project.name@\ninfo.build.description=@project.description@\ninfo.build.version=@project.version@\n# \u63a7\u5236\u8bbf\u95ee\u7ba1\u7406\u53f0\u9700\u8981\u7684\u89d2\u8272\nmanagement.security.role=SUPERUSER\n# \u4e3a\u5355\u72ec\u7684\u7ec8\u7aef\u6307\u5b9a\u8def\u5f84\nendpoints.{name}.path\n# \u7981\u7528 HTTP \u7ec8\u7aef\nmanagement.port=-1\n# \u4fee\u6539 MBean \u540d\u5b57\nendpoints.jmx.domain=myapp\nendpoints.jmx.unique-names: true\n")),(0,r.kt)("h2",d({},{id:"remote-shell"}),"Remote shell"),(0,r.kt)("pre",null,(0,r.kt)("code",d({parentName:"pre"},{className:"language-xml"}),"<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-remote-shell</artifactId>\n</dependency>\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u9ed8\u8ba4\u7aef\u53e3\u4e3a 2000"),(0,r.kt)("li",{parentName:"ul"},"\u547d\u4ee4\u626b\u63cf\u8def\u5f84\u4e3a")),(0,r.kt)("pre",null,(0,r.kt)("code",d({parentName:"pre"},{}),"classpath*:/commands/**\nclasspath*:/crash/commands/**\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u53ef\u901a\u8fc7 ",(0,r.kt)("inlineCode",{parentName:"li"},"shell.command-path-patterns")," \u6765\u4fee\u6539\u547d\u4ee4\u8def\u5f84"),(0,r.kt)("li",{parentName:"ul"},"\u7ee7\u627f\u81ea ",(0,r.kt)("inlineCode",{parentName:"li"},"org.crsh.plugin.CRaSHPlugin")," \u7684 Bean \u4f1a\u81ea\u52a8\u6ce8\u518c")),(0,r.kt)("h3",d({},{id:"\u914d\u7f6e-1"}),"\u914d\u7f6e"),(0,r.kt)("pre",null,(0,r.kt)("code",d({parentName:"pre"},{}),"shell.auth.simple.user.name\nshell.auth.simple.user.password\n")),(0,r.kt)("h2",d({},{id:"metrics"}),"Metrics"),(0,r.kt)("h3",d({},{id:"\u76d1\u63a7\u4fe1\u606f"}),"\u76d1\u63a7\u4fe1\u606f"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u7cfb\u7edf\u76d1\u63a7")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",d({parentName:"tr"},{align:null}),"\u952e"),(0,r.kt)("th",d({parentName:"tr"},{align:null}),"\u63cf\u8ff0"),(0,r.kt)("th",d({parentName:"tr"},{align:null}),"\u5355\u4f4d"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",d({parentName:"tr"},{align:null}),"mem"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"\u603b\u5185\u5b58"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"KB")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",d({parentName:"tr"},{align:null}),"mem.free"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"\u7a7a\u95f2\u5185\u5b58"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"KB")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",d({parentName:"tr"},{align:null}),"processors"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"\u8fdb\u7a0b\u6570"),(0,r.kt)("td",d({parentName:"tr"},{align:null}))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",d({parentName:"tr"},{align:null}),"uptime"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"\u7cfb\u7edf\u8fd0\u884c\u65f6\u95f4 ms"),(0,r.kt)("td",d({parentName:"tr"},{align:null}))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",d({parentName:"tr"},{align:null}),"instance.uptime"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"\u7a0b\u5e8f\u8fd0\u884c\u65f6\u95f4"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"ms")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",d({parentName:"tr"},{align:null}),"systemload.average"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"\u7cfb\u7edf\u5e73\u5747\u8d1f\u8f7d"),(0,r.kt)("td",d({parentName:"tr"},{align:null}))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",d({parentName:"tr"},{align:null}),"heap",(0,r.kt)("br",null),"heap.committed",(0,r.kt)("br",null),"heap.init",(0,r.kt)("br",null),"heap.used"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"\u5806\u4fe1\u606f"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"KB")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",d({parentName:"tr"},{align:null}),"threads",(0,r.kt)("br",null),"thread.peak",(0,r.kt)("br",null),"thread.daemon"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"\u7ebf\u7a0b\u4fe1\u606f"),(0,r.kt)("td",d({parentName:"tr"},{align:null}))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",d({parentName:"tr"},{align:null}),"classes",(0,r.kt)("br",null),"classes.loaded",(0,r.kt)("br",null),"classes.unloaded"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"\u7c7b\u52a0\u8f7d\u4fe1\u606f"),(0,r.kt)("td",d({parentName:"tr"},{align:null}))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",d({parentName:"tr"},{align:null}),"gc.xxx.count",(0,r.kt)("br",null),"gc.xxx.time"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"\u5783\u573e\u56de\u6536\u4fe1\u606f"),(0,r.kt)("td",d({parentName:"tr"},{align:null}))))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u6570\u636e\u6e90\u76d1\u63a7")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",d({parentName:"tr"},{align:null}),"\u952e"),(0,r.kt)("th",d({parentName:"tr"},{align:null}),"\u63cf\u8ff0"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",d({parentName:"tr"},{align:null}),"datasource.xxx.active"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"\u6fc0\u6d3b\u94fe\u63a5\u6570")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",d({parentName:"tr"},{align:null}),"datasource.xxx.usage"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"\u5f53\u524d\u7ebf\u7a0b\u6c60\u7684\u4f7f\u7528\u60c5\u51b5")))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"datasource.primary")," \u8868\u793a ",(0,r.kt)("inlineCode",{parentName:"li"},"@Primary")," \u7684\u6570\u636e\u6e90"),(0,r.kt)("li",{parentName:"ul"},"\u5982\u679c\u4e00\u4e2a\u6570\u636e\u6e90 bean \u7684\u540d\u5b57\u662f\u4ee5 DataSource \u7ed3\u5c3e\u7684,\u90a3\u4e48 metric \u91cc\u53ea\u4f1a\u663e\u793a\u4e4b\u524d\u7684,\u4f8b\u5982 ",(0,r.kt)("inlineCode",{parentName:"li"},"myDataSource")," \u663e\u793a\u4e3a ",(0,r.kt)("inlineCode",{parentName:"li"},"datasource.my")),(0,r.kt)("li",{parentName:"ul"},"\u5426\u5219\u90fd\u662f\u7528 bean \u540d\u4f5c\u4e3a metric \u540d"),(0,r.kt)("li",{parentName:"ul"},"\u53ef\u901a\u8fc7\u6ce8\u518c ",(0,r.kt)("inlineCode",{parentName:"li"},"DataSourcePublicMetrics")," \u6765\u4fee\u6539\u90e8\u5206\u9ed8\u8ba4\u914d\u7f6e."),(0,r.kt)("li",{parentName:"ul"},"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4f1a\u663e\u793a\u6240\u6709\u652f\u6301\u7684\u5143\u6570\u636e,\u53ef\u901a\u8fc7 ",(0,r.kt)("inlineCode",{parentName:"li"},"DataSourcePoolMetadataProvider")," Bean \u6dfb\u52a0\u989d\u5916\u7684. \u8bf7\u67e5\u770b",(0,r.kt)("inlineCode",{parentName:"li"},"DataSourcePoolMetadataProvidersConfiguration"),".")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u7f13\u5b58\u76d1\u63a7")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",d({parentName:"tr"},{align:null}),"\u952e"),(0,r.kt)("th",d({parentName:"tr"},{align:null}),"\u63cf\u8ff0"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",d({parentName:"tr"},{align:null}),"cache.xxx.size"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"\u7f13\u5b58\u5927\u5c0f")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",d({parentName:"tr"},{align:null}),"cache.xxx.hit.ratio"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"\u547d\u4e2d\u7387")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",d({parentName:"tr"},{align:null}),"cache.xxx.miss.ratio"),(0,r.kt)("td",d({parentName:"tr"},{align:null}),"\u672a\u547d\u4e2d\u7387")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"TOMCAT SESSION")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"httpsessions.active"),(0,r.kt)("li",{parentName:"ul"},"httpsessions.max")),(0,r.kt)("h3",d({},{id:"\u81ea\u5b9a\u4e49"}),"\u81ea\u5b9a\u4e49"),(0,r.kt)("p",null,"\u53ef\u901a\u8fc7\u6ce8\u5165 CounterService \u6216 GaugeService \u6765\u63d0\u4f9b\u5e94\u7528\u76d1\u63a7, \u867d\u7136\u4efb\u4f55\u5b57\u7b26\u4e32\u90fd\u53ef\u4ee5\u4f5c\u4e3a\u540d\u5b57,\u4f46\u5efa\u8bae\u53c2\u8003 ",(0,r.kt)("a",d({parentName:"p"},{href:"http://matt.aimonetti.net/posts/2013/06/26/practical-guide-to-graphite-monitoring/"}),"\u8be5\u6307\u5357"),"."),(0,r.kt)("p",null,"\u53ef\u901a\u8fc7\u6ce8\u518c ",(0,r.kt)("inlineCode",{parentName:"p"},"PublicMetrics")," \u6765\u505a\u901a\u8fc7\u8ba1\u7b97\u5f97\u51fa\u7684\u7edf\u8ba1.\u53ef\u901a\u8fc7 ",(0,r.kt)("inlineCode",{parentName:"p"},"MetricsEndpoint")," \u6765\u5b9a\u5236\u5904\u7406\u65b9\u5f0f."),(0,r.kt)("h3",d({},{id:"\u8f93\u51fa\u76d1\u63a7\u4fe1\u606f"}),"\u8f93\u51fa\u76d1\u63a7\u4fe1\u606f"),(0,r.kt)("pre",null,(0,r.kt)("code",d({parentName:"pre"},{}),"spring.metrics.export\n  .send-latest\n  .delay-millis\n  .includes\n  .excludes\n# \u4e5f\u53ef\u4e3a\u6bcf\u4e2a bean \u8bbe\u7f6e\nspring.metrics.export.triggers.<name>.*\n")),(0,r.kt)("h4",d({},{id:"\u8f93\u51fa\u5230-redis"}),"\u8f93\u51fa\u5230 Redis"),(0,r.kt)("pre",null,(0,r.kt)("code",d({parentName:"pre"},{className:"language-java"}),"@Bean\n@ExportMetricWriter\nMetricWriter metricWriter(MetricExportProperties export) {\n    return new RedisMetricRepository(connectionFactory,\n      export.getRedis().getPrefix(), export.getRedis().getKey());\n}\n")),(0,r.kt)("pre",null,(0,r.kt)("code",d({parentName:"pre"},{}),"spring.metrics.export.redis.prefix: metrics.mysystem.${spring.application.name:application}.${random.value:0000}\nspring.metrics.export.redis.key: keys.metrics.mysystem\n")),(0,r.kt)("h4",d({},{id:"\u8f93\u51fa\u5230-statd"}),"\u8f93\u51fa\u5230 statd"),(0,r.kt)("pre",null,(0,r.kt)("code",d({parentName:"pre"},{className:"language-java"}),'@Value("${spring.application.name:application}.${random.value:0000}")\nprivate String prefix = "metrics";\n\n@Bean\n@ExportMetricWriter\nMetricWriter metricWriter() {\n    return new StatsdMetricWriter(prefix, "localhost", "8125");\n}\n')),(0,r.kt)("h4",d({},{id:"\u5bfc\u51fa\u5230-jmx"}),"\u5bfc\u51fa\u5230 JMX"),(0,r.kt)("pre",null,(0,r.kt)("code",d({parentName:"pre"},{className:"language-java"}),"@Bean\n@ExportMetricWriter\nMetricWriter metricWriter(MBeanExporter exporter) {\n    return new JmxMetricWriter(exporter);\n}\n")),(0,r.kt)("h3",d({},{id:"\u83b7\u53d6-xmlmapper"}),"\u83b7\u53d6 XmlMapper"),(0,r.kt)("p",null,(0,r.kt)("a",d({parentName:"p"},{href:"http://docs.spring.io/spring-boot/docs/current/reference/html/howto-spring-mvc.html"}),"http://docs.spring.io/spring-boot/docs/current/reference/html/howto-spring-mvc.html")),(0,r.kt)("pre",null,(0,r.kt)("code",d({parentName:"pre"},{className:"language-xml"}),"<dependency>\n    <groupId>com.fasterxml.jackson.dataformat</groupId>\n    <artifactId>jackson-dataformat-xml</artifactId>\n</dependency>\n")),(0,r.kt)("pre",null,(0,r.kt)("code",d({parentName:"pre"},{className:"language-java"}),"@Autowired\npublic void init(MappingJackson2XmlHttpMessageConverter xmlConverter){\n    XmlMapper mapper = (XmlMapper) xmlConverter.getObjectMapper();\n}\n")),(0,r.kt)("h3",d({},{id:"\u83b7\u53d6\u8bf7\u6c42\u4f53\u6587\u672c"}),"\u83b7\u53d6\u8bf7\u6c42\u4f53\u6587\u672c"),(0,r.kt)("pre",null,(0,r.kt)("code",d({parentName:"pre"},{className:"language-java"}),'@RequestMapping(path = "/echo", method = RequestMethod.POST)\npublic Object echo(HttpServletRequest request) throws IOException {\n  String content = CharStreams.toString(new InputStreamReader(request.getInputStream()));\n  return content;\n}\n')),(0,r.kt)("h3",d({},{id:"\u53bb\u9664\u9519\u8bef\u767d\u677f\u9875"}),"\u53bb\u9664\u9519\u8bef\u767d\u677f\u9875"),(0,r.kt)("pre",null,(0,r.kt)("code",d({parentName:"pre"},{className:"language-java"}),'@RestController\npublic class IndexController implements ErrorController{\n\n    private static final String PATH = "/error";\n\n    private final ErrorAttributes errorAttributes;\n\n    // \u4e5f\u53ef\u4ee5\u81ea\u5df1\u5904\u7406\u9519\u8bef\n    @Autowired\n    public IndexController(ErrorAttributes errorAttributes) {\n      Assert.notNull(errorAttributes, "ErrorAttributes must not be null");\n      this.errorAttributes = errorAttributes;\n    }\n\n    @RequestMapping(value = PATH)\n    public String error() {\n        return "Error handling";\n    }\n\n    @Override\n    public String getErrorPath() {\n        return PATH;\n    }\n}\n// \u9ed8\u8ba4\u7684\u9519\u8bef\u63a7\u5236\u5668\u4e3a ErrorMvcAutoConfiguration#basicErrorController\n')),(0,r.kt)("h2",d({},{id:"\u521b\u5efa\u81ea\u5b9a\u4e49\u7684\u81ea\u52a8\u914d\u7f6e"}),"\u521b\u5efa\u81ea\u5b9a\u4e49\u7684\u81ea\u52a8\u914d\u7f6e"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",d({parentName:"li"},{href:"https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-developing-auto-configuration.html"}),"46. Creating Your Own Auto-configuration")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"META-INF/spring.factories")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"org.springframework.boot.autoconfigure.EnableAutoConfiguration="),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u9017\u53f7\u5206\u9694")))))}y.isMDXComponent=!0}}]);