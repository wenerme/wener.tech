/*! For license information please see ddd052d8.a862649b.js.LICENSE.txt */
"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[48728],{94756:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>t,toc:()=>d});var i=s(2488),l=s(62780);const r={title:"fission"},o="fission",t={id:"devops/kubernetes/platform/fission",title:"fission",description:"- fission/fission",source:"@site/../notes/devops/kubernetes/platform/fission.md",sourceDirName:"devops/kubernetes/platform",slug:"/devops/kubernetes/platform/fission",permalink:"/notes/devops/kubernetes/platform/fission",draft:!1,unlisted:!1,editUrl:"https://github.com/wenerme/wener/edit/master/notes/../notes/devops/kubernetes/platform/fission.md",tags:[],version:"current",lastUpdatedBy:"wener",lastUpdatedAt:1634945411,formattedLastUpdatedAt:"Oct 22, 2021",frontMatter:{title:"fission"},sidebar:"docs",previous:{title:"K8S \u5e73\u53f0",permalink:"/notes/devops/kubernetes/platform/"},next:{title:"harvester",permalink:"/notes/devops/kubernetes/platform/harvester"}},c={},d=[{value:"Functions",id:"functions",level:2},{value:"HTTP",id:"http",level:2},{value:"Environment",id:"environment",level:2},{value:"CanaryConfig",id:"canaryconfig",level:2},{value:"cli",id:"cli",level:2},{value:"deploy",id:"deploy",level:2}];function a(n){const e={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.M)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.h1,{id:"fission",children:"fission"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.a,{href:"https://github.com/fission/fission",children:"fission/fission"}),"\nFast and Simple Serverless Functions\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u76ee\u524d\u652f\u6301 NodeJS, Python, Ruby, Go, PHP, Bash, Linux executable"}),"\n",(0,i.jsx)(e.li,{children:"\u53ea\u64cd\u4f5c\u6e90\u7801\u4e0d\u64cd\u4f5c\u5bb9\u5668"}),"\n",(0,i.jsxs)(e.li,{children:["\u5185\u7f6e\u8def\u7531\u57fa\u4e8e gorilla/mux\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u652f\u6301\u547d\u540d\u53c2\u6570 ",(0,i.jsx)(e.code,{children:"/guestbook/{name}/{age:[0-9]+}"})]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"X-Fission-Params-Name: <name>"})," - \u6ce8\u610f\u540d\u5b57\u4f1a\u8f6c\u6362"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.li,{children:"\u652f\u6301 WebSocket"}),"\n",(0,i.jsx)(e.li,{children:"\u5e95\u5c42\u57fa\u4e8e keda"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["helm ",(0,i.jsx)(e.a,{href:"https://github.com/fission/fission-charts",children:"fission/fission-charts"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"fission-all - nats, influxdb"}),"\n",(0,i.jsx)(e.li,{children:"fission-core"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["Function\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u6e90\u7801 - \u53ef\u6267\u884c\u5185\u5bb9"}),"\n",(0,i.jsx)(e.li,{children:"Archive - \u53ef\u4ee5\u662f\u6253\u5305\u7684\u5185\u5bb9 - zip"}),"\n",(0,i.jsx)(e.li,{children:"Package - fission \u5c06 Archive \u8fdb\u884c\u6253\u5305 - \u5b9e\u9645\u6267\u884c"}),"\n",(0,i.jsxs)(e.li,{children:["\u90e8\u5206\u8bed\u8a00\u9700\u8981\u7f16\u8bd1 - \u9700\u8981\u521b\u5efa\u73af\u5883\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"fission \u8d1f\u8d23\u6784\u5efa"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["Environment\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u63d0\u4f9b HTTP \u670d\u52a1"}),"\n",(0,i.jsx)(e.li,{children:"\u8fd0\u884c Function"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["Trigger - \u5165\u53e3/\u89e6\u53d1\u65b9\u5f0f\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"HTTP"}),"\n",(0,i.jsx)(e.li,{children:"Timer - \u5b9a\u65f6"}),"\n",(0,i.jsx)(e.li,{children:"Message Queue - KEDA - Kafka, NATS"}),"\n",(0,i.jsx)(e.li,{children:"Kubernetes Watch - \u5f53\u96c6\u7fa4\u53d8\u5316\u65f6"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.a,{href:"https://hub.docker.com/u/fission/",children:"https://hub.docker.com/u/fission/"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"<lang>-env"})," - \u6267\u884c\u73af\u5883"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"<lang>-builder"})," - \u6784\u5efa"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u5185\u7f6e\u8def\u5f84\u6620\u5c04\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:"/secrets/<namespace>/<name>/<key>"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:"/configs/<namespace>/<name>/<key>"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["secrets \u548c configs \u9700\u8981\u542f\u52a8\u65f6\u5141\u8bb8\u8bbf\u95ee\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u4fee\u6539\u65f6\u4f1a\u5bfc\u81f4 pod \u91cd\u542f"}),"\n",(0,i.jsx)(e.li,{children:"\u5982\u679c\u5927\u91cf function \u4f7f\u7528\u76f8\u540c\u7684\uff0c\u5219\u4f1a\u77ac\u95f4\u5bfc\u81f4"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u6267\u884c\u7c7b\u578b\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["poolmgr\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u521b\u5efa env \u81ea\u52a8\u521b\u5efa"}),"\n",(0,i.jsx)(e.li,{children:"\u9ed8\u8ba4 pool 3"}),"\n",(0,i.jsx)(e.li,{children:"\u652f\u6301 Requests Per Pod - rpp \u9650\u5b9a\u6bcf\u4e2a pod \u8bf7\u6c42\u91cf"}),"\n",(0,i.jsx)(e.li,{children:"OnceOnly - \u4e00\u4e2a pod \u53ea\u5904\u7406\u4e00\u4e2a\u8bf7\u6c42"}),"\n",(0,i.jsx)(e.li,{children:"Concurrency - \u9650\u5b9a\u8bf7\u6c42\u5e76\u53d1"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["newdeploy\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u652f\u6301\u81ea\u52a8\u6269\u7f29\u5bb9"}),"\n",(0,i.jsx)(e.li,{children:"\u914d\u7f6e min,max"}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"--minscale 0"})," \u53ef\u5b8c\u5168\u7f29\u5bb9 - \u51b7\u542f\u52a8\u4f1a\u6162"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.admonition,{type:"caution",children:(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u4e0d\u652f\u6301 gRPC \u8def\u7531 - ",(0,i.jsx)(e.a,{href:"https://github.com/fission/fission/issues/250",children:"fission/fission#250"})]}),"\n",(0,i.jsx)(e.li,{children:"NATS \u76ee\u524d\u5c1a\u672a\u4f7f\u7528 JetStream API"}),"\n"]})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# macOS\ncurl -Lo fission https://github.com/fission/fission/releases/download/1.14.1/fission-1.14.1-darwin-amd64 \\\n    && chmod +x fission && sudo mv fission /usr/local/bin/\n\nfission env create --name nodejs --image fission/node-env\ncurl https://raw.githubusercontent.com/fission/examples/master/nodejs/hello.js > hello.js\nfission function create --name hello --env nodejs --code hello.js\n\n# \u521b\u5efa\u8def\u7531\nfission route create --method GET --url /hello --function hello\n# \u8bf7\u6c42\nfission function test --name hello\n\n\n# \u6dfb\u52a0 Go \u73af\u5883\nfission environment create --name go --image fission/go-env-1.12:1.13.1 --builder fission/go-builder-1.12:1.13.1\n"})}),"\n",(0,i.jsx)(e.h2,{id:"functions",children:"Functions"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"websocket.js"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-js",children:"module.exports = async function (ws, clients) {\n  ws.on('message', function incoming(data) {\n    clients.forEach(function each(client) {\n      client.send(data);\n    });\n  });\n\n  ws.on('close', function close() {\n    return {\n      status: 200,\n      message: 'I am done',\n    };\n  });\n};\n"})}),"\n",(0,i.jsx)(e.h2,{id:"http",children:"HTTP"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"X-Fission-Function-Uid: 82c95606-9afa-11e8-bbd1-08002720b796\nX-Fission-Function-Resourceversion: 480652\nX-Fission-Function-Name: reqpayload\nX-Fission-Function-Namespace: default\n\nX-Fission-Params-Name: Alice\nX-Fission-Params-Age: 23\n"})}),"\n",(0,i.jsx)(e.h2,{id:"environment",children:"Environment"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"apiVersion: fission.io/v1\nkind: Environment\nmetadata:\n  creationTimestamp: null\n  name: nodejs\n  namespace: default\nspec:\n  builder: {}\n  imagepullsecret: ''\n  keeparchive: false\n  poolsize: 3\n  resources: {}\n  runtime:\n    image: fission/node-env:latest\n  version: 2\n"})}),"\n",(0,i.jsx)(e.h2,{id:"canaryconfig",children:"CanaryConfig"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"apiVersion: fission.io/v1\nkind: CanaryConfig\nmetadata:\n  name: canary-1\n  namespace: default\nspec:\n  duration: 1m\n  failureType: status-code\n  failurethreshold: 10\n  newfunction: fn-a-v2\n  oldfunction: fn-a-v1\n  trigger: route-fn-a\n  weightincrement: 30\n"})}),"\n",(0,i.jsx)(e.h2,{id:"cli",children:"cli"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"FISSION_NAMESPACE"}),"\n",(0,i.jsx)(e.li,{children:"FISSION_ROUTER"}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"deploy",children:"deploy"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://github.com/fission/fission/tree/master/charts/fission-all",children:"https://github.com/fission/fission/tree/master/charts/fission-all"})}),"\n"]})]})}function h(n={}){const{wrapper:e}={...(0,l.M)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(a,{...n})}):a(n)}},38088:(n,e,s)=>{var i=s(96651),l=Symbol.for("react.element"),r=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,t=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function d(n,e,s){var i,r={},d=null,a=null;for(i in void 0!==s&&(d=""+s),void 0!==e.key&&(d=""+e.key),void 0!==e.ref&&(a=e.ref),e)o.call(e,i)&&!c.hasOwnProperty(i)&&(r[i]=e[i]);if(n&&n.defaultProps)for(i in e=n.defaultProps)void 0===r[i]&&(r[i]=e[i]);return{$$typeof:l,type:n,key:d,ref:a,props:r,_owner:t.current}}e.Fragment=r,e.jsx=d,e.jsxs=d},2488:(n,e,s)=>{n.exports=s(38088)},62780:(n,e,s)=>{s.d(e,{I:()=>t,M:()=>o});var i=s(96651);const l={},r=i.createContext(l);function o(n){const e=i.useContext(r);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function t(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(l):n.components||l:o(n.components),i.createElement(r.Provider,{value:e},n.children)}}}]);