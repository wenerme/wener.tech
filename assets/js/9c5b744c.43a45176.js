/*! For license information please see 9c5b744c.43a45176.js.LICENSE.txt */
"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[68841],{97422:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>c,contentTitle:()=>i,default:()=>j,frontMatter:()=>l,metadata:()=>d,toc:()=>h});var t=s(11527),r=s(47214);const l={title:"Systemd"},i="Systemd",d={id:"os/linux/init/systemd",title:"Systemd",description:"- systemd",source:"@site/../notes/os/linux/init/systemd.md",sourceDirName:"os/linux/init",slug:"/os/linux/init/systemd",permalink:"/notes/os/linux/init/systemd",draft:!1,unlisted:!1,editUrl:"https://github.com/wenerme/wener/edit/master/notes/../notes/os/linux/init/systemd.md",tags:[],version:"current",lastUpdatedBy:"wener",lastUpdatedAt:1701580433,formattedLastUpdatedAt:"Dec 3, 2023",frontMatter:{title:"Systemd"},sidebar:"docs",previous:{title:"Supervisor",permalink:"/notes/os/linux/init/supervisor"},next:{title:"libc",permalink:"/notes/os/linux/lib/libc"}},c={},h=[{value:"Unit \u6587\u4ef6",id:"unit-\u6587\u4ef6",level:2},{value:"Target",id:"target",level:2},{value:"Target vs init/RunLevel",id:"target-vs-initrunlevel",level:2},{value:"Why archlinux migrate to systemd",id:"why-archlinux-migrate-to-systemd",level:2},{value:"\u67e5\u770b\u5f00\u542f\u7684\u670d\u52a1",id:"\u67e5\u770b\u5f00\u542f\u7684\u670d\u52a1",level:2},{value:"crontab",id:"crontab",level:2}];function x(n){const e={a:"a",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.a)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.h1,{id:"systemd",children:"Systemd"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"https://www.freedesktop.org/wiki/Software/systemd",children:"systemd"})}),"\n",(0,t.jsxs)(e.li,{children:["wikipedia ",(0,t.jsx)(e.a,{href:"https://en.wikipedia.org/wiki/Systemd",children:"systemd"})]}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"https://www.freedesktop.org/software/systemd/man/systemd.unit.html",children:"systemd.unit"})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"https://www.freedesktop.org/software/systemd/man/systemctl.html",children:"systemctl manpage"})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"https://www.digitalocean.com/community/tutorials/how-to-use-systemctl-to-manage-systemd-services-and-units",children:"How To Use Systemctl to Manage Systemd Services and Units"})}),"\n",(0,t.jsxs)(e.li,{children:["\u914d\u7f6e\u76ee\u5f55\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.code,{children:"/etc/systemd/system/docker.service.d/*.conf"})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.code,{children:"/etc/systemd/system/"})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.code,{children:"/lib/systemd/system/"})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\u53c2\u8003\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"https://wiki.archlinux.org/index.php/Systemd-networkd",children:"https://wiki.archlinux.org/index.php/Systemd-networkd"})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"http://www.ruanyifeng.com/blog/2016/03/systemd-tutorial-commands.html",children:"Systemd \u5165\u95e8\u6559\u7a0b\uff1a\u547d\u4ee4\u7bc7"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# \u67e5\u770b\u914d\u7f6e\nsystemctl show docker\n# \u4fee\u6539 Service \u9700\u8981\u91cd\u8f7d\nsystemctl daemon-reload\n# \u67e5\u770b\u5b9a\u4e49\u7684\u914d\u7f6e\nsystemctl show --property=Environment docker\n# \u91cd\u542f\u670d\u52a1\nsystemctl restart docker\n\nsystemctl list-units --all\nsystemctl list-units --type=service\nsystemctl list-unit-files\n# \u67e5\u770b service \u6587\u4ef6\nsystemctl cat docker.service\n# \u67e5\u770b\u4f9d\u8d56\nsystemctl list-dependencies sshd.service\n# mask \u540e\u7684\u670d\u52a1\u4e0d\u80fd\u88ab\u542f\u52a8\nsystemctl mask nginx.service\nsystemctl unmask nginx.service\n# \u7f16\u8f91 service \u6587\u4ef6\nsystemctl edit nginx.service\n# \u7f16\u8f91\u5b8c\u6574\u7684\u6587\u4ef6,\u800c\u4e0d\u662f\u4e00\u4e2a\u7247\u6bb5,\u4f1a\u751f\u6210\u90e8\u5206\u5185\u5bb9\nsystemctl edit --full nginx.service\n\n# \u7cfb\u7edf\u72b6\u6001\nsystemctl status\n# \u670d\u52a1\u72b6\u6001\nsystemctl status prometheus-node-exporter.service\n# \u8fdc\u7a0b\u670d\u52a1\u72b6\u6001\nsystemctl -H root@127.0.0.1 status httpd.service\n# is-active, is-failed, is-enabled\nsystemctl is-active prometheus-node-exporter.service\n# \u7ba1\u7406\n# start stop restart kill reload show\nsystemctl start apache.service\n# \u67e5\u770b\u5c5e\u6027\nsystemctl show -P CPUShare apache.service\n# \u8bbe\u7f6e\u5c5e\u6027\nsystemctl set-property httpd.service CPUShares=500\n#\nsystemctl daemon-reload\n\n# \u67e5\u770b\u4f9d\u8d56\n# --all - \u6240\u6709\nsystemctl list-dependencies nginx.service\n\n# enabled disabled static masked\n# static - \u65e0 [Install]\uff0c \u53ea\u80fd\u88ab\u4f9d\u8d56\n# masked - \u88ab\u7981\u6b62\nsystemctl list-unit-files --type=service\n\n# \u67e5\u770b\u5185\u5bb9\nsystemctl cat atd.service\n"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,t.jsxs)(e.table,{children:[(0,t.jsx)(e.thead,{children:(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.th,{children:"command"}),(0,t.jsx)(e.th,{children:"mean"})]})}),(0,t.jsxs)(e.tbody,{children:[(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"\u67e5\u8be2"}),(0,t.jsx)(e.td,{children:"-"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"systemctl list-dependencies"}),(0,t.jsx)(e.td,{children:"unit \u4f9d\u8d56"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"systemctl list-sockets"}),(0,t.jsx)(e.td,{children:"sockets \u72b6\u6001"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"systemctl list-jobs"}),(0,t.jsx)(e.td,{children:"\u6d3b\u8dc3 jobs"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"systemctl list-unit-files"}),(0,t.jsx)(e.td,{children:"unit \u6587\u4ef6\u548c\u72b6\u6001"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"systemctl list-units"}),(0,t.jsx)(e.td,{children:"units loaded/active"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"systemctl get-default"}),(0,t.jsx)(e.td,{children:"default target (like run level)"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"\u670d\u52a1"}),(0,t.jsx)(e.td,{children:"-"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsxs)(e.td,{children:["systemctl stop ",(0,t.jsx)(e.em,{children:"service"})]}),(0,t.jsx)(e.td,{children:"\u505c\u6b62"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsxs)(e.td,{children:["systemctl start ",(0,t.jsx)(e.em,{children:"service"})]}),(0,t.jsx)(e.td,{children:"\u542f\u52a8"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsxs)(e.td,{children:["systemctl restart ",(0,t.jsx)(e.em,{children:"service"})]}),(0,t.jsx)(e.td,{children:"\u91cd\u542f"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsxs)(e.td,{children:["systemctl reload ",(0,t.jsx)(e.em,{children:"service"})]}),(0,t.jsx)(e.td,{children:"\u914d\u7f6e\u91cd\u8f7d"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"systemctl daemon-reload"}),(0,t.jsx)(e.td,{children:"\u91cd\u8f7d unit \u6587\u4ef6"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsxs)(e.td,{children:["systemctl status ",(0,t.jsx)(e.em,{children:"service"})]}),(0,t.jsx)(e.td,{children:"\u670d\u52a1\u72b6\u6001"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"systemctl --failed"}),(0,t.jsx)(e.td,{children:"\u5931\u8d25\u7684\u670d\u52a1"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"systemctl reset-failed"}),(0,t.jsx)(e.td,{children:"\u91cd\u7f6e\u5931\u8d25\u7684\u72b6\u6001"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsxs)(e.td,{children:["systemctl enable ",(0,t.jsx)(e.em,{children:"service"})]}),(0,t.jsx)(e.td,{children:"\u670d\u52a1\u81ea\u542f\u52a8"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsxs)(e.td,{children:["systemctl disable ",(0,t.jsx)(e.em,{children:"service"})]}),(0,t.jsx)(e.td,{children:"\u5173\u95ed\u81ea\u542f\u52a8"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsxs)(e.td,{children:["systemctl show ",(0,t.jsx)(e.em,{children:"service"})]}),(0,t.jsx)(e.td,{children:"\u670d\u52a1\u4fe1\u606f"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsxs)(e.td,{children:["systemctl edit ",(0,t.jsx)(e.em,{children:"service"})]}),(0,t.jsx)(e.td,{children:"\u7f16\u8f91 unit"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsxs)(e.td,{children:["systemctl edit --full ",(0,t.jsx)(e.em,{children:"service"})]}),(0,t.jsx)(e.td,{children:"\u7f16\u8f91\u670d\u52a1"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsxs)(e.td,{children:["systemctl -H ",(0,t.jsx)(e.em,{children:"host"})," status network"]}),(0,t.jsx)(e.td,{children:"\u8fdc\u7a0b\u6267\u884c"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"\u7cfb\u7edf\u72b6\u6001"}),(0,t.jsx)(e.td,{children:"-"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"systemctl reboot"}),(0,t.jsx)(e.td,{children:"\u91cd\u542f / reboot.target"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"systemctl poweroff"}),(0,t.jsx)(e.td,{children:"\u5173\u673a / poweroff.target"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"systemctl emergency"}),(0,t.jsx)(e.td,{children:"emergency.target"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"systemctl default"}),(0,t.jsx)(e.td,{children:"\u6062\u590d\u5230\u9ed8\u8ba4 multi-user.target"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"\u65e5\u5fd7"}),(0,t.jsx)(e.td,{children:"-"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"journalctl"}),(0,t.jsx)(e.td,{children:"\u6240\u6709\u65e5\u5fd7"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"journalctl -u network.service"}),(0,t.jsx)(e.td,{children:"\u7f51\u7edc\u670d\u52a1\u65e5\u5fd7"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"journalctl -f"}),(0,t.jsx)(e.td,{children:"\u8ddf\u968f\u663e\u793a"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"journalctl -k"}),(0,t.jsx)(e.td,{children:"\u5185\u6838\u65e5\u5fd7"})]})]})]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,t.jsxs)(e.table,{children:[(0,t.jsx)(e.thead,{children:(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.th,{children:"util"}),(0,t.jsx)(e.th,{children:"desc"})]})}),(0,t.jsxs)(e.tbody,{children:[(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"systemctl"}),(0,t.jsx)(e.td,{children:"\u4e3b\u8981\u547d\u4ee4"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"journalctl"}),(0,t.jsx)(e.td,{})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"notify"}),(0,t.jsx)(e.td,{})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"systemd-analyze"}),(0,t.jsx)(e.td,{children:"\u67e5\u770b\u542f\u52a8\u8017\u65f6"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"cgls"}),(0,t.jsx)(e.td,{})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"cgtop"}),(0,t.jsx)(e.td,{})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"loginctl"}),(0,t.jsx)(e.td,{children:"\u5f53\u524d\u767b\u9646\u7528\u6237"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"nspwan"}),(0,t.jsx)(e.td,{})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"hostnamectl"}),(0,t.jsx)(e.td,{children:"\u67e5\u770b\u548c\u7ba1\u7406\u4e3b\u673a\u4fe1\u606f"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"localectl"}),(0,t.jsx)(e.td,{children:"\u672c\u5730\u5316\u914d\u7f6e"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"timedatectl"}),(0,t.jsx)(e.td,{children:"\u65f6\u533a"})]})]})]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,t.jsxs)(e.table,{children:[(0,t.jsx)(e.thead,{children:(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.th,{children:"daemon"}),(0,t.jsx)(e.th,{children:"desc"})]})}),(0,t.jsxs)(e.tbody,{children:[(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"systemd"}),(0,t.jsx)(e.td,{})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"journald"}),(0,t.jsx)(e.td,{})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"networkd"}),(0,t.jsx)(e.td,{})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"logind"}),(0,t.jsx)(e.td,{})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"user session"}),(0,t.jsx)(e.td,{})]})]})]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,t.jsxs)(e.table,{children:[(0,t.jsx)(e.thead,{children:(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.th,{children:"unit"}),(0,t.jsx)(e.th,{children:"desc"})]})}),(0,t.jsxs)(e.tbody,{children:[(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Service"}),(0,t.jsx)(e.td,{children:"\u7cfb\u7edf\u670d\u52a1"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Target"}),(0,t.jsx)(e.td,{children:"\u591a\u4e2a Unit \u6784\u6210\u7684\u4e00\u4e2a\u7ec4"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Device"}),(0,t.jsx)(e.td,{children:"\u786c\u4ef6\u8bbe\u5907"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Mount"}),(0,t.jsx)(e.td,{children:"\u6587\u4ef6\u7cfb\u7edf\u7684\u6302\u8f7d\u70b9"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Automount"}),(0,t.jsx)(e.td,{children:"\u81ea\u52a8\u6302\u8f7d\u70b9"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Path"}),(0,t.jsx)(e.td,{children:"\u6587\u4ef6\u6216\u8def\u5f84"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Scope"}),(0,t.jsx)(e.td,{children:"\u4e0d\u662f\u7531 Systemd \u542f\u52a8\u7684\u5916\u90e8\u8fdb\u7a0b"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Slice"}),(0,t.jsx)(e.td,{children:"\u8fdb\u7a0b\u7ec4"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Snapshot"}),(0,t.jsx)(e.td,{children:"Systemd \u5feb\u7167\uff0c\u53ef\u4ee5\u5207\u56de\u67d0\u4e2a\u5feb\u7167"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Socket"}),(0,t.jsx)(e.td,{children:"\u8fdb\u7a0b\u95f4\u901a\u4fe1\u7684 socket"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Swap"}),(0,t.jsx)(e.td,{children:"swap \u6587\u4ef6"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Timer"}),(0,t.jsx)(e.td,{children:"\u5b9a\u65f6\u5668"})]})]})]}),"\n",(0,t.jsx)(e.h2,{id:"unit-\u6587\u4ef6",children:"Unit \u6587\u4ef6"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ini",children:"[Unit]\nDescription=\u63cf\u8ff0\nDocumentation=\u6587\u6863\u5730\u5740\n\nRequires=\u5f3a\u4f9d\u8d56 Unit\nWants=\u5f31\u4f9d\u8d56 Unit\nBindsTo=\u6dfb\u52a0\u4f9d\u8d56\u5230 Unit - \u6307\u5b9a Unit \u9000\u51fa\u5219\u5f53\u524d Unit \u4f1a\u9000\u51fa\nBefore=\nAfter=\nConflicts=\u4e0d\u80fd\u540c\u65f6\u8fd0\u884c Unit\nCondition=\nAssert=\n\n[Install]\nWantedBy=\u6307\u5b9a Target \u4f1a link \u5230 /etc/systemd/system/<Target>.wants\nRequiredBy=\u6307\u5b9a Target \u4f1a link \u5230 /etc/systemd/system/<Target>.required\nAlias=\nAlso=\u540c\u65f6\u542f\u52a8\u5176\u4ed6 Unit\n\n[Service]\n# simple - \u6267\u884c ExecStart\n# forking\n# oneshot - \u4e00\u6b21\u6027\uff0c\u6267\u884c\u5b8c\u6210\u540e\u7ee7\u7eed\n# dbus - \u901a\u8fc7 DBus \u542f\u52a8\n# notify - \u6267\u884c\u5b8c\u6bd5\u901a\u77e5 systemd\n# idle - \u6709\u5176\u4ed6\u4efb\u52a1\u5f53\u524d\u4efb\u52a1\u624d\u6267\u884c\nType=simple\n\nExecStart=\nExecStartPre=\nExecStartPost=\n\nExecReload=\n\nExecStop=\nExecStopPost=\n\nRestartSec=\n# \u91cd\u542f\u60c5\u51b5 - always, on-success, on-failure, on-abnormal, on-abort, on-watchdog\nRestart=\n\nTimeoutSec=\nEnvironment=\n"})}),"\n",(0,t.jsx)(e.h2,{id:"target",children:"Target"}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"Unit \u7ec4, \u7c7b\u4f3c\u4e8e\u5176\u4ed6 init \u7684 runlevel \u6982\u5ff5"}),"\n"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,t.jsxs)(e.table,{children:[(0,t.jsx)(e.thead,{children:(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.th,{children:"runlevel"}),(0,t.jsx)(e.th,{children:"target name"}),(0,t.jsx)(e.th,{children:"link"})]})}),(0,t.jsxs)(e.tbody,{children:[(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Runlevel 0"}),(0,t.jsx)(e.td,{children:"runlevel0.target"}),(0,t.jsx)(e.td,{children:"poweroff.target"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Runlevel 1"}),(0,t.jsx)(e.td,{children:"runlevel1.target"}),(0,t.jsx)(e.td,{children:"rescue.target"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Runlevel 2"}),(0,t.jsx)(e.td,{children:"runlevel2.target"}),(0,t.jsx)(e.td,{children:"multi-user.target"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Runlevel 3"}),(0,t.jsx)(e.td,{children:"runlevel3.target"}),(0,t.jsx)(e.td,{children:"multi-user.target"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Runlevel 4"}),(0,t.jsx)(e.td,{children:"runlevel4.target"}),(0,t.jsx)(e.td,{children:"multi-user.target"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Runlevel 5"}),(0,t.jsx)(e.td,{children:"runlevel5.target"}),(0,t.jsx)(e.td,{children:"graphical.target"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Runlevel 6"}),(0,t.jsx)(e.td,{children:"runlevel6.target"}),(0,t.jsx)(e.td,{children:"reboot.target"})]})]})]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# \u67e5\u770b\u5f53\u524d\u7cfb\u7edf\u7684\u6240\u6709 Target\nsystemctl list-unit-files --type=target\n\n# \u67e5\u770b\u4e00\u4e2a Target \u5305\u542b\u7684\u6240\u6709 Unit\nsystemctl list-dependencies multi-user.target\n\n# \u67e5\u770b\u542f\u52a8\u65f6\u7684\u9ed8\u8ba4 Target\nsystemctl get-default\n\n# \u8bbe\u7f6e\u542f\u52a8\u65f6\u7684\u9ed8\u8ba4 Target\nsudo systemctl set-default multi-user.target\n\n# \u5207\u6362 Target \u65f6\uff0c\u9ed8\u8ba4\u4e0d\u5173\u95ed\u524d\u4e00\u4e2a Target \u542f\u52a8\u7684\u8fdb\u7a0b\uff0c\n# systemctl isolate \u547d\u4ee4\u6539\u53d8\u8fd9\u79cd\u884c\u4e3a\uff0c\n# \u5173\u95ed\u524d\u4e00\u4e2a Target \u91cc\u9762\u6240\u6709\u4e0d\u5c5e\u4e8e\u540e\u4e00\u4e2a Target \u7684\u8fdb\u7a0b\nsudo systemctl isolate multi-user.target\n"})}),"\n",(0,t.jsx)(e.h2,{id:"target-vs-initrunlevel",children:"Target vs init/RunLevel"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["init/RunLevel\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\u9ed8\u8ba4 RunLevel /etc/inittab"}),"\n",(0,t.jsx)(e.li,{children:"\u811a\u672c\u4f4d\u4e8e /etc/init.d - \u7b49\u540c\u4e8e Unit"}),"\n",(0,t.jsx)(e.li,{children:"\u542f\u52a8\u7684\u811a\u672c link \u5230 /etc/rc.d \u6216 /etc/runlevels/"}),"\n",(0,t.jsxs)(e.li,{children:["init \u914d\u7f6e\u4f4d\u4e8e ",(0,t.jsx)(e.code,{children:"/etc/sysconfig"})," \u6216 ",(0,t.jsx)(e.code,{children:"/etc/rc.conf"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["Target\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\u9ed8\u8ba4 /etc/systemd/system/default.target\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"link \u5230 multi-user.target \u6216 graphical.target"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.li,{children:"Unit \u4f4d\u4e8e /lib/systemd/system"}),"\n",(0,t.jsx)(e.li,{children:"\u542f\u52a8\u540e\u4f4d\u4e8e /etc/systemd/system"}),"\n",(0,t.jsx)(e.li,{children:"systemd \u914d\u7f6e /lib/systemd, /etc/systemd"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.h1,{id:"example",children:"Example"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"https://github.com/docker/docker/blob/master/contrib/init/systemd/",children:"docker systemd"})}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"/etc/systemd/system/prometheus-node-exporter.service"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ini",children:"[Unit]\nDescription=Prometheus Node Exporter\nAfter=network-online.target\n\n[Service]\n# User=prometheus\nRestart=on-failure\n\nExecStart=/opt/prometheus/bin/node_exporter\n"})}),"\n",(0,t.jsx)(e.h1,{id:"faq",children:"FAQ"}),"\n",(0,t.jsx)(e.h2,{id:"why-archlinux-migrate-to-systemd",children:"Why archlinux migrate to systemd"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.a,{href:"https://bbs.archlinux.org/viewtopic.php?pid=1149530#p1149530",children:"Archlinux is moving to systemd"})," - 2012-08"]}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"\u67e5\u770b\u5f00\u542f\u7684\u670d\u52a1",children:"\u67e5\u770b\u5f00\u542f\u7684\u670d\u52a1"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"systemctl list-unit-files --state=enabled\nsystemctl list-unit-files --state=enabled --type=service\nsystemctl list-unit-files | grep enabled\n"})}),"\n",(0,t.jsx)(e.h2,{id:"crontab",children:"crontab"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"/var/spool/cron/root - \u5168\u5c40\uff0c\u65e0\u7528\u6237"}),"\n",(0,t.jsx)(e.li,{children:"/etc/crontab - root\uff0c\u9700\u8981\u6307\u5b9a\u7528\u6237"}),"\n",(0,t.jsx)(e.li,{children:"/etc/cron.d/ - \u9700\u8981\u6307\u5b9a\u7528\u6237"}),"\n"]})]})}function j(n={}){const{wrapper:e}={...(0,r.a)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(x,{...n})}):x(n)}},3354:(n,e,s)=>{var t=s(50959),r=Symbol.for("react.element"),l=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,d=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function h(n,e,s){var t,l={},h=null,x=null;for(t in void 0!==s&&(h=""+s),void 0!==e.key&&(h=""+e.key),void 0!==e.ref&&(x=e.ref),e)i.call(e,t)&&!c.hasOwnProperty(t)&&(l[t]=e[t]);if(n&&n.defaultProps)for(t in e=n.defaultProps)void 0===l[t]&&(l[t]=e[t]);return{$$typeof:r,type:n,key:h,ref:x,props:l,_owner:d.current}}e.Fragment=l,e.jsx=h,e.jsxs=h},11527:(n,e,s)=>{n.exports=s(3354)},47214:(n,e,s)=>{s.d(e,{Z:()=>d,a:()=>i});var t=s(50959);const r={},l=t.createContext(r);function i(n){const e=t.useContext(l);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function d(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:i(n.components),t.createElement(l.Provider,{value:e},n.children)}}}]);