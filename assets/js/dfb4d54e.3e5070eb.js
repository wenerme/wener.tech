/*! For license information please see dfb4d54e.3e5070eb.js.LICENSE.txt */
"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[31183],{77678:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>r,default:()=>h,frontMatter:()=>s,metadata:()=>a,toc:()=>c});var o=t(11527),l=t(47214);const s={title:"Nextcloud FAQ",tags:["FAQ"]},r="Nextcloud FAQ",a={id:"service/file/nextcloud/nextcloud-faq",title:"Nextcloud FAQ",description:"su as",source:"@site/../notes/service/file/nextcloud/nextcloud-faq.md",sourceDirName:"service/file/nextcloud",slug:"/service/file/nextcloud/faq",permalink:"/notes/service/file/nextcloud/faq",draft:!1,unlisted:!1,editUrl:"https://github.com/wenerme/wener/edit/master/notes/../notes/service/file/nextcloud/nextcloud-faq.md",tags:[{label:"FAQ",permalink:"/notes/tags/faq"}],version:"current",lastUpdatedBy:"wener",lastUpdatedAt:1701580433,formattedLastUpdatedAt:"Dec 3, 2023",frontMatter:{title:"Nextcloud FAQ",tags:["FAQ"]},sidebar:"docs",previous:{title:"Nextcloud \u5f00\u53d1",permalink:"/notes/service/file/nextcloud/dev"},next:{title:"Nextcloud \u7248\u672c",permalink:"/notes/service/file/nextcloud/version"}},i={},c=[{value:"su as",id:"su-as",level:2},{value:"\u79fb\u9664\u83b7\u53d6\u514d\u8d39\u8d26\u53f7\u7684 Footer",id:"\u79fb\u9664\u83b7\u53d6\u514d\u8d39\u8d26\u53f7\u7684-footer",level:2},{value:"\u6ce8\u610f proxy \u914d\u7f6e",id:"\u6ce8\u610f-proxy-\u914d\u7f6e",level:2},{value:"nextcloud put 413",id:"nextcloud-put-413",level:2},{value:"Auto provisioning not allowed and user hello does not exist",id:"auto-provisioning-not-allowed-and-user-hello-does-not-exist",level:2},{value:"Found an Attribute element with duplicated Name",id:"found-an-attribute-element-with-duplicated-name",level:2},{value:"Command &quot;maintenance&quot; is not defined.",id:"command-maintenance-is-not-defined",level:2},{value:"cURL error 28: Operation timed out after XXXXXX milliseconds",id:"curl-error-28-operation-timed-out-after-xxxxxx-milliseconds",level:2},{value:"Error when trying to connect (Host violates local access rules)",id:"error-when-trying-to-connect-host-violates-local-access-rules",level:2},{value:"fpm caddy",id:"fpm-caddy",level:2},{value:"Collabora Online should expose the same protocol as the server installation. Please check the ssl.enable and ssl.termination settings of your Collabora Online server.",id:"collabora-online-should-expose-the-same-protocol-as-the-server-installation-please-check-the-sslenable-and-ssltermination-settings-of-your-collabora-online-server",level:2},{value:"loading document exception: No acceptable WOPI hosts found matching the target host",id:"loading-document-exception-no-acceptable-wopi-hosts-found-matching-the-target-host",level:2},{value:"Refused to send form data to &#39;https://nextcloud&#39; because it violates the following Content Security Policy directive: &quot;form-action &#39;self&#39; https://collabora&quot;",id:"refused-to-send-form-data-to-httpsnextcloud-because-it-violates-the-following-content-security-policy-directive-form-action-self-httpscollabora",level:2},{value:"AH00558: apache2: Could not reliably determine the server&#39;s fully qualified domain name",id:"ah00558-apache2-could-not-reliably-determine-the-servers-fully-qualified-domain-name",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,l.a)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h1,{id:"nextcloud-faq",children:"Nextcloud FAQ"}),"\n",(0,o.jsx)(n.h2,{id:"su-as",children:"su as"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["\u6709\u4e9b\u65f6\u5019\u65e0\u6cd5 ",(0,o.jsx)(n.code,{children:"docker exec -u www-data"})]}),"\n",(0,o.jsx)(n.li,{children:"kubectl \u4e0d\u652f\u6301 -u"}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"su -l www-data -s /bin/bash\ncd /var/www/html\nexport PHP_MEMORY_LIMIT=8G\n./occ\n\ntail -f /var/www/html/data/nextcloud.log\n"})}),"\n",(0,o.jsx)(n.h2,{id:"\u79fb\u9664\u83b7\u53d6\u514d\u8d39\u8d26\u53f7\u7684-footer",children:"\u79fb\u9664\u83b7\u53d6\u514d\u8d39\u8d26\u53f7\u7684 Footer"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"su -l www-data -s /bin/bash\ncd /var/www/html\n./occ config:system:set simpleSignUpLink.shown --value=false --type=boolean\n"})}),"\n",(0,o.jsx)(n.h2,{id:"\u6ce8\u610f-proxy-\u914d\u7f6e",children:"\u6ce8\u610f proxy \u914d\u7f6e"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"\u5982\u679c\u51fa\u73b0 office \u6253\u4e0d\u5f00\uff0c\u4e5f\u53ef\u80fd\u662f\u5f00\u4e86 proxy \u5bfc\u81f4\u65e0\u6cd5\u8fde\u63a5"}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"nextcloud-put-413",children:"nextcloud put 413"}),"\n",(0,o.jsx)(n.p,{children:"\u53d1\u751f\u672a\u77e5\u9519\u8bef"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"\u8c03\u6574 nginx\u3001haproxy \u6700\u5927 body \u5927\u5c0f"}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"auto-provisioning-not-allowed-and-user-hello-does-not-exist",children:"Auto provisioning not allowed and user hello does not exist"}),"\n",(0,o.jsx)(n.h2,{id:"found-an-attribute-element-with-duplicated-name",children:"Found an Attribute element with duplicated Name"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Keycloak"}),"\n",(0,o.jsx)(n.li,{children:"(Realm) -> Client Scopes -> role_list (saml) -> Mappers tab -> role list -> 'Single Role Attribute'."}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"command-maintenance-is-not-defined",children:'Command "maintenance:install" is not defined.'}),"\n",(0,o.jsxs)(n.p,{children:["\u5e94\u7528\u88ab\u91cd\u65b0\u5b89\u88c5\u4e86\uff0c\u56e0\u4e3a\u6ca1\u6709\u68c0\u6d4b\u5230 ",(0,o.jsx)(n.code,{children:"/var/www/html/version.php"}),"\uff0c\u9700\u8981\u6ce8\u610f\u6302\u8f7d\u8def\u5f84"]}),"\n",(0,o.jsx)(n.h2,{id:"curl-error-28-operation-timed-out-after-xxxxxx-milliseconds",children:"cURL error 28: Operation timed out after XXXXXX milliseconds"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"https://github.com/nextcloud/server/issues/18103",children:"#18103"})}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"error-when-trying-to-connect-host-violates-local-access-rules",children:"Error when trying to connect (Host violates local access rules)"}),"\n",(0,o.jsx)(n.p,{children:"\u914d\u7f6e"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-php",children:"'allow_local_remote_servers'=>true,\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"sudo -u www-data ./occ config:system:set allow_local_remote_servers --value=true --type=boolean\n"})}),"\n",(0,o.jsx)(n.h2,{id:"fpm-caddy",children:"fpm caddy"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"https:// {\n\n      reverse_proxy /loleaflet collabora:9980\n      reverse_proxy /hosting/discovery collabora:9980\n      reverse_proxy /lool collabora:9980\n      reverse_proxy /cool/* collabora:9980\n      reverse_proxy /hosting/capabilities collabora:9980\n      reverse_proxy /browser collabora:9980\n\n\n        header {\nStrict-Transport-Security max-age=31536000;\n        }\n\n\ttls internal {\n\t\ton_demand\n\t}\n\n        #redir /.well-known/carddav /remote.php/dav 301\n        #redir /.well-known/caldav /remote.php/dav 301\n\n        # .htaccess / data / config / ... shouldn't be accessible from outside\n        @forbidden {\n                path    /.htaccess\n                path    /data/*\n                path    /config/*\n                path    /db_structure\n                path    /.xml\n                path    /README\n                path    /3rdparty/*\n                path    /lib/*\n                path    /templates/*\n                path    /occ\n                path    /console.php\n        }\n\n        respond @forbidden 404\n\n}\n"})}),"\n",(0,o.jsx)(n.h2,{id:"collabora-online-should-expose-the-same-protocol-as-the-server-installation-please-check-the-sslenable-and-ssltermination-settings-of-your-collabora-online-server",children:"Collabora Online should expose the same protocol as the server installation. Please check the ssl.enable and ssl.termination settings of your Collabora Online server."}),"\n",(0,o.jsx)(n.h2,{id:"loading-document-exception-no-acceptable-wopi-hosts-found-matching-the-target-host",children:"loading document exception: No acceptable WOPI hosts found matching the target host"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"docker run --rm -it -e 'domain=nextcloud.wener.me'\n"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"\u6ce8\u610f\u914d\u7f6e domain"}),"\n"]}),"\n",(0,o.jsxs)(n.h2,{id:"refused-to-send-form-data-to-httpsnextcloud-because-it-violates-the-following-content-security-policy-directive-form-action-self-httpscollabora",children:["Refused to send form data to '",(0,o.jsx)(n.a,{href:"https://nextcloud",children:"https://nextcloud"}),"' because it violates the following Content Security Policy directive: \"form-action 'self' ",(0,o.jsx)(n.a,{href:"https://collabora",children:"https://collabora"}),'"']}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"CSP"}),"\n",(0,o.jsx)(n.li,{children:"form-action 'self'"}),"\n",(0,o.jsxs)(n.li,{children:["\u5982\u679c\u662f http \u548c https \u95ee\u9898\u53ef\u4ee5\u914d\u7f6e ",(0,o.jsx)(n.code,{children:"'overwriteprotocol' => 'https'"})]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"./occ config:system:set overwriteprotocol --value=https\n"})}),"\n",(0,o.jsx)(n.h2,{id:"ah00558-apache2-could-not-reliably-determine-the-servers-fully-qualified-domain-name",children:"AH00558: apache2: Could not reliably determine the server's fully qualified domain name"}),"\n",(0,o.jsx)(n.p,{children:"Apache \u9519\u8bef\u4fe1\u606f\uff0c\u4e0d\u5f71\u54cd"})]})}function h(e={}){const{wrapper:n}={...(0,l.a)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},3354:(e,n,t)=>{var o=t(50959),l=Symbol.for("react.element"),s=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,a=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function c(e,n,t){var o,s={},c=null,d=null;for(o in void 0!==t&&(c=""+t),void 0!==n.key&&(c=""+n.key),void 0!==n.ref&&(d=n.ref),n)r.call(n,o)&&!i.hasOwnProperty(o)&&(s[o]=n[o]);if(e&&e.defaultProps)for(o in n=e.defaultProps)void 0===s[o]&&(s[o]=n[o]);return{$$typeof:l,type:e,key:c,ref:d,props:s,_owner:a.current}}n.Fragment=s,n.jsx=c,n.jsxs=c},11527:(e,n,t)=>{e.exports=t(3354)},47214:(e,n,t)=>{t.d(n,{Z:()=>a,a:()=>r});var o=t(50959);const l={},s=o.createContext(l);function r(e){const n=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:r(e.components),o.createElement(s.Provider,{value:n},e.children)}}}]);