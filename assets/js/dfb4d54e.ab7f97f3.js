"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[31183],{49613:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return f}});var o=n(59496);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,o,l=function(e,t){if(null==e)return{};var n,o,l={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(l[n]=e[n]);return l}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}var s=o.createContext({}),c=function(e){var t=o.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},u=function(e){var t=c(e.components);return o.createElement(s.Provider,{value:t},e.children)},d="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},m=o.forwardRef((function(e,t){var n=e.components,l=e.mdxType,r=e.originalType,s=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),d=c(n),m=l,f=d["".concat(s,".").concat(m)]||d[m]||p[m]||r;return n?o.createElement(f,a(a({ref:t},u),{},{components:n})):o.createElement(f,a({ref:t},u))}));function f(e,t){var n=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var r=n.length,a=new Array(r);a[0]=m;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i[d]="string"==typeof e?e:l,a[1]=i;for(var c=2;c<r;c++)a[c]=n[c];return o.createElement.apply(null,a)}return o.createElement.apply(null,n)}m.displayName="MDXCreateElement"},9152:function(e,t,n){n.r(t),n.d(t,{assets:function(){return b},contentTitle:function(){return h},default:function(){return w},frontMatter:function(){return f},metadata:function(){return v},toc:function(){return y}});var o=n(49613),l=Object.defineProperty,r=Object.defineProperties,a=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable,u=(e,t,n)=>t in e?l(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,d=(e,t)=>{for(var n in t||(t={}))s.call(t,n)&&u(e,n,t[n]);if(i)for(var n of i(t))c.call(t,n)&&u(e,n,t[n]);return e},p=(e,t)=>r(e,a(t)),m=(e,t)=>{var n={};for(var o in e)s.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&i)for(var o of i(e))t.indexOf(o)<0&&c.call(e,o)&&(n[o]=e[o]);return n};const f={title:"Nextcloud FAQ",tags:["FAQ"]},h="Nextcloud FAQ",v={unversionedId:"service/file/nextcloud/nextcloud-faq",id:"service/file/nextcloud/nextcloud-faq",title:"Nextcloud FAQ",description:"su as",source:"@site/../notes/service/file/nextcloud/nextcloud-faq.md",sourceDirName:"service/file/nextcloud",slug:"/service/file/nextcloud/faq",permalink:"/notes/service/file/nextcloud/faq",draft:!1,editUrl:"https://github.com/wenerme/wener/edit/master/notes/../notes/service/file/nextcloud/nextcloud-faq.md",tags:[{label:"FAQ",permalink:"/notes/tags/faq"}],version:"current",lastUpdatedBy:"wener",lastUpdatedAt:1689238697,formattedLastUpdatedAt:"Jul 13, 2023",frontMatter:{title:"Nextcloud FAQ",tags:["FAQ"]},sidebar:"docs",previous:{title:"Nextcloud \u5f00\u53d1",permalink:"/notes/service/file/nextcloud/dev"},next:{title:"Nextcloud \u7248\u672c",permalink:"/notes/service/file/nextcloud/version"}},b={},y=[{value:"su as",id:"su-as",level:2},{value:"nextcloud put 413",id:"nextcloud-put-413",level:2},{value:"Auto provisioning not allowed and user hello does not exist",id:"auto-provisioning-not-allowed-and-user-hello-does-not-exist",level:2},{value:"Found an Attribute element with duplicated Name",id:"found-an-attribute-element-with-duplicated-name",level:2},{value:"Command &quot;maintenance:install&quot; is not defined.",id:"command-maintenanceinstall-is-not-defined",level:2},{value:"cURL error 28: Operation timed out after XXXXXX milliseconds",id:"curl-error-28-operation-timed-out-after-xxxxxx-milliseconds",level:2},{value:"Error when trying to connect (Host violates local access rules)",id:"error-when-trying-to-connect-host-violates-local-access-rules",level:2},{value:"fpm caddy",id:"fpm-caddy",level:2},{value:"Collabora Online should expose the same protocol as the server installation. Please check the ssl.enable and ssl.termination settings of your Collabora Online server.",id:"collabora-online-should-expose-the-same-protocol-as-the-server-installation-please-check-the-sslenable-and-ssltermination-settings-of-your-collabora-online-server",level:2},{value:"loading document exception: No acceptable WOPI hosts found matching the target host",id:"loading-document-exception-no-acceptable-wopi-hosts-found-matching-the-target-host",level:2},{value:"Refused to send form data to &#39;https://nextcloud&#39; because it violates the following Content Security Policy directive: &quot;form-action &#39;self&#39; https://collabora&quot;",id:"refused-to-send-form-data-to-httpsnextcloud-because-it-violates-the-following-content-security-policy-directive-form-action-self-httpscollabora",level:2},{value:"AH00558: apache2: Could not reliably determine the server&#39;s fully qualified domain name",id:"ah00558-apache2-could-not-reliably-determine-the-servers-fully-qualified-domain-name",level:2}],x={toc:y},g="wrapper";function w(e){var t=e,{components:n}=t,l=m(t,["components"]);return(0,o.kt)(g,p(d(d({},x),l),{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",d({},{id:"nextcloud-faq"}),"Nextcloud FAQ"),(0,o.kt)("h2",d({},{id:"su-as"}),"su as"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"\u6709\u4e9b\u65f6\u5019\u65e0\u6cd5 ",(0,o.kt)("inlineCode",{parentName:"li"},"docker exec -u www-data")),(0,o.kt)("li",{parentName:"ul"},"kubectl \u4e0d\u652f\u6301 -u")),(0,o.kt)("pre",null,(0,o.kt)("code",d({parentName:"pre"},{className:"language-bash"}),"su -l www-data -s /bin/bash\ncd /var/www/html\nexport PHP_MEMORY_LIMIT=8G\n./occ\n\ntail -f /var/www/html/data/nextcloud.log\n")),(0,o.kt)("h2",d({},{id:"nextcloud-put-413"}),"nextcloud put 413"),(0,o.kt)("p",null,"\u53d1\u751f\u672a\u77e5\u9519\u8bef"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"\u8c03\u6574 nginx\u3001haproxy \u6700\u5927 body \u5927\u5c0f")),(0,o.kt)("h2",d({},{id:"auto-provisioning-not-allowed-and-user-hello-does-not-exist"}),"Auto provisioning not allowed and user hello does not exist"),(0,o.kt)("h2",d({},{id:"found-an-attribute-element-with-duplicated-name"}),"Found an Attribute element with duplicated Name"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Keycloak"),(0,o.kt)("li",{parentName:"ul"},"(Realm) -> Client Scopes -> role_list (saml) -> Mappers tab -> role list -> 'Single Role Attribute'.")),(0,o.kt)("h2",d({},{id:"command-maintenanceinstall-is-not-defined"}),'Command "maintenance:install" is not defined.'),(0,o.kt)("p",null,"\u5e94\u7528\u88ab\u91cd\u65b0\u5b89\u88c5\u4e86\uff0c\u56e0\u4e3a\u6ca1\u6709\u68c0\u6d4b\u5230 ",(0,o.kt)("inlineCode",{parentName:"p"},"/var/www/html/version.php"),"\uff0c\u9700\u8981\u6ce8\u610f\u6302\u8f7d\u8def\u5f84"),(0,o.kt)("h2",d({},{id:"curl-error-28-operation-timed-out-after-xxxxxx-milliseconds"}),"cURL error 28: Operation timed out after XXXXXX milliseconds"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",d({parentName:"li"},{href:"https://github.com/nextcloud/server/issues/18103"}),"#18103"))),(0,o.kt)("h2",d({},{id:"error-when-trying-to-connect-host-violates-local-access-rules"}),"Error when trying to connect (Host violates local access rules)"),(0,o.kt)("p",null,"\u914d\u7f6e"),(0,o.kt)("pre",null,(0,o.kt)("code",d({parentName:"pre"},{className:"language-php"}),"'allow_local_remote_servers'=>true,\n")),(0,o.kt)("pre",null,(0,o.kt)("code",d({parentName:"pre"},{className:"language-bash"}),"sudo -u www-data ./occ config:system:set allow_local_remote_servers --value=true --type=boolean\n")),(0,o.kt)("h2",d({},{id:"fpm-caddy"}),"fpm caddy"),(0,o.kt)("pre",null,(0,o.kt)("code",d({parentName:"pre"},{}),"https:// {\n\n      reverse_proxy /loleaflet collabora:9980\n      reverse_proxy /hosting/discovery collabora:9980\n      reverse_proxy /lool collabora:9980\n      reverse_proxy /cool/* collabora:9980\n      reverse_proxy /hosting/capabilities collabora:9980\n      reverse_proxy /browser collabora:9980\n\n\n        header {\nStrict-Transport-Security max-age=31536000;\n        }\n\n    tls internal {\n        on_demand\n    }\n\n        #redir /.well-known/carddav /remote.php/dav 301\n        #redir /.well-known/caldav /remote.php/dav 301\n\n        # .htaccess / data / config / ... shouldn't be accessible from outside\n        @forbidden {\n                path    /.htaccess\n                path    /data/*\n                path    /config/*\n                path    /db_structure\n                path    /.xml\n                path    /README\n                path    /3rdparty/*\n                path    /lib/*\n                path    /templates/*\n                path    /occ\n                path    /console.php\n        }\n\n        respond @forbidden 404\n\n}\n")),(0,o.kt)("h2",d({},{id:"collabora-online-should-expose-the-same-protocol-as-the-server-installation-please-check-the-sslenable-and-ssltermination-settings-of-your-collabora-online-server"}),"Collabora Online should expose the same protocol as the server installation. Please check the ssl.enable and ssl.termination settings of your Collabora Online server."),(0,o.kt)("h2",d({},{id:"loading-document-exception-no-acceptable-wopi-hosts-found-matching-the-target-host"}),"loading document exception: No acceptable WOPI hosts found matching the target host"),(0,o.kt)("pre",null,(0,o.kt)("code",d({parentName:"pre"},{className:"language-bash"}),"docker run --rm -it -e 'domain=nextcloud.wener.me'\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"\u6ce8\u610f\u914d\u7f6e domain")),(0,o.kt)("h2",d({},{id:"refused-to-send-form-data-to-httpsnextcloud-because-it-violates-the-following-content-security-policy-directive-form-action-self-httpscollabora"}),"Refused to send form data to 'https://nextcloud' because it violates the following Content Security Policy directive: \"form-action 'self' https://collabora\""),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"CSP"),(0,o.kt)("li",{parentName:"ul"},"form-action 'self'"),(0,o.kt)("li",{parentName:"ul"},"\u5982\u679c\u662f http \u548c https \u95ee\u9898\u53ef\u4ee5\u914d\u7f6e ",(0,o.kt)("inlineCode",{parentName:"li"},"'overwriteprotocol' => 'https'"))),(0,o.kt)("pre",null,(0,o.kt)("code",d({parentName:"pre"},{className:"language-bash"}),"./occ config:system:set overwriteprotocol --value=https\n")),(0,o.kt)("h2",d({},{id:"ah00558-apache2-could-not-reliably-determine-the-servers-fully-qualified-domain-name"}),"AH00558: apache2: Could not reliably determine the server's fully qualified domain name"),(0,o.kt)("p",null,"Apache \u9519\u8bef\u4fe1\u606f\uff0c\u4e0d\u5f71\u54cd"))}w.isMDXComponent=!0}}]);