"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[52975],{49613:function(e,n,t){t.d(n,{Zo:function(){return m},kt:function(){return c}});var r=t(59496);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function o(e,n){if(null==e)return{};var t,r,i=function(e,n){if(null==e)return{};var t,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var p=r.createContext({}),s=function(e){var n=r.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},m=function(e){var n=s(e.components);return r.createElement(p.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},d=r.forwardRef((function(e,n){var t=e.components,i=e.mdxType,a=e.originalType,p=e.parentName,m=o(e,["components","mdxType","originalType","parentName"]),d=s(t),c=i,k=d["".concat(p,".").concat(c)]||d[c]||u[c]||a;return t?r.createElement(k,l(l({ref:n},m),{},{components:t})):r.createElement(k,l({ref:n},m))}));function c(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var a=t.length,l=new Array(a);l[0]=d;var o={};for(var p in n)hasOwnProperty.call(n,p)&&(o[p]=n[p]);o.originalType=e,o.mdxType="string"==typeof e?e:i,l[1]=o;for(var s=2;s<a;s++)l[s]=t[s];return r.createElement.apply(null,l)}return r.createElement.apply(null,t)}d.displayName="MDXCreateElement"},94768:function(e,n,t){t.r(n),t.d(n,{assets:function(){return h},contentTitle:function(){return c},default:function(){return g},frontMatter:function(){return d},metadata:function(){return k},toc:function(){return f}});var r=t(49613),i=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,p=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,m=(e,n,t)=>n in e?i(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,u=(e,n)=>{for(var t in n||(n={}))p.call(n,t)&&m(e,t,n[t]);if(o)for(var t of o(n))s.call(n,t)&&m(e,t,n[t]);return e};const d={title:"InfiniBand"},c="InfiniBand",k={unversionedId:"network/link/infiniband",id:"network/link/infiniband",title:"InfiniBand",description:"- mtu > 1500 \u53ef\u80fd\u4f1a\u6709\u95ee\u9898",source:"@site/../notes/network/link/infiniband.md",sourceDirName:"network/link",slug:"/network/link/infiniband",permalink:"/notes/network/link/infiniband",draft:!1,editUrl:"https://github.com/wenerme/wener/edit/master/notes/../notes/network/link/infiniband.md",tags:[],version:"current",lastUpdatedBy:"wener",lastUpdatedAt:1688543048,formattedLastUpdatedAt:"Jul 5, 2023",frontMatter:{title:"InfiniBand"},sidebar:"docs",previous:{title:"\u5e38\u89c1\u7aef\u53e3\u53f7",permalink:"/notes/network/internet/ports"},next:{title:"Port forward",permalink:"/notes/network/port-forward"}},h={},f=[{value:"\u5e38\u89c1\u7684\u5ef6\u8fdf\u548c\u901f\u5ea6",id:"\u5e38\u89c1\u7684\u5ef6\u8fdf\u548c\u901f\u5ea6",level:3},{value:"\u5185\u6838\u6a21\u5757",id:"\u5185\u6838\u6a21\u5757",level:3},{value:"\u542f\u52a8\u5185\u6838\u4fe1\u606f",id:"\u542f\u52a8\u5185\u6838\u4fe1\u606f",level:3},{value:"opensm",id:"opensm",level:2},{value:"\u5e38\u89c1\u9519\u8bef",id:"\u5e38\u89c1\u9519\u8bef",level:2},{value:"IPoIB",id:"ipoib",level:2},{value:"ethernet mode",id:"ethernet-mode",level:2},{value:"MTU",id:"mtu",level:2}],b={toc:f};function g(e){var n,t=e,{components:i}=t,m=((e,n)=>{var t={};for(var r in e)p.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(null!=e&&o)for(var r of o(e))n.indexOf(r)<0&&s.call(e,r)&&(t[r]=e[r]);return t})(t,["components"]);return(0,r.kt)("wrapper",(n=u(u({},b),m),a(n,l({components:i,mdxType:"MDXLayout"}))),(0,r.kt)("h1",u({},{id:"infiniband"}),"InfiniBand"),(0,r.kt)("admonition",u({},{type:"caution"}),(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},"mtu > 1500 \u53ef\u80fd\u4f1a\u6709\u95ee\u9898"))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",u({parentName:"li"},{href:"https://en.wikipedia.org/wiki/InfiniBand"}),"wiki/InfiniBand")),(0,r.kt)("li",{parentName:"ul"},"Current message level",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",u({parentName:"li"},{href:"https://www.kernel.org/doc/Documentation/networking/netif-msg.txt"}),"https://www.kernel.org/doc/Documentation/networking/netif-msg.txt")))),(0,r.kt)("li",{parentName:"ul"},"Arch",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",u({parentName:"li"},{href:"https://wiki.archlinux.org/index.php/InfiniBand"}),"https://wiki.archlinux.org/index.php/InfiniBand")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",u({parentName:"li"},{href:"https://wiki.archlinux.org/index.php/Jumbo_frames"}),"https://wiki.archlinux.org/index.php/Jumbo_frames")))),(0,r.kt)("li",{parentName:"ul"},"10 Gig Eth",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u4e0d\u9700\u8981 IB \u4ea4\u6362\u673a"),(0,r.kt)("li",{parentName:"ul"},"Mellanox \u5e26 ",(0,r.kt)("inlineCode",{parentName:"li"},"_en")," \u7684\u5373\u4e3a ethernet \u8bbe\u5907"))),(0,r.kt)("li",{parentName:"ul"},"jumbo frames",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"MTU \u5927\u4e8e 1500 \u7684 Ethernet \u5e27"),(0,r.kt)("li",{parentName:"ul"},"\u6700\u591a 9000, \u6839\u636e\u8bbe\u5907\u548c\u7f51\u7edc\u7ed3\u6784\u53ef\u80fd\u6709\u6240\u4e0d\u540c"),(0,r.kt)("li",{parentName:"ul"},"\u53ef\u80fd\u589e\u52a0\u5ef6\u65f6, \u4f46\u662f\u80fd\u5927\u91cf\u63d0\u5347\u7f51\u7edc\u4f20\u8f93\u901f\u5ea6"))),(0,r.kt)("li",{parentName:"ul"},"mellanox",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",u({parentName:"li"},{href:"http://www.mellanox.com/related-docs/prod_software/MLNX_EN_Linux_README.txt"}),"MLNX_EN_Linux_README.txt")),(0,r.kt)("li",{parentName:"ul"},"linux ",(0,r.kt)("a",u({parentName:"li"},{href:"https://github.com/torvalds/linux/blob/master/drivers/net/ethernet/mellanox/mlx4/mlx4_en.h"}),"mlx4_en.h")))),(0,r.kt)("li",{parentName:"ul"},"\u53c2\u8003",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",u({parentName:"li"},{href:"http://www.infinibandta.org/"}),"infinibandta")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",u({parentName:"li"},{href:"https://serverfault.com/questions/757961"}),"How to fine tune TCP performance on Linux with a 10Gb fiber connection")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",u({parentName:"li"},{href:"https://blog.cloudflare.com/how-to-achieve-low-latency/"}),"How to achieve low latency with 10Gbps Ethernet")))),(0,r.kt)("li",{parentName:"ul"},"\u6ce8\u610f",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u5728 ",(0,r.kt)("inlineCode",{parentName:"li"},"/etc/network/interface")," \u4e0b\u914d\u7f6e\u7684\u987a\u5e8f\u4f1a\u5f71\u54cd\u9ed8\u8ba4\u7f51\u5361, \u5c06 ib \u914d\u7f6e\u5728\u7b2c\u4e00\u4f4d\u5373\u53ef"))),(0,r.kt)("li",{parentName:"ul"},"SM - subnet manager")),(0,r.kt)("pre",null,(0,r.kt)("code",u({parentName:"pre"},{className:"language-bash"}),"# \u67e5\u770b\u90ae\u4ef6\napk add lshw\nlshw -class network\n\n# \u67e5\u770b pci \u8bbe\u5907\napk add pciutils\nlspci | grep -i 'ethernet'\n\n# \u5e38\u89c1\u5382\u5546\u4fe1\u606f\ndmesg | egrep -i \"Mellanox|InfiniBand|QLogic|Voltaire\"\n# ib \u72b6\u6001, \u9700\u8981\u5b89\u88c5\u6269\u5c55\u5305\nibstat\n# \u67e5\u770b\u8bbe\u5907\nls /sys/class/infiniband/\n# \u67e5\u770b\u7269\u7406\u72b6\u6001\ngrep . /sys/class/infiniband/*/ports/*/phys_state\n# \u67e5\u770b\u8bbe\u5907\u72b6\u6001\ngrep . /sys/class/infiniband/*/ports/*/state\n# \u67e5\u770b mtu \u548c \u5730\u5740\ngrep . /sys/class/net/*/{mtu,address}\n\n# \u67e5\u770b\u8bbe\u7f6e\nethtool eth2\n# Settings for eth2:\n#   Supported ports: [ FIBRE ]\n#   Supported link modes:   10000baseT/Full\n#   Supported pause frame use: No\n#   Supports auto-negotiation: No\n#   Advertised link modes:  10000baseT/Full\n#   Advertised pause frame use: No\n#   Advertised auto-negotiation: No\n#   Speed: 10000Mb/s\n#   Duplex: Full\n#   Port: FIBRE\n#   PHYAD: 0\n#   Transceiver: internal\n#   Auto-negotiation: off\n#   Supports Wake-on: d\n#   Wake-on: d\n#   Current message level: 0x00000014 (20)\n#                  link ifdown\n#   Link detected: yes\n\n# \u67e5\u770b\u9a71\u52a8\u4fe1\u606f\nethtool -i eth2\n# driver: mlx4_en\n# version: 2.2-1 (Feb 2014)\n# firmware-version: 2.9.1000\n# expansion-rom-version:\n# bus-info: 0000:08:00.0\n# supports-statistics: yes\n# supports-test: yes\n# supports-eeprom-access: no\n# supports-register-dump: no\n# supports-priv-flags: yes\n\nlsmod | grep -E 'mlx|ib_|ipoib' | sort\nmodprobe ib_ipoib\n\nls /lib/modules/$(uname -r)/kernel/drivers/net/ethernet/mellanox/mlx4\n")),(0,r.kt)("h3",u({},{id:"\u5e38\u89c1\u7684\u5ef6\u8fdf\u548c\u901f\u5ea6"}),"\u5e38\u89c1\u7684\u5ef6\u8fdf\u548c\u901f\u5ea6"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",u({parentName:"tr"},{align:null}),"Mode"),(0,r.kt)("th",u({parentName:"tr"},{align:null}),"MTU"),(0,r.kt)("th",u({parentName:"tr"},{align:null}),"MB/s"),(0,r.kt)("th",u({parentName:"tr"},{align:null}),"Latency/us"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",u({parentName:"tr"},{align:null}),"datagram"),(0,r.kt)("td",u({parentName:"tr"},{align:null}),"2044"),(0,r.kt)("td",u({parentName:"tr"},{align:null}),"707"),(0,r.kt)("td",u({parentName:"tr"},{align:null}),"19.4")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",u({parentName:"tr"},{align:null}),"connected"),(0,r.kt)("td",u({parentName:"tr"},{align:null}),"2044"),(0,r.kt)("td",u({parentName:"tr"},{align:null}),"353"),(0,r.kt)("td",u({parentName:"tr"},{align:null}),"18.9")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",u({parentName:"tr"},{align:null}),"connected"),(0,r.kt)("td",u({parentName:"tr"},{align:null}),"65520"),(0,r.kt)("td",u({parentName:"tr"},{align:null}),"726"),(0,r.kt)("td",u({parentName:"tr"},{align:null}),"19.6")))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"MTU 1500 ~ 1.70 Gbits/sec")),(0,r.kt)("h3",u({},{id:"\u5185\u6838\u6a21\u5757"}),"\u5185\u6838\u6a21\u5757"),(0,r.kt)("pre",null,(0,r.kt)("code",u({parentName:"pre"},{}),"$ tree /lib/modules/*/kernel/drivers/infiniband/\n/lib/modules/4.9.65-1-hardened/kernel/drivers/infiniband/\n\u251c\u2500\u2500 core\n\u2502\xa0\xa0 \u251c\u2500\u2500 ib_cm.ko\n\u2502\xa0\xa0 \u251c\u2500\u2500 ib_core.ko\n\u2502\xa0\xa0 \u251c\u2500\u2500 ib_ucm.ko\n\u2502\xa0\xa0 \u251c\u2500\u2500 ib_umad.ko\n\u2502\xa0\xa0 \u251c\u2500\u2500 ib_uverbs.ko\n\u2502\xa0\xa0 \u251c\u2500\u2500 iw_cm.ko\n\u2502\xa0\xa0 \u251c\u2500\u2500 rdma_cm.ko\n\u2502\xa0\xa0 \u2514\u2500\u2500 rdma_ucm.ko\n\u251c\u2500\u2500 hw\n\u2502\xa0\xa0 \u251c\u2500\u2500 cxgb3\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 iw_cxgb3.ko\n\u2502\xa0\xa0 \u251c\u2500\u2500 cxgb4\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 iw_cxgb4.ko\n\u2502\xa0\xa0 \u251c\u2500\u2500 hfi1\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 hfi1.ko\n\u2502\xa0\xa0 \u251c\u2500\u2500 i40iw\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 i40iw.ko\n\u2502\xa0\xa0 \u251c\u2500\u2500 mlx4\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 mlx4_ib.ko\n\u2502\xa0\xa0 \u251c\u2500\u2500 mlx5\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 mlx5_ib.ko\n\u2502\xa0\xa0 \u251c\u2500\u2500 mthca\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 ib_mthca.ko\n\u2502\xa0\xa0 \u251c\u2500\u2500 nes\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 iw_nes.ko\n\u2502\xa0\xa0 \u2514\u2500\u2500 qib\n\u2502\xa0\xa0     \u2514\u2500\u2500 ib_qib.ko\n\u251c\u2500\u2500 sw\n\u2502\xa0\xa0 \u251c\u2500\u2500 rdmavt\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 rdmavt.ko\n\u2502\xa0\xa0 \u2514\u2500\u2500 rxe\n\u2502\xa0\xa0     \u2514\u2500\u2500 rdma_rxe.ko\n\u2514\u2500\u2500 ulp\n    \u251c\u2500\u2500 ipoib\n    \u2502\xa0\xa0 \u2514\u2500\u2500 ib_ipoib.ko\n    \u251c\u2500\u2500 iser\n    \u2502\xa0\xa0 \u2514\u2500\u2500 ib_iser.ko\n    \u251c\u2500\u2500 isert\n    \u2502\xa0\xa0 \u2514\u2500\u2500 ib_isert.ko\n    \u251c\u2500\u2500 srp\n    \u2502\xa0\xa0 \u2514\u2500\u2500 ib_srp.ko\n    \u2514\u2500\u2500 srpt\n        \u2514\u2500\u2500 ib_srpt.ko\n")),(0,r.kt)("h3",u({},{id:"\u542f\u52a8\u5185\u6838\u4fe1\u606f"}),"\u542f\u52a8\u5185\u6838\u4fe1\u606f"),(0,r.kt)("pre",null,(0,r.kt)("code",u({parentName:"pre"},{}),"[   12.225627] mlx4_core 0000:42:00.0: PCIe link speed is 5.0GT/s, device supports 5.0GT/s\n[   12.225632] mlx4_core 0000:42:00.0: PCIe link width is x8, device supports x8\n[   12.501725] NET: Registered protocol family 10\n[   12.537987] mlx4_en: Mellanox ConnectX HCA Ethernet driver v2.2-1 (Feb 2014)\n[   12.538258] mlx4_en 0000:42:00.0: Activating port:1\n[   12.550287] mlx4_en: 0000:42:00.0: Port 1: Using 256 TX rings\n[   12.550289] mlx4_en: 0000:42:00.0: Port 1: Using 8 RX rings\n[   12.550292] mlx4_en: 0000:42:00.0: Port 1:   frag:0 - size:1522 prefix:0 stride:1536\n[   12.550428] mlx4_en: 0000:42:00.0: Port 1: Initializing port\n[   12.563234] <mlx4_ib> mlx4_ib_add: mlx4_ib: Mellanox ConnectX InfiniBand driver v2.2-1 (Feb 2014)\n[   12.566383] <mlx4_ib> mlx4_ib_add: counter index 1 for port 1 allocated 1\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"v4.0")),(0,r.kt)("pre",null,(0,r.kt)("code",u({parentName:"pre"},{}),"mlx4_core: Mellanox ConnectX core driver v4.0-0\nmlx4_core: Initializing 0000:04:00.0\nmlx4_core 0000:04:00.0: 32.000 Gb/s available PCIe bandwidth (5.0 GT/s PCIe x8 link)\nmlx4_en: Mellanox ConnectX HCA Ethernet driver v4.0-0\nmlx4_en 0000:04:00.0: Activating port:1\nmlx4_en: 0000:04:00.0: Port 1: Using 24 TX rings\nmlx4_en: 0000:04:00.0: Port 1: Using 16 RX rings\nmlx4_en: 0000:04:00.0: Port 1: Initializing port\n<mlx4_ib> mlx4_ib_add: mlx4_ib: Mellanox ConnectX InfiniBand driver v4.0-0\n<mlx4_ib> mlx4_ib_add: counter index 1 for port 1 allocated 1\nmlx4_en: eth4: Link Up\nmlx4_en: eth4: Link Down\nmlx4_en: eth4: Link Down\nmlx4_en: eth4: Steering Mode 1\nmlx4_en: eth4: Link Up\n")),(0,r.kt)("h1",u({},{id:"faq"}),"FAQ"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"QSFP , Q/quad SFP"),(0,r.kt)("li",{parentName:"ul"},"VPI - Virtual Protocol Interface"),(0,r.kt)("li",{parentName:"ul"},"QDR - Quad Data Rate"),(0,r.kt)("li",{parentName:"ul"},"OFED",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",u({parentName:"li"},{href:"https://network.nvidia.com/products/infiniband-drivers/linux/mlnx_ofed/"}),"https://network.nvidia.com/products/infiniband-drivers/linux/mlnx_ofed/"))))),(0,r.kt)("h2",u({},{id:"opensm"}),"opensm"),(0,r.kt)("pre",null,(0,r.kt)("code",u({parentName:"pre"},{className:"language-bash"}),"apk add opensm rdma-core -X https://mirrors.sjtug.sjtu.edu.cn/alpine/edge/testing\nmodprobe ib_umad\nosmtest\n\nservice opensmd start\n\n# https://pkgs.alpinelinux.org/contents?branch=edge&name=rdma%2dcore&arch=x86_64&repo=testing\nibstat\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"/etc/rdma/modules/"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",u({parentName:"li"},{href:"https://pkgs.alpinelinux.org/package/edge/testing/x86/opensm"}),"https://pkgs.alpinelinux.org/package/edge/testing/x86/opensm")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",u({parentName:"li"},{href:"https://docs.nvidia.com/networking/display/MLNXOFEDv461000/OpenSM"}),"https://docs.nvidia.com/networking/display/MLNXOFEDv461000/OpenSM"))),(0,r.kt)("h2",u({},{id:"\u5e38\u89c1\u9519\u8bef"}),"\u5e38\u89c1\u9519\u8bef"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u901f\u5ea6\u6ca1\u4e0a\u53bb",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u786e\u5b9a\u662f\u8d70\u7684\u6b63\u786e\u7684\u7f51\u5361, \u4e00\u822c ib \u4e0d\u662f eth0")))),(0,r.kt)("pre",null,(0,r.kt)("code",u({parentName:"pre"},{className:"language-bash"}),"# \u786e\u4fdd\u9ed8\u8ba4\u8def\u7531\u662f ib \u5361\nip ro get 8.8.8.8\n\n# \u5982\u679c\u4e0d\u662f, \u5219\u66ff\u6362\u9ed8\u8ba4\u8def\u7531\n# \u5047\u8bbe eth2 \u4e3a ib \u5361\nip route replace default via 192.168.1.1 dev eth2\n")),(0,r.kt)("h2",u({},{id:"ipoib"}),"IPoIB"),(0,r.kt)("h2",u({},{id:"ethernet-mode"}),"ethernet mode"),(0,r.kt)("pre",null,(0,r.kt)("code",u({parentName:"pre"},{className:"language-bash"}),"# lb eth\ncat /sys/bus/pci/devices/0000:04:00.0/mlx4_port1\necho eth > /sys/bus/pci/devices/0000:XX:00.0/mlx4_port1\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",u({parentName:"li"},{href:"https://enterprise-support.nvidia.com/s/article/howto-change-port-type-in-mellanox-connectx-3-adapter"}),"https://enterprise-support.nvidia.com/s/article/howto-change-port-type-in-mellanox-connectx-3-adapter")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",u({parentName:"li"},{href:"https://www.servethehome.com/changing-mellanox-connectx-vpi-ports-ethernet-infiniband-linux/"}),"https://www.servethehome.com/changing-mellanox-connectx-vpi-ports-ethernet-infiniband-linux/")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",u({parentName:"li"},{href:"https://forum.proxmox.com/threads/40gbs-mellanox-infinityband.57118/#post-263263"}),"https://forum.proxmox.com/threads/40gbs-mellanox-infinityband.57118/#post-263263"))),(0,r.kt)("h2",u({},{id:"mtu"}),"MTU"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"1500 \u6ca1\u95ee\u9898"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",u({parentName:"li"},{href:"https://docs.nvidia.com/networking/display/MLNXOFEDv494170/Known+Issues"}),"https://docs.nvidia.com/networking/display/MLNXOFEDv494170/Known+Issues"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u6709\u5f88\u591a MTU \u76f8\u5173\u7684\u95ee\u9898"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",u({parentName:"li"},{href:"https://support.lenovo.com/br/zh/solutions/ht110000/"}),"https://support.lenovo.com/br/zh/solutions/ht110000/")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",u({parentName:"li"},{href:"https://github.com/geerlingguy/raspberry-pi-pcie-devices/issues/21#issuecomment-1427176397"}),"https://github.com/geerlingguy/raspberry-pi-pcie-devices/issues/21#issuecomment-1427176397")," t"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",u({parentName:"li"},{href:"https://www.dell.com/support/home/en-au/drivers/driversdetails?driverid=7gjnd"}),"https://www.dell.com/support/home/en-au/drivers/driversdetails?driverid=7gjnd"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"LRO fixes and improvements for jumbo MTU.")))))}g.isMDXComponent=!0}}]);