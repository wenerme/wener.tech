"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[5034],{49613:function(e,t,a){a.d(t,{Zo:function(){return m},kt:function(){return c}});var n=a(59496);function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function p(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){l(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,l=function(e,t){if(null==e)return{};var a,n,l={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(l[a]=e[a]);return l}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(l[a]=e[a])}return l}var d=n.createContext({}),o=function(e){var t=n.useContext(d),a=t;return e&&(a="function"==typeof e?e(t):p(p({},t),e)),a},m=function(e){var t=o(e.components);return n.createElement(d.Provider,{value:t},e.children)},s={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,l=e.mdxType,r=e.originalType,d=e.parentName,m=i(e,["components","mdxType","originalType","parentName"]),u=o(a),c=l,k=u["".concat(d,".").concat(c)]||u[c]||s[c]||r;return a?n.createElement(k,p(p({ref:t},m),{},{components:a})):n.createElement(k,p({ref:t},m))}));function c(e,t){var a=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var r=a.length,p=new Array(r);p[0]=u;var i={};for(var d in t)hasOwnProperty.call(t,d)&&(i[d]=t[d]);i.originalType=e,i.mdxType="string"==typeof e?e:l,p[1]=i;for(var o=2;o<r;o++)p[o]=a[o];return n.createElement.apply(null,p)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},93755:function(e,t,a){a.r(t),a.d(t,{assets:function(){return m},contentTitle:function(){return d},default:function(){return c},frontMatter:function(){return i},metadata:function(){return o},toc:function(){return s}});var n=a(96600),l=a(27279),r=(a(59496),a(49613)),p=["components"],i={title:"OpenLDAP"},d="OpenLDAP",o={unversionedId:"service/auth/ldap/openldap",id:"service/auth/ldap/openldap",title:"OpenLDAP",description:"- openldap/openldap",source:"@site/../notes/service/auth/ldap/openldap.md",sourceDirName:"service/auth/ldap",slug:"/service/auth/ldap/openldap",permalink:"/notes/service/auth/ldap/openldap",draft:!1,editUrl:"https://github.com/wenerme/wener/edit/master/../notes/service/auth/ldap/openldap.md",tags:[],version:"current",lastUpdatedBy:"wener",lastUpdatedAt:1663813e3,formattedLastUpdatedAt:"Sep 22, 2022",frontMatter:{title:"OpenLDAP"},sidebar:"docs",previous:{title:"LDAP Schema",permalink:"/notes/service/auth/ldap/ldap-schema"},next:{title:"OAuth",permalink:"/notes/service/auth/oauth/"}},m={},s=[{value:"Note",id:"note",level:2},{value:"Overlay",id:"overlay",level:2},{value:"dynlist",id:"dynlist",level:3},{value:"Schema",id:"schema",level:2},{value:"Password",id:"password",level:3},{value:"slapd-config",id:"slapd-config",level:2},{value:"\u57fa\u7840\u914d\u7f6e",id:"\u57fa\u7840\u914d\u7f6e",level:3},{value:"slapd.conf",id:"slapdconf",level:2},{value:"\u57fa\u7840\u914d\u7f6e",id:"\u57fa\u7840\u914d\u7f6e-1",level:3},{value:"backend sql",id:"backend-sql",level:2},{value:"backend monitor",id:"backend-monitor",level:2},{value:"Access Control",id:"access-control",level:2},{value:"Off-line",id:"off-line",level:2},{value:"\u5907\u4efd",id:"\u5907\u4efd",level:2},{value:"lloadd",id:"lloadd",level:2},{value:"\u4e0d\u652f\u6301 sha256, sha512",id:"\u4e0d\u652f\u6301-sha256-sha512",level:2},{value:"No passwd entry for user ldap",id:"no-passwd-entry-for-user-ldap",level:2},{value:"slapd.ldif",id:"slapdldif",level:2},{value:"daemon: bind(7) failed errno=2 (No such file or directory)",id:"daemon-bind7-failed-errno2-no-such-file-or-directory",level:2}],u={toc:s};function c(e){var t=e.components,a=(0,l.Z)(e,p);return(0,r.kt)("wrapper",(0,n.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"openldap"},"OpenLDAP"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/openldap/openldap"},"openldap/openldap"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u652f\u6301 SQL \u540e\u7aef - PostgreSQL"))),(0,r.kt)("li",{parentName:"ul"},"\u4f7f\u7528\u573a\u666f - \u7528\u6237\u8054\u90a6, \u6570\u636e\u5b58\u50a8",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Linux PAM"),(0,r.kt)("li",{parentName:"ul"},"SSH PAM"),(0,r.kt)("li",{parentName:"ul"},"Keycloak user federation"),(0,r.kt)("li",{parentName:"ul"},"Kerberos database"),(0,r.kt)("li",{parentName:"ul"},"PowerDNS database"),(0,r.kt)("li",{parentName:"ul"},"Serive user - Gitea, Gitlab, Nextcloud"))),(0,r.kt)("li",{parentName:"ul"},"\u53c2\u8003",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://www.openldap.org/doc/"},"\u6587\u6863")),(0,r.kt)("li",{parentName:"ul"},"archlinux ",(0,r.kt)("a",{parentName:"li",href:"https://wiki.archlinux.org/index.php/OpenLDAP"},"OpenLDAP")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/leenooks/phpLDAPadmin"},"leenooks/phpLDAPadmin"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"http://demo.phpldapadmin.org/"},"demo")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://stackoverflow.com/questions/22606811"},"OpenLDAP multi-tenant like ACL"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://www.openldap.org/faq/data/cache/1133.html"},"Sets in Access Controls")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/osixia/docker-openldap"},"osixia/docker-openldap")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/jp-gouin/helm-openldap"},"jp-gouin/helm-openldap")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/ltb-project/self-service-password"},"ltb-project/self-service-password"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"GPLv3, PHP"),(0,r.kt)("li",{parentName:"ul"},"change and reset password in an LDAP")))))),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},"sql backend \u9700\u8981\u81ea\u884c\u7ef4\u62a4 \u8868 \u4e0e ObjectClass \u7684\u5173\u7cfb",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u5e76\u4e0d\u662f\u76f4\u63a5\u53ef\u7528 - \u521d\u671f\u6709\u4e00\u5b9a\u5de5\u4f5c\u91cf"))),(0,r.kt)("li",{parentName:"ul"},"\u4e0d\u652f\u6301 reload - \u76f4\u63a5\u91cd\u542f"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'# macOS\n/usr/libexec/slapd -VVV # \u81ea\u5e26 v2.4\n\nbrew install openldap\nexport PATH="/usr/local/opt/openldap/bin:$PATH"\nexport PATH="/usr/local/opt/openldap/sbin:$PATH"\n/usr/local/opt/openldap/libexec/slapd -VVV # \u6700\u65b0\u7248 v2.6\n\n# AlpineLinux\napk add openldap\n# \u6dfb\u52a0\u540e\u7aef - \u751f\u4ea7\u7528 sql \u6d4b\u8bd5\u7528 mdb\napk add openldap-back-sql openldap-back-mdb\n# \u6dfb\u52a0 overlay - openldap-overlay-all \u4e3a\u6240\u6709\napk add openldap-overlay-{accesslog,memberof,otp}\napk add openldap-passwd-{pbkdf2,argon2,sha2}\n# /etc/openldap/slapd.conf\nservice slapd checkconfig\n')),(0,r.kt)("h2",{id:"note"},"Note"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"overlay",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u524d\u540e\u7aef\u4e4b\u95f4\u7684\u4e2d\u95f4\u5c42"),(0,r.kt)("li",{parentName:"ul"},"\u4f5c\u4e3a\u6269\u5c55\u6dfb\u52a0\u5176\u4ed6\u529f\u80fd"))),(0,r.kt)("li",{parentName:"ul"},"\u914d\u7f6e",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"/etc/openldap/slapd.conf"),(0,r.kt)("li",{parentName:"ul"},"/etc/openldap/slapd.ldif"))),(0,r.kt)("li",{parentName:"ul"},"\u540e\u7aef - bdb, dnssrv, hdb, ldap, mdb, meta, monitor, null, passwd, relay, shell, sock, sql")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"cli"),(0,r.kt)("th",{parentName:"tr",align:null},"desc"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"SBIN")),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"slapacl"),(0,r.kt)("td",{parentName:"tr",align:null},"\u6821\u9a8c slapd \u76ee\u5f55\u6743\u9650")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"slapadd"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"slapauth"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"slapcat"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"slapd"),(0,r.kt)("td",{parentName:"tr",align:null},"\u72ec\u7acb LDAP \u5b88\u62a4\u8fdb\u7a0b")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"slapdn"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"slapindex"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"slappasswd"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"slapschema"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"slaptest"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"slapmodify"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"BIN")),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"ldapadd"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"ldapdelete"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"ldapmodify"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"ldappasswd"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"ldapurl"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"ldapwhoami"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"ldapcompare"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"ldapexop"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"ldapmodrdn"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"ldapsearch"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"ldapvc"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"MISC")),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"lloadd"),(0,r.kt)("td",{parentName:"tr",align:null},"\u8d1f\u8f7d\u5747\u8861\u4ee3\u7406\u670d\u52a1")))),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"slapd"),(0,r.kt)("th",{parentName:"tr",align:null},"for"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"-h URLs"),(0,r.kt)("td",{parentName:"tr",align:null},"\u76d1\u542c")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"-u user"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"-g group"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"-r dir"),(0,r.kt)("td",{parentName:"tr",align:null},"chroot")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"-c cookie"),(0,r.kt)("td",{parentName:"tr",align:null},"cookie for syncrepl")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"-o option=value"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"-d debug-level"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"-f slapd.conf"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"-F slapd.d"),(0,r.kt)("td",{parentName:"tr",align:null},"ldif \u914d\u7f6e\u76ee\u5f55")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"-T"),(0,r.kt)("td",{parentName:"tr",align:null},"\u5de5\u5177")))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"-T - acl, a/add, auth, c/cat, d/dn, i/index, p/passwd, s/schema, t/test"),(0,r.kt)("li",{parentName:"ul"},"-h ",(0,r.kt)("inlineCode",{parentName:"li"},"ldap:/// ldaps:/// ldapi:///"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"ldap - \u9ed8\u8ba4 389"),(0,r.kt)("li",{parentName:"ul"},"ldaps - \u9ed8\u8ba4 636 - LDAP over TLS"),(0,r.kt)("li",{parentName:"ul"},"ldapi - LDAP over IPC",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"x-mod \u53ef\u6307\u5b9a\u6743\u9650"))),(0,r.kt)("li",{parentName:"ul"},"PLDAP, PLDAPS - HAProxy proxy protocol version 2"))),(0,r.kt)("li",{parentName:"ul"},"-c cookie",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"rid, sid, csn"))),(0,r.kt)("li",{parentName:"ul"},"-o option",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"slp")))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'slapd -d ?                 # \u663e\u793a\u6240\u6709\u7684 debug level\nslapd -Tt -f slapd.conf    # \u6821\u9a8c\u914d\u7f6e - slaptest\nslapd -f slapd.conf -d 255 # \u542f\u52a8\n\nchown -R ldap:ldap slapd.d # \u786e\u4fdd\u6743\u9650\u6b63\u786e\n# \u5b58\u5728 slapd.d/cn=config.ldif\nslapd -F slapd.d -u ldap -g ldap # \u63a8\u8350\u4f7f\u7528 ldif \u914d\u7f6e\n\n# \u914d\u7f6e\u8f6c\u6362\nslaptest -f slapd.conf -F slapd.d\n\nslapcat -F /usr/local/etc/openldap/slapd.d -n0 -l extracted_config.ldif\nslapadd -F /usr/local/etc/openldap/slapd.d -l updated_config.ldif\n\n# -b DN\n# -U authcID\n# [attr[/access][:value]]\n# \u68c0\u6d4b wener \u7528\u6237\u662f\u5426\u80fd\u8bfb\u53d6 dc=wener,dc=me \u7684 name \u5c5e\u6027\nslapacl -f slapd.conf -v -U wener -b "dc=wener,dc=me" "name/read:wener"\n')),(0,r.kt)("h2",{id:"overlay"},"Overlay"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"overlay"),(0,r.kt)("th",{parentName:"tr",align:null},"desc"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"accesslog"),(0,r.kt)("td",{parentName:"tr",align:null},"\u5b58\u50a8\u8bbf\u95ee\u65e5\u5fd7\u5230 DB - \u4e5f\u4f1a\u7528\u4e8e delta-syncrepl")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"auditlog"),(0,r.kt)("td",{parentName:"tr",align:null},"\u4fee\u6539\u65e5\u5fd7")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"chain"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"collect"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"constraint"),(0,r.kt)("td",{parentName:"tr",align:null},"\u7528 regex \u9650\u5b9a\u5c5e\u6027\u503c")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"dds"),(0,r.kt)("td",{parentName:"tr",align:null},"dynamicObject,ttl")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"deref"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"dynlist"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"homedir"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"lastbind"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"memberof"),(0,r.kt)("td",{parentName:"tr",align:null},"\u7ef4\u62a4\u53cd\u5411\u5206\u7ec4\u5173\u7cfb")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"mqtt"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"pcache"),(0,r.kt)("td",{parentName:"tr",align:null},"Proxy Cache")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"ppolicy"),(0,r.kt)("td",{parentName:"tr",align:null},"Password Policy")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"proxycache"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"refint"),(0,r.kt)("td",{parentName:"tr",align:null},"Referential Integrity")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"remoteauth"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"retcode"),(0,r.kt)("td",{parentName:"tr",align:null},"Return Code")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"rwm"),(0,r.kt)("td",{parentName:"tr",align:null},"Rewrite/Remap")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"seqmod"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"sssvlv"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"syncprov"),(0,r.kt)("td",{parentName:"tr",align:null},"Sync Provider")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"translucent"),(0,r.kt)("td",{parentName:"tr",align:null},"Translucent Proxy")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"unique"),(0,r.kt)("td",{parentName:"tr",align:null},"\u552f\u4e00\u9650\u5b9a")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"valsort"),(0,r.kt)("td",{parentName:"tr",align:null},"Value Sorting")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("del",{parentName:"td"},"dyngroup")),(0,r.kt)("td",{parentName:"tr",align:null},"\u4f7f\u7528 dynlist")))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u591a\u4e2a overlay \u662f\u53cd\u5e8f\u6267\u884c\u7684"),(0,r.kt)("li",{parentName:"ul"},"dds - Dynamic Directory Services - rfc2859",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"CRP - Client Refresh Period",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u5237\u65b0 ttl - ldapexop"))))),(0,r.kt)("li",{parentName:"ul"},"memberof",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u4e3a groupOfNames \u7684 member \u5bf9\u8c61\u751f\u6210 memberof \u53cd\u5411\u5f15\u7528\u5c5e\u6027"))),(0,r.kt)("li",{parentName:"ul"},"rwm ",(0,r.kt)("a",{parentName:"li",href:"https://www.openldap.org/software/man.cgi?query=slapo-rwm&apropos=0&sektion=5&manpath=OpenLDAP+2.6-Release&arch=default&format=html"},"slapo-rwm"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u4e3a\u8fdc\u7a0b ldap \u6216 relay \u63d0\u4f9b\u865a\u62df\u5b57\u6bb5"))),(0,r.kt)("li",{parentName:"ul"},"translucent",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u5b58\u50a8\u90e8\u5206\u4ee3\u7406\u6570\u636e\u7684\u5230\u672c\u5730"))),(0,r.kt)("li",{parentName:"ul"},"unique",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"unique_uri - ",(0,r.kt)("inlineCode",{parentName:"li"},"ldap:///ou=users,dc=example,dc=com?mail?sub?(objectClass=inetOrgPerson)")))),(0,r.kt)("li",{parentName:"ul"},"valsort",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"valsort-attr - ",(0,r.kt)("inlineCode",{parentName:"li"},"memberUid ou=groups,dc=wener,dc=me alpha-ascend"))))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"refint")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u652f\u6301 rename"),(0,r.kt)("li",{parentName:"ul"},"\u5982\u679c user \u88ab\u5220\u9664\uff0c\u5bf9\u5e94\u7684 member \u5173\u7cfb\u4e5f\u88ab\u5220\u9664"),(0,r.kt)("li",{parentName:"ul"},"\u5982\u679c\u6ca1\u6709\u4efb\u4f55 member \u5219\u4f7f\u7528 refint_nothing")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-conf"},'overlay refint\nrefint_attributes member\nrefint_nothing "cn=admin,dc=example,dc=com"\n')),(0,r.kt)("h3",{id:"dynlist"},"dynlist"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-conf"},"overlay dynlist\n# dynlist-attrset <group-oc> <URL-ad> [member-ad]\n# member-ad - \u5b58\u5728\u5219\u4e3a dyngroup - \u9700\u8981\u5305\u542b dyngroup.schema\n\n# \u5c06\u67e5\u8be2\u7ed3\u679c\u7684\u5355\u4e00\u5c5e\u6027\u8fd4\u56de\ndynlist-attrset nisMailAlias labeledURI\n\n# \u5c06\u67e5\u8be2\u7ed3\u679c\u4f5c\u4e3a member \u5c5e\u6027\u8fd4\u56de\ndynlist-attrset groupOfURLs labeledURI member\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ldif"},"cn=all,ou=aliases,dc=example,dc=com\ncn: all\nobjectClass: nisMailAlias\nlabeledURI: ldap:///ou=People,dc=example,dc=com?mail?one?(objectClass=inetOrgPerson)\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u67e5\u8be2\u8be5\u5bf9\u8c61\u65f6\u5b9e\u9645\u8fd4\u56de labeledURI \u67e5\u8be2\u7ed3\u679c")),(0,r.kt)("h2",{id:"schema"},"Schema"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"schema"),(0,r.kt)("th",{parentName:"tr",align:null},"note"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"collective"),(0,r.kt)("td",{parentName:"tr",align:null},"Collective attributes (experimental)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"corba"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"core"),(0,r.kt)("td",{parentName:"tr",align:null},"OpenLDAP core")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"cosine"),(0,r.kt)("td",{parentName:"tr",align:null},"COSINE Pilot")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"dsee"),(0,r.kt)("td",{parentName:"tr",align:null},"Sun DSEE")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"duaconf"),(0,r.kt)("td",{parentName:"tr",align:null},"Client Configuration - WIP")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"dyngroup"),(0,r.kt)("td",{parentName:"tr",align:null},"Dynamic Group (experimental)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"inetorgperson"),(0,r.kt)("td",{parentName:"tr",align:null},"InetOrgPerson")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"java"),(0,r.kt)("td",{parentName:"tr",align:null},"Java Object")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"misc"),(0,r.kt)("td",{parentName:"tr",align:null},"Miscellaneous Schema (experimental)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"msuser"),(0,r.kt)("td",{parentName:"tr",align:null},"Microsoft's Active Directory schema for replication")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"namedobject"),(0,r.kt)("td",{parentName:"tr",align:null},"namedObject draft schema - WIP")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"nis"),(0,r.kt)("td",{parentName:"tr",align:null},"Network Information Service (experimental)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"openldap"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"pmi"),(0,r.kt)("td",{parentName:"tr",align:null},"ITU X.509 PMI support (experimental)")))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/openldap/openldap/tree/master/contrib"},"https://github.com/openldap/openldap/tree/master/contrib"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u989d\u5916\u6a21\u5757",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"passwd/pbkdf2"),(0,r.kt)("li",{parentName:"ul"},"passwd/sha2")))))),(0,r.kt)("h3",{id:"password"},"Password"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"argon2"),(0,r.kt)("li",{parentName:"ul"},"pbkdf2",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"PBKDF2 -> PBKDF2-SHA1"),(0,r.kt)("li",{parentName:"ul"},"PBKDF2-SHA1"),(0,r.kt)("li",{parentName:"ul"},"PBKDF2-SHA256"),(0,r.kt)("li",{parentName:"ul"},"PBKDF2-SHA512"))),(0,r.kt)("li",{parentName:"ul"},"sha2",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"SHA512"),(0,r.kt)("li",{parentName:"ul"},"SHA384"),(0,r.kt)("li",{parentName:"ul"},"SHA256"),(0,r.kt)("li",{parentName:"ul"},"SSHA512"),(0,r.kt)("li",{parentName:"ul"},"SSHA384"),(0,r.kt)("li",{parentName:"ul"},"SSHA256"),(0,r.kt)("li",{parentName:"ul"},"S \u524d\u7f00 Salted"))),(0,r.kt)("li",{parentName:"ul"},"totp - RFC 6238 Time-based One Time Passwords",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"TOTP1 - SHA-1"),(0,r.kt)("li",{parentName:"ul"},"TOTP256 - SHA-256"),(0,r.kt)("li",{parentName:"ul"},"TOTP512 - SHA-512"),(0,r.kt)("li",{parentName:"ul"},"TOTP1ANDPW"),(0,r.kt)("li",{parentName:"ul"},"TOTP256ANDPW"),(0,r.kt)("li",{parentName:"ul"},"TOTP512ANDPW",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"TOTP+password"))))),(0,r.kt)("li",{parentName:"ul"},"kerberos"),(0,r.kt)("li",{parentName:"ul"},"netscape"),(0,r.kt)("li",{parentName:"ul"},"apr1"),(0,r.kt)("li",{parentName:"ul"},"radius")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-txt",metastring:'title="password"',title:'"password"'},"# password=secret salt=saltsalt\nuserPassword: {ARGON2}$argon2i$v=19$m=4096,t=3,p=1$c2FsdHNhbHQ$DKlexoEJUoZTmkAAC3SaMWk30El9/RvVhlqGo6afIng\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'# \u9ed8\u8ba4\u652f\u6301 SHA\nslappasswd -o module-load=pw-sha2.so -h {SHA} -s secret\n\necho -n "secret" | argon2 "salt" -e\nslappasswd -o module-load=argon2.so -h {ARGON2} -s secret\n\nslappasswd -o module-load=pw-pbkdf2.so -h {PBKDF2} -s secret\n\nslappasswd -o module-load=pw-sha2.so -h {SHA256} -s secret\necho -n "secret" | openssl dgst -sha256 -binary | openssl enc -base64\n')),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"passwd - ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/openldap/openldap/tree/master/servers/slapd/pwmods"},"servers/slapd/pwmods"))),(0,r.kt)("h2",{id:"slapd-config"},"slapd-config"),(0,r.kt)("p",null,"\u4f7f\u7528 ldif \u914d\u7f6e"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"cn=config 0 olcGlobal",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"olcIdleTimeout"),(0,r.kt)("li",{parentName:"ul"},"olcLogLevel"),(0,r.kt)("li",{parentName:"ul"},"olcReferral"),(0,r.kt)("li",{parentName:"ul"},"cn=module",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"olcModuleLoad"),(0,r.kt)("li",{parentName:"ul"},"olcModulePath"))),(0,r.kt)("li",{parentName:"ul"},"cn=schema - olcSchemaConfig - System schema",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"olcAttributeTypes"),(0,r.kt)("li",{parentName:"ul"},"olcObjectClasses"),(0,r.kt)("li",{parentName:"ul"},"cn={0}core - CoreSchema",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"olcAttributeTypes"),(0,r.kt)("li",{parentName:"ul"},"olcObjectClasses"))))),(0,r.kt)("li",{parentName:"ul"},"olcBackend"),(0,r.kt)("li",{parentName:"ul"},"olcDatabase={1}mdb - olcBackendConfig",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"index \u7528\u4e8e\u533a\u5206\u591a\u4e2a\u540c\u7c7b\u578b\u7684\u4e0d\u540c db",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u4e0d\u6307\u5b9a\u4f1a\u81ea\u52a8\u521b\u5efa"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"olcAccess: to <what> [ by <who> [<accesslevel>] [<control>] ]+")),(0,r.kt)("li",{parentName:"ul"},"olcReadonly"),(0,r.kt)("li",{parentName:"ul"},"olcRootDN"),(0,r.kt)("li",{parentName:"ul"},"olcRootPW"),(0,r.kt)("li",{parentName:"ul"},"olcSizeLimit"),(0,r.kt)("li",{parentName:"ul"},"olcSuffix"),(0,r.kt)("li",{parentName:"ul"},"olcSyncrepl"),(0,r.kt)("li",{parentName:"ul"},"olcTimeLimit: 3600"),(0,r.kt)("li",{parentName:"ul"},"olcUpdateref"))),(0,r.kt)("li",{parentName:"ul"},"olcDatabase=frontend",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"olcAccess"))))),(0,r.kt)("li",{parentName:"ul"},"mdb",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"backend",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"olcBkMdbIdlExp: 16"))),(0,r.kt)("li",{parentName:"ul"},"database",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"olcDbDirectory: /usr/local/var/openldap-data"),(0,r.kt)("li",{parentName:"ul"},"olcDbCheckpoint: 1024 10"),(0,r.kt)("li",{parentName:"ul"},"olcDbEnvFlags"),(0,r.kt)("li",{parentName:"ul"},"olcDbIndex"),(0,r.kt)("li",{parentName:"ul"},"olcDbMaxEntrySize: 0"),(0,r.kt)("li",{parentName:"ul"},"olcDbMaxReaders: 126"),(0,r.kt)("li",{parentName:"ul"},"olcDbMaxSize: 10485760 - 10MB"),(0,r.kt)("li",{parentName:"ul"},"olcDbMode: 0600"),(0,r.kt)("li",{parentName:"ul"},"olcDbMultival"),(0,r.kt)("li",{parentName:"ul"},"olcDbRtxnsize"),(0,r.kt)("li",{parentName:"ul"},"olcDbSearchStack: 16"),(0,r.kt)("li",{parentName:"ul"},"olcDbNosync")))))),(0,r.kt)("h3",{id:"\u57fa\u7840\u914d\u7f6e"},"\u57fa\u7840\u914d\u7f6e"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ldif"},'dn: cn=config\nobjectClass: olcGlobal\ncn: config\n\nolcArgsFile: /var/lib/openldap/run/slapd.args\nolcPidFile: /var/lib/openldap/run/slapd.pid\n\n# \u6a21\u5757\u52a0\u8f7d\ndn: cn=module,cn=config\nobjectClass: olcModuleList\ncn: module\nolcModulepath:  /usr/lib/openldap\nolcModuleload:  back_mdb.so\n\ndn: cn=schema,cn=config\nobjectClass: olcSchemaConfig\ncn: schema\n\ninclude: file:///etc/openldap/schema/core.ldif\n\n# \u524d\u7aef\n#\ndn: olcDatabase=frontend,cn=config\nobjectClass: olcDatabaseConfig\nobjectClass: olcFrontendConfig\nolcDatabase: frontend\n# \u8bbf\u95ee\u63a7\u5236\u7b56\u7565\n#   Other DSEs:\n#       Allow self write access\n#       Allow authenticated users read access\n#       Allow anonymous users to authenticate\n#\n#olcAccess: to dn.base="" by * read\n#olcAccess: to dn.base="cn=Subschema" by * read\n#olcAccess: to *\n#   by self write\n#   by users read\n#   by anonymous auth\n#\n# if no access controls are present, the default policy\n# allows anyone and everyone to read anything but restricts\n# updates to rootdn.  (e.g., "access to * by * read")\n#\n# rootdn can always read and write EVERYTHING!\n#\n\n# \u6570\u636e\u5e93\u914d\u7f6e\ndn: olcDatabase=mdb,cn=config\nobjectClass: olcDatabaseConfig\nobjectClass: olcMdbConfig\nolcDatabase: mdb\nolcDbMaxSize: 1073741824\nolcSuffix: dc=wener,dc=me\nolcRootDN: cn=admin,dc=wener,dc=me\nolcRootPW: secret\nolcDbDirectory: /var/lib/openldap/openldap-data\nolcDbIndex: objectClass eq\n\ndn: olcDatabase=monitor,cn=config\nobjectClass: olcDatabaseConfig\nolcDatabase: monitor\nolcRootDN: cn=config\nolcMonitoring: FALSE\n')),(0,r.kt)("h2",{id:"slapdconf"},"slapd.conf"),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},"\u8be5\u914d\u7f6e\u65b9\u5f0f\u5df2\u5e9f\u5f03\uff0c\u63a8\u8350\u4f7f\u7528 slapd-config \u914d\u7f6e"))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u5168\u5c40\u914d\u7f6e+\u6570\u636e\u5e93\u914d\u7f6e"),(0,r.kt)("li",{parentName:"ul"},"\u884c\u5f00\u5934\u4e3a\u7a7a\u767d\u5219\u4e3a \u7eed \u884c"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"backend <type>"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"asyncmeta, config, dnssrv, ldap, ldif, mdb, meta, monitor, null, passwd, perl, relay, sock, sql, wt"),(0,r.kt)("li",{parentName:"ul"},"wt - WiredTiger"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"overlay <name>"))),(0,r.kt)("hr",null),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://www.openldap.org/doc/admin26/slapdconf2.html"},"https://www.openldap.org/doc/admin26/slapdconf2.html")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://man7.org/linux/man-pages/man5/slapd.conf.5.html"},"https://man7.org/linux/man-pages/man5/slapd.conf.5.html"))),(0,r.kt)("h3",{id:"\u57fa\u7840\u914d\u7f6e-1"},"\u57fa\u7840\u914d\u7f6e"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-conf"},'include     /etc/openldap/schema/core.schema\n\npidfile     /var/lib/openldap/run/slapd.pid\nargsfile    /var/lib/openldap/run/slapd.args\n\n# \u52a0\u8f7d\u6a21\u5757\nmodulepath  /usr/lib/openldap\nmoduleload  back_mdb.la\n\nattributeoptions x-hidden lang-\naccess to attrs=name;x-hidden by * =cs\naccess to attrs=userPassword  by * auth\naccess to * by * read\n\ndatabase config\n# \u5f00\u542f\u540e\u53ef bind cn=config \u76f4\u63a5\u4fee\u6539\u914d\u7f6e - \u4e0d\u8fc7\u914d\u7f6e\u4fee\u6539\u4e0d\u4f1a\u4fdd\u5b58\n# rootpw secret\n\n# mdb \u914d\u7f6e\ndatabase    mdb\nmaxsize     1073741824\nsuffix      "dc=wener,dc=me"\nrootdn      "cn=admin,dc=wener,dc=me"\n# \u907f\u514d\u5bc6\u7801\u660e\u6587 - \u4f7f\u7528 slappasswd \u751f\u6210\nrootpw      secret\n# chmod 700\ndirectory   /var/lib/openldap/openldap-data\n# \u9700\u8981\u7ef4\u62a4\u7684\u7d22\u5f15\nindex   objectClass eq\nindex cn,sn,mail pres,eq,approx,sub\n\ndatabase monitor\n')),(0,r.kt)("h2",{id:"backend-sql"},"backend sql"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u4f7f\u7528 odbc \u8fde\u63a5"),(0,r.kt)("li",{parentName:"ul"},"\u9700\u8981\u81ea\u884c\u7ef4\u62a4 \u8868 \u4e0e ObjectClass \u7684\u5173\u7cfb")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ini",metastring:'title="/etc/odbc.ini"',title:'"/etc/odbc.ini"'},"[example]\nDescription         = OpenLDAP back-sql\nDriver              = PostgreSQL\nTrace               = No\nDatabase            = example\nServername          = localhost\nUserName            = manager\nPassword            = secret\nPort                = 5432\n;Protocol            = 6.4\nReadOnly            = No\nRowVersioning       = No\nShowSystemTables    = No\nShowOidColumn       = No\nFakeOidIndex        = No\nConnSettings        =\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ini",metastring:'title="/etc/odbcinst.ini"',title:'"/etc/odbcinst.ini"'},"[PostgreSQL]\nDescription     = ODBC for PostgreSQL\nDriver          = /usr/lib/libodbcpsql.so\nSetup           = /usr/lib/libodbcpsqlS.so\nFileUsage       = 1\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-conf"},'database    sql\nsuffix      "o=sql,c=RU"\nrootdn      "cn=root,o=sql,c=RU"\nrootpw      secret\ndbname      PostgreSQL\ndbuser      postgres\ndbpasswd    postgres\ninsentry_stmt   "insert into ldap_entries (id,dn,oc_map_id,parent,keyval) values ((select max(id)+1 from ldap_entries),?,?,?,?)"\nupper_func  "upper"\nstrcast_func    "text"\nconcat_pattern  "?||?"\nhas_ldapinfo_dn_ru  no\n')),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"PostgreSQL")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"ldap_oc_mappings"),(0,r.kt)("li",{parentName:"ul"},"ldap_attr_mappings"),(0,r.kt)("li",{parentName:"ul"},"ldap_entries"),(0,r.kt)("li",{parentName:"ul"},"ldap_entry_objclasses")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"create table\n  ldap_oc_mappings (\n    id serial not null primary key,\n    -- objectClass name\n    name varchar(64) not null,\n    -- \u6620\u5c04\u7684\u8868\u540d\n    keytbl varchar(64) not null,\n    -- pk \u5217\n    keycol varchar(64) not null,\n    -- \u521b\u5efa SQL\n    create_proc varchar(255),\n    -- \u5220\u9664 SQL\n    delete_proc varchar(255),\n    expect_return int not null\n  );\n\ncreate table\n  ldap_attr_mappings (\n    id serial not null primary key,\n    oc_map_id integer not null references ldap_oc_mappings(id),\n    name varchar(255) not null,\n    sel_expr varchar(255) not null,\n    sel_expr_u varchar(255),\n    from_tbls varchar(255) not null,\n    join_where varchar(255),\n    add_proc varchar(255),\n    delete_proc varchar(255),\n    param_order int not null,\n    expect_return int not null\n  );\n\ncreate table\n  ldap_entries (\n    id serial not null primary key,\n    dn varchar(255) not null,\n    oc_map_id integer not null references ldap_oc_mappings(id),\n    parent int NOT NULL,\n    keyval int NOT NULL,\n    UNIQUE (oc_map_id, keyval),\n    UNIQUE (dn)\n  );\n\ncreate table\n  ldap_entry_objclasses (\n    entry_id integer not null references ldap_entries(id),\n    oc_name varchar(64)\n  );\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/openldap/openldap/tree/master/servers/slapd/back-sql/rdbms_depend/pgsql"},"https://github.com/openldap/openldap/tree/master/servers/slapd/back-sql/rdbms_depend/pgsql"))),(0,r.kt)("h2",{id:"backend-monitor"},"backend monitor"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u7531 slapd \u7ef4\u62a4\uff0c\u63d0\u4f9b\u7cfb\u7edf\u5065\u5eb7\u4fe1\u606f"),(0,r.kt)("li",{parentName:"ul"},"cn=Monitor",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"cn=Backends",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"monitoredInfo"),(0,r.kt)("li",{parentName:"ul"},"cn=Backend 0"))),(0,r.kt)("li",{parentName:"ul"},"cn=Connections",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"cn=Total"),(0,r.kt)("li",{parentName:"ul"},"cn=Current"))),(0,r.kt)("li",{parentName:"ul"},"cn=Databases",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"cn=Database 0"))),(0,r.kt)("li",{parentName:"ul"},"cn=Listeners"),(0,r.kt)("li",{parentName:"ul"},"cn=Overlays",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"monitoredInfo"))),(0,r.kt)("li",{parentName:"ul"},"cn=Statistics",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"cn=Entries",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"monitorCounter"))))),(0,r.kt)("li",{parentName:"ul"},"cn=Threads",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"cn=Max",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"monitoredInfo"))))),(0,r.kt)("li",{parentName:"ul"},"cn=Time",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"cn=Current",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"monitorTimestamp"))),(0,r.kt)("li",{parentName:"ul"},"cn=Start"))),(0,r.kt)("li",{parentName:"ul"},"cn=Waiters",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"cn=Read",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"monitorCounter"))),(0,r.kt)("li",{parentName:"ul"},"cn=Write")))))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-conf"},'database monitor\naccess to * by dn.exact="cn=admin,dc=wener,dc=me" by * none\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"ldapsearch -x -D 'cn=admin,dc=wener,dc=me' -W -b 'cn=Monitor' -s base 1.1\nldapsearch -x -D 'cn=admin,dc=wener,dc=me' -W -b 'cn=Monitor' -s base '(objectClass=*)' '*' '+'\n")),(0,r.kt)("h2",{id:"access-control"},"Access Control"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"<access directive> ::= to <what>\n    [by <who> [<access>] [<control>] ]+\n<what> ::= * |\n    [dn[.<basic-style>]=<regex> | dn.<scope-style>=<DN>]\n    [filter=<ldapfilter>] [attrs=<attrlist>]\n<basic-style> ::= regex | exact\n<scope-style> ::= base | one | subtree | children\n<attrlist> ::= <attr> [val[.<basic-style>]=<regex>] | <attr> , <attrlist>\n<attr> ::= <attrname> | entry | children\n<who> ::= * | [anonymous | users | self\n        | dn[.<basic-style>]=<regex> | dn.<scope-style>=<DN>]\n    [dnattr=<attrname>]\n    [group[/<objectclass>[/<attrname>][.<basic-style>]]=<regex>]\n    [peername[.<basic-style>]=<regex>]\n    [sockname[.<basic-style>]=<regex>]\n    [domain[.<basic-style>]=<regex>]\n    [sockurl[.<basic-style>]=<regex>]\n    [set=<setspec>]\n    [aci=<attrname>]\n<access> ::= [self]{<level>|<priv>}\n<level> ::= none | disclose | auth | compare | search | read | write | manage\n<priv> ::= {=|+|-}{m|w|r|s|c|x|d|0}+\n<control> ::= [stop | continue | break]\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"what",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"*")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"dn[.<basic-style>]=<regex> | dn.<scope-style>=<DN>"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"basic-style - regex, exact"),(0,r.kt)("li",{parentName:"ul"},"scope-style - base, one, subtree, children"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"filter=<ldapfilter>] [attrs=<attrlist>")))),(0,r.kt)("li",{parentName:"ul"},"who",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"*")),(0,r.kt)("li",{parentName:"ul"},"anonymous"),(0,r.kt)("li",{parentName:"ul"},"users - \u8ba4\u8bc1\u7528\u6237"),(0,r.kt)("li",{parentName:"ul"},"self - \u7528\u6237\u6240\u5728 entry"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"dn[.<basic-style>]=<regex> | dn.<scope-style>=<DN>]")),(0,r.kt)("li",{parentName:"ul"},"dnattr="),(0,r.kt)("li",{parentName:"ul"},"group="),(0,r.kt)("li",{parentName:"ul"},"peername="),(0,r.kt)("li",{parentName:"ul"},"sockname="),(0,r.kt)("li",{parentName:"ul"},"domain="),(0,r.kt)("li",{parentName:"ul"},"sockurl="),(0,r.kt)("li",{parentName:"ul"},"set="),(0,r.kt)("li",{parentName:"ul"},"aci="))),(0,r.kt)("li",{parentName:"ul"},"access",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"self"),(0,r.kt)("li",{parentName:"ul"},"level",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"none | disclose | auth | compare | search | read | write | manage"),(0,r.kt)("li",{parentName:"ul"},"\u4e0b\u7ea7\u5305\u542b\u4e0a\u7ea7"))),(0,r.kt)("li",{parentName:"ul"},"priv",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"{=|+|-}{m|w|r|s|c|x|d|0}+")))))),(0,r.kt)("li",{parentName:"ul"},"control",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"stop - \u9ed8\u8ba4"),(0,r.kt)("li",{parentName:"ul"},"continue - \u7ee7\u7eed\u5904\u7406 who"),(0,r.kt)("li",{parentName:"ul"},"break - \u8df3\u51fa\u5f53\u524d access \u7ee7\u7eed\u5904\u7406\u4e0b\u4e00\u6761"))),(0,r.kt)("li",{parentName:"ul"},"\u9690\u542b\u89c4\u5219 ",(0,r.kt)("inlineCode",{parentName:"li"},"by * none stop"))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u6743\u9650\u7ec4\u5408")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'access to *\n    by peername.ip="127.0.0.1" =w continue\n    by dn.exact="cn=foo" +rcsx\n    by * auth\n')),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"127.0.0.1 \u6743\u9650\u4e3a ",(0,r.kt)("inlineCode",{parentName:"li"},"w"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u5982\u679c cn=foo \u5219\u6dfb\u52a0\u66f4\u591a\u6743\u9650")))),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"who"),(0,r.kt)("th",{parentName:"tr",align:null},"desc"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"*")),(0,r.kt)("td",{parentName:"tr",align:null},"\u6240\u6709")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"anonymous"),(0,r.kt)("td",{parentName:"tr",align:null},"\u533f\u540d/\u672a\u6388\u6743 \u7528\u6237")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"users"),(0,r.kt)("td",{parentName:"tr",align:null},"\u6388\u6743\u7528\u6237")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"self"),(0,r.kt)("td",{parentName:"tr",align:null},"User associated with target entry")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"dn[.<basic-style>]=<regex>")),(0,r.kt)("td",{parentName:"tr",align:null},"Users matching a regular expression")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"dn.<scope-style>=<DN>")),(0,r.kt)("td",{parentName:"tr",align:null},"Users within scope of a DN")))),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"level"),(0,r.kt)("th",{parentName:"tr",align:null},"priv"),(0,r.kt)("th",{parentName:"tr",align:null},"desc"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"none"),(0,r.kt)("td",{parentName:"tr",align:null},"=0"),(0,r.kt)("td",{parentName:"tr",align:null},"\u4e0d\u80fd\u8bbf\u95ee")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"disclose"),(0,r.kt)("td",{parentName:"tr",align:null},"=d"),(0,r.kt)("td",{parentName:"tr",align:null},"needed for information disclosure on error")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"auth"),(0,r.kt)("td",{parentName:"tr",align:null},"=dx"),(0,r.kt)("td",{parentName:"tr",align:null},"\u9700\u8981\u8ba4\u8bc1 - bind")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"compare"),(0,r.kt)("td",{parentName:"tr",align:null},"=cdx"),(0,r.kt)("td",{parentName:"tr",align:null},"needed to compare")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"search"),(0,r.kt)("td",{parentName:"tr",align:null},"=scdx"),(0,r.kt)("td",{parentName:"tr",align:null},"needed to apply search filters")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"read"),(0,r.kt)("td",{parentName:"tr",align:null},"=rscdx"),(0,r.kt)("td",{parentName:"tr",align:null},"needed to read search results")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"write"),(0,r.kt)("td",{parentName:"tr",align:null},"=wrscdx"),(0,r.kt)("td",{parentName:"tr",align:null},"needed to modify/rename")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"manage"),(0,r.kt)("td",{parentName:"tr",align:null},"=mwrscdx"),(0,r.kt)("td",{parentName:"tr",align:null},"needed to manage")))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://www.openldap.org/faq/data/cache/454.html"},"https://www.openldap.org/faq/data/cache/454.html")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://uit.stanford.edu/service/directory/aclexamples"},"https://uit.stanford.edu/service/directory/aclexamples"))),(0,r.kt)("h2",{id:"off-line"},"Off-line"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ldif"},"dn: dc=wener,dc=me\nobjectClass: dcObject\nobjectClass: organization\ndc: wener\no: Wener's Website\ndescription: A blog full of notes\n\ndn: cn=admin,dc=example,dc=com\nobjectClass: organizationalRole\ncn: admin\ndescription: Directory Administrator\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"# \u4f7f\u7528 directory \u7684 \u53ef\u4ee5\u52a0\nslapd -Ta -F slapd.d -l demo.ldif\n")),(0,r.kt)("h2",{id:"\u5907\u4efd"},"\u5907\u4efd"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'slapcat -f slapd.conf -b "dc=example,dc=com"\n')),(0,r.kt)("h2",{id:"lloadd"},"lloadd"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u8d1f\u8f7d\u5747\u8861")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-conf"},'feature proxyauthz\n\nbindconf bindmethod=simple\n        binddn="cn=Manager,dc=example,dc=com"\n        credentials=secret\n\ntier roundrobin\nbackend-server uri=ldap://server1.example.com\n              numconns=5 bindconns=5\n              max-pending-ops=10 conn-max-pending=3\n              retry=5000\nbackend-server uri=ldap://server2.example.com\n              numconns=5 bindconns=5\n              max-pending-ops=10 conn-max-pending=3\n              retry=5000\n')),(0,r.kt)("h1",{id:"faq"},"FAQ"),(0,r.kt)("h2",{id:"\u4e0d\u652f\u6301-sha256-sha512"},"\u4e0d\u652f\u6301 sha256, sha512"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"At present there is no need to change anything in the core since SHA-2 support\ncan be dynamically loaded. Don't fix what isn't broken.\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u53c2\u8003",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://www.openldap.org/lists/openldap-bugs/201205/msg00055.html"},"https://www.openldap.org/lists/openldap-bugs/201205/msg00055.html")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://www.openldap.org/faq/data/cache/1467.html"},"https://www.openldap.org/faq/data/cache/1467.html"))))),(0,r.kt)("h2",{id:"no-passwd-entry-for-user-ldap"},"No passwd entry for user ldap"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"getent passwd ldap\n")),(0,r.kt)("h2",{id:"slapdldif"},"slapd.ldif"),(0,r.kt)("p",null,"\u9ed8\u8ba4\u53ea\u80fd slapd.conf \u5355\u6587\u4ef6\u914d\u7f6e\uff0c\u53ef\u4ee5\u901a\u8fc7\u4e00\u5b9a\u7684\u65b9\u5f0f\u5b9e\u73b0 ldif \u914d\u7f6e\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"slapd -f slapd.conf.init -F slapd.d -h 'ldap:// ldaps:// ldapi://'\n\n# slapd.ldif \u5305\u542b\u6240\u6709\u914d\u7f6e\nldapadd -Y EXTERNAL -H ldapi:// -f slapd.ldif\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-conf",metastring:'title="slapd.conf.init"',title:'"slapd.conf.init"'},'pidfile /var/lib/openldap/run/slapd.pid\n\ndatabase config\n# \u5141\u8bb8\u901a\u8fc7 sock \u7ba1\u7406\naccess to * by dn.base="gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth" manage\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ldif",metastring:'title="slapd.ldif"',title:'"slapd.ldif"'},'dn: cn=module,cn=config\nobjectClass: olcModuleList\ncn: module\nolcModulePath: /usr/lib/openldap\nolcModuleLoad: back_mdb.so\n\ndn: olcDatabase=mdb,cn=config\nobjectClass: olcDatabaseConfig\nobjectClass: olcMdbConfig\nolcDatabase: mdb\nolcSuffix: dc=example,dc=com\nolcRootDN: cn=manager,dc=example,dc=com\nolcRootPW:: c2VjcmV0\nolcDbDirectory: /var/lib/openldap/example.com\nolcAccess: to * by dn.base="gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth" manage\n')),(0,r.kt)("h2",{id:"daemon-bind7-failed-errno2-no-such-file-or-directory"},"daemon: bind(7) failed errno=2 (No such file or directory)"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"install -d -m 700 -o ldap -g ldap /var/lib/openldap/run\nchown -R ldap:ldap /var/lib/openldap\n")))}c.isMDXComponent=!0}}]);