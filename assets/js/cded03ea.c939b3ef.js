/*! For license information please see cded03ea.c939b3ef.js.LICENSE.txt */
"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[17092],{50320:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>a,contentTitle:()=>r,default:()=>h,frontMatter:()=>l,metadata:()=>c,toc:()=>o});var n=t(2488),i=t(62780);const l={title:"TimeScale"},r="TimeScale",c={id:"db/relational/postgresql/timescale",title:"TimeScale",description:"- \u9002\u7528\u4e8e",source:"@site/../notes/db/relational/postgresql/timescale.md",sourceDirName:"db/relational/postgresql",slug:"/db/relational/postgresql/timescale",permalink:"/notes/db/relational/postgresql/timescale",draft:!1,unlisted:!1,editUrl:"https://github.com/wenerme/wener/edit/master/notes/../notes/db/relational/postgresql/timescale.md",tags:[],version:"current",lastUpdatedBy:"wener",lastUpdatedAt:1692169664,formattedLastUpdatedAt:"Aug 16, 2023",frontMatter:{title:"TimeScale"},sidebar:"docs",previous:{title:"Spilo",permalink:"/notes/db/relational/postgresql/spilo"},next:{title:"WAL-G",permalink:"/notes/db/relational/postgresql/wal-g"}},a={},o=[{value:"Notes",id:"notes",level:2}];function d(e){const s={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.M)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.h1,{id:"timescale",children:"TimeScale"}),"\n",(0,n.jsx)(s.admonition,{type:"tip",children:(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["\u9002\u7528\u4e8e\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"\u9700\u8981\u65f6\u5e8f\u6570\u636e\u5b58\u50a8"}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\u4e0d\u9002\u7528\u4e8e\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"\u76d1\u63a7"}),"\n",(0,n.jsx)(s.li,{children:"Metrics"}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["promscale \u505c\u6b62\u5f00\u53d1 ",(0,n.jsx)(s.a,{href:"https://github.com/timescale/promscale/issues/1836",children:"promscale#1836"})]}),"\n"]})}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"http://www.timescale.com/",children:"TimeScale"})}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"https://github.com/timescale/timescaledb",children:"timescale/timescaledb"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"Apache-2.0"}),"\n",(0,n.jsx)(s.li,{children:"An open-source time-series database optimized for fast ingest and complex queries. Engineered up from PostgreSQL, packaged as an extension."}),"\n",(0,n.jsx)(s.li,{children:"data retention policies"}),"\n",(0,n.jsx)(s.li,{children:"continuous aggregate views"}),"\n",(0,n.jsx)(s.li,{children:"downsampling"}),"\n",(0,n.jsx)(s.li,{children:"data gap-filling"}),"\n",(0,n.jsx)(s.li,{children:"interpolation"}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\u53c2\u8003\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://blog.timescale.com/time-series-data-postgresql-10-vs-timescaledb-816ee808bac5",children:"Problems with PostgreSQL 10 for time-series data"})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://blog.timescale.com/blog/building-a-distributed-time-series-database-on-postgresql/",children:"Building a distributed time-series database on PostgreSQL"})}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"https://github.com/timescale/pg_prometheus",children:"timescale/pg_prometheus"})," - ",(0,n.jsx)(s.a,{href:"https://github.com/timescale/prometheus-postgresql-adapter",children:"timescale/prometheus-postgresql-adapter"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"PostgreSQL extension for Prometheus data"}),"\n",(0,n.jsx)(s.li,{children:"\u4e0d\u518d\u4f7f\u7528\u8be5\u7ed3\u6784"}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"https://github.com/timescale/timescale-prometheus",children:"timescale/timescale-prometheus"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"prometheus \u4ea4\u4e92\u65b0\u7684\u67b6\u6784"}),"\n",(0,n.jsx)(s.li,{children:"\u4f5c\u4e3a RemoteStorage"}),"\n",(0,n.jsxs)(s.li,{children:["prometheus ",(0,n.jsx)(s.a,{href:"https://prometheus.io/docs/prometheus/latest/configuration/configuration/#remote_write",children:"remote_write"})]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"https://docs.timescaledb.com/using-timescaledb/telemetry",children:"https://docs.timescaledb.com/using-timescaledb/telemetry"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.code,{children:"timescaledb.telemetry_level=off"})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.code,{children:"ALTER [SYSTEM | DATABASE | USER] { *db_name* | *role_specification* } SET timescaledb.telemetry_level=off"})}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.a,{href:"https://github.com/timescale/timescaledb/issues/638",children:"timescale/timescaledb#638"})," - List of recommended ZFS/Zpool settings"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"# \u57fa\u4e8e postgres \u4e0a\u6e38\u6784\u5efa\u7684\u955c\u50cf\n# https://github.com/timescale/timescaledb-docker\n# timescale/timescaledb-postgis \u5305\u542b postgis \u6269\u5c55\ndocker run --rm -it \\\n  -p 5432:5432 \\\n  -v $PWD/data:/var/lib/postgresql/data \\\n  -e POSTGRES_DB=timescale \\\n  -e POSTGRES_USER=timescale \\\n  -e POSTGRES_PASSWORD=timescale \\\n  --name timescaledb timescale/timescaledb:latest-pg12\n\n# http://localhost:9201/metrics\n# -log-level \u9ed8\u8ba4 debug\n# -async-acks \u5728\u5199\u5165\u5230\u6570\u636e\u5e93\u4e4b\u524d\u54cd\u5e94 - \u53ef\u80fd\u4e22\u4f46 metric \u573a\u666f\u4e0b\u4e00\u822c\u4e0d\u5f71\u54cd\ndocker run --rm -it --link timescaledb:db \\\n  -p 9201:9201 \\\n  --name ts-prometheus timescale/timescale-prometheus \\\n  -async-acks \\\n  -db-host=db -db-name=timescale -db-port=5432 -db-user=timescale -db-password=timescale\n\nprometheus --config.file=prometheus.yml\n"})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"prometheus.yml"})}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-yaml",children:"global:\n  scrape_interval: 15s\n\nscrape_configs:\n  - job_name: 'prometheus'\n    static_configs:\n      - targets: ['localhost:9090']\n\n  - job_name: 'node'\n    static_configs:\n      - targets: ['localhost:9100']\n\n  - job_name: 'tsdb-prom'\n    static_configs:\n      - targets: ['localhost:9201']\n\nremote_write:\n  - url: 'http://localhost:9201/write'\nremote_read:\n  - url: 'http://localhost:9201/read'\n"})}),"\n",(0,n.jsx)(s.h2,{id:"notes",children:"Notes"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["create_hypertable\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"chunk_time_interval=7d"}),"\n",(0,n.jsx)(s.li,{children:"partitioning_column"}),"\n",(0,n.jsx)(s.li,{children:"number_partitions - \u57fa\u4e8e partitioning_column \u7684 hash \u5206\u7247"}),"\n",(0,n.jsxs)(s.li,{children:["associated_schema_name=",(0,n.jsx)(s.code,{children:"_timescaledb_internal"})]}),"\n",(0,n.jsxs)(s.li,{children:["associated_table_prefix=",(0,n.jsx)(s.code,{children:"_hyper"})]}),"\n",(0,n.jsx)(s.li,{children:"replication_factor=timescaledb.hypertable_replication_factor_default"}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://docs.timescale.com/api/latest/hypertable/create_hypertable/",children:"https://docs.timescale.com/api/latest/hypertable/create_hypertable/"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-sql",children:"SELECT create_hypertable('samples', 'ts', chunk_time_interval => INTERVAL '7 day');\n\nselect chunks_detailed_size('samples');\nselect * from timescaledb_information.chunks;\n"})}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://docs.timescale.com/introduction/architecture",children:"Architecture & Concepts"})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://docs.timescale.com/use-timescale/latest/hypertables/",children:"https://docs.timescale.com/use-timescale/latest/hypertables/"})}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,i.M)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},38088:(e,s,t)=>{var n=t(96651),i=Symbol.for("react.element"),l=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,c=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function o(e,s,t){var n,l={},o=null,d=null;for(n in void 0!==t&&(o=""+t),void 0!==s.key&&(o=""+s.key),void 0!==s.ref&&(d=s.ref),s)r.call(s,n)&&!a.hasOwnProperty(n)&&(l[n]=s[n]);if(e&&e.defaultProps)for(n in s=e.defaultProps)void 0===l[n]&&(l[n]=s[n]);return{$$typeof:i,type:e,key:o,ref:d,props:l,_owner:c.current}}s.Fragment=l,s.jsx=o,s.jsxs=o},2488:(e,s,t)=>{e.exports=t(38088)},62780:(e,s,t)=>{t.d(s,{I:()=>c,M:()=>r});var n=t(96651);const i={},l=n.createContext(i);function r(e){const s=n.useContext(l);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),n.createElement(l.Provider,{value:s},e.children)}}}]);