"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[19633],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return g}});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var p=r.createContext({}),m=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=m(e.components);return r.createElement(p.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},s=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,l=e.originalType,p=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),s=m(n),g=a,k=s["".concat(p,".").concat(g)]||s[g]||d[g]||l;return n?r.createElement(k,i(i({ref:t},u),{},{components:n})):r.createElement(k,i({ref:t},u))}));function g(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var l=n.length,i=new Array(l);i[0]=s;var o={};for(var p in t)hasOwnProperty.call(t,p)&&(o[p]=t[p]);o.originalType=e,o.mdxType="string"==typeof e?e:a,i[1]=o;for(var m=2;m<l;m++)i[m]=n[m];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}s.displayName="MDXCreateElement"},93777:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return o},contentTitle:function(){return p},metadata:function(){return m},toc:function(){return u},default:function(){return s}});var r=n(87462),a=n(63366),l=(n(67294),n(3905)),i=["components"],o={id:"boot",title:"Spring Boot"},p=void 0,m={unversionedId:"java/spring/boot",id:"java/spring/boot",title:"Spring Boot",description:"Tips",source:"@site/notes/java/spring/spring-boot.md",sourceDirName:"java/spring",slug:"/java/spring/boot",permalink:"/notes/java/spring/boot",editUrl:"https://github.com/wenerme/wener/edit/master/notes/java/spring/spring-boot.md",tags:[],version:"current",frontMatter:{id:"boot",title:"Spring Boot"},sidebar:"docs",previous:{title:"Spring",permalink:"/notes/java/spring/"},next:{title:"Spring Cloud",permalink:"/notes/java/spring/cloud"}},u=[{value:"Tips",id:"tips",children:[],level:2},{value:"\u53c2\u8003",id:"\u53c2\u8003",children:[],level:2},{value:"\u4f7f\u7528 Jetty \u800c\u4e0d\u4f7f\u7528 Tomcat",id:"\u4f7f\u7528-jetty-\u800c\u4e0d\u4f7f\u7528-tomcat",children:[],level:2},{value:"\u5e38\u91cf",id:"\u5e38\u91cf",children:[],level:2},{value:"\u91cd\u8981\u7684\u5904\u7406\u63a5\u53e3",id:"\u91cd\u8981\u7684\u5904\u7406\u63a5\u53e3",children:[],level:2},{value:"\u914d\u7f6e",id:"\u914d\u7f6e",children:[{value:"\u4e3b\u8981\u914d\u7f6e\u5bf9\u8c61",id:"\u4e3b\u8981\u914d\u7f6e\u5bf9\u8c61",children:[],level:3},{value:"\u914d\u7f6e\u5c5e\u6027\u52a0\u8f7d\u987a\u5e8f",id:"\u914d\u7f6e\u5c5e\u6027\u52a0\u8f7d\u987a\u5e8f",children:[],level:3},{value:"\u67e5\u627e\u5c5e\u6027\u6587\u4ef6\u7684\u987a\u5e8f",id:"\u67e5\u627e\u5c5e\u6027\u6587\u4ef6\u7684\u987a\u5e8f",children:[],level:3},{value:"\u7279\u6b8a\u914d\u7f6e\u8bf4\u660e",id:"\u7279\u6b8a\u914d\u7f6e\u8bf4\u660e",children:[],level:3},{value:"\u5c5e\u6027\u6587\u4ef6\u53ef\u4f7f\u7528\u5360\u4f4d\u7b26",id:"\u5c5e\u6027\u6587\u4ef6\u53ef\u4f7f\u7528\u5360\u4f4d\u7b26",children:[],level:3},{value:"\u5355\u4e2a YAML \u53ef\u6307\u5b9a\u591a\u4e2a profile",id:"\u5355\u4e2a-yaml-\u53ef\u6307\u5b9a\u591a\u4e2a-profile",children:[],level:3},{value:"\u914d\u7f6e\u6ce8\u89e3",id:"\u914d\u7f6e\u6ce8\u89e3",children:[],level:3},{value:"\u7ed1\u5b9a\u5c5e\u6027\u540d",id:"\u7ed1\u5b9a\u5c5e\u6027\u540d",children:[],level:3},{value:"\u65e5\u5fd7\u914d\u7f6e",id:"\u65e5\u5fd7\u914d\u7f6e",children:[],level:3},{value:"\u5e38\u7528\u914d\u7f6e",id:"\u5e38\u7528\u914d\u7f6e",children:[],level:3},{value:"Tips",id:"tips-1",children:[],level:3}],level:2},{value:"Actuator",id:"actuator",children:[{value:"\u5e38\u7528\u7ec8\u7aef",id:"\u5e38\u7528\u7ec8\u7aef",children:[],level:3},{value:"\u914d\u7f6e",id:"\u914d\u7f6e-1",children:[],level:3}],level:2},{value:"Remote shell",id:"remote-shell",children:[{value:"\u914d\u7f6e",id:"\u914d\u7f6e-2",children:[],level:3}],level:2},{value:"Metrics",id:"metrics",children:[{value:"\u76d1\u63a7\u4fe1\u606f",id:"\u76d1\u63a7\u4fe1\u606f",children:[],level:3},{value:"\u81ea\u5b9a\u4e49",id:"\u81ea\u5b9a\u4e49",children:[],level:3},{value:"\u8f93\u51fa\u76d1\u63a7\u4fe1\u606f",id:"\u8f93\u51fa\u76d1\u63a7\u4fe1\u606f",children:[{value:"\u8f93\u51fa\u5230 Redis",id:"\u8f93\u51fa\u5230-redis",children:[],level:4},{value:"\u8f93\u51fa\u5230 statd",id:"\u8f93\u51fa\u5230-statd",children:[],level:4},{value:"\u5bfc\u51fa\u5230 JMX",id:"\u5bfc\u51fa\u5230-jmx",children:[],level:4}],level:3},{value:"\u83b7\u53d6 XmlMapper",id:"\u83b7\u53d6-xmlmapper",children:[],level:3},{value:"\u83b7\u53d6\u8bf7\u6c42\u4f53\u6587\u672c",id:"\u83b7\u53d6\u8bf7\u6c42\u4f53\u6587\u672c",children:[],level:3},{value:"\u53bb\u9664\u9519\u8bef\u767d\u677f\u9875",id:"\u53bb\u9664\u9519\u8bef\u767d\u677f\u9875",children:[],level:3}],level:2},{value:"\u521b\u5efa\u81ea\u5b9a\u4e49\u7684\u81ea\u52a8\u914d\u7f6e",id:"\u521b\u5efa\u81ea\u5b9a\u4e49\u7684\u81ea\u52a8\u914d\u7f6e",children:[],level:2}],d={toc:u};function s(e){var t=e.components,n=(0,a.Z)(e,i);return(0,l.kt)("wrapper",(0,r.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h2",{id:"tips"},"Tips"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u65b9\u4fbf\u67e5\u770b\u6bcf\u4e2a\u7248\u672c\u7684\u4f9d\u8d56\u7248\u672c",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"http://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-parent/2.0.0.RELEASE"},"org.springframework.boot/spring-boot-starter-parent"))))),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"# \u5b89\u88c5\u547d\u4ee4\u884c\u5de5\u5177\nbrew tap pivotal/tap\nbrew install springboot\n# \u5b89\u88c5 Spring Cloud \u6269\u5c55\n# https://cloud.spring.io/spring-cloud-cli/\nspring install org.springframework.cloud:spring-cloud-cli:1.3.2.RELEASE\n\n# \u5982\u679c\u60f3\u7528\u52a0\u5bc6\u7684\u529f\u80fd\u8fd8\u9700\u8981\u5b89\u88c5 jce\n# http://www.oracle.com/technetwork/java/javase/downloads/jce8-download-2133166.html\n")),(0,l.kt)("h2",{id:"\u53c2\u8003"},"\u53c2\u8003"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"http://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/"},"\u6700\u65b0\u6587\u6863")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"http://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#common-application-properties"},"\u6240\u6709\u7684\u914d\u7f6e\u5c5e\u6027"))),(0,l.kt)("h2",{id:"\u4f7f\u7528-jetty-\u800c\u4e0d\u4f7f\u7528-tomcat"},"\u4f7f\u7528 Jetty \u800c\u4e0d\u4f7f\u7528 Tomcat"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},"<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-web</artifactId>\n    <exclusions>\n        <exclusion>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-tomcat</artifactId>\n        </exclusion>\n    </exclusions>\n</dependency>\n<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-jetty</artifactId>\n</dependency>\n")),(0,l.kt)("h2",{id:"\u5e38\u91cf"},"\u5e38\u91cf"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"org.springframework.http.HttpHeaders"),(0,l.kt)("li",{parentName:"ul"},"org.springframework.http.HttpStatus")),(0,l.kt)("h2",{id:"\u91cd\u8981\u7684\u5904\u7406\u63a5\u53e3"},"\u91cd\u8981\u7684\u5904\u7406\u63a5\u53e3"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"org.springframework.util.PathMatcher\n\u8def\u5f84\u7684\u5339\u914d\u683c\u5f0f,\u6bd4\u5982 cors \u914d\u7f6e"),(0,l.kt)("li",{parentName:"ul"},"org.springframework.boot.logging.LoggingSystem",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u7528\u4e8e\u63a7\u5236\u65e5\u5fd7\u7ea7\u522b"),(0,l.kt)("li",{parentName:"ul"},"\u8fd0\u884c\u65f6\u4f1a\u66b4\u9732 logger endpoint, \u53ef\u67e5\u770b\u548c\u4fee\u6539\u65e5\u5fd7\u7ea7\u522b",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"org.springframework.boot.actuate.endpoint.LoggersEndpoint"))),(0,l.kt)("li",{parentName:"ul"},"\u65e5\u5fd7\u7ea7\u522b",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"TRACE, DEBUG, INFO, WARN, ERROR, FATAL, OFF"))),(0,l.kt)("li",{parentName:"ul"},"\u65e5\u5fd7\u5c5e\u6027\u5206\u4e3a configuredLevel \u548c effectiveLevel",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u4fee\u6539\u65f6\u4f7f\u7528 configuredLevel"))),(0,l.kt)("li",{parentName:"ul"},"Spring Boot \u81ea\u5e26\u4e86\u8f83\u591a\u7684 Logback \u914d\u7f6e",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"org.springframework.boot.logging.logback")))))),(0,l.kt)("h2",{id:"\u914d\u7f6e"},"\u914d\u7f6e"),(0,l.kt)("h3",{id:"\u4e3b\u8981\u914d\u7f6e\u5bf9\u8c61"},"\u4e3b\u8981\u914d\u7f6e\u5bf9\u8c61"),(0,l.kt)("p",null,"\u914d\u7f6e\u5bf9\u8c61\u90fd\u901a\u8fc7 Adapter/Configurer \u7684\u7c7b\u8fdb\u884c\u914d\u7f6e, \u53ea\u662f\u5bf9\u5185\u90e8\u914d\u7f6e\u8fdb\u884c\u4fee\u6539\u800c\u4e0d\u662f\u76f4\u63a5\u66ff\u6362."),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"org.springframework.web.servlet.config.annotation.WebMvcConfigurerAdapter"),(0,l.kt)("li",{parentName:"ul"},"org.springframework.security.config.annotation.authentication.configurers.GlobalAuthenticationConfigurerAdapter"),(0,l.kt)("li",{parentName:"ul"},"org.springframework.data.rest.webmvc.config.RepositoryRestConfigurerAdapter"),(0,l.kt)("li",{parentName:"ul"},"org.springframework.security.config.annotation.SecurityConfigurerAdapter"),(0,l.kt)("li",{parentName:"ul"},"org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter"),(0,l.kt)("li",{parentName:"ul"},"org.springframework.scheduling.annotation.AsyncConfigurer"),(0,l.kt)("li",{parentName:"ul"},"org.springframework.cache.annotation.CachingConfigurer"),(0,l.kt)("li",{parentName:"ul"},"org.springframework.web.servlet.config.annotation.ContentNegotiationConfigurer"),(0,l.kt)("li",{parentName:"ul"},"org.springframework.security.config.annotation.web.configurers.HeadersConfigurer"),(0,l.kt)("li",{parentName:"ul"},"org.springframework.boot.autoconfigure.security.oauth2.resource.JwtAccessTokenConverterConfigurer"),(0,l.kt)("li",{parentName:"ul"},"org.springframework.web.servlet.config.annotation.PathMatchConfigurer"),(0,l.kt)("li",{parentName:"ul"},"org.springframework.security.config.annotation.web.configurers.RequestCacheConfigurer"),(0,l.kt)("li",{parentName:"ul"},"org.springframework.transaction.annotation.TransactionManagementConfigurer")),(0,l.kt)("h3",{id:"\u914d\u7f6e\u5c5e\u6027\u52a0\u8f7d\u987a\u5e8f"},"\u914d\u7f6e\u5c5e\u6027\u52a0\u8f7d\u987a\u5e8f"),(0,l.kt)("ol",{start:0},(0,l.kt)("li",{parentName:"ol"},"\u547d\u4ee4\u884c\u53c2\u6570"),(0,l.kt)("li",{parentName:"ol"},"\u73af\u5883\u53d8\u91cf ",(0,l.kt)("inlineCode",{parentName:"li"},"SPRING_APPLICATION_JSON")," \u6307\u5b9a\u7684 JSON \u914d\u7f6e\u6216\u7cfb\u7edf\u5c5e\u6027"),(0,l.kt)("li",{parentName:"ol"},"JNDI \u5c5e\u6027 ",(0,l.kt)("inlineCode",{parentName:"li"},"java:comp/env")),(0,l.kt)("li",{parentName:"ol"},"Java \u7cfb\u7edf\u5c5e\u6027 (System.getProperties())"),(0,l.kt)("li",{parentName:"ol"},"\u64cd\u4f5c\u7cfb\u7edf\u73af\u5883\u53d8\u91cf"),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"RandomValuePropertySource")," \u4e3a ",(0,l.kt)("inlineCode",{parentName:"li"},"random.*")," \u8bbe\u7f6e\u968f\u673a\u5c5e\u6027\u503c"),(0,l.kt)("li",{parentName:"ol"},"Jar \u5305\u5916\u57fa\u4e8e profile \u7684\u5e94\u7528\u5c5e\u6027 (application-{profile}.properties \u6216 YAML)"),(0,l.kt)("li",{parentName:"ol"},"Jar \u5305\u5185\u57fa\u4e8e profile \u7684\u5e94\u7528\u5c5e\u6027 (application-{profile}.properties \u6216 YAML)"),(0,l.kt)("li",{parentName:"ol"},"Jar \u5305\u5916\u7684\u5e94\u7528\u5c5e\u6027\u914d\u7f6e (application.properties \u6216 YAML)"),(0,l.kt)("li",{parentName:"ol"},"Jar \u5305\u5185\u7684\u5e94\u7528\u5c5e\u6027\u914d\u7f6e (application.properties \u6216 YAML)"),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"@Configuration")," \u7c7b\u4e0a\u7684 ",(0,l.kt)("inlineCode",{parentName:"li"},"@PropertySource")),(0,l.kt)("li",{parentName:"ol"},"\u9ed8\u8ba4\u5c5e\u6027 (\u901a\u8fc7 SpringApplication.setDefaultProperties \u6307\u5b9a)")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u793a\u4f8b")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},'SPRING_APPLICATION_JSON=\'{"foo":{"bar":"spam"}}\' java -jar myapp.jar\njava -Dspring.application.json=\'{"foo":"bar"}\' -jar myapp.jar\njava -jar myapp.jar --spring.application.json=\'{"foo":"bar"}\'\n')),(0,l.kt)("h3",{id:"\u67e5\u627e\u5c5e\u6027\u6587\u4ef6\u7684\u987a\u5e8f"},"\u67e5\u627e\u5c5e\u6027\u6587\u4ef6\u7684\u987a\u5e8f"),(0,l.kt)("ol",{start:0},(0,l.kt)("li",{parentName:"ol"},"\u5f53\u524d\u76ee\u5f55\u4e0b\u7684 ",(0,l.kt)("inlineCode",{parentName:"li"},"/config")," \u5b50\u76ee\u5f55"),(0,l.kt)("li",{parentName:"ol"},"\u5f53\u524d\u76ee\u5f55"),(0,l.kt)("li",{parentName:"ol"},"\u7c7b\u8def\u5f84\u4e0b\u7684 ",(0,l.kt)("inlineCode",{parentName:"li"},"/config")," \u5305"),(0,l.kt)("li",{parentName:"ol"},"\u7c7b\u8def\u5f84\u6839")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u4fee\u6539")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},'# \u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u540d\njava -jar myproject.jar --spring.config.name=myproject\n# \u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u76ee\u5f55\njava -jar myproject.jar --spring.config.location=classpath:/default.properties,classpath:/override.properties\n# \u901a\u8fc7\u73af\u5883\u53d8\u91cf\u4fee\u6539\u6587\u4ef6\u540d\nSPRING_CONFIG_NAME=myproject java -jar myproject.jar\n# \u53ef\u540c\u65f6\u52a0\u8f7d\u591a\u4e2a\u914d\u7f6e\u540d\n# --spring.config.name=server-app,env\n# \u53ef\u5728\u542f\u52a8\u65f6\u6fc0\u6d3b\u76f8\u5e94\u914d\u7f6e\n# --spring.profiles.active=local\n# \u53ef\u4fee\u6539\u914d\u7f6e\u7684\u641c\u7d22\u8def\u5f84\n# --spring.profiles.location=file:./conf\n# \u4fee\u6539\u9ed8\u8ba4 Profile\n# --spring.profiles.default=test\n# \u53ef\u76f4\u63a5\u4f20\u9012 JSON \u53c2\u6570\n# --spring.application.json={"redis.port":6379}\n')),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},(0,l.kt)("strong",{parentName:"p"},"\u6ce8\u610f"),":"),(0,l.kt)("ul",{parentName:"blockquote"},(0,l.kt)("li",{parentName:"ul"},"\u4f7f\u7528 Profile \u65f6, include \u7684\u4f18\u5148\u7ea7\u4f1a\u6bd4\u5f53\u524d\u914d\u7f6e\u7684\u4f18\u5148\u7ea7\u9ad8,\u56e0\u6b64\u5728\u4f7f\u7528\u65f6\u5efa\u8bae\u907f\u514d\u4f7f\u7528 include \u6765\u5305\u542b\u9ed8\u8ba4\u914d\u7f6e."),(0,l.kt)("li",{parentName:"ul"},"\u6307\u5b9a\u591a\u4e2a profile \u65f6\u540e\u9762\u7684\u4f1a\u8986\u76d6\u524d\u9762\u7684"))),(0,l.kt)("h3",{id:"\u7279\u6b8a\u914d\u7f6e\u8bf4\u660e"},"\u7279\u6b8a\u914d\u7f6e\u8bf4\u660e"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"DevTool \u4f1a\u5c1d\u8bd5\u67e5\u627e HOME \u4e0b\u7684 ",(0,l.kt)("inlineCode",{parentName:"li"},".spring-boot-devtools.properties")," \u914d\u7f6e\u6587\u4ef6"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"spring.main")," \u4e0b\u7684\u53c2\u6570\u4f1a\u5e94\u7528\u5230 ",(0,l.kt)("inlineCode",{parentName:"li"},"SpringApplication")," \u4e0a,\u56e0\u6b64\u53ef\u4ee5\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u914d\u7f6e ",(0,l.kt)("inlineCode",{parentName:"li"},"spring.main.web_environment: false")," \u8fd9\u6837\u7684\u53c2\u6570"),(0,l.kt)("li",{parentName:"ul"},"Spring \u542f\u52a8\u65f6\u7684\u5904\u7406\u7c7b\u4e3a ",(0,l.kt)("inlineCode",{parentName:"li"},"org.springframework.boot.context.config.ConfigFileApplicationListener"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u8d1f\u8d23\u52a0\u8f7d\u7ed9\u5b9a\u7684\u914d\u7f6e ",(0,l.kt)("inlineCode",{parentName:"li"},"spring.config.name"),",",(0,l.kt)("inlineCode",{parentName:"li"},"spring.profiles.active"),",",(0,l.kt)("inlineCode",{parentName:"li"},"spring.profiles.location")),(0,l.kt)("li",{parentName:"ul"},"\u8d1f\u8d23\u5c06 ",(0,l.kt)("inlineCode",{parentName:"li"},"spring.main")," \u4e0a\u7684\u5c5e\u6027\u7ed1\u5b9a\u5230 ",(0,l.kt)("inlineCode",{parentName:"li"},"SpringApplication")," \u4e0a"))),(0,l.kt)("li",{parentName:"ul"},"\u53ef\u542f\u7528\u65e5\u5fd7,\u8bb0\u5f55\u6240\u6709\u5c1d\u8bd5\u52a0\u8f7d\u7684\u914d\u7f6e\u6587\u4ef6\u540d")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'<logger name="org.springframework.boot.context.config.ConfigFileApplicationListener"\n        level="TRACE"\n        additivity="false">\n    <appender-ref ref="CONSOLE"/>\n    <appender-ref ref="FILE"/>\n</logger>\n')),(0,l.kt)("h3",{id:"\u5c5e\u6027\u6587\u4ef6\u53ef\u4f7f\u7528\u5360\u4f4d\u7b26"},"\u5c5e\u6027\u6587\u4ef6\u53ef\u4f7f\u7528\u5360\u4f4d\u7b26"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"app.name=MyApp\napp.description=${app.name:Default Name} is a Spring Boot application\n")),(0,l.kt)("h3",{id:"\u5355\u4e2a-yaml-\u53ef\u6307\u5b9a\u591a\u4e2a-profile"},"\u5355\u4e2a YAML \u53ef\u6307\u5b9a\u591a\u4e2a profile"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},"server:\n    address: 192.168.1.100\n---\nspring:\n    profiles: development\nserver:\n    address: 127.0.0.1\n---\nspring:\n    profiles: production\nserver:\n    address: 192.168.1.120\n")),(0,l.kt)("h3",{id:"\u914d\u7f6e\u6ce8\u89e3"},"\u914d\u7f6e\u6ce8\u89e3"),(0,l.kt)("p",null,"\u9ed8\u8ba4\u4f1a\u5f00\u542f ",(0,l.kt)("inlineCode",{parentName:"p"},"@EnableConfigurationProperties")," \u6ce8\u89e3\u914d\u7f6e, \u6709 ",(0,l.kt)("inlineCode",{parentName:"p"},"@ConfigurationProperties")," \u6ce8\u89e3\u4f1a\u81ea\u52a8\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"Environment")," \u8fdb\u884c\u521d\u59cb\u5316.\u4e5f\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7 ",(0,l.kt)("inlineCode",{parentName:"p"},"@EnableConfigurationProperties")," \u6765\u6ce8\u518c\u914d\u7f6e\u5bf9\u8c61"),(0,l.kt)("h3",{id:"\u7ed1\u5b9a\u5c5e\u6027\u540d"},"\u7ed1\u5b9a\u5c5e\u6027\u540d"),(0,l.kt)("p",null,"\u8fdb\u884c\u7ed1\u5b9a\u7684\u5c5e\u6027\u540d\u76f8\u5bf9\u5bbd\u5bb9"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u5c5e\u6027\u540d\u683c\u5f0f"),(0,l.kt)("th",{parentName:"tr",align:null},"\u8bf4\u660e"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"person.firstName"),(0,l.kt)("td",{parentName:"tr",align:null},"\u6807\u51c6\u9a7c\u5cf0\u8bed\u6cd5")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"person.first-name"),(0,l.kt)("td",{parentName:"tr",align:null},"\u6a2a\u7ebf\u5206\u9694, \u63a8\u8350\u5728 .properties \u548c .yml \u4e2d\u4f7f\u7528")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"PERSON_FIRST_NAME"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5927\u5199\u683c\u5f0f, \u63a8\u8350\u5728\u7cfb\u7edf\u53d8\u91cf\u4f7f\u7528")))),(0,l.kt)("h3",{id:"\u65e5\u5fd7\u914d\u7f6e"},"\u65e5\u5fd7\u914d\u7f6e"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Spring Environment"),(0,l.kt)("th",{parentName:"tr",align:null},"System Property"),(0,l.kt)("th",{parentName:"tr",align:null},"Comments"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"logging.exception-conversion-word"),(0,l.kt)("td",{parentName:"tr",align:null},"LOG_EXCEPTION_CONVERSION_WORD"),(0,l.kt)("td",{parentName:"tr",align:null},"The conversion word that\u2019s used when logging exceptions.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"logging.file"),(0,l.kt)("td",{parentName:"tr",align:null},"LOG_FILE"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5982\u679c\u5b9a\u4e49\u4e86\u4f1a\u4f5c\u4e3a\u9ed8\u8ba4\u65e5\u5fd7\u914d\u7f6e")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"logging.path"),(0,l.kt)("td",{parentName:"tr",align:null},"LOG_PATH"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"logging.pattern.console"),(0,l.kt)("td",{parentName:"tr",align:null},"CONSOLE_LOG_PATTERN"),(0,l.kt)("td",{parentName:"tr",align:null},"\u63a7\u5236\u53f0(stdout)\u8f93\u51fa\u7684\u65e5\u5fd7\u683c\u5f0f(\u4e0d\u652f\u6301 JDK logger)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"logging.pattern.file"),(0,l.kt)("td",{parentName:"tr",align:null},"FILE_LOG_PATTERN"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8f93\u51fa\u5230\u6587\u4ef6\u7684\u65e5\u5fd7\u683c\u5f0f")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"logging.pattern.level"),(0,l.kt)("td",{parentName:"tr",align:null},"LOG_LEVEL_PATTERN"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8f93\u51fa\u65e5\u5fd7\u7b49\u7ea7\u7684\u683c\u5f0f(\u9ed8\u8ba4 %5p)(logging.pattern.level \u652f\u6301\u76f4 Logback)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"PID"),(0,l.kt)("td",{parentName:"tr",align:null},"PID"),(0,l.kt)("td",{parentName:"tr",align:null})))),(0,l.kt)("h3",{id:"\u5e38\u7528\u914d\u7f6e"},"\u5e38\u7528\u914d\u7f6e"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},"# \u65e5\u5fd7\u914d\u7f6e\nlogging.level.root: INFO\nlogging.level.org.springframework.web: DEBUG\nlogging.level.org.hibernate: ERROR\n\n# \u542f\u7528 h2 \u63a7\u5236\u53f0\nspring.h2.console.enabled: true\n# \u4fee\u6539\u63a7\u5236\u53f0\u8def\u5f84,\u9ed8\u8ba4 /h2-console\nspring.h2.console.path: /h2-console\n\n# \u4fee\u6539 Jackson \u65f6\u95f4\u683c\u5f0f,\u8bbe\u7f6e\u6b63\u786e\u7684\u65f6\u533a\u975e\u5e38\u91cd\u8981,\u5426\u5219\u4f1a\u5bfc\u81f4\u5e8f\u5217\u5316\u7684\u65f6\u95f4\u6709\u65f6\u5dee\nspring:\n  jackson:\n    date-format: yyyy-MM-dd HH:mm:ss\n    locale: zh_CN\n    time-zone: GMT+8\n")),(0,l.kt)("h3",{id:"tips-1"},"Tips"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u53ef\u81ea\u5b9a\u4e49\u6570\u636e\u7c7b\u578b\u8f6c\u6362 ",(0,l.kt)("a",{parentName:"li",href:"https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-features-external-config-conversion"},"Properties conversion")),(0,l.kt)("li",{parentName:"ul"},"\u53ef\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"li"},"javax.validation")," \u5bf9\u914d\u7f6e\u7684\u5c5e\u6027\u8fdb\u884c\u6821\u9a8c"),(0,l.kt)("li",{parentName:"ul"},"\u53ef\u901a\u8fc7 ",(0,l.kt)("inlineCode",{parentName:"li"},"spring-boot-actuator")," \u6a21\u5757\u5728 ",(0,l.kt)("inlineCode",{parentName:"li"},"/configprops")," \u67e5\u770b\u5c5e\u6027\u914d\u7f6e")),(0,l.kt)("h2",{id:"actuator"},"Actuator"),(0,l.kt)("h3",{id:"\u5e38\u7528\u7ec8\u7aef"},"\u5e38\u7528\u7ec8\u7aef"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"ID"),(0,l.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u9ed8\u8ba4\u654f\u611f"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"actuator"),(0,l.kt)("td",{parentName:"tr",align:null},"\u63d0\u4f9b\u57fa\u4e8e\u8d85\u5a92\u4f53\u7684\u53d1\u73b0\u9875,\u9700\u8981 Spring HATEOAS."),(0,l.kt)("td",{parentName:"tr",align:null},"true")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"autoconfig"),(0,l.kt)("td",{parentName:"tr",align:null},"\u663e\u793a\u81ea\u52a8\u914d\u7f6e\u7684\u6c47\u62a5,\u663e\u793a\u6240\u6709\u81ea\u52a8\u914d\u7f6e\u7684\u5019\u9009\u548c\u4e3a\u4ec0\u4e48\u6ca1\u6709\u88ab\u4f7f\u7528"),(0,l.kt)("td",{parentName:"tr",align:null},"true")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"beans"),(0,l.kt)("td",{parentName:"tr",align:null},"\u663e\u793a\u7a0b\u5e8f\u4e2d\u7684 beans \u5217\u8868"),(0,l.kt)("td",{parentName:"tr",align:null},"true")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"configprops"),(0,l.kt)("td",{parentName:"tr",align:null},"\u663e\u793a\u6240\u6709 ",(0,l.kt)("inlineCode",{parentName:"td"},"@ConfigurationProperties")),(0,l.kt)("td",{parentName:"tr",align:null},"true")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"docs"),(0,l.kt)("td",{parentName:"tr",align:null},"\u663e\u793a\u6587\u6863,\u5305\u62ec\u8bf7\u6c42\u548c\u76f8\u5e94\u7684\u4f8b\u5b50,\u9700\u8981 ",(0,l.kt)("inlineCode",{parentName:"td"},"spring-boot-actuator-docs")),(0,l.kt)("td",{parentName:"tr",align:null},"false")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"dump"),(0,l.kt)("td",{parentName:"tr",align:null},"\u6267\u884c\u7ebf\u7a0b\u8f6c\u50a8"),(0,l.kt)("td",{parentName:"tr",align:null},"true")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"env"),(0,l.kt)("td",{parentName:"tr",align:null},"\u66b4\u9732 ",(0,l.kt)("inlineCode",{parentName:"td"},"ConfigurableEnvironment")," \u7684\u5c5e\u6027"),(0,l.kt)("td",{parentName:"tr",align:null},"true")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"flyway"),(0,l.kt)("td",{parentName:"tr",align:null},"\u663e\u793a Flyway \u6570\u636e\u5e93\u7684\u8fc1\u79fb\u72b6\u6001"),(0,l.kt)("td",{parentName:"tr",align:null},"true")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"health"),(0,l.kt)("td",{parentName:"tr",align:null},"\u663e\u793a\u5e94\u7528\u7684\u76d1\u63a7\u4fe1\u606f,\u6388\u6743\u540e\u8bf7\u6c42\u8fd4\u56de\u8be6\u7ec6\u4fe1\u606f"),(0,l.kt)("td",{parentName:"tr",align:null},"false")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"info"),(0,l.kt)("td",{parentName:"tr",align:null},"\u663e\u793a\u4efb\u4f55\u4fe1\u606f"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"liquibase"),(0,l.kt)("td",{parentName:"tr",align:null},"\u663e\u793a liquibase \u6570\u636e\u5e93\u8fc1\u79fb\u72b6\u6001"),(0,l.kt)("td",{parentName:"tr",align:null},"true")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"logfile"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8fd4\u56de logfile \u4e2d\u7684\u5185\u5bb9(\u5982\u679c\u8bbe\u7f6e\u4e86 logging.file \u6216 logging.path \u5c5e\u6027).\u9700\u8981 MVC \u652f\u6301.\u652f\u6301 HTTP \u5934\u7684\u8303\u56f4\u8bf7\u6c42."),(0,l.kt)("td",{parentName:"tr",align:null},"true")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"metrics"),(0,l.kt)("td",{parentName:"tr",align:null},"\u663e\u793a\u5f53\u524d\u5e94\u7528\u7684 metrices \u4fe1\u606f"),(0,l.kt)("td",{parentName:"tr",align:null},"true")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"mappings"),(0,l.kt)("td",{parentName:"tr",align:null},"\u663e\u793a\u6240\u6709 ",(0,l.kt)("inlineCode",{parentName:"td"},"@RequestMapping")," \u8def\u5f84"),(0,l.kt)("td",{parentName:"tr",align:null},"true")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"shutdown"),(0,l.kt)("td",{parentName:"tr",align:null},"\u505c\u6b62\u5e94\u7528(\u9ed8\u8ba4\u672a\u5f00\u542f)"),(0,l.kt)("td",{parentName:"tr",align:null},"true")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"trace"),(0,l.kt)("td",{parentName:"tr",align:null},"\u663e\u793a\u8ddf\u8e2a\u4fe1\u606f(\u9ed8\u8ba4\u53ea\u663e\u793a\u524d\u51e0\u4e2a HTTP \u8bf7\u6c42)"),(0,l.kt)("td",{parentName:"tr",align:null},"true")))),(0,l.kt)("h3",{id:"\u914d\u7f6e-1"},"\u914d\u7f6e"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},"# \u4fee\u6539\u4e00\u4e2a\u7ec8\u7aef\u7684\u654f\u611f\u503c\nendpoints.beans.id=springbeans\nendpoints.beans.sensitive=false\n# \u63a7\u5236\u662f\u5426\u542f\u7528\u7ec8\u7aef\nendpoints.enabled=false\nendpoints.info.enabled=true\nendpoints.shutdown.enabled=true\n# \u63a7\u5236\u662f\u5426\u542f\u7528\u654f\u611f\nendpoints.sensitive=true\nendpoints.info.sensitive=false\n# \u63a7\u5236 CORS\nendpoints.cors.allowed-origins: http://example.com\nendpoints.cors.allowed-methods: GET,POST\n# \u63a7\u5236\u662f\u5426\u542f\u7528\u76d1\u63a7\u68c0\u67e5\nmanagement.health.defaults.enabled=false\n# \u63a7\u5236\u8def\u5f84\u548c\u7aef\u53e3\u5730\u5740\nmanagement.context-path: /manage\nmanagement.port=8081\nmanagement.address=127.0.0.1\n# \u5b9a\u5236\u5316\u901a\u8fc7 info \u7ec8\u7aef\u66b4\u9732\u7684\u4fe1\u606f\ninfo.app.name=MyService\ninfo.app.description=My awesome service\ninfo.app.version=1.0.0\n# \u901a\u8fc7 Maven \u81ea\u52a8\u5c55\u5f00\u5c5e\u6027\n# spring boot parent \u4f7f\u7528 git \u63d2\u4ef6\u63d0\u4f9b\u4e86 git.properties \u6587\u4ef6\nproject.artifactId=myproject\nproject.name=Demo\nproject.version=X.X.X.X\nproject.description=Demo project for info endpoint\ninfo.build.artifact=@project.artifactId@\ninfo.build.name=@project.name@\ninfo.build.description=@project.description@\ninfo.build.version=@project.version@\n# \u63a7\u5236\u8bbf\u95ee\u7ba1\u7406\u53f0\u9700\u8981\u7684\u89d2\u8272\nmanagement.security.role=SUPERUSER\n# \u4e3a\u5355\u72ec\u7684\u7ec8\u7aef\u6307\u5b9a\u8def\u5f84\nendpoints.{name}.path\n# \u7981\u7528 HTTP \u7ec8\u7aef\nmanagement.port=-1\n# \u4fee\u6539 MBean \u540d\u5b57\nendpoints.jmx.domain=myapp\nendpoints.jmx.unique-names: true\n")),(0,l.kt)("h2",{id:"remote-shell"},"Remote shell"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},"<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-remote-shell</artifactId>\n</dependency>\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u9ed8\u8ba4\u7aef\u53e3\u4e3a 2000"),(0,l.kt)("li",{parentName:"ul"},"\u547d\u4ee4\u626b\u63cf\u8def\u5f84\u4e3a")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"classpath*:/commands/**\nclasspath*:/crash/commands/**\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u53ef\u901a\u8fc7 ",(0,l.kt)("inlineCode",{parentName:"li"},"shell.command-path-patterns")," \u6765\u4fee\u6539\u547d\u4ee4\u8def\u5f84"),(0,l.kt)("li",{parentName:"ul"},"\u7ee7\u627f\u81ea ",(0,l.kt)("inlineCode",{parentName:"li"},"org.crsh.plugin.CRaSHPlugin")," \u7684 Bean \u4f1a\u81ea\u52a8\u6ce8\u518c")),(0,l.kt)("h3",{id:"\u914d\u7f6e-2"},"\u914d\u7f6e"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"shell.auth.simple.user.name\nshell.auth.simple.user.password\n")),(0,l.kt)("h2",{id:"metrics"},"Metrics"),(0,l.kt)("h3",{id:"\u76d1\u63a7\u4fe1\u606f"},"\u76d1\u63a7\u4fe1\u606f"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u7cfb\u7edf\u76d1\u63a7")),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u952e"),(0,l.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"),(0,l.kt)("th",{parentName:"tr",align:null},"\u5355\u4f4d"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"mem"),(0,l.kt)("td",{parentName:"tr",align:null},"\u603b\u5185\u5b58"),(0,l.kt)("td",{parentName:"tr",align:null},"KB")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"mem.free"),(0,l.kt)("td",{parentName:"tr",align:null},"\u7a7a\u95f2\u5185\u5b58"),(0,l.kt)("td",{parentName:"tr",align:null},"KB")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"processors"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8fdb\u7a0b\u6570"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"uptime"),(0,l.kt)("td",{parentName:"tr",align:null},"\u7cfb\u7edf\u8fd0\u884c\u65f6\u95f4  ms"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"instance.uptime"),(0,l.kt)("td",{parentName:"tr",align:null},"\u7a0b\u5e8f\u8fd0\u884c\u65f6\u95f4"),(0,l.kt)("td",{parentName:"tr",align:null},"ms")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"systemload.average"),(0,l.kt)("td",{parentName:"tr",align:null},"\u7cfb\u7edf\u5e73\u5747\u8d1f\u8f7d"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"heap",(0,l.kt)("br",null),"heap.committed",(0,l.kt)("br",null),"heap.init",(0,l.kt)("br",null),"heap.used"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5806\u4fe1\u606f"),(0,l.kt)("td",{parentName:"tr",align:null},"KB")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"threads",(0,l.kt)("br",null),"thread.peak",(0,l.kt)("br",null),"thread.daemon"),(0,l.kt)("td",{parentName:"tr",align:null},"\u7ebf\u7a0b\u4fe1\u606f"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"classes",(0,l.kt)("br",null),"classes.loaded",(0,l.kt)("br",null),"classes.unloaded"),(0,l.kt)("td",{parentName:"tr",align:null},"\u7c7b\u52a0\u8f7d\u4fe1\u606f"),(0,l.kt)("td",{parentName:"tr",align:null})),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"gc.xxx.count",(0,l.kt)("br",null),"gc.xxx.time"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5783\u573e\u56de\u6536\u4fe1\u606f"),(0,l.kt)("td",{parentName:"tr",align:null})))),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u6570\u636e\u6e90\u76d1\u63a7")),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u952e"),(0,l.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"datasource.xxx.active"),(0,l.kt)("td",{parentName:"tr",align:null},"\u6fc0\u6d3b\u94fe\u63a5\u6570")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"datasource.xxx.usage"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5f53\u524d\u7ebf\u7a0b\u6c60\u7684\u4f7f\u7528\u60c5\u51b5")))),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"datasource.primary")," \u8868\u793a ",(0,l.kt)("inlineCode",{parentName:"li"},"@Primary")," \u7684\u6570\u636e\u6e90"),(0,l.kt)("li",{parentName:"ul"},"\u5982\u679c\u4e00\u4e2a\u6570\u636e\u6e90 bean \u7684\u540d\u5b57\u662f\u4ee5 DataSource \u7ed3\u5c3e\u7684,\u90a3\u4e48 metric \u91cc\u53ea\u4f1a\u663e\u793a\u4e4b\u524d\u7684,\u4f8b\u5982 ",(0,l.kt)("inlineCode",{parentName:"li"},"myDataSource")," \u663e\u793a\u4e3a ",(0,l.kt)("inlineCode",{parentName:"li"},"datasource.my")),(0,l.kt)("li",{parentName:"ul"},"\u5426\u5219\u90fd\u662f\u7528 bean \u540d\u4f5c\u4e3a metric \u540d"),(0,l.kt)("li",{parentName:"ul"},"\u53ef\u901a\u8fc7\u6ce8\u518c ",(0,l.kt)("inlineCode",{parentName:"li"},"DataSourcePublicMetrics")," \u6765\u4fee\u6539\u90e8\u5206\u9ed8\u8ba4\u914d\u7f6e."),(0,l.kt)("li",{parentName:"ul"},"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4f1a\u663e\u793a\u6240\u6709\u652f\u6301\u7684\u5143\u6570\u636e,\u53ef\u901a\u8fc7 ",(0,l.kt)("inlineCode",{parentName:"li"},"DataSourcePoolMetadataProvider")," Bean \u6dfb\u52a0\u989d\u5916\u7684. \u8bf7\u67e5\u770b",(0,l.kt)("inlineCode",{parentName:"li"},"DataSourcePoolMetadataProvidersConfiguration"),".")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u7f13\u5b58\u76d1\u63a7")),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u952e"),(0,l.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"cache.xxx.size"),(0,l.kt)("td",{parentName:"tr",align:null},"\u7f13\u5b58\u5927\u5c0f")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"cache.xxx.hit.ratio"),(0,l.kt)("td",{parentName:"tr",align:null},"\u547d\u4e2d\u7387")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"cache.xxx.miss.ratio"),(0,l.kt)("td",{parentName:"tr",align:null},"\u672a\u547d\u4e2d\u7387")))),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"TOMCAT SESSION")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"httpsessions.active"),(0,l.kt)("li",{parentName:"ul"},"httpsessions.max")),(0,l.kt)("h3",{id:"\u81ea\u5b9a\u4e49"},"\u81ea\u5b9a\u4e49"),(0,l.kt)("p",null,"\u53ef\u901a\u8fc7\u6ce8\u5165 CounterService \u6216 GaugeService \u6765\u63d0\u4f9b\u5e94\u7528\u76d1\u63a7, \u867d\u7136\u4efb\u4f55\u5b57\u7b26\u4e32\u90fd\u53ef\u4ee5\u4f5c\u4e3a\u540d\u5b57,\u4f46\u5efa\u8bae\u53c2\u8003 ",(0,l.kt)("a",{parentName:"p",href:"http://matt.aimonetti.net/posts/2013/06/26/practical-guide-to-graphite-monitoring/"},"\u8be5\u6307\u5357"),"."),(0,l.kt)("p",null,"\u53ef\u901a\u8fc7\u6ce8\u518c ",(0,l.kt)("inlineCode",{parentName:"p"},"PublicMetrics")," \u6765\u505a\u901a\u8fc7\u8ba1\u7b97\u5f97\u51fa\u7684\u7edf\u8ba1.\u53ef\u901a\u8fc7 ",(0,l.kt)("inlineCode",{parentName:"p"},"MetricsEndpoint")," \u6765\u5b9a\u5236\u5904\u7406\u65b9\u5f0f."),(0,l.kt)("h3",{id:"\u8f93\u51fa\u76d1\u63a7\u4fe1\u606f"},"\u8f93\u51fa\u76d1\u63a7\u4fe1\u606f"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"spring.metrics.export\n  .send-latest\n  .delay-millis\n  .includes\n  .excludes\n# \u4e5f\u53ef\u4e3a\u6bcf\u4e2a bean \u8bbe\u7f6e\nspring.metrics.export.triggers.<name>.*\n")),(0,l.kt)("h4",{id:"\u8f93\u51fa\u5230-redis"},"\u8f93\u51fa\u5230 Redis"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"@Bean\n@ExportMetricWriter\nMetricWriter metricWriter(MetricExportProperties export) {\n    return new RedisMetricRepository(connectionFactory,\n      export.getRedis().getPrefix(), export.getRedis().getKey());\n}\n")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"spring.metrics.export.redis.prefix: metrics.mysystem.${spring.application.name:application}.${random.value:0000}\nspring.metrics.export.redis.key: keys.metrics.mysystem\n")),(0,l.kt)("h4",{id:"\u8f93\u51fa\u5230-statd"},"\u8f93\u51fa\u5230 statd"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@Value("${spring.application.name:application}.${random.value:0000}")\nprivate String prefix = "metrics";\n\n@Bean\n@ExportMetricWriter\nMetricWriter metricWriter() {\n    return new StatsdMetricWriter(prefix, "localhost", "8125");\n}\n')),(0,l.kt)("h4",{id:"\u5bfc\u51fa\u5230-jmx"},"\u5bfc\u51fa\u5230 JMX"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"@Bean\n@ExportMetricWriter\nMetricWriter metricWriter(MBeanExporter exporter) {\n    return new JmxMetricWriter(exporter);\n}\n")),(0,l.kt)("h3",{id:"\u83b7\u53d6-xmlmapper"},"\u83b7\u53d6 XmlMapper"),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"http://docs.spring.io/spring-boot/docs/current/reference/html/howto-spring-mvc.html"},"http://docs.spring.io/spring-boot/docs/current/reference/html/howto-spring-mvc.html")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},"<dependency>\n    <groupId>com.fasterxml.jackson.dataformat</groupId>\n    <artifactId>jackson-dataformat-xml</artifactId>\n</dependency>\n")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"@Autowired\npublic void init(MappingJackson2XmlHttpMessageConverter xmlConverter){\n    XmlMapper mapper = (XmlMapper) xmlConverter.getObjectMapper();\n}\n")),(0,l.kt)("h3",{id:"\u83b7\u53d6\u8bf7\u6c42\u4f53\u6587\u672c"},"\u83b7\u53d6\u8bf7\u6c42\u4f53\u6587\u672c"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@RequestMapping(path = "/echo", method = RequestMethod.POST)\npublic Object echo(HttpServletRequest request) throws IOException {\n  String content = CharStreams.toString(new InputStreamReader(request.getInputStream()));\n  return content;\n}\n')),(0,l.kt)("h3",{id:"\u53bb\u9664\u9519\u8bef\u767d\u677f\u9875"},"\u53bb\u9664\u9519\u8bef\u767d\u677f\u9875"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@RestController\npublic class IndexController implements ErrorController{\n\n    private static final String PATH = "/error";\n\n    private final ErrorAttributes errorAttributes;\n\n    // \u4e5f\u53ef\u4ee5\u81ea\u5df1\u5904\u7406\u9519\u8bef\n    @Autowired\n    public IndexController(ErrorAttributes errorAttributes) {\n      Assert.notNull(errorAttributes, "ErrorAttributes must not be null");\n      this.errorAttributes = errorAttributes;\n    }\n\n    @RequestMapping(value = PATH)\n    public String error() {\n        return "Error handling";\n    }\n\n    @Override\n    public String getErrorPath() {\n        return PATH;\n    }\n}\n// \u9ed8\u8ba4\u7684\u9519\u8bef\u63a7\u5236\u5668\u4e3a ErrorMvcAutoConfiguration#basicErrorController\n')),(0,l.kt)("h2",{id:"\u521b\u5efa\u81ea\u5b9a\u4e49\u7684\u81ea\u52a8\u914d\u7f6e"},"\u521b\u5efa\u81ea\u5b9a\u4e49\u7684\u81ea\u52a8\u914d\u7f6e"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-developing-auto-configuration.html"},"46. Creating Your Own Auto-configuration")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"META-INF/spring.factories")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"org.springframework.boot.autoconfigure.EnableAutoConfiguration="),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u9017\u53f7\u5206\u9694")))))}s.isMDXComponent=!0}}]);