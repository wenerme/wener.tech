/*! For license information please see 339966e4.a3eaf7e7.js.LICENSE.txt */
"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[62200],{19292:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>d,toc:()=>a});var i=s(2488),r=s(62780);const t={title:"Redis FAQ",tags:["FAQ"]},l="Redis FAQ",d={id:"db/kv/redis/redis-faq",title:"Redis FAQ",description:"Replica vs Slave",source:"@site/../notes/db/kv/redis/redis-faq.md",sourceDirName:"db/kv/redis",slug:"/db/kv/redis/faq",permalink:"/notes/db/kv/redis/faq",draft:!1,unlisted:!1,editUrl:"https://github.com/wenerme/wener/edit/master/notes/../notes/db/kv/redis/redis-faq.md",tags:[{label:"FAQ",permalink:"/notes/tags/faq"}],version:"current",lastUpdatedBy:"wener",lastUpdatedAt:1689578517,formattedLastUpdatedAt:"Jul 17, 2023",frontMatter:{title:"Redis FAQ",tags:["FAQ"]},sidebar:"docs",previous:{title:"\u914d\u7f6e",permalink:"/notes/db/kv/redis/conf"},next:{title:"Redis Module",permalink:"/notes/db/kv/redis/module"}},c={},a=[{value:"Replica vs Slave",id:"replica-vs-slave",level:2},{value:"Queue: List vs PubSub vs Stream vs ZSet",id:"queue",level:2},{value:"MISCONF Redis is configured to save RDB snapshots",id:"misconf-redis-is-configured-to-save-rdb-snapshots",level:2},{value:"RESP3",id:"resp3",level:2},{value:"ERR max number of clients reached",id:"err-max-number-of-clients-reached",level:2}];function o(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",hr:"hr",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.M)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"redis-faq",children:"Redis FAQ"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"AOF base file appendonly.aof.1.base.rdb\nAOF incr file appendonly.aof.1.incr.aof\n"})}),"\n",(0,i.jsx)(n.h2,{id:"replica-vs-slave",children:"Replica vs Slave"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u542b\u4e49\u5b8c\u5168\u76f8\u540c"}),"\n",(0,i.jsx)(n.li,{children:"slaveof = replicaof"}),"\n",(0,i.jsxs)(n.li,{children:["\u662f\u56e0\u4e3a\u8c03\u6574\u4e86\u540d\u8bcd ",(0,i.jsx)(n.a,{href:"https://github.com/redis/redis/issues/5335",children:"redis#5335"})]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"queue",children:"Queue: List vs PubSub vs Stream vs ZSet"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\u90fd\u80fd\u5b9e\u73b0\u6d88\u606f\u961f\u5217\u80fd\u529b\uff0c\u4f46\u573a\u666f\u4e0d\u540c"}),"\n"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["List\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u5b58\u50a8\u6570\u636e"}),"\n",(0,i.jsx)(n.li,{children:"\u4e0d\u80fd\u91cd\u590d\u6d88\u8d39 - POP \u540e\u5c31\u4e0d\u5b58\u5728\u4e86"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Pub/Sub\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u4e0d\u5b58\u50a8\u6570\u636e - \u7528\u4e8e\u4f20\u9012\u4fe1\u606f - \u5b9e\u73b0\u5f02\u6b65/\u540c\u6b65\u901a\u8baf\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"at-most-once, fire & forget, fan-out"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"\u6ca1\u6709 Sub \u65f6 Pub \u662f\u65e0\u610f\u4e49\u7684"}),"\n",(0,i.jsxs)(n.li,{children:["\u53ef\u7528\u4e8e\u8ba2\u9605\u7cfb\u7edf\u4e8b\u4ef6 - keyspace, keyevent - \u9700\u8981\u8c03\u6574\u914d\u7f6e ",(0,i.jsx)(n.a,{href:"./redis.md#%E9%94%AE%E5%8F%98%E5%8C%96%E9%80%9A%E7%9F%A5",children:"\u952e\u53d8\u5316\u901a\u77e5"})]}),"\n",(0,i.jsxs)(n.li,{children:["\u652f\u6301 pattern - \u4f8b\u5982 ",(0,i.jsx)(n.code,{children:"system.events.*"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Stream\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u5b58\u50a8\u6570\u636e - \u6709\u6d88\u8d39\u8005\u3001\u6d88\u8d39\u7ec4\u6982\u5ff5"}),"\n",(0,i.jsx)(n.li,{children:"\u80fd\u91cd\u590d\u6d88\u8d39 - at-most-once \u6216 at-least-once"}),"\n",(0,i.jsx)(n.li,{children:"\u6709\u66f4\u591a\u6d88\u606f\u961f\u5217\u7684\u6982\u5ff5 - \u4f8b\u5982: \u6d88\u606f ID\u3001\u65f6\u95f4\u6233\u3001 ACK"}),"\n",(0,i.jsx)(n.li,{children:"\u80fd\u5b9e\u73b0 List \u548c Pub/Sub \u7684\u6240\u6709\u8bed\u4e49"}),"\n",(0,i.jsx)(n.li,{children:"\u53ef\u4ee5\u4e0d\u963b\u585e"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["ZSet\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u6709\u5e8f\u96c6\u5408"}),"\n",(0,i.jsx)(n.li,{children:"score \u4e3a double"}),"\n",(0,i.jsx)(n.li,{children:"key \u4f1a\u53bb\u91cd"}),"\n",(0,i.jsx)(n.li,{children:"\u53ef\u4f5c\u4e3a\u6d88\u606f\u961f\u5217\uff0c\u57fa\u4e8e key/offset \u6d88\u8d39"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"misconf-redis-is-configured-to-save-rdb-snapshots",children:"MISCONF Redis is configured to save RDB snapshots"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"MISCONF Redis is configured to save RDB snapshots, but is currently not able to persist on disk. Commands that may modify the data set are disabled.\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"redis-cli\n# config set stop-writes-on-bgsave-error no\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://gist.github.com/kapkaev/4619127",children:"https://gist.github.com/kapkaev/4619127"})}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"resp3",children:"RESP3"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u76ee\u524d\u7684 RESP \u662f QA \u6a21\u5f0f\uff0c\u6027\u80fd\u548c\u5904\u7406\u80fd\u529b\u4e0a\u6709\u9650"}),"\n",(0,i.jsx)(n.li,{children:"\u53d1\u9001 HELLO \u5224\u65ad\u662f\u5426\u652f\u6301 RESP3"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://gist.github.com/antirez/2bc68a9e9e45395e297d288453d5d54c",children:"https://gist.github.com/antirez/2bc68a9e9e45395e297d288453d5d54c"})}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"err-max-number-of-clients-reached",children:"ERR max number of clients reached"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"client \u9ed8\u8ba4 timeout \u4e3a 0\uff0c\u53ef\u5c1d\u8bd5\u6dfb\u52a0 timeout \u5728\u670d\u52a1\u7aef\u5173\u95ed\u94fe\u63a5"}),"\n",(0,i.jsx)(n.li,{children:"maxclients \u9ed8\u8ba4 10,000"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# \u5982\u679c\u589e\u52a0\u4e86 maxclients \u4e5f\u8981\u589e\u52a0\u7cfb\u7edf\u9650\u5236\nulimit -Sn 100000\nsysctl -w fs.file-max=100000\n"})})]})}function h(e={}){const{wrapper:n}={...(0,r.M)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},38088:(e,n,s)=>{var i=s(96651),r=Symbol.for("react.element"),t=Symbol.for("react.fragment"),l=Object.prototype.hasOwnProperty,d=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function a(e,n,s){var i,t={},a=null,o=null;for(i in void 0!==s&&(a=""+s),void 0!==n.key&&(a=""+n.key),void 0!==n.ref&&(o=n.ref),n)l.call(n,i)&&!c.hasOwnProperty(i)&&(t[i]=n[i]);if(e&&e.defaultProps)for(i in n=e.defaultProps)void 0===t[i]&&(t[i]=n[i]);return{$$typeof:r,type:e,key:a,ref:o,props:t,_owner:d.current}}n.Fragment=t,n.jsx=a,n.jsxs=a},2488:(e,n,s)=>{e.exports=s(38088)},62780:(e,n,s)=>{s.d(n,{I:()=>d,M:()=>l});var i=s(96651);const r={},t=i.createContext(r);function l(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);