/*! For license information please see 7bc6c1a6.000d22af.js.LICENSE.txt */
"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[54406],{32248:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>i,default:()=>h,frontMatter:()=>t,metadata:()=>c,toc:()=>a});var s=r(2488),l=r(62780);const t={title:"JavaScript \u5e38\u89c1\u95ee\u9898",tags:["FAQ"]},i="JavaScript \u5e38\u89c1\u95ee\u9898",c={id:"web/spec/js-faq",title:"JavaScript \u5e38\u89c1\u95ee\u9898",description:"- Promise \u5728\u521b\u5efa\u65f6\u4fbf\u4f1a\u8bf7\u6c42\uff0c\u800c\u4e0d\u662f\u5728 then \u65f6\u8bf7\u6c42 - eager eval",source:"@site/../notes/web/spec/js-faq.md",sourceDirName:"web/spec",slug:"/web/spec/js-faq",permalink:"/notes/web/spec/js-faq",draft:!1,unlisted:!1,editUrl:"https://github.com/wenerme/wener/edit/master/notes/../notes/web/spec/js-faq.md",tags:[{label:"FAQ",permalink:"/notes/tags/faq"}],version:"current",lastUpdatedBy:"wener",lastUpdatedAt:1708697175,formattedLastUpdatedAt:"Feb 23, 2024",frontMatter:{title:"JavaScript \u5e38\u89c1\u95ee\u9898",tags:["FAQ"]},sidebar:"docs",previous:{title:"JS DOM FAQ",permalink:"/notes/web/spec/js-dom-faq"},next:{title:"Messaging",permalink:"/notes/web/spec/messaging"}},o={},a=[{value:"\u5185\u5b58\u6cc4\u9732",id:"\u5185\u5b58\u6cc4\u9732",level:2},{value:"Membrane",id:"membrane",level:2},{value:"Date.toJSON include timezone",id:"datetojson-include-timezone",level:2},{value:"tbody to array",id:"tbody-to-array",level:2},{value:"NaN self compare",id:"nan-self-compare",level:2},{value:"Primitive vs Object",id:"primitive-vs-object",level:2},{value:"substr vs substring",id:"substr-vs-substring",level:2},{value:"Performance",id:"performance",level:2},{value:"TypeError: Function.prototype.toString requires that &#39;this&#39; be a Function",id:"typeerror-functionprototypetostring-requires-that-this-be-a-function",level:2},{value:"Object.create(null)",id:"objectcreatenull",level:2},{value:"ArrayBuffer vs Blob",id:"arraybuffer-vs-blob",level:2},{value:"Promise.race vs Promise.any vs Promise.allS vs Promise.allSettled",id:"promiserace-vs-promiseany-vs-promisealls-vs-promiseallsettled",level:2}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.M)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"javascript-\u5e38\u89c1\u95ee\u9898",children:"JavaScript \u5e38\u89c1\u95ee\u9898"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Promise \u5728\u521b\u5efa\u65f6\u4fbf\u4f1a\u8bf7\u6c42\uff0c\u800c\u4e0d\u662f\u5728 then \u65f6\u8bf7\u6c42 - eager eval"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"\u5185\u5b58\u6cc4\u9732",children:"\u5185\u5b58\u6cc4\u9732"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u5e38\u89c1\u573a\u666f\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"\u5168\u5c40\u53d8\u91cf"}),"\n",(0,s.jsx)(n.li,{children:"\u95ed\u5305"}),"\n",(0,s.jsx)(n.li,{children:"DOM"}),"\n",(0,s.jsx)(n.li,{children:"\u5b9a\u65f6\u5668"}),"\n",(0,s.jsx)(n.li,{children:"EventListener"}),"\n",(0,s.jsx)(n.li,{children:"console.log"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"membrane",children:"Membrane"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"isolate two object graphs"}),"\n",(0,s.jsx)(n.li,{children:"\u5f71\u54cd\u5b9e\u73b0\u7684 GC \u903b\u8f91"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/ajvincent/es-membrane",children:"ajvincent/es-membrane"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/salesforce/observable-membrane",children:"salesforce/observable-membrane"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/privacycg/js-membranes",children:"privacycg/js-membranes"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://tvcutsem.github.io/js-membranes",children:"https://tvcutsem.github.io/js-membranes"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://tvcutsem.github.io/membranes",children:"https://tvcutsem.github.io/membranes"})}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"datetojson-include-timezone",children:"Date.toJSON include timezone"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"// \u9ed8\u8ba4 toJSON \u4e3a UTC\nconst now = new Date(2021, 12, 12, 0, 0, 0);\n// now.getTimezoneOffset() // local timezone offset\nconsole.assert(now.toJSON() === now.toISOString());\nJSON.stringify({ now });\n\nDate.prototype.toJSON = function () {\n  // return moment(this).format();\n  // return format(new Date(2016, 0, 1), \"yyyy-MM-dd'T'HH:mm:ss.SSSxxx\") // date-fns\n  return dayjs(this).format();\n};\n"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"method"}),(0,s.jsx)(n.th,{children:"format"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"now.toJSON()"}),(0,s.jsx)(n.td,{children:"2022-01-11T16:00:00.000Z"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"moment(now).format()"}),(0,s.jsx)(n.td,{children:"2022-01-12T00:00:00+08:00"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"dayjs(now).format()"}),(0,s.jsx)(n.td,{children:"2022-01-12T00:00:00+08:00"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"date-fns format(now, \"yyyy-MM-dd'T'HH:mm:ss.SSSxxx\")"}),(0,s.jsx)(n.td,{children:"2022-01-12T00:00:00.000+08:00"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"tbody-to-array",children:"tbody to array"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"Array.prototype.map.call($0.querySelectorAll('tr'), ($tr) =>\n  Array.prototype.map.call($tr.querySelectorAll('td'), ($td) => $td.innerText),\n);\n"})}),"\n",(0,s.jsx)(n.h2,{id:"nan-self-compare",children:"NaN self compare"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const a = Number('a');\nconsole.log(a === a); // false\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/FormidableLabs/react-fast-compare/blob/d42bfe0b02de1e52023a7f94a074d356270718a7/index.js#L114",children:"https://github.com/FormidableLabs/react-fast-compare/blob/d42bfe0b02de1e52023a7f94a074d356270718a7/index.js#L114"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://eslint.org/docs/latest/rules/no-self-compare",children:"https://eslint.org/docs/latest/rules/no-self-compare"})}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"primitive-vs-object",children:"Primitive vs Object"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Glossary/Primitive",children:"Primitive"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"primitive value, primitive data type"}),"\n",(0,s.jsxs)(n.li,{children:["\u4e0d\u662f\u5bf9\u8c61\uff0c\u6ca1\u6709\u65b9\u6cd5\uff0c",(0,s.jsx)(n.strong,{children:"\u4e0d\u53ef\u53d8"})]}),"\n",(0,s.jsx)(n.li,{children:"7 \u79cd\u7c7b\u578b - string, number, bigint, boolean, undefined, symbol, null"}),"\n",(0,s.jsx)(n.li,{children:"\u9664\u4e86 null \u548c undefined \u90fd\u6709\u5c01\u88c5\u7c7b\u578b - String, Number, BigInt, Boolean, Symbol"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Object\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u975e Primitive"}),"\n",(0,s.jsx)(n.li,{children:"\u96c6\u6210\u81ea Object.prototype"}),"\n",(0,s.jsx)(n.li,{children:"Object.create(null)"}),"\n",(0,s.jsxs)(n.li,{children:["JS \u4e2d ",(0,s.jsx)(n.strong,{children:"\u6570\u7ec4\u4e3a\u5bf9\u8c61"})]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["typeof\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u4f1a\u8fd4\u56de function, undefined, object, string, number, boolean, bigint, symbol"}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"typeof null"})," \u4f1a\u8fd4\u56de ",(0,s.jsx)(n.code,{children:"object"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"// \u6700\u7b80\u5355\u76f4\u63a5\u5224\u65ad\ntypeof obj === 'object' && obj !== null;\n\n// \u5224\u65ad\u662f\u5426\u4e3a\u5bf9\u8c61 - \u975e Prim\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object\nfunction isObject(obj) {\n  return obj === Object(obj);\n}\n\n// \u5728 Object.prototype, Object.create(null) \u8fd4\u56de false\nval instanceof Object;\n// null \u8fd4\u56de true\ntypeof val === 'object';\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u53c2\u8003\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u6027\u80fd\u5bf9\u6bd4 ",(0,s.jsx)(n.a,{href:"https://jsbench.me/epk80dx8xr/1",children:"typeof vs Object()"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"typeof \u66f4\u5feb"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"substr-vs-substring",children:"substr vs substring"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/substr",children:"substr"}),(0,s.jsx)(n.code,{children:"(startPos, newLen)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u5e9f\u5f03"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"substring(startPos, endPos)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"substr(startPos, newLen)"})," -> ",(0,s.jsx)(n.code,{children:"substring(startPos, startPos+newLen)"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"performance",children:"Performance"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://mathiasbynens.be/notes/shapes-ics",children:"JavaScript engine fundamentals: Shapes and Inline Caches"})}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"typeerror-functionprototypetostring-requires-that-this-be-a-function",children:"TypeError: Function.prototype.toString requires that 'this' be a Function"}),"\n",(0,s.jsx)(n.p,{children:"Function.prototype.toString \u65b9\u6cd5\u4e2d this \u4e0d\u662f\u51fd\u6570\u5219\u4f1a\u5f02\u5e38\u3002"}),"\n",(0,s.jsx)(n.h2,{id:"objectcreatenull",children:"Object.create(null)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"{}"})," \u540c ",(0,s.jsx)(n.code,{children:"Object.create(Object.prototype)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u7ee7\u627f Object"}),"\n",(0,s.jsx)(n.li,{children:"hasOwnProperty"}),"\n",(0,s.jsx)(n.li,{children:"isPrototypeOf"}),"\n",(0,s.jsx)(n.li,{children:"propertyIsEnumerable"}),"\n",(0,s.jsx)(n.li,{children:"toString/toLocaleString"}),"\n",(0,s.jsx)(n.li,{children:"valueOf"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Object.create(null)"})," - \u4e0d\u7ee7\u627f\u4efb\u4f55\u65b9\u6cd5\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u4f5c\u4e3a Map \u4f7f\u7528"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"console.assert(!Object.create(null).hasOwnProperty); // \u4e0d\u5b58\u5728\nconsole.assert({}.hasOwnProperty); // \u5b58\u5728\n\nString({}); // \u6709 toString \u65b9\u6cd5\nString(Object.create(null)); // \u5931\u8d25 - \u4e0d\u53ef\u4ee5\u8f6c string\n// throws error: Cannot convert object to primitive value\n"})}),"\n",(0,s.jsx)(n.h2,{id:"arraybuffer-vs-blob",children:"ArrayBuffer vs Blob"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["ArrayBuffer\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u901a\u7528\u6570\u636e - \u5185\u5b58"}),"\n",(0,s.jsx)(n.li,{children:"\u901a\u8fc7 DataView/TypedArray \u53ef\u64cd\u4f5c"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Blob\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u7c7b\u4f3c\u6587\u4ef6 - \u53ef\u80fd\u5728\u78c1\u76d8"}),"\n",(0,s.jsx)(n.li,{children:"\u4e0d\u53ef\u53d8"}),"\n",(0,s.jsxs)(n.li,{children:["\u53ef\u521b\u5efa URL - ",(0,s.jsx)(n.code,{children:"window.URL.createObjectURL()"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Blob -> ArrayBuffer\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"FileReader.readAsArrayBuffer()"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["ArrayBuffer -> Blob\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"new Blob(arrayBuffer)"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"promiserace-vs-promiseany-vs-promisealls-vs-promiseallsettled",children:"Promise.race vs Promise.any vs Promise.allS vs Promise.allSettled"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\u5b8c\u6210/fulfilled = resolve or reject"}),"\n"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Promise.race\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u4efb\u610f\u4e00\u4e2a Promise \u6210\u529f/resolve or \u5931\u8d25/reject"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Promise.any\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u4efb\u610f\u4e00\u4e2a Promise \u6210\u529f"}),"\n",(0,s.jsx)(n.li,{children:"\u6240\u6709\u5931\u8d25\u8fd4\u56de AggregateError"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Promise.all\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u6240\u6709 Promise \u6210\u529f"}),"\n",(0,s.jsx)(n.li,{children:"\u4e00\u4e2a\u5931\u8d25\u5219\u8fd4\u56de\u5931\u8d25"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Promise.allSettled\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u6240\u6709 Promise \u5b8c\u6210/fulfilled"}),"\n",(0,s.jsx)(n.li,{children:"\u4e0d\u533a\u5206\u6210\u529f\u5931\u8d25"}),"\n",(0,s.jsx)(n.li,{children:"\u8fd4\u56de\u6240\u6709\u7ed3\u679c"}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"{status:'reject'|'resolve',reason}"})}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.M)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},38088:(e,n,r)=>{var s=r(96651),l=Symbol.for("react.element"),t=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,c=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function a(e,n,r){var s,t={},a=null,d=null;for(s in void 0!==r&&(a=""+r),void 0!==n.key&&(a=""+n.key),void 0!==n.ref&&(d=n.ref),n)i.call(n,s)&&!o.hasOwnProperty(s)&&(t[s]=n[s]);if(e&&e.defaultProps)for(s in n=e.defaultProps)void 0===t[s]&&(t[s]=n[s]);return{$$typeof:l,type:e,key:a,ref:d,props:t,_owner:c.current}}n.Fragment=t,n.jsx=a,n.jsxs=a},2488:(e,n,r)=>{e.exports=r(38088)},62780:(e,n,r)=>{r.d(n,{I:()=>c,M:()=>i});var s=r(96651);const l={},t=s.createContext(l);function i(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:i(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);