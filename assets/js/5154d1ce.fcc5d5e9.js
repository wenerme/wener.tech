/*! For license information please see 5154d1ce.fcc5d5e9.js.LICENSE.txt */
"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[6304],{30320:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>r,metadata:()=>s,toc:()=>c});var i=t(2488),a=t(62780);const r={title:"Guava"},o="Gauva",s={id:"java/lib/guava",title:"Guava",description:"- google/guava",source:"@site/../notes/java/lib/guava.md",sourceDirName:"java/lib",slug:"/java/lib/guava",permalink:"/notes/java/lib/guava",draft:!1,unlisted:!1,editUrl:"https://github.com/wenerme/wener/edit/master/notes/../notes/java/lib/guava.md",tags:[],version:"current",lastUpdatedBy:"wener",lastUpdatedAt:1678678348,formattedLastUpdatedAt:"Mar 13, 2023",frontMatter:{title:"Guava"},sidebar:"docs",previous:{title:"Flyway",permalink:"/notes/java/lib/flyway"},next:{title:"Guice",permalink:"/notes/java/lib/guice"}},l={},c=[{value:"TypeToken",id:"typetoken",level:2},{value:"Immutable",id:"immutable",level:2}];function u(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",pre:"pre",ul:"ul",...(0,a.M)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"gauva",children:"Gauva"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/google/guava",children:"google/guava"})}),"\n"]}),"\n",(0,i.jsx)(n.h1,{id:"performance",children:"Performance"}),"\n",(0,i.jsx)(n.h2,{id:"typetoken",children:"TypeToken"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u5bf9\u6027\u80fd\u6709\u4e00\u5b9a\u5f71\u54cd, \u8c28\u614e\u4f7f\u7528"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Benchmark                       Mode  Cnt     Score     Error  Units\nBenchTypeToken.generic          avgt   10     4.001 \xb1   0.197  ns/op\nBenchTypeToken.typeTokenString  avgt   10   973.403 \xb1  13.519  ns/op\nBenchTypeToken.typeTokenTwo     avgt   10  3289.355 \xb1 134.182  ns/op\nBenchTypeToken.typeTokenVoid    avgt   10  1019.551 \xb1  43.565  ns/op\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'@State(Scope.Thread)\n@OutputTimeUnit(TimeUnit.NANOSECONDS)\n@Warmup(iterations = 4)\n@Measurement(iterations = 10)\n@BenchmarkMode(Mode.AverageTime)\npublic class BenchTypeToken {\n  public static void main(String[] args) throws RunnerException {\n    Options options =\n        new OptionsBuilder()\n            .include(BenchTypeToken.class.getSimpleName())\n            .threads(1)\n            .forks(1)\n            .shouldFailOnError(true)\n            .shouldDoGC(true)\n            .jvmArgs("-server")\n            .measurementTime(TimeValue.seconds(2))\n            .build();\n    new Runner(options).run();\n  }\n\n  @Benchmark\n  public void typeTokenString(Blackhole bh) {\n    bh.consume(new ATyped());\n  }\n\n  @Benchmark\n  public void typeTokenVoid(Blackhole bh) {\n    bh.consume(new ATyped());\n  }\n\n  @Benchmark\n  public void typeTokenTwo(Blackhole bh) {\n    bh.consume(new ATyped2());\n  }\n\n  @Benchmark\n  public void generic(Blackhole bh) {\n    bh.consume(new AGen());\n  }\n\n  static class ATyped extends TypedImpl<Void> {}\n\n  static class ATypedS extends TypedImpl<String> {}\n\n  static class ATyped2 extends TypedImpl2<Void, Void> {}\n\n  static class AGen extends GenImpl<Void> {}\n\n  @Getter\n  @Setter\n  static class TypedImpl<IN> {\n\n    private final TypeToken<IN> in = new TypeToken<IN>(getClass()) {};\n  }\n\n  @Getter\n  @Setter\n  static class TypedImpl2<IN, OUT> {\n\n    private final TypeToken<IN> in = new TypeToken<IN>(getClass()) {};\n    private final TypeToken<OUT> out = new TypeToken<OUT>(getClass()) {};\n  }\n\n  @Getter\n  @Setter\n  static class GenImpl<IN> {}\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"immutable",children:"Immutable"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u6bd4\u6b63\u5e38\u7684\u6027\u80fd\u7a0d\u5fae\u597d\u4e00\u70b9\u70b9"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Benchmark                     Mode  Cnt     Score     Error  Units\nBenchImmutable.immutableList  avgt   10  4288.096 \xb1  97.184  ns/op\nBenchImmutable.immutableMap   avgt   10  7922.092 \xb1 368.066  ns/op\nBenchImmutable.list           avgt   10  4739.961 \xb1 131.327  ns/op\nBenchImmutable.map            avgt   10  8779.917 \xb1 498.843  ns/op\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'@State(Scope.Thread)\n@OutputTimeUnit(TimeUnit.NANOSECONDS)\n@Warmup(iterations = 4)\n@Measurement(iterations = 10)\n@BenchmarkMode(Mode.AverageTime)\npublic class BenchImmutable {\n  public static void main(String[] args) throws RunnerException {\n    Options options =\n        new OptionsBuilder()\n            .include(BenchImmutable.class.getSimpleName())\n            .threads(1)\n            .forks(1)\n            .shouldFailOnError(true)\n            .shouldDoGC(true)\n            .jvmArgs("-server")\n            .measurementTime(TimeValue.seconds(8))\n            .build();\n    new Runner(options).run();\n  }\n\n  @Benchmark\n  public void list(Blackhole bh) {\n    ArrayList<Integer> list = Lists.newArrayList();\n    for (int i = 0; i < 100; i++) {\n      list.add(i);\n    }\n    for (int i = 0; i < 1000; i++) {\n      bh.consume(list.get(i % 100));\n    }\n  }\n\n  @Benchmark\n  public void immutableList(Blackhole bh) {\n    Builder<Integer> builder = ImmutableList.builder();\n    for (int i = 0; i < 100; i++) {\n      builder.add(i);\n    }\n    ImmutableList<Integer> list = builder.build();\n    for (int i = 0; i < 1000; i++) {\n      bh.consume(list.get(i % 100));\n    }\n  }\n\n  @Benchmark\n  public void map(Blackhole bh) {\n    HashMap<Integer, Integer> map = Maps.newHashMap();\n\n    for (int i = 0; i < 100; i++) {\n      map.put(i, i);\n    }\n    for (int i = 0; i < 1000; i++) {\n      bh.consume(map.get(i % 100));\n    }\n  }\n\n  @Benchmark\n  public void immutableMap(Blackhole bh) {\n    ImmutableMap.Builder<Integer, Integer> builder = ImmutableMap.builder();\n\n    for (int i = 0; i < 100; i++) {\n      builder.put(i, i);\n    }\n    ImmutableMap<Integer, Integer> map = builder.build();\n    for (int i = 0; i < 1000; i++) {\n      bh.consume(map.get(i % 100));\n    }\n  }\n}\n'})})]})}function p(e={}){const{wrapper:n}={...(0,a.M)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(u,{...e})}):u(e)}},38088:(e,n,t)=>{var i=t(96651),a=Symbol.for("react.element"),r=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,s=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,n,t){var i,r={},c=null,u=null;for(i in void 0!==t&&(c=""+t),void 0!==n.key&&(c=""+n.key),void 0!==n.ref&&(u=n.ref),n)o.call(n,i)&&!l.hasOwnProperty(i)&&(r[i]=n[i]);if(e&&e.defaultProps)for(i in n=e.defaultProps)void 0===r[i]&&(r[i]=n[i]);return{$$typeof:a,type:e,key:c,ref:u,props:r,_owner:s.current}}n.Fragment=r,n.jsx=c,n.jsxs=c},2488:(e,n,t)=>{e.exports=t(38088)},62780:(e,n,t)=>{t.d(n,{I:()=>s,M:()=>o});var i=t(96651);const a={},r=i.createContext(a);function o(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);