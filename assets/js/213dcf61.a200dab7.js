/*! For license information please see 213dcf61.a200dab7.js.LICENSE.txt */
"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[96332],{28504:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>s,metadata:()=>a,toc:()=>d});var l=i(2488),t=i(62780);const s={title:"Gitlab FAQ"},r="Gitlab FAQ",a={id:"service/forge/gitlab/gitlab-faq",title:"Gitlab FAQ",description:"go get \u4e0d\u652f\u6301\u5b50\u7fa4\u7ec4",source:"@site/../notes/service/forge/gitlab/gitlab-faq.md",sourceDirName:"service/forge/gitlab",slug:"/service/forge/gitlab/faq",permalink:"/notes/service/forge/gitlab/faq",draft:!1,unlisted:!1,editUrl:"https://github.com/wenerme/wener/edit/master/notes/../notes/service/forge/gitlab/gitlab-faq.md",tags:[],version:"current",lastUpdatedBy:"wener",lastUpdatedAt:1668846252,formattedLastUpdatedAt:"Nov 19, 2022",frontMatter:{title:"Gitlab FAQ"},sidebar:"docs",previous:{title:"GitLab\u914d\u7f6e",permalink:"/notes/service/forge/gitlab/config"},next:{title:"Gitlab Get Started",permalink:"/notes/service/forge/gitlab/get-started"}},c={},d=[{value:"go get \u4e0d\u652f\u6301\u5b50\u7fa4\u7ec4",id:"go-get-\u4e0d\u652f\u6301\u5b50\u7fa4\u7ec4",level:2},{value:"badage",id:"badage",level:2},{value:"\u8986\u76d6\u5ea6",id:"\u8986\u76d6\u5ea6",level:2},{value:"\u8986\u76d6\u53ef\u89c6\u5316",id:"\u8986\u76d6\u53ef\u89c6\u5316",level:2},{value:"\u624b\u52a8\u89e6\u53d1\u90e8\u7f72",id:"\u624b\u52a8\u89e6\u53d1\u90e8\u7f72",level:2},{value:"2FA SSH \u751f\u6210\u6062\u590d\u7801",id:"2fa-ssh-\u751f\u6210\u6062\u590d\u7801",level:2},{value:"gitlab runner \u7f13\u5b58\u8017\u65f6\u957f",id:"gitlab-runner-\u7f13\u5b58\u8017\u65f6\u957f",level:2},{value:"Docker build cache",id:"docker-build-cache",level:2},{value:"RBAC",id:"rbac",level:2},{value:"pipeline failed due to the user not being verified",id:"pipeline-failed-due-to-the-user-not-being-verified",level:2}];function o(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.M)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.h1,{id:"gitlab-faq",children:"Gitlab FAQ"}),"\n",(0,l.jsx)(n.h2,{id:"go-get-\u4e0d\u652f\u6301\u5b50\u7fa4\u7ec4",children:"go get \u4e0d\u652f\u6301\u5b50\u7fa4\u7ec4"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'# \u4f1a\u6307\u5411 gitlab.com/random/xyz \u800c\u4e0d\u662f gitlab.com/random/xyz/something\ncurl "https://gitlab.com/random/xyz/something?go-get=1"\n'})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["go get \u80fd\u8bc6\u522b gitlab.com/random/xyz/something.git\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u4f46\u8981\u6c42 module \u540d\u5b57\u4e5f\u5f97\u5339\u914d"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\u53ef\u4ee5\u4f7f\u7528 deploy token + .netrc \u6dfb\u52a0 auth\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u4f46\u65e0\u6cd5\u7ed5\u5f00 ssh \u7684\u95ee\u9898"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\u53c2\u8003\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://gitlab.com/gitlab-org/gitlab/-/issues/196007",children:"https://gitlab.com/gitlab-org/gitlab/-/issues/196007"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://gitlab.com/gitlab-org/gitlab-foss/-/issues/30785",children:"https://gitlab.com/gitlab-org/gitlab-foss/-/issues/30785"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/golang/go/issues/34094",children:"https://github.com/golang/go/issues/34094"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"badage",children:"badage"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"https://gitlab.com/%{project_path}/badges/%{default_branch}/pipeline.svg"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"/pipeline.svg"}),"\n",(0,l.jsx)(n.li,{children:"/coverage.svg"}),"\n",(0,l.jsx)(n.li,{children:"style=flat-square,flat"}),"\n",(0,l.jsx)(n.li,{children:"job=karma&key_text=Frontend+Coverage&key_width=130"}),"\n",(0,l.jsx)(n.li,{children:"\u53ef\u80fd\u72b6\u6001 pending, running, passed, failed, skipped, canceled, unknown"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://docs.gitlab.com/ee/ci/pipelines/settings.html#pipeline-status-badge",children:"Pipeline status badge"})}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"\u8986\u76d6\u5ea6",children:"\u8986\u76d6\u5ea6"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"CI/CD \u901a\u7528\u8bbe\u7f6e - \u914d\u7f6e\u68c0\u6d4b log \u7684\u89c4\u5219"}),"\n"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"tool"}),(0,l.jsx)(n.th,{children:"conf"})]})}),(0,l.jsx)(n.tbody,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"go test -cover"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"coverage: \\d+.\\d+% of statements"})})]})})]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://docs.gitlab.com/ee/ci/pipelines/settings.html#test-coverage-examples",children:"https://docs.gitlab.com/ee/ci/pipelines/settings.html#test-coverage-examples"})}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"\u8986\u76d6\u53ef\u89c6\u5316",children:"\u8986\u76d6\u53ef\u89c6\u5316"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u53ea\u6709\u5728 MR \u53ef\u89c1\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u9700\u8981\u7b49\u5168\u90e8 pipeline \u8dd1\u5b8c\u624d\u53ef\u89c1 ",(0,l.jsx)(n.a,{href:"https://gitlab.com/gitlab-org/gitlab/-/issues/236248",children:"https://gitlab.com/gitlab-org/gitlab/-/issues/236248"})]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://docs.gitlab.com/ee/user/project/merge_requests/test_coverage_visualization.html",children:"https://docs.gitlab.com/ee/user/project/merge_requests/test_coverage_visualization.html"})}),"\n",(0,l.jsxs)(n.li,{children:["\u9700\u8981\u8f93\u51fa\u4e3a ",(0,l.jsx)(n.a,{href:"https://github.com/cobertura/cobertura",children:"cobertura/cobertura"})]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"go install github.com/boumenot/gocover-cobertura@latest\ngocover-cobertura < coverage.txt > coverage.xml\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"test:\n  script:\n    - npm install\n    - npx nyc --reporter cobertura mocha\n  artifacts:\n    reports:\n      cobertura: coverage/cobertura-coverage.xml\n"})}),"\n",(0,l.jsx)(n.h2,{id:"\u624b\u52a8\u89e6\u53d1\u90e8\u7f72",children:"\u624b\u52a8\u89e6\u53d1\u90e8\u7f72"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"deploy:prod:manually:\n  extends:\n    - .deploy\n  when: manual\n"})}),"\n",(0,l.jsx)(n.h2,{id:"2fa-ssh-\u751f\u6210\u6062\u590d\u7801",children:"2FA SSH \u751f\u6210\u6062\u590d\u7801"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"ssh git@gitlab.com 2fa_recovery_codes\n"})}),"\n",(0,l.jsx)(n.h2,{id:"gitlab-runner-\u7f13\u5b58\u8017\u65f6\u957f",children:"gitlab runner \u7f13\u5b58\u8017\u65f6\u957f"}),"\n",(0,l.jsxs)(n.p,{children:["\u4e0d\u7f13\u5b58\uff0c\u4e0d\u505a ",(0,l.jsx)(n.code,{children:"git clean -ffdx"}),"\u3002\u975e\u5e38\u9002\u7528\u4e8e\u5927\u4ed3\u5e93\u6216\u751f\u6210\u975e\u5e38\u591a\u6587\u4ef6\u7684\u65f6\u5019\u3002"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"variables:\n  GIT_STRATEGY: fetch\n  GIT_CLEAN_FLAGS: none\n"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["GIT_CLEAN_FLAGS - GitLab Runner 11.10\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://docs.gitlab.com/ee/ci/yaml/#git-clean-flags",children:"https://docs.gitlab.com/ee/ci/yaml/#git-clean-flags"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://docs.gitlab.com/ee/ci/large_repositories/#git-clean-flags",children:"https://docs.gitlab.com/ee/ci/large_repositories/#git-clean-flags"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://gitlab.com/gitlab-org/gitlab-runner/-/merge_requests/1281",children:"https://gitlab.com/gitlab-org/gitlab-runner/-/merge_requests/1281"})}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\u95ee\u9898\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://gitlab.com/gitlab-org/gitlab-runner/-/issues/280#note_39937930",children:"https://gitlab.com/gitlab-org/gitlab-runner/-/issues/280#note_39937930"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"docker-build-cache",children:"Docker build cache"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"Build:\n  extends: .docker\n  stage: build\n  script:\n    - docker pull $CI_REGISTRY_IMAGE:build || true\n    - >\n      docker build\n      --pull\n      --cache-from $CI_REGISTRY_IMAGE:build\n      --tag build-env\n      -f Dockerfile.build\n      .\n    - docker tag build-env $CI_REGISTRY_IMAGE:build\n    - docker push $CI_REGISTRY_IMAGE:build\n"})}),"\n",(0,l.jsx)(n.h2,{id:"rbac",children:"RBAC"}),"\n",(0,l.jsx)(n.admonition,{type:"caution",children:(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Developer \u9ed8\u8ba4\u4e0d\u53ef\u4ee5\u64cd\u4f5c\u4fdd\u62a4\u5206\u652f\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u53ef\u914d\u7f6e\u5141\u8bb8\u64cd\u4f5c"}),"\n"]}),"\n"]}),"\n"]})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Guest"}),"\n",(0,l.jsx)(n.li,{children:"Reporter"}),"\n",(0,l.jsx)(n.li,{children:"Developer"}),"\n",(0,l.jsx)(n.li,{children:"Maintainer"}),"\n",(0,l.jsx)(n.li,{children:"Owner"}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://docs.gitlab.com/ee/user/permissions.html",children:"https://docs.gitlab.com/ee/user/permissions.html"})}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"pipeline-failed-due-to-the-user-not-being-verified",children:"pipeline failed due to the user not being verified"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u4f7f\u7528\u5171\u4eab Runner\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u9700\u8981\u7528\u6237\u9a8c\u8bc1 - \u8bbe\u7f6e\u4fe1\u7528\u5361\u3001\u4e0d\u4f1a\u6536\u8d39"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\u4f7f\u7528\u81ea\u5df1\u7684 Runner\uff0c\u53ef\u4ee5\u5173\u95ed\u5171\u4eab\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Setting -> CICD -> Runner (Expand) -> disable Shared runner."}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.M)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(o,{...e})}):o(e)}},38088:(e,n,i)=>{var l=i(96651),t=Symbol.for("react.element"),s=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,a=l.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function d(e,n,i){var l,s={},d=null,o=null;for(l in void 0!==i&&(d=""+i),void 0!==n.key&&(d=""+n.key),void 0!==n.ref&&(o=n.ref),n)r.call(n,l)&&!c.hasOwnProperty(l)&&(s[l]=n[l]);if(e&&e.defaultProps)for(l in n=e.defaultProps)void 0===s[l]&&(s[l]=n[l]);return{$$typeof:t,type:e,key:d,ref:o,props:s,_owner:a.current}}n.Fragment=s,n.jsx=d,n.jsxs=d},2488:(e,n,i)=>{e.exports=i(38088)},62780:(e,n,i)=>{i.d(n,{I:()=>a,M:()=>r});var l=i(96651);const t={},s=l.createContext(t);function r(e){const n=l.useContext(s);return l.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),l.createElement(s.Provider,{value:n},e.children)}}}]);