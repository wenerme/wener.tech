/*! For license information please see ba67a9bf.d66d1d44.js.LICENSE.txt */
"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[54912],{11134:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>d});var t=s(11527),l=s(47214);const r={tags:["FAQ"]},a="MySQL FAQ",i={id:"db/relational/mysql/mysql-faq",title:"MySQL FAQ",description:"\u9650\u5236",source:"@site/../notes/db/relational/mysql/mysql-faq.md",sourceDirName:"db/relational/mysql",slug:"/db/relational/mysql/faq",permalink:"/notes/db/relational/mysql/faq",draft:!1,unlisted:!1,editUrl:"https://github.com/wenerme/wener/edit/master/notes/../notes/db/relational/mysql/mysql-faq.md",tags:[{label:"FAQ",permalink:"/notes/tags/faq"}],version:"current",lastUpdatedBy:"wener",lastUpdatedAt:1690946986,formattedLastUpdatedAt:"Aug 2, 2023",frontMatter:{tags:["FAQ"]},sidebar:"docs",previous:{title:"MySQL \u914d\u7f6e",permalink:"/notes/db/relational/mysql/conf"},next:{title:"MySQL GTID",permalink:"/notes/db/relational/mysql/gtid"}},o={},d=[{value:"\u9650\u5236",id:"limits",level:2},{value:"debug connections",id:"debug-connections",level:2},{value:"\u4fee\u6539\u5bc6\u7801",id:"\u4fee\u6539\u5bc6\u7801",level:2},{value:"\u4f30\u7b97\u8868\u5927\u5c0f",id:"\u4f30\u7b97\u8868\u5927\u5c0f",level:2},{value:"Backup",id:"backup",level:2},{value:"Expression of generated column &#39;status&#39; contains a disallowed function: curdate.",id:"expression-of-generated-column-status-contains-a-disallowed-function-curdate",level:2},{value:"\u5220\u9664\u6570\u636e\u4e0d\u4f1a\u91ca\u653e\u7a7a\u95f4",id:"\u5220\u9664\u6570\u636e\u4e0d\u4f1a\u91ca\u653e\u7a7a\u95f4",level:2},{value:"1418",id:"1418",level:2},{value:"dump",id:"dump",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"mysql-faq",children:"MySQL FAQ"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"select version();\n"})}),"\n",(0,t.jsx)(n.h2,{id:"limits",children:"\u9650\u5236"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"bind \u53c2\u6570 65535"}),"\n",(0,t.jsxs)(n.li,{children:["max_prepared_stmt_count=16382\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"\u6700\u5927 prepare \u6570\u91cf"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.li,{children:"4096 \u5217/\u8868"}),"\n",(0,t.jsxs)(n.li,{children:["65,535 byte/row\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"blob \u548c text \u5360\u7528 9-12 byte"}),"\n"]}),"\n"]}),"\n"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{children:"Maximum length"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"TINYTEXT"}),(0,t.jsx)(n.td,{children:"255 (2 8\u22121) bytes"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"TEXT"}),(0,t.jsx)(n.td,{children:"65,535 (216\u22121) bytes = 64 KiB"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"MEDIUMTEXT"}),(0,t.jsx)(n.td,{children:"16,777,215 (224\u22121) bytes = 16 MiB"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"LONGTEXT"}),(0,t.jsx)(n.td,{children:"4,294,967,295 (232\u22121) bytes = 4 GiB"})]})]})]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/column-count-limit.html",children:"https://dev.mysql.com/doc/refman/8.0/en/column-count-limit.html"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/table-size-limit.html",children:"https://dev.mysql.com/doc/refman/8.0/en/table-size-limit.html"})}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"ALTER TABLE tbl_name MAX_ROWS=1000000000 AVG_ROW_LENGTH=nnn;\nSHOW TABLE STATUS FROM db_name LIKE 'tbl_name';\n"})}),"\n",(0,t.jsx)(n.h2,{id:"debug-connections",children:"debug connections"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"-- \u9ed8\u8ba4 151 - 150 \u666e\u901a\u7528\u6237, 1 super\nshow variables like 'max_connections';\nshow status where variable_name = 'threads_connected';\nshow processlist;\n\nselect id,\n       user,\n       host,\n       db,\n       command,\n       time,\n       state,\n       info\nfrom information_schema.processlist\n"})}),"\n",(0,t.jsx)(n.h2,{id:"\u4fee\u6539\u5bc6\u7801",children:"\u4fee\u6539\u5bc6\u7801"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"select user,host from mysql.user;\nselect user,host,db from mysql.db;\n\nALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY 'password';\n\n-- \u5141\u8bb8 root \u8fdc\u7a0b\n-- root@localhost -> root@%\nUPDATE mysql.user SET Host='%' WHERE Host='localhost' AND User='root';\nFLUSH PRIVILEGES;\n\n-- UPDATE mysql.db SET Host='%' WHERE Host='localhost' AND User='username';\n-- GRANT ALL PRIVILEGES ON database_name.* TO 'username'@'localhost';\n-- GRANT ALL PRIVILEGES ON *.* TO 'admin'@'%';\n"})}),"\n",(0,t.jsx)(n.h2,{id:"\u4f30\u7b97\u8868\u5927\u5c0f",children:"\u4f30\u7b97\u8868\u5927\u5c0f"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:'-- \u884c\u6570\nselect table_rows, TABLE_SCHEMA, TABLE_NAME\nfrom information_schema.tables\norder by TABLE_ROWS desc;\n\nselect (DATA_LENGTH / AVG_ROW_LENGTH) as total_rows, TABLE_NAME\nfrom INFORMATION_SCHEMA.TABLES\norder by total_rows desc;\n\n-- \u6570\u636e\u91cf\nselect sys.format_bytes(DATA_LENGTH), TABLE_NAME\nfrom INFORMATION_SCHEMA.TABLES\norder by DATA_LENGTH desc;\n\n-- DB \u5927\u5c0f\nSELECT table_schema                                            "DB Name",\n       ROUND(SUM(data_length + index_length) / 1024 / 1024, 1) "DB Size in MB"\nFROM information_schema.tables\nGROUP BY table_schema;\n'})}),"\n",(0,t.jsx)(n.h2,{id:"backup",children:"Backup"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://dba.stackexchange.com/a/91322/234272",children:"https://dba.stackexchange.com/a/91322/234272"})}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"expression-of-generated-column-status-contains-a-disallowed-function-curdate",children:"Expression of generated column 'status' contains a disallowed function: curdate."}),"\n",(0,t.jsx)(n.p,{children:"MySQL virtual \u5217\u4e0d\u80fd\u7528 CONNECTION_ID(), CURRENT_USER(), NOW()."}),"\n",(0,t.jsx)(n.h2,{id:"\u5220\u9664\u6570\u636e\u4e0d\u4f1a\u91ca\u653e\u7a7a\u95f4",children:"\u5220\u9664\u6570\u636e\u4e0d\u4f1a\u91ca\u653e\u7a7a\u95f4"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"\u9664\u975e\u4f7f\u7528 innodb_file_per_table"}),"\n",(0,t.jsx)(n.li,{children:"optimize table \u4f1a\u51cf\u5c0f .idb, \u4f46\u4e0d\u4f1a\u51cf\u5c0f ibdata1"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"1418",children:"1418"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-txt",children:"1418 - This function has none of DETERMINISTIC, NO SQL, or READS SQL DATA in its declaration and binary logging is enabled (you *might* want to use the less safe log_bin_trust_function_creators variable)\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/stored-programs-logging.html",children:"https://dev.mysql.com/doc/refman/8.0/en/stored-programs-logging.html"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://stackoverflow.com/a/26015334/1870054",children:"https://stackoverflow.com/a/26015334/1870054"})}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"dump",children:"dump"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"mysqldump --single-transaction --routines --triggers --all-databases > MySQLData.sql\n"})})]})}function h(e={}){const{wrapper:n}={...(0,l.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},3354:(e,n,s)=>{var t=s(50959),l=Symbol.for("react.element"),r=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,i=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function d(e,n,s){var t,r={},d=null,c=null;for(t in void 0!==s&&(d=""+s),void 0!==n.key&&(d=""+n.key),void 0!==n.ref&&(c=n.ref),n)a.call(n,t)&&!o.hasOwnProperty(t)&&(r[t]=n[t]);if(e&&e.defaultProps)for(t in n=e.defaultProps)void 0===r[t]&&(r[t]=n[t]);return{$$typeof:l,type:e,key:d,ref:c,props:r,_owner:i.current}}n.Fragment=r,n.jsx=d,n.jsxs=d},11527:(e,n,s)=>{e.exports=s(3354)},47214:(e,n,s)=>{s.d(n,{Z:()=>i,a:()=>a});var t=s(50959);const l={},r=t.createContext(l);function a(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:a(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);