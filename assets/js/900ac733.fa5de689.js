/*! For license information please see 900ac733.fa5de689.js.LICENSE.txt */
"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[36354],{15767:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>i,metadata:()=>c,toc:()=>a});var t=s(11527),d=s(47214);const i={title:"DuckDB"},r="DuckDB",c={id:"db/column/duckdb",title:"DuckDB",description:"- duckdb/duckdb",source:"@site/../notes/db/column/duckdb.md",sourceDirName:"db/column",slug:"/db/column/duckdb",permalink:"/notes/db/column/duckdb",draft:!1,unlisted:!1,editUrl:"https://github.com/wenerme/wener/edit/master/notes/../notes/db/column/duckdb.md",tags:[],version:"current",lastUpdatedBy:"wener",lastUpdatedAt:1700666411,formattedLastUpdatedAt:"Nov 22, 2023",frontMatter:{title:"DuckDB"},sidebar:"docs",previous:{title:"CQL",permalink:"/notes/db/column/cql"},next:{title:"ScyllaDB",permalink:"/notes/db/column/scylladb/"}},l={},a=[{value:"Inspect",id:"inspect",level:2},{value:"extension",id:"extension",level:2},{value:"duckdb vs SQLite3",id:"duckdb-vs-sqlite3",level:2}];function o(n){const e={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",li:"li",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.a)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.h1,{id:"duckdb",children:"DuckDB"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.a,{href:"https://github.com/duckdb/duckdb",children:"duckdb/duckdb"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"MIT, C++"}),"\n",(0,t.jsx)(e.li,{children:"\u5d4c\u5165\u5f0f OLAP \u6570\u636e\u5e93"}),"\n",(0,t.jsx)(e.li,{children:"\u7c7b\u4f3c SQLite - \u4f46\u5217\u5b58\u50a8\uff0c\u9762\u5411\u5206\u6790"}),"\n",(0,t.jsx)(e.li,{children:"\u652f\u6301\u67e5\u8be2 Parquet, CSV"}),"\n",(0,t.jsx)(e.li,{children:"\u5411\u91cf\u5f15\u64ce\uff0c\u5e76\u884c\u67e5\u8be2"}),"\n",(0,t.jsx)(e.li,{children:"\u5b98\u65b9\u652f\u6301 SDK: Python, Java, C++, NodeJS, R"}),"\n",(0,t.jsx)(e.li,{children:"\u8bed\u6cd5\u7c7b\u4f3c pg - \u4f7f\u7528 libpg_query"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\u53c2\u8003\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.a,{href:"https://github.com/duckdb/duckdb-wasm",children:"duckdb/duckdb-wasm"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\u5728 Web \u5185\u6267\u884c\uff0c\u57fa\u4e8e FS API \u8fdb\u884c IO \u4ea4\u4e92"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"https://news.ycombinator.com/item?id=32684424",children:"https://news.ycombinator.com/item?id=32684424"})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"https://h2oai.github.io/db-benchmark/",children:"https://h2oai.github.io/db-benchmark/"})}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.a,{href:"https://github.com/duckdblabs/arrow",children:"duckdblabs/arrow"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Arrow - Python Binding"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.a,{href:"https://github.com/evanwashere/duckdb",children:"evanwashere/duckdb"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"bun binding"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.admonition,{type:"caution",children:(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\u4e0d\u652f\u6301 vacuum ",(0,t.jsx)(e.a,{href:"https://github.com/duckdb/duckdb/issues/109",children:"duckdb#109"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\u53ea\u80fd export \u7136\u540e import \u6765\u51cf\u5c0f\u6587\u4ef6\u4f53\u79ef"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\u4e0d\u80fd\u66f4\u65b0 unique \u5217 ",(0,t.jsx)(e.a,{href:"https://github.com/duckdb/duckdb/issues/5771",children:"#5771"})]}),"\n",(0,t.jsxs)(e.li,{children:["DataGrip Driver ",(0,t.jsx)(e.a,{href:"https://youtrack.jetbrains.com/issue/DBE-15099/Driver-for-DuckDB",children:"DBE-15099/"})]}),"\n"]})}),"\n",(0,t.jsx)(e.admonition,{type:"note",children:(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["upsert 0.6.2\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\u652f\u6301 insert or replace/ignore"}),"\n",(0,t.jsx)(e.li,{children:"\u652f\u6301 on conflict"}),"\n"]}),"\n"]}),"\n"]})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# by Homebre\nbrew install duckdb\n# by Download\ncurl -LO https://ghproxy.com/github.com/duckdb/duckdb/releases/download/v0.8.0/duckdb_cli-osx-universal.zip\nunzip duckdb_cli-osx-universal.zip\n./duckdb\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-sql",children:"SELECT * FROM 'myfile.csv';\nSELECT * FROM 'myfile.parquet';\n\n-- csv, parquet\nSELECT * FROM 'https://domain.tld/file.extension';\n\n-- S3\nSET s3_region='us-east-1';\nSET s3_endpoint='<domain>.<tld>:<port>';\nSET s3_url_style='path';\nSET s3_access_key_id='<AWS access key id>';\nSET s3_secret_access_key='<AWS secret access key>';\nSET s3_session_token='<AWS session token>';\nSELECT * FROM 's3://bucket/file.extension';\n\nSELECT * FROM parquet_scan('s3://bucket/*.parquet');\nSELECT COUNT(*) FROM parquet_scan('s3://bucket/folder*/100?/t[0-9].parquet');\nSELECT * FROM parquet_scan('s3://bucket/*.parquet', FILENAME = 1);\nSELECT * FROM parquet_scan('s3://bucket/*/file.parquet', HIVE_PARTITIONING = 1);\n\n-- s3_uploader_max_parts_per_file, s3_uploader_max_filesize, s3_uploader_thread_limit\nCOPY table_name TO 's3://bucket/file.extension';\n\n-- SQLite\nCALL sqlite_attach('data.db');\nPRAGMA show_tables;\n\n-- PostgreSQL\n-- connect string\nCALL POSTGRES_ATTACH('');\nSELECT * FROM POSTGRES_SCAN('', 'public', 'mytable');\n\n-- CSV\nSELECT * FROM read_csv_auto('test.csv');\n-- HEADER=TRUE\n-- read_csv_auto -> read_csv(AUTO_DETECT=TRUE)\nSELECT * FROM read_csv_auto('test.csv', SAMPLE_SIZE=20000);\n-- \u5bfc\u5165\nCREATE TABLE ontime AS SELECT * FROM read_csv_auto('test.csv');\n-- \u4e5f\u53ef\u4ee5\u5148\u521b\u5efa\u8868\u518d\u901a\u8fc7 COPY \u5bfc\u5165\nCOPY ontime FROM 'test.csv' ( DELIMITER '|', HEADER, AUTO_DETECT TRUE );\n\n-- PARQUET\nSELECT * FROM parquet_scan('test.parquet');\nSELECT * FROM 'test.parquet';\n-- \u591a\u6587\u4ef6\nSELECT * FROM parquet_scan('test/*.parquet');\n-- \u4e0d\u5bfc\u5165\u4f46\u4e5f\u63d0\u4f9b\u67e5\u8be2\nCREATE VIEW people AS SELECT * FROM parquet_scan('test.parquet');\n-- \u5bfc\u5165\u5e26\u538b\u7f29\nCOPY tbl TO 'result-zstd.parquet' (FORMAT 'PARQUET', CODEC 'ZSTD')\n\n-- \u5bfc\u51fa\u8868 - \u53ef\u4ee5 FORMAT PARQUET\nCOPY lineitem TO 'lineitem.tbl' ( DELIMITER '|', HEADER );\nCOPY lineitem(l_orderkey) TO 'orderkey.tbl' ( DELIMITER '|' );\nCOPY (SELECT 42 AS a, 'hello' AS b) TO 'query.csv' WITH (HEADER 1, DELIMITER ',');\n\n-- \u5bfc\u51fa\u6570\u636e\u5e93\n-- \u5bfc\u51fa\u5230\u76ee\u5f55\nEXPORT DATABASE 'target_directory';\n-- \u5bfc\u51fa CSV\nEXPORT DATABASE 'target_directory' (FORMAT CSV, DELIMITER '|');\n-- \u5bfc\u51fa parquet \u683c\u5f0f\nEXPORT DATABASE 'target_directory' (FORMAT PARQUET);\n-- \u5bfc\u5165\nIMPORT DATABASE 'target_directory'\n"})}),"\n",(0,t.jsx)(e.h2,{id:"inspect",children:"Inspect"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-sql",children:"PRAGMA storage_info('table_name');\n\nSELECT * EXCLUDE (column_path, segment_id, start, stats, persistent, block_id, block_offset, has_updates)\nFROM pragma_storage_info('names') USING SAMPLE 10 ROWS\nORDER BY row_group_id;\n"})}),"\n",(0,t.jsx)(e.h2,{id:"extension",children:"extension"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-sql",children:"select * from duckdb_extensions();\n\ninstall 'fts';\nload 'fts';\n\n-- \u4e0b\u8f7d http://extensions.duckdb.org/v0.6.1/osx_amd64/httpfs.duckdb_extension.gz\n-- \u672c\u5730 ~/.duckdb/extensions/v0.6.1/osx_amd64/httpfs.duckdb_extension\ninstall 'httpfs';\nload 'httpfs';\n"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\u4e0d\u652f\u6301\u4ee3\u7406 ",(0,t.jsx)(e.a,{href:"https://github.com/duckdb/duckdb/issues/3836",children:"https://github.com/duckdb/duckdb/issues/3836"})]}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"ver=$(duckdb -version | cut -d ' ' -f 1)\nmkdir -p ~/.duckdb/extensions/$ver/osx_amd64\ncd ~/.duckdb/extensions/$ver/osx_amd64\n\n# https://duckdb.org/docs/extensions/overview\nfor name in httpfs excel fts sqlite_scanner postgres_scanner json parquet jemalloc; do\n  [ -e $name.duckdb_extension ] && continue\n  echo Installing $name\n  curl -LO http://extensions.duckdb.org/$ver/osx_amd64/$name.duckdb_extension.gz\n  gzip -d $name.duckdb_extension.gz\ndone\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-sql",children:"load 'jemalloc';\nload 'json';\nload 'postgres_scanner';\nload 'sqlite_scanner';\n"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["sqlite_scanner\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.code,{children:"sqlite_attach('data.sqlite')"})," - \u521b\u5efa view - \u53ea\u80fd\u67e5 ",(0,t.jsx)(e.strong,{children:"\u4e0d\u80fd\u5199"})]}),"\n",(0,t.jsxs)(e.li,{children:["sqlite_scan - ",(0,t.jsx)(e.code,{children:"SELECT * FROM sqlite_scan('data.sqlite', 'tab');"})," - \u76f4\u63a5\u67e5\u8be2\u5355\u4e2a\u8868"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.li,{children:"wasm"}),"\n",(0,t.jsxs)(e.li,{children:["visualizer\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\u6d4b\u8bd5\u7ed3\u679c -> HTML"}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.code,{children:"pragma visualize_last_profiling_output('__TEST_DIR__/test.html')"})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["sqlsmith\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"SQL \u751f\u6210\u5668\uff0c\u7528\u4e8e\u6d4b\u8bd5"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.li,{children:"tpch"}),"\n",(0,t.jsx)(e.li,{children:"tpcds"}),"\n"]}),"\n",(0,t.jsx)(e.h1,{id:"faq",children:"FAQ"}),"\n",(0,t.jsx)(e.h2,{id:"duckdb-vs-sqlite3",children:"duckdb vs SQLite3"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,t.jsxs)(e.table,{children:[(0,t.jsx)(e.thead,{children:(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.th,{children:"-"}),(0,t.jsx)(e.th,{children:"duckdb"}),(0,t.jsx)(e.th,{children:"SQLite"})]})}),(0,t.jsxs)(e.tbody,{children:[(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Since"}),(0,t.jsx)(e.td,{children:"2018"}),(0,t.jsx)(e.td,{children:"2000-08-17"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"\u67b6\u6784"}),(0,t.jsx)(e.td,{children:"\u5217\u5b58"}),(0,t.jsx)(e.td,{children:"\u884c\u5b58"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"\u573a\u666f"}),(0,t.jsx)(e.td,{children:"OLAP"}),(0,t.jsx)(e.td,{children:"OLTP"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"\u8bed\u8a00"}),(0,t.jsx)(e.td,{children:"C++"}),(0,t.jsx)(e.td,{children:"C"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"\u591a\u7ebf\u7a0b\u8bbf\u95ee"}),(0,t.jsx)(e.td,{children:"\u274c"}),(0,t.jsx)(e.td,{children:"\u2705"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"\u751f\u6001"}),(0,t.jsx)(e.td,{children:"\u2b50\ufe0f"}),(0,t.jsx)(e.td,{children:"\u2b50\ufe0f\u2b50\ufe0f\u2b50\ufe0f"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"\u6210\u719f"}),(0,t.jsx)(e.td,{children:"\u2b50\ufe0f"}),(0,t.jsx)(e.td,{children:"\u2b50\ufe0f\u2b50\ufe0f\u2b50\ufe0f"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"\u5e76\u53d1"}),(0,t.jsx)(e.td,{children:"MVCC"}),(0,t.jsx)(e.td,{children:"fs lock"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Native JSON"}),(0,t.jsx)(e.td,{children:"\u2705"}),(0,t.jsx)(e.td,{children:"\u274c"})]})]})]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"https://duckdb.org/why_duckdb.html",children:"https://duckdb.org/why_duckdb.html"})}),"\n"]})]})}function h(n={}){const{wrapper:e}={...(0,d.a)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(o,{...n})}):o(n)}},3354:(n,e,s)=>{var t=s(50959),d=Symbol.for("react.element"),i=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,c=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function a(n,e,s){var t,i={},a=null,o=null;for(t in void 0!==s&&(a=""+s),void 0!==e.key&&(a=""+e.key),void 0!==e.ref&&(o=e.ref),e)r.call(e,t)&&!l.hasOwnProperty(t)&&(i[t]=e[t]);if(n&&n.defaultProps)for(t in e=n.defaultProps)void 0===i[t]&&(i[t]=e[t]);return{$$typeof:d,type:n,key:a,ref:o,props:i,_owner:c.current}}e.Fragment=i,e.jsx=a,e.jsxs=a},11527:(n,e,s)=>{n.exports=s(3354)},47214:(n,e,s)=>{s.d(e,{Z:()=>c,a:()=>r});var t=s(50959);const d={},i=t.createContext(d);function r(n){const e=t.useContext(i);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(d):n.components||d:r(n.components),t.createElement(i.Provider,{value:e},n.children)}}}]);