/*! For license information please see 5da798c5.6339c672.js.LICENSE.txt */
"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[88140],{70456:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>r,metadata:()=>l,toc:()=>a});var s=t(2488),i=t(62780);const r={title:"zod"},o="zod",l={id:"web/script/lib/zod",title:"zod",description:"- colinhacks/zod",source:"@site/../notes/web/script/lib/zod.md",sourceDirName:"web/script/lib",slug:"/web/script/lib/zod",permalink:"/notes/web/script/lib/zod",draft:!1,unlisted:!1,editUrl:"https://github.com/wenerme/wener/edit/master/notes/../notes/web/script/lib/zod.md",tags:[],version:"current",lastUpdatedBy:"wener",lastUpdatedAt:1708697175,formattedLastUpdatedAt:"Feb 23, 2024",frontMatter:{title:"zod"},sidebar:"docs",previous:{title:"typebox",permalink:"/notes/web/script/lib/typebox"},next:{title:"Polyfill",permalink:"/notes/web/script/polyfill"}},c={},a=[{value:"openapi",id:"openapi",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",li:"li",pre:"pre",ul:"ul",...(0,i.M)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"zod",children:"zod"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://github.com/colinhacks/zod",children:"colinhacks/zod"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["adpoted by: ",(0,s.jsx)(n.a,{href:"/notes/web/script/lib/trpc",children:"tRPC"})]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\u53c2\u8003\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://zod.dev/",children:"zod.dev"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/StefanTerdell/zod-to-json-schema",children:"StefanTerdell/zod-to-json-schema"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/fabien0102/ts-to-zod",children:"fabien0102/ts-to-zod"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/asteasolutions/zod-to-openapi",children:"asteasolutions/zod-to-openapi"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://github.com/Effect-TS/schema",children:"Effect-TS/schema"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u6709\u70b9\u7c7b\u4f3c Typebox \u5b9a\u4e49 schema \u7684\u611f\u89c9"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["parse \u4f1a\u8fd4\u56de clone \u7684\u5bf9\u8c61\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u6240\u4ee5\u6027\u80fd\u4f1a\u5dee\u4e00\u70b9 ",(0,s.jsx)(n.a,{href:"https://github.com/colinhacks/zod/issues/205",children:"#205"})]}),"\n",(0,s.jsxs)(n.li,{children:["\u4f7f\u7528 proxy \u5bf9\u8c61\u65f6\u9700\u8981\u6ce8\u610f\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u4f8b\u5982\u4e0d\u80fd\u914d\u5408 immer\u3001valtio \u4f7f\u7528"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/colinhacks/zod/issues/1769",children:"#1769"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://github.com/colinhacks/zod/discussions/2030",children:"#2030"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Serialize"}),"\n",(0,s.jsx)(n.li,{children:"Serialize \u63a8\u8350 JSONSchema - \u51cf\u5c11\u90e8\u5206\u6821\u9a8c\uff0c\u4f46\u80fd\u7528\u5230\u66f4\u591a\u573a\u666f"}),"\n"]}),"\n"]}),"\n"]})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u6821\u9a8c\u5408\u6cd5 JSON \u5bf9\u8c61\nconst LiteralSchema = z.union([z.string(), z.number(), z.boolean(), z.null()]);\ntype Literal = z.infer<typeof LiteralSchema>;\ntype Json = Literal | { [key: string]: Json } | Json[];\nconst JsonSchema: z.ZodType<Json> = z.lazy(() => z.union([LiteralSchema, z.array(JsonSchema), z.record(JsonSchema)]));\n"})}),"\n",(0,s.jsx)(n.h2,{id:"openapi",children:"openapi"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/asteasolutions/zod-to-openapi",children:"asteasolutions/zod-to-openapi"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { extendZodWithOpenApi } from '@asteasolutions/zod-to-openapi';\nimport { z } from 'zod';\n\n// \u589e\u52a0 openapi \u65b9\u6cd5\nextendZodWithOpenApi(z);\n\n// \u652f\u6301\u5b9a\u4e49\u989d\u5916\u6570\u636e\nz.string().openapi({ description: 'Some string' });\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u4f7f\u7528 registry \u5b9a\u4e49\u63a5\u53e3\u65b9\u6cd5"}),"\n",(0,s.jsx)(n.li,{children:"\u901a\u8fc7 schema \u5b9a\u4e49\u7684\u5bf9\u8c61\u9ed8\u8ba4\u4f1a\u5305\u542b\u5728 registry \u4e2d"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { OpenAPIRegistry, OpenApiGeneratorV3 } from '@asteasolutions/zod-to-openapi';\n\nconst registry = new OpenAPIRegistry();\n\n// Registry \u4e5f\u53ef\u4ee5\u5b9a\u4e49 Schema\nconst UserSchema = registry.register(\n  'User',\n  z.object({\n    id: z.string().openapi({ example: '1212121' }),\n    name: z.string().openapi({ example: 'John Doe' }),\n    age: z.number().openapi({ example: 42 }),\n  })\n);\n\n// \u5b9a\u4e49\u63a5\u53e3\nregistry.registerPath({\n  method: 'get',\n  path: '/users/{id}',\n  description: 'Get user data by its id',\n  summary: 'Get a single user',\n  request: {\n    params: z.object({\n      id: z.string().openapi({ example: '1212121' }),\n    }),\n  },\n  responses: {\n    200: {\n      description: 'Object with user data.',\n      content: {\n        'application/json': {\n          schema: UserSchema,\n        },\n      },\n    },\n    204: {\n      description: 'No content - successful operation',\n    },\n  },\n});\n\nconst generator = new OpenApiGeneratorV3(registry.definitions);\n\n// \u751f\u6210\u6587\u6863\ngenerator.generateComponents();\n"})})]})}function p(e={}){const{wrapper:n}={...(0,i.M)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},38088:(e,n,t)=>{var s=t(96651),i=Symbol.for("react.element"),r=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,l=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function a(e,n,t){var s,r={},a=null,d=null;for(s in void 0!==t&&(a=""+t),void 0!==n.key&&(a=""+n.key),void 0!==n.ref&&(d=n.ref),n)o.call(n,s)&&!c.hasOwnProperty(s)&&(r[s]=n[s]);if(e&&e.defaultProps)for(s in n=e.defaultProps)void 0===r[s]&&(r[s]=n[s]);return{$$typeof:i,type:e,key:a,ref:d,props:r,_owner:l.current}}n.Fragment=r,n.jsx=a,n.jsxs=a},2488:(e,n,t)=>{e.exports=t(38088)},62780:(e,n,t)=>{t.d(n,{I:()=>l,M:()=>o});var s=t(96651);const i={},r=s.createContext(i);function o(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);