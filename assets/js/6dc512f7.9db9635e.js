/*! For license information please see 6dc512f7.9db9635e.js.LICENSE.txt */
"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[61800],{75308:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>i,metadata:()=>a,toc:()=>l});var t=r(2488),s=r(62780);const i={title:"strongSwan FAQ",tags:["FAQ"]},o="strongSwan FAQ",a={id:"service/network/vpn/strongswan/strongswan-faq",title:"strongSwan FAQ",description:"no IDi configured, fall back on IP address",source:"@site/../notes/service/network/vpn/strongswan/strongswan-faq.md",sourceDirName:"service/network/vpn/strongswan",slug:"/service/network/vpn/strongswan/faq",permalink:"/notes/service/network/vpn/strongswan/faq",draft:!1,unlisted:!1,editUrl:"https://github.com/wenerme/wener/edit/master/notes/../notes/service/network/vpn/strongswan/strongswan-faq.md",tags:[{label:"FAQ",permalink:"/notes/tags/faq"}],version:"current",lastUpdatedBy:"wener",lastUpdatedAt:1680070123,formattedLastUpdatedAt:"Mar 29, 2023",frontMatter:{title:"strongSwan FAQ",tags:["FAQ"]},sidebar:"docs",previous:{title:"strongSwan Cookbook",permalink:"/notes/service/network/vpn/strongswan/cookbook"},next:{title:"tailscale",permalink:"/notes/service/network/vpn/tailscale"}},c={},l=[{value:"no IDi configured, fall back on IP address",id:"no-idi-configured-fall-back-on-ip-address",level:2},{value:"ipsec.conf \u81ea\u52a8\u91cd\u8fde",id:"ipsecconf-\u81ea\u52a8\u91cd\u8fde",level:2},{value:"peer didn&#39;t accept DH group ECP_256, it requested MODP_2048",id:"peer-didnt-accept-dh-group-ecp_256-it-requested-modp_2048",level:2},{value:"giving up after 5 retransmits",id:"giving-up-after-5-retransmits",level:2},{value:"virtual ip \u603b\u662f\u8fd4\u56de\u540c\u4e00\u4e2a",id:"virtual-ip-\u603b\u662f\u8fd4\u56de\u540c\u4e00\u4e2a",level:2},{value:"\u591a\u4e2a\u5ba2\u6237\u7aef\u8bbf\u95ee\u4f1a\u6389",id:"\u591a\u4e2a\u5ba2\u6237\u7aef\u8bbf\u95ee\u4f1a\u6389",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.M)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"strongswan-faq",children:"strongSwan FAQ"}),"\n",(0,t.jsx)(n.h2,{id:"no-idi-configured-fall-back-on-ip-address",children:"no IDi configured, fall back on IP address"}),"\n",(0,t.jsx)(n.h2,{id:"ipsecconf-\u81ea\u52a8\u91cd\u8fde",children:"ipsec.conf \u81ea\u52a8\u91cd\u8fde"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ini",children:"# \u542f\u52a8\u81ea\u52a8\u542f\u52a8\nauto=start\n\ndpdaction=restart\ncloseaction=restart\nkeyingtries=%forever\n"})}),"\n",(0,t.jsx)(n.h2,{id:"peer-didnt-accept-dh-group-ecp_256-it-requested-modp_2048",children:"peer didn't accept DH group ECP_256, it requested MODP_2048"}),"\n",(0,t.jsx)(n.p,{children:"\u6ce8\u610f\u9009\u62e9 cipher suit, \u5982\u679c\u670d\u52a1\u7aef\u4e0d\u652f\u6301\u5219\u4f1a\u51fa\u73b0\u8be5\u5f02\u5e38"}),"\n",(0,t.jsx)(n.p,{children:"ipsec \u4f7f\u7528 aes128-sha256 AES_CBC_128/HMAC_SHA1_96, \u4f46 swanctl \u4e0d\u4f1a\u4f18\u5148\u5c1d\u8bd5\u3002"}),"\n",(0,t.jsx)(n.p,{children:"\u4e4b\u540e\u4f1a\u4ece\u65b0\u9009\u62e9"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"selected proposal: IKE:AES_CBC_128/HMAC_SHA1_96/PRF_HMAC_SHA1/MODP_2048\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"ipsec.conf \u914d\u7f6e esp \u6216\u8005 ah"}),"\n",(0,t.jsx)(n.li,{children:"swanctl.conf \u914d\u7f6e esp_proposal"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"giving-up-after-5-retransmits",children:"giving up after 5 retransmits"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"12[IKE] establishing IKE_SA failed, peer not responding\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"ipsec.conf"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ini",children:"dpdaction=restart\nretransmit_tries=5\n# default 3\nkeyingtries=%forever\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"swanctl.conf"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"connections {\n  conn {\n    # default 1\n    keyingtries=0\n    children {\n      child {\n        dpd_action=start\n      }\n    }\n  }\n}\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\u53c2\u8003\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://wiki.strongswan.org/issues/2665",children:"https://wiki.strongswan.org/issues/2665"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"virtual-ip-\u603b\u662f\u8fd4\u56de\u540c\u4e00\u4e2a",children:"virtual ip \u603b\u662f\u8fd4\u56de\u540c\u4e00\u4e2a"}),"\n",(0,t.jsx)(n.p,{children:"\u4fee\u6539 id \u4f1a\u8fd4\u56de\u4e0d\u540c ip"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"connections {\n  vpn {\n    remote {\n      id=vpnx\n      auth=psk\n    }\n    local {\n      # \u4f7f\u7528\u4e0d\u540c ID\n      id=vpnx\n      auth=psk\n    }\n  }\n"})}),"\n",(0,t.jsx)(n.h2,{id:"\u591a\u4e2a\u5ba2\u6237\u7aef\u8bbf\u95ee\u4f1a\u6389",children:"\u591a\u4e2a\u5ba2\u6237\u7aef\u8bbf\u95ee\u4f1a\u6389"}),"\n",(0,t.jsx)(n.p,{children:"\u68c0\u67e5\u662f\u4e0d\u662f id \u76f8\u540c\uff0c\u83b7\u53d6\u5230\u7684 vip \u76f8\u540c\uff0c\u5bfc\u81f4\u4e00\u4e2a\u4e0a\u53e6\u5916\u4e00\u4e2a\u4f1a\u88ab\u6324\u4e0b\u53bb\u3002"})]})}function p(e={}){const{wrapper:n}={...(0,s.M)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},38088:(e,n,r)=>{var t=r(96651),s=Symbol.for("react.element"),i=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,n,r){var t,i={},l=null,d=null;for(t in void 0!==r&&(l=""+r),void 0!==n.key&&(l=""+n.key),void 0!==n.ref&&(d=n.ref),n)o.call(n,t)&&!c.hasOwnProperty(t)&&(i[t]=n[t]);if(e&&e.defaultProps)for(t in n=e.defaultProps)void 0===i[t]&&(i[t]=n[t]);return{$$typeof:s,type:e,key:l,ref:d,props:i,_owner:a.current}}n.Fragment=i,n.jsx=l,n.jsxs=l},2488:(e,n,r)=>{e.exports=r(38088)},62780:(e,n,r)=>{r.d(n,{I:()=>a,M:()=>o});var t=r(96651);const s={},i=t.createContext(s);function o(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);