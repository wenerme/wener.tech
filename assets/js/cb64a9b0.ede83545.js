/*! For license information please see cb64a9b0.ede83545.js.LICENSE.txt */
"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[54845],{74931:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>o,contentTitle:()=>s,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>c});var r=a(11527),t=a(47214);const l={title:"Bazel Java"},s="Bazel Java",i={id:"dev/build/bazel/bazel-java",title:"Bazel Java",description:"- _deploy.jar",source:"@site/../notes/dev/build/bazel/bazel-java.md",sourceDirName:"dev/build/bazel",slug:"/dev/build/bazel/java",permalink:"/notes/dev/build/bazel/java",draft:!1,unlisted:!1,editUrl:"https://github.com/wenerme/wener/edit/master/notes/../notes/dev/build/bazel/bazel-java.md",tags:[],version:"current",lastUpdatedBy:"wener",lastUpdatedAt:1642521786,formattedLastUpdatedAt:"Jan 18, 2022",frontMatter:{title:"Bazel Java"},sidebar:"docs",previous:{title:"Brazel Go",permalink:"/notes/dev/build/bazel/go"},next:{title:"Build Awesome",permalink:"/notes/dev/build/awesome"}},o={},c=[{value:"Maven",id:"maven",level:3}];function d(e){const n={a:"a",code:"code",h1:"h1",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"bazel-java",children:"Bazel Java"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"_deploy.jar"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u5305\u542b\u6240\u6709\u4f9d\u8d56"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\u5e94\u7528\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/google/dagger",children:"google/dagger"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/angular/angular/blob/master/BUILD.bazel",children:"angular/angular/BUILD.bazel"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\u53c2\u8003\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://medium.com/wix-engineering/a58a8142c549",children:"How to choose the right build unit granularity"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://medium.com/wix-engineering/be561f455c37",children:"How to Decide on CI Server and remote execution / caching"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/bazelbuild/rules_gwt",children:"bazelbuild/rules_gwt"})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://github.com/johnynek/bazel-deps",children:"johnynek/bazel-deps"})," - Generate bazel dependencies for maven artifacts"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://github.com/wix/exodus",children:"wix/exodus"})," - Easily migrate your JVM code from Maven to Bazel"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"bazel build //:java-maven\n# \u6784\u5efa\u5b8c\u6574\u7684\u5305\uff0c\u5305\u542b\u6240\u6709\u4f9d\u8d56\uff0c\u53ef\u90e8\u7f72\u6267\u884c\nbazel build //:java-maven_deploy.jar\n\n# Maven \u8fc1\u79fb\ngit clone https://github.com/bazelbuild/migration-tooling.git\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-py",children:'# \u5b9a\u4e49\u6267\u884c\u6587\u4ef6\njava_binary(\n    name = "ProjectRunner",\n    srcs = glob(["src/main/java/com/example/ProjectRunner.java"]),\n    # \u4f9d\u8d56\n    deps = [":greeter"],\n    main_class = "com.example.ProjectRunner",\n)\n\n# \u5b9a\u4e49\u5e93\njava_library(\n    name = "greeter",\n    srcs = ["src/main/java/com/example/Greeting.java"],\n    # \u9ed8\u8ba4\u5f53\u524d BUILD \u6587\u4ef6\u53ef\u89c1\n    visibility = ["//src/main/java/com/example/cmdline:__pkg__"],\n)\n'})}),"\n",(0,r.jsx)(n.h3,{id:"maven",children:"Maven"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://github.com/bazelbuild/rules_jvm_external",children:"rules_jvm_external"})," - Java \u6784\u5efa\u5916\u90e8\u4f9d\u8d56\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Maven"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://github.com/google/bazel-common/tree/master/tools/maven",children:"google/bazel-common/maven"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u652f\u6301\u751f\u6210 pom.xml"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u67e5\u770b\u6240\u6709\u4f9d\u8d56\uff0c\u8f93\u51fa\u4e3a BUILD\nbazel query @maven//:all --output=build\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'load("@rules_jvm_external//:defs.bzl", "maven_install", "artifact")\n\nload("@rules_jvm_external//:defs.bzl", "artifact")\n# \u53ef\u4ee5\u4f7f\u7528 artifact("junit:junit") \u800c\u4e0d\u662f @maven//:junit_junit\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"WORKSPACE"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-py",children:'load("@bazel_tools//tools/build_defs/repo:http.bzl", "http_archive")\n\nRULES_JVM_EXTERNAL_TAG = "2.6.1"\nRULES_JVM_EXTERNAL_SHA = "45203b89aaf8b266440c6b33f1678f516a85b3e22552364e7ce6f7c0d7bdc772"\n\n# \u4e0b\u8f7d\u89c4\u5219\u4f9d\u8d56\nhttp_archive(\n    name = "rules_jvm_external",\n    strip_prefix = "rules_jvm_external-%s" % RULES_JVM_EXTERNAL_TAG,\n    sha256 = RULES_JVM_EXTERNAL_SHA,\n    url = "https://github.com/bazelbuild/rules_jvm_external/archive/%s.zip" % RULES_JVM_EXTERNAL_TAG,\n)\n\n# \u5bfc\u5165\nload("@rules_jvm_external//:defs.bzl", "maven_install")\n\n# \u5b9a\u4e49 Maven \u4ed3\u5e93\u548c\u4f7f\u7528\u7684\u5305\nmaven_install(\n    artifacts = [\n        "junit:junit:4.12",\n        "androidx.test.espresso:espresso-core:3.1.1",\n        "org.hamcrest:hamcrest-library:1.3",\n    ],\n    repositories = [\n        # Private repositories are supported through HTTP Basic auth\n        "http://username:password@localhost:8081/artifactory/my-repository",\n        "https://jcenter.bintray.com/",\n        "https://maven.google.com",\n        "https://repo1.maven.org/maven2",\n    ],\n)\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"BUILD"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-py",children:'java_library(\n    name = "java_test_deps",\n    exports = [\n        "@maven//:junit_junit"\n        "@maven//:org_hamcrest_hamcrest_library",\n    ],\n)\n\nandroid_library(\n    name = "android_test_deps",\n    exports = [\n        "@maven//:junit_junit"\n        "@maven//:androidx_test_espresso_espresso_core",\n    ],\n)\n'})})]})}function h(e={}){const{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},3354:(e,n,a)=>{var r=a(50959),t=Symbol.for("react.element"),l=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,i=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function c(e,n,a){var r,l={},c=null,d=null;for(r in void 0!==a&&(c=""+a),void 0!==n.key&&(c=""+n.key),void 0!==n.ref&&(d=n.ref),n)s.call(n,r)&&!o.hasOwnProperty(r)&&(l[r]=n[r]);if(e&&e.defaultProps)for(r in n=e.defaultProps)void 0===l[r]&&(l[r]=n[r]);return{$$typeof:t,type:e,key:c,ref:d,props:l,_owner:i.current}}n.Fragment=l,n.jsx=c,n.jsxs=c},11527:(e,n,a)=>{e.exports=a(3354)},47214:(e,n,a)=>{a.d(n,{Z:()=>i,a:()=>s});var r=a(50959);const t={},l=r.createContext(t);function s(e){const n=r.useContext(l);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),r.createElement(l.Provider,{value:n},e.children)}}}]);