/*! For license information please see 7dda6ef1.c846a19d.js.LICENSE.txt */
"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[77789],{39465:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>p,frontMatter:()=>r,metadata:()=>o,toc:()=>l});var i=t(11527),s=t(47214);const r={title:"bit"},c="bit",o={id:"web/react/bit",title:"bit",description:"bit \u4f1a\u4e3a\u6bcf\u4e2a\u7ec4\u4ef6\u5efa\u7acb git \u201c\u4ed3\u5e93\u201d\uff0c\u7ef4\u62a4\u6bcf\u4e2a\u7ec4\u4ef6\u7684\u751f\u547d\u5468\u671f\u3002",source:"@site/../notes/web/react/bit.md",sourceDirName:"web/react",slug:"/web/react/bit",permalink:"/notes/web/react/bit",draft:!1,unlisted:!1,editUrl:"https://github.com/wenerme/wener/edit/master/notes/../notes/web/react/bit.md",tags:[],version:"current",lastUpdatedBy:"wener",lastUpdatedAt:1655510210,formattedLastUpdatedAt:"Jun 17, 2022",frontMatter:{title:"bit"},sidebar:"docs",previous:{title:"Ant Design",permalink:"/notes/web/react/antd"},next:{title:"BlueprinrJS",permalink:"/notes/web/react/blueprint"}},a={},l=[{value:"bit server",id:"bit-server",level:2},{value:"\u73af\u5883",id:"\u73af\u5883",level:2},{value:"\u5e94\u7528",id:"\u5e94\u7528",level:2},{value:"PKG",id:"pkg",level:2},{value:"\u901a\u8fc7\u4ee3\u7801\u83b7\u53d6\u7ec4\u4ef6\u4fe1\u606f",id:"\u901a\u8fc7\u4ee3\u7801\u83b7\u53d6\u7ec4\u4ef6\u4fe1\u606f",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"bit",children:"bit"}),"\n",(0,i.jsx)(n.p,{children:"bit \u4f1a\u4e3a\u6bcf\u4e2a\u7ec4\u4ef6\u5efa\u7acb git \u201c\u4ed3\u5e93\u201d\uff0c\u7ef4\u62a4\u6bcf\u4e2a\u7ec4\u4ef6\u7684\u751f\u547d\u5468\u671f\u3002"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/teambit/bit",children:"teambit/bit"})}),"\n",(0,i.jsx)(n.li,{children:"BVM - bit version manager"}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"@<owner>/<scope>.<namespace>.<component-name>"})}),"\n",(0,i.jsxs)(n.li,{children:["my-org.my-scope/ui/inputs/button\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"ID: my-org.my-scope/ui/inputs/button"}),"\n",(0,i.jsx)(n.li,{children:"Scope: my-org.my-scope"}),"\n",(0,i.jsx)(n.li,{children:"Name: ui/inputs/button"}),"\n",(0,i.jsxs)(n.li,{children:["Package: ",(0,i.jsx)(n.code,{children:"@my-org/my-scope.ui.inputs.button"})]}),"\n",(0,i.jsx)(n.li,{children:"\u4e00\u822c\u4e3a organization.team - \u4f8b\u5982: teambit.docs"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["bit\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Git \u76f8\u5173: tag, untag, add, untrack, diff, lane, snap, export, import, checkout, artifacts, remote\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"lane = branch"}),"\n",(0,i.jsx)(n.li,{children:"export = push"}),"\n",(0,i.jsx)(n.li,{children:"import = pull"}),"\n",(0,i.jsx)(n.li,{children:".git/bit/scope.json = .git/config"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"pnpm \u76f8\u5173: install, link"}),"\n",(0,i.jsx)(n.li,{children:"scope fork = fork \u4ed3\u5e93"}),"\n",(0,i.jsx)(n.li,{children:"start, compile, test, lint, format, build"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\u53c2\u8003\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/bit-demos/base-ui",children:"bit-demos/base-ui"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{type:"caution",children:(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["react 18 ",(0,i.jsx)(n.a,{href:"https://github.com/teambit/bit/issues/5751",children:"#5751"})]}),"\n"]})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# \u4e0b\u8f7d\u7f13\u5b58 ~/.bvm/temp/bit-0.0.762.tar.gz\n# \u5b89\u88c5\u4f4d\u7f6e \uff5e/.bvm/versions/0.0.762\n# \u975e\u5e38\u5927 - \u7ea6 1.2G node_modules\n# https://bvm.bit.dev/\n# https://bvm.bit.dev/versions/dev/Darwin/0.0.762/bit-0.0.762.tar.gz\nnpx @teambit/bvm install\n\n# \u65b0\u9879\u76ee\n# ==========\n# \u9ed8\u8ba4 \u4f7f\u7528 pnpm\n# bit templates\n# --default-scope my-org.my-scope\nbit new react my-ui\ncd my-ui\nbit start\n\n# my-scope/ui/my-welcome\nbit create react ui/my-welcome              #  \u521b\u5efa\u7ec4\u4ef6\nbit show ui/my-welcome                      # \u67e5\u770b\u7ec4\u4ef6\u72b6\u6001\nbit tag ui/my-welcome -v 1.0.0 -m "initial" # tag \u672c\u5730\u7248\u672c\nbit diff ui/my-welcome                      # \u4fee\u6539\u540e\u53ef\u67e5\u770b\u53d8\u5316\nbit log ui/my-welcome                       # \u5386\u53f2\u4fee\u6539\nbit artifacts ui/my-welcome                 #\u6587\u4ef6\u5185\u5bb9\nbit dependencies ui/my-welcome              # \u67e5\u770b\u7ec4\u4ef6\u4f9d\u8d56\n\n# \u5feb\u7167\u4f1a\u751f\u6210 hash - \u7528\u4e8e\u534f\u4f5c\n# \u672c\u8d28\u7c7b\u4f3c tag\nbit snap ui/my-welcome --message "demo snapshot"\n\n# bit export [collection]\n# bit import\n# bit checkout latest --all\n# bit untag\n\nbit status\n\n# \u5df2\u6709\u9879\u76ee\n# ==========\n# --bare \u7528\u4e8e\u81ea\u5efa server\n# monorepo \u9700\u8981\u5728 root \u4f4d\u7f6e init\nbit init --bare\n\n# \u5e38\u7528\u64cd\u4f5c\n# ==========\nnpx @teambit/bvm upgrade          # \u5347\u7ea7 bit\nbit add src/components/button     # \u6dfb\u52a0\u7ec4\u4ef6\nbit untrack src/components/button #\u53d6\u6d88\u8ddf\u8e2a\u7ec4\u4ef6\n\nbit move ui/my-component design/my-component # \u8c03\u6574\u7ec4\u4ef6\u4f4d\u7f6e\n\nbit eject teambit.design/ui/buttons/button  # \u8c03\u6574\u7ec4\u4ef6\u4ed3\u5e93\nbit import teambit.design/ui/buttons/button # \u5728\u65b0\u7684\u4ed3\u5e93\u5bfc\u5165\n\nbit install "classnames@^2" -u # \u5b89\u88c5\u5347\u7ea7\u4f9d\u8d56\n\n# \u91cd\u547d\u540d\u7ec4\u4ef6\n# --refactor \u4f1a\u8c03\u6574\u73b0\u6709\u4ee3\u7801\nbit rename loaders/skeleton placeholders/skeleton --refactor\n\nbit show ui/my-welcome # \u67e5\u770b\u7ec4\u4ef6\u4fe1\u606f\n# \u83b7\u53d6\u7ec4\u4ef6 \u5143\u4fe1\u606f\n# \u53ef\u4ee5\u662f remote\nbit aspect get my-org.my-scope/ui/my-welcome\n\nbit cat-scope # \u67e5\u770b\u7528\u5230\u7684 scope\nbit insights  # \u5206\u6790\u5faa\u73af\u4f9d\u8d56\nbit env       # \u7ec4\u4ef6\u73af\u5883\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:".bitmap - \u81ea\u52a8\u751f\u6210 - \u7ec4\u4ef6\u5230\u76ee\u5f55\u6620\u5c04"}),"\n",(0,i.jsx)(n.li,{children:"workspace.jsonc"}),"\n",(0,i.jsxs)(n.li,{children:[".git/bit - Local Scope\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"cache,components,objects,scope.json"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",metastring:'title="workspace.jsonc"',children:'{\n  "teambit.workspace/workspace": {\n    "name": "my-ui",\n    // icon: ""\n\n    // <root>/{scope}/{name}/button/index.ts\n    "defaultDirectory": "{scope}/{name}",\n    "defaultScope": "my-org.my-scope"\n  },\n  "teambit.dependencies/dependency-resolver": {\n    "packageManager": "teambit.dependencies/pnpm",\n    "policy": {\n      "dependencies": {},\n      "peerDependencies": {}\n    }\n  },\n  "teambit.workspace/variants": {\n    "{ui/**}": {\n      "teambit.dependencies/dependency-resolver": {\n        "policy": {\n          "dependencies": {\n            "classnames": "^2"\n          }\n        }\n      }\n    }\n  }\n}\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["ui/my-button - \u7ec4\u4ef6\u76ee\u5f55\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"index.tsx - entry"}),"\n",(0,i.jsx)(n.li,{children:"my-button.tsx - main"}),"\n",(0,i.jsx)(n.li,{children:"my-button.spec.tsx - test"}),"\n",(0,i.jsx)(n.li,{children:"my-button.composition.tsx"}),"\n",(0,i.jsx)(n.li,{children:"my-button.docs.mdx"}),"\n",(0,i.jsx)(n.li,{children:"component.json"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://bit.dev/docs/workspace/workspace-json",children:"workspace.jsonc"})}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u6bcf\u4e2a\u7ec4\u4ef6\u90fd\u4f4d\u4e8e\u4e00\u4e2a\u201c\u5c0f\u4ed3\u5e93\u201d\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u56e0\u6b64\u7248\u672c\u548c\u4fee\u6539\u90fd\u662f\u72ec\u7acb\u7684"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["capsules - \u7ec4\u4ef6\u7684\u4e34\u65f6\u5de5\u4f5c\u7a7a\u95f4 - bit build\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"capsules_root_base_dir"}),"\n",(0,i.jsxs)(n.li,{children:["macOS ",(0,i.jsx)(n.code,{children:"~/Library/Caches/Bit/capsules/"})]}),"\n",(0,i.jsxs)(n.li,{children:["Windows ",(0,i.jsx)(n.code,{children:"%LOCALAPPDATA%\\Bit\\capsules\\"})]}),"\n"]}),"\n"]}),"\n"]})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"component.json"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# eject \u540e\u4f1a\u5f97\u5230 component.json\nbit eject-conf ui/my-button\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "componentId": {\n    "name": "ui/button",\n    "version": "0.0.1",\n    "scope": "company.scope"\n  },\n  "propagate": true,\n  "extensions": {\n    "teambit.dependencies/dependency-resolver": {\n      "policy": {\n        "dependencies": {\n          "lodash": "^14.17.21"\n        }\n      }\n    }\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"bit-server",children:"bit server"}),"\n",(0,i.jsx)(n.p,{children:"\u672c\u8d28\u548c git bare \u4ed3\u5e93\u7c7b\u4f3c\uff0c"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker run -it --rm \\\n  -v $PWD/remote-scope:/root/remote-scope \\\n  -p 3030:3000 \\\n  --name bit-server bitcli/bit-server:latest\n\nbit remote add http://localhost:3030\n\n# \u4e0d\u540c scope \u4e4b\u95f4\u4e92\u901a\n# docker exec -it bit-server bit remote add http://192.168.1.110:3000\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"/root/Library/Caches/Bit/logs"}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/teambit/bit/blob/master/scripts/docker-teambit-bit/README.md",children:"scripts/docker-teambit-bit"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/teambit/bit-docker",children:"teambit/bit-docker"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/teambit/bit/discussions/4707",children:"How to self host components and publish to npm"})}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dockerfile",children:"FROM node:12.22.0\nUSER root\n\nRUN npm i @teambit/bvm -g\nRUN bvm upgrade\nENV PATH=$PATH:/root/bin\n\n# increase memory to avoid 137 error code\nENV NODE_OPTIONS=--max_old_space_size=4096\n\nRUN bit config set analytics_reporting false\nRUN bit config set no_warnings false\nRUN bit config set interactive false\nRUN bit config set error_reporting true\n\nARG SCOPE_PATH=/root/remote-scope\nWORKDIR ${SCOPE_PATH}\nRUN bit init --bare\nCMD bit start\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\u73af\u5883",children:"\u73af\u5883"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"builder, generator, compiler, tester, docs, compositions, preview, linter, formatter"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'bit env\nbit env get teambit.react/react\nbit show teambit.react/react\n# \u4fee\u6539\u7ec4\u4ef6 env\nbit env set acme.demo/welcome acme.envs/react\n# \u6279\u91cf\u4fee\u6539\nbit env set "acme.demo/ui/*" acme.envs/react\nbit env replace teambit.react/react acme.envs/react\n\n# \u81ea\u5b9a\u4e49 env\nbit create react-env envs/my-env\n'})}),"\n",(0,i.jsx)(n.h2,{id:"\u5e94\u7528",children:"\u5e94\u7528"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"bit fork learnbit.apps/node-app\nbit app list\nbit run hello-node-app\nbit build company.scope/apps/my-app\nbit tag company.scope/apps/my-app\n"})}),"\n",(0,i.jsx)(n.h2,{id:"pkg",children:"PKG"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u4fee\u6539\u7ec4\u4ef6"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",metastring:'title="component.json"',children:'{\n  "teambit.pkg/pkg": {\n    "packageJson": {\n      "main": "dist/{main}.js"\n    }\n  }\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u4fee\u6539\u5168\u90e8"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "teambit.workspace/variants": {\n    "{ui/*}": {\n      "teambit.pkg/pkg": {\n        "packageJson": {\n          "private": false,\n          "main": "dist/{main}.js",\n          "custom-prop": "value"\n        }\n      }\n    }\n  }\n}\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",metastring:'title="my-env.env.ts"',children:"import { PackageEnv } from '@teambit/envs';\n\nexport class MyEnv implements PackageEnv {\n  getPackageJsonProps() {\n    return {\n      main: 'dist/{main}.js',\n      types: '{main}.ts',\n    };\n  }\n}\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["my-env.main.runtime.ts\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"provider - \u5408\u5e76 pkg"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"\u7ef4\u62a4\u7ec4\u4ef6\u7684 package.json"}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://bit.dev/teambit/pkg/pkg",children:"https://bit.dev/teambit/pkg/pkg"})}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"\u901a\u8fc7\u4ee3\u7801\u83b7\u53d6\u7ec4\u4ef6\u4fe1\u606f",children:"\u901a\u8fc7\u4ee3\u7801\u83b7\u53d6\u7ec4\u4ef6\u4fe1\u606f"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"import { Workspace, WorkspaceAspect } from '@teambit/workspace';\n// ...\nexport class MetadataRetrieval {\n  // ...\n  static dependencies = [WorkspaceAspect];\n  static async provider([workspace]: [Workspace]) {\n    // scope.get(componentId)\n    // component.getHost().get(componentId)\n    const component = await this.workspace.get(componentId);\n    /* retrieve the custom metadata provided by this aspect */\n    const componentCustomMetadata = component.state.aspects.get(MetadataRetrievalAspect.id).data;\n    return new CustomMetadataMain();\n  }\n}\n"})})]})}function p(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},3354:(e,n,t)=>{var i=t(50959),s=Symbol.for("react.element"),r=Symbol.for("react.fragment"),c=Object.prototype.hasOwnProperty,o=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function l(e,n,t){var i,r={},l=null,d=null;for(i in void 0!==t&&(l=""+t),void 0!==n.key&&(l=""+n.key),void 0!==n.ref&&(d=n.ref),n)c.call(n,i)&&!a.hasOwnProperty(i)&&(r[i]=n[i]);if(e&&e.defaultProps)for(i in n=e.defaultProps)void 0===r[i]&&(r[i]=n[i]);return{$$typeof:s,type:e,key:l,ref:d,props:r,_owner:o.current}}n.Fragment=r,n.jsx=l,n.jsxs=l},11527:(e,n,t)=>{e.exports=t(3354)},47214:(e,n,t)=>{t.d(n,{Z:()=>o,a:()=>c});var i=t(50959);const s={},r=i.createContext(s);function c(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);