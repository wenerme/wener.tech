/*! For license information please see 122a75dd.487a57cf.js.LICENSE.txt */
"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[95233],{54725:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>h,frontMatter:()=>i,metadata:()=>l,toc:()=>d});var r=s(11527),t=s(47214);const i={title:"emissary-ingress"},a="emissary-ingress",l={id:"devops/kubernetes/network/emissary-ingress",title:"emissary-ingress",description:"- emissary-ingress/emissary",source:"@site/../notes/devops/kubernetes/network/emissary-ingress.md",sourceDirName:"devops/kubernetes/network",slug:"/devops/kubernetes/network/emissary-ingress",permalink:"/notes/devops/kubernetes/network/emissary-ingress",draft:!1,unlisted:!1,editUrl:"https://github.com/wenerme/wener/edit/master/notes/../notes/devops/kubernetes/network/emissary-ingress.md",tags:[],version:"current",lastUpdatedBy:"wener",lastUpdatedAt:1637477347,formattedLastUpdatedAt:"Nov 21, 2021",frontMatter:{title:"emissary-ingress"},sidebar:"docs",previous:{title:"cilium",permalink:"/notes/devops/kubernetes/network/cilium"},next:{title:"Flannel",permalink:"/notes/devops/kubernetes/network/flannel"}},o={},d=[{value:"CDR",id:"cdr",level:2},{value:"Module",id:"module",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",pre:"pre",ul:"ul",...(0,t.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"emissary-ingress",children:"emissary-ingress"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://github.com/emissary-ingress/emissary",children:"emissary-ingress/emissary"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Apache-2.0, Go+Python"}),"\n",(0,r.jsx)(n.li,{children:"API Gateway + Layer 7 LB + Kubernetes Ingress"}),"\n",(0,r.jsx)(n.li,{children:"Envoy Proxy"}),"\n",(0,r.jsx)(n.li,{children:"\u4e4b\u524d\u4e3a Ambassador API Gateway"}),"\n",(0,r.jsx)(n.li,{children:"\u652f\u6301 Kubernetest Ingress \u548c Gateway API"}),"\n",(0,r.jsx)(n.li,{children:"\u5f88\u591a CDR \u4f9b\u81ea\u5b9a\u4e49\u670d\u52a1"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\u53c2\u8003\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.getambassador.io/docs/emissary/latest/about/alternatives/",children:"vs. Others"})}),"\n",(0,r.jsxs)(n.li,{children:["vs. Ambassador Edge Stack\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Edge Stack \u7684\u6838\u5fc3 - \u4f5c\u4e3a\u4e86 CNCF \u5b75\u5316\u9879\u76ee"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\u529f\u80fd\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u8def\u7531 - Ingress, Gateway API"}),"\n",(0,r.jsx)(n.li,{children:"\u5b89\u5168 - AuthService, RateLimitService"}),"\n",(0,r.jsxs)(n.li,{children:["\u76d1\u63a7 - TracingService\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"tracing"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"\u7edf\u8ba1 - statd, /metrics"}),"\n",(0,r.jsx)(n.li,{children:"\u96c6\u6210 - Knative, Istio, Linkerd2, Consul"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"cdr",children:"CDR"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"getambassador.io/v3alpha1"}),"\n",(0,r.jsx)(n.li,{children:"Host - \u53ef\u8bbf\u95ee\u5165\u53e3 Hostname"}),"\n",(0,r.jsx)(n.li,{children:"Listener - \u5b9a\u4e49\u76d1\u542c\u65b9\u5f0f"}),"\n",(0,r.jsx)(n.li,{children:"Mapping - HTTP \u6620\u5c04\u5230 Host"}),"\n",(0,r.jsx)(n.li,{children:"TCPMappings"}),"\n",(0,r.jsx)(n.li,{children:"Module - \u7cfb\u7edf\u7eac\u5ea6\u914d\u7f6e"}),"\n",(0,r.jsxs)(n.li,{children:["\u670d\u52a1\u53d1\u73b0\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"KubernetesServiceResolver"}),"\n",(0,r.jsx)(n.li,{children:"KubernetesEndpointResolver"}),"\n",(0,r.jsx)(n.li,{children:"ConsulResolver"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\u63d2\u4ef6\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["AuthService - \u53ea\u80fd\u5b9a\u4e49\u4e00\u4e2a\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Ambassador \u5185\u4f7f\u7528 External, Filter"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"LogService"}),"\n",(0,r.jsx)(n.li,{children:"RateLimitService"}),"\n",(0,r.jsxs)(n.li,{children:["TracingService\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"lightstep, zipkin, datadog"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"apiVersion: getambassador.io/v3alpha1\nkind: Host\nmetadata:\n  name: minimal-host\nspec:\n  # \u652f\u6301 *.example.com, host.example.*\n  hostname: host.example.com\n  # \u9009\u62e9 Mapping\n  mappingSelector:\n    matchLabels:\n      examplehost: host\n  acmeProvider:\n    authority: none\n    email: julian@example.com\n  tlsSecret:\n    name: tls-cert\n  requestPolicy:\n    insecure:\n      # Redirect, Route, Reject\n      # \u9ed8\u8ba4 HTTP \u4f1a\u8df3\u8f6c HTTPS\n      action: Redirect\n      additionalPort: 8080\n---\napiVersion: getambassador.io/v3alpha1\nkind: TLSContext\nmetadata:\n  name: upstream-context\nspec:\n  hosts: []\n  secret: upstream-certs\n  # self-signed\n  # secret: self-signed-cert\n  min_tls_version: v1.3\n  sni: some-sni-hostname\n---\napiVersion: getambassador.io/v3alpha1\nkind: Mapping\nmetadata:\n  name: mapping-with-label-match\n  labels:\n    examplehost: host\nspec:\n  # \u53ef\u4ee5\u914d\u7f6e hostname \u9009\u62e9 Host\n  hostname: '*.example.com'\n  prefix: /httpbin/\n  service: http://httpbin.org\n  host_rewrite: httpbin.org\n  tls: upstream-context\n\n---\napiVersion: getambassador.io/v3alpha1\nkind: Listener\nmetadata:\n  name: example-listener\nspec:\n  port: 8080\n  protocol: HTTPS # HTTP, HTTPS, HTTPPROXY, HTTPSPROXY, TCP\n  protocolStack: [HTTP, TCP]\n  securityModel: XFP # XFP (for X-Forwarded-Proto), SECURE, INSECURE\n  statsPrefix: example-listener # default depends on protocol\n  l7Depth: 0\n  hostBinding:\n    namespace:\n      from: SELF # SELF, ALL\n    selector: ... # Kubernetes label selector\n\n---\napiVersion: getambassador.io/v3alpha1\nkind: AuthService\nmetadata:\n  name: authentication\nspec:\n  ambassador_id: ['ambassador-1']\n  auth_service: 'example-auth.authentication:3000'\n  tls: true\n  proto: http\n  timeout_ms: 5000\n  include_body:\n    max_bytes: 4096\n    allow_partial: true\n  status_on_error:\n    code: 403\n  failure_mode_allow: false\n\n  # proto: grpc only\n  protocol_version: v2\n\n  # proto: http only\n  path_prefix: '/path'\n  allowed_request_headers:\n    - 'x-example-header'\n  allowed_authorization_headers:\n    - 'x-qotm-session'\n  add_auth_headers:\n    x-added-auth: auth-added\n  add_linkerd_headers: false\n"})}),"\n",(0,r.jsx)(n.h2,{id:"module",children:"Module"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"apiVersion: getambassador.io/v3alpha1\nkind: Module\nmetadata:\n  name: ambassador\nspec:\n  config:\n    grpc_stats:\n      upstream_stats: true\n      services:\n        - name: <package>.<service>\n          method_names: [<method>]\n"})})]})}function h(e={}){const{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},3354:(e,n,s)=>{var r=s(50959),t=Symbol.for("react.element"),i=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,l=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function d(e,n,s){var r,i={},d=null,c=null;for(r in void 0!==s&&(d=""+s),void 0!==n.key&&(d=""+n.key),void 0!==n.ref&&(c=n.ref),n)a.call(n,r)&&!o.hasOwnProperty(r)&&(i[r]=n[r]);if(e&&e.defaultProps)for(r in n=e.defaultProps)void 0===i[r]&&(i[r]=n[r]);return{$$typeof:t,type:e,key:d,ref:c,props:i,_owner:l.current}}n.Fragment=i,n.jsx=d,n.jsxs=d},11527:(e,n,s)=>{e.exports=s(3354)},47214:(e,n,s)=>{s.d(n,{Z:()=>l,a:()=>a});var r=s(50959);const t={},i=r.createContext(t);function a(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);