/*! For license information please see 0389c611.ff69b3a7.js.LICENSE.txt */
"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[16648],{99020:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>u,frontMatter:()=>i,metadata:()=>o,toc:()=>l});var s=t(2488),r=t(62780);const i={title:"\u6cdb\u578b"},a="Golang \u6cdb\u578b",o={id:"languages/go/go-generic",title:"\u6cdb\u578b",description:"- \u7c7b\u578b\u53c2\u6570",source:"@site/../notes/languages/go/go-generic.md",sourceDirName:"languages/go",slug:"/languages/go/generic",permalink:"/notes/languages/go/generic",draft:!1,unlisted:!1,editUrl:"https://github.com/wenerme/wener/edit/master/notes/../notes/languages/go/go-generic.md",tags:[],version:"current",lastUpdatedBy:"wener",lastUpdatedAt:1655970411,formattedLastUpdatedAt:"Jun 23, 2022",frontMatter:{title:"\u6cdb\u578b"},sidebar:"docs",previous:{title:"Go FAQ",permalink:"/notes/languages/go/faq"},next:{title:"Go GUI Awesome",permalink:"/notes/languages/go/gui-awesome"}},c={},l=[{value:"new(T)",id:"newt",level:2},{value:"method must have no type parameters",id:"method-must-have-no-type-parameters",level:2},{value:"cannot use generic type without instantiation",id:"cannot-use-generic-type-without-instantiation",level:2},{value:"cannot use type assertion on type parameter value Xxx(variable of type T constrained by any)",id:"cannot-use-type-assertion-on-type-parameter-value-xxxvariable-of-type-t-constrained-by-any",level:2}];function d(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.M)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"golang-\u6cdb\u578b",children:"Golang \u6cdb\u578b"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u7c7b\u578b\u53c2\u6570\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"T any"})," - \u4efb\u610f\u7c7b\u578b"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"T int | int8"})," - \u5176\u4e2d\u4e4b\u4e00"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"T ~int"})," - \u5141\u8bb8\u884d\u751f\u7c7b\u578b - \u4f8b\u5982 ",(0,s.jsx)(n.code,{children:"type Age int"})]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\u53c2\u8003\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://go.googlesource.com/proposal/+/refs/heads/master/design/43651-type-parameters.md",children:"propose"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://go.dev/doc/tutorial/generics",children:"Tutorial: Getting started with generics"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{type:"caution",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u76ee\u524d\u4e0d\u597d\u4f7f\u7528 new(T), \u589e\u52a0\u4e00\u4e2a\u7c7b\u578b\u8fdb\u884c\u9650\u5236"}),"\n",(0,s.jsxs)(n.li,{children:["method \u4e0d\u652f\u6301\u7c7b\u578b\u53c2\u6570 - ",(0,s.jsx)(n.a,{href:"https://go.googlesource.com/proposal/+/refs/heads/master/design/43651-type-parameters.md#No-parameterized-methods",children:"No parameterized methods"})]}),"\n",(0,s.jsxs)(n.li,{children:["type \u53c2\u6570\u4e0d\u652f\u6301 assert - \u53ef\u4ee5\u8003\u8651 ",(0,s.jsx)(n.code,{children:"_,ok := any(v).(int)"})]}),"\n"]})}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["golang.org/x/exp/slices - ",(0,s.jsx)(n.a,{href:"https://github.com/golang/go/issues/45955",children:"#45955"})]}),"\n",(0,s.jsxs)(n.li,{children:["lightweight anonymous function syntax - ",(0,s.jsx)(n.a,{href:"https://github.com/golang/go/issues/21498",children:"#21498"})]}),"\n",(0,s.jsxs)(n.li,{children:["\u4f7f\u7528 struct \u5b57\u6bb5\u4f5c\u4e3a\u4e00\u4e2a\u7c7b\u578b ",(0,s.jsx)(n.a,{href:"https://github.com/golang/go/issues/48522",children:"#48522"})]}),"\n"]})}),"\n",(0,s.jsx)(n.h1,{id:"faq",children:"FAQ"}),"\n",(0,s.jsx)(n.h2,{id:"newt",children:"new(T)"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["\u76ee\u524d\u8be5\u65b9\u6cd5\u65e0\u6cd5\u4f7f\u7528 ",(0,s.jsx)(n.a,{href:"https://stackoverflow.com/questions/71440697",children:"https://stackoverflow.com/questions/71440697"})]}),"\n"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u76f4\u63a5\u9650\u5b9a\u4e0d\u65b9\u4fbf\u4f20\u53c2\u6570\uff0c\u56e0\u4e3a struct \u4e0d\u4e00\u5b9a\u5b9e\u73b0 interface, ",(0,s.jsx)(n.code,{children:"*struct"})," \u624d\u5b9e\u73b0 interface"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",metastring:'title="\u6b63\u786e\u505a\u6cd5"',children:"type Setter[T any] interface {\n\tSetIndex(n int)\n\t*T\n}\nfunc setIndex[T any, PT Setter[T]](items []int) (o []PT) {\n\tfor _, v := range items {\n\t\tm := PT(new(T))\n\t\tm.SetIndex(v)\n\t\to = append(o, m)\n\t}\n\treturn\n}\n\n// \u9650\u5b9a \u63a5\u53e3 \u76f4\u63a5\u5199\u4e5f\u53ef\u4ee5\nfunc setIndex[T any, PT interface {\n  SetIndex(n int)\n  *T\n}](items []int) (o []PT) {\n\tfor _, v := range items {\n\t\tm := PT(new(T))\n\t\tm.SetIndex(v)\n\t\to = append(o, m)\n\t}\n\treturn\n}\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",metastring:'title="\u9519\u8bef\u505a\u6cd5"',children:"func setIndex[M interface {\n\tSetIndex(n int)\n}](items []int) (o []M) {\n\tfor _, v := range items {\n    // NPE\n\t\tm := *new(M)\n\t\tm.SetIndex(v)\n\t\to = append(o, m)\n\t}\n\treturn\n}\n\ntype A struct {\n\tIndex int\n}\n\nfunc (s *A) SetIndex(v int) {\n\ts.Index = v\n}\nfunc TestSetIndex(t *testing.T) {\n  // \u4f1a\u51fa\u73b0 NPE\n\tfmt.Println(setIndex[*A]([]int{1, 2, 3, 4}))\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"method-must-have-no-type-parameters",children:"method must have no type parameters"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"func \u652f\u6301\u7c7b\u578b\u53c2\u6570"}),"\n",(0,s.jsxs)(n.li,{children:["method \u4e0d\u652f\u6301\u7c7b\u578b\u53c2\u6570\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u53ea\u80fd\u4f7f\u7528 struct \u4e0a\u7684\u7c7b\u578b\u53c2\u6570"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://go.googlesource.com/proposal/+/refs/heads/master/design/43651-type-parameters.md#No-parameterized-methods",children:"No parameterized methods"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:"type A struct{}\n// method \u4e0d\u652f\u6301 \u7c7b\u578b\u53c2\u6570\nfunc (v A)Map[T any](f func(A)T)T{\n  return f(v)\n}\n\n// func \u652f\u6301 \u7c7b\u578b\u53c2\u6570\nfunc Map[IN any, OUT any](s IN, f func(IN) OUT) (o OUT) {\n\treturn f(s)\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"cannot-use-generic-type-without-instantiation",children:"cannot use generic type without instantiation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:"type A[T any] struct {}\n// \u4e0d\u53ef\u4ee5\nfunc(a A)Name(){}\n// \u53ef\u4ee5\nfunc(a A[T])Name(){}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"cannot-use-type-assertion-on-type-parameter-value-xxxvariable-of-type-t-constrained-by-any",children:"cannot use type assertion on type parameter value Xxx(variable of type T constrained by any)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:"type A[T any] struct {\n  Val T\n}\nfunc(a A[T])Name(){\n  // \u4e0d\u53ef\u4ee5 - \u56e0\u4e3a T \u662f\u5177\u4f53\u7c7b\u578b\n  _,_=a.Val.(string)\n\n  // \u53ef\u4ee5\n  var v interface{} = a.Val\n\t_, _ = v.(string)\n\n  // \u53ef\u4ee5\n  _, _ = (interface{})(a.Val).(string)\n}\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["proposal: spec: generics: type switch on parametric types ",(0,s.jsx)(n.a,{href:"https://github.com/golang/go/issues/45380",children:"#45380"})]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,r.M)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},38088:(e,n,t)=>{var s=t(96651),r=Symbol.for("react.element"),i=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,o=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,n,t){var s,i={},l=null,d=null;for(s in void 0!==t&&(l=""+t),void 0!==n.key&&(l=""+n.key),void 0!==n.ref&&(d=n.ref),n)a.call(n,s)&&!c.hasOwnProperty(s)&&(i[s]=n[s]);if(e&&e.defaultProps)for(s in n=e.defaultProps)void 0===i[s]&&(i[s]=n[s]);return{$$typeof:r,type:e,key:l,ref:d,props:i,_owner:o.current}}n.Fragment=i,n.jsx=l,n.jsxs=l},2488:(e,n,t)=>{e.exports=t(38088)},62780:(e,n,t)=>{t.d(n,{I:()=>o,M:()=>a});var s=t(96651);const r={},i=s.createContext(r);function a(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);