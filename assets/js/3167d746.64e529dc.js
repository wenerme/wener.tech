/*! For license information please see 3167d746.64e529dc.js.LICENSE.txt */
"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[71742],{7332:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>i,metadata:()=>d,toc:()=>o});var s=r(2488),t=r(62780);const i={title:"craft.js"},l="craft.js",d={id:"web/editor/craftjs",title:"craft.js",description:"- prevwong/craft.js",source:"@site/../notes/web/editor/craftjs.md",sourceDirName:"web/editor",slug:"/web/editor/craftjs",permalink:"/notes/web/editor/craftjs",draft:!1,unlisted:!1,editUrl:"https://github.com/wenerme/wener/edit/master/notes/../notes/web/editor/craftjs.md",tags:[],version:"current",lastUpdatedBy:"wener",lastUpdatedAt:1699940620,formattedLastUpdatedAt:"Nov 14, 2023",frontMatter:{title:"craft.js"},sidebar:"docs",previous:{title:"CodeMirror",permalink:"/notes/web/editor/codemirror"},next:{title:"Draftjs",permalink:"/notes/web/editor/draftjs"}},c={},o=[{value:"Internal",id:"internal",level:2}];function a(n){const e={a:"a",admonition:"admonition",code:"code",del:"del",h1:"h1",h2:"h2",li:"li",pre:"pre",ul:"ul",...(0,t.M)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.h1,{id:"craftjs",children:"craft.js"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.a,{href:"https://github.com/prevwong/craft.js",children:"prevwong/craft.js"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"MIT, React"}),"\n",(0,s.jsx)(e.li,{children:"drag and drop page editors"}),"\n",(0,s.jsx)(e.li,{children:"\u7f16\u8f91\u6a21\u5f0f\u5bf9\u73b0\u6709\u7ec4\u4ef6\u4fb5\u5165"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["@craftjs/core\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"150kb - self 30kb + @craftjs/utils 13kb + lodash 96kb + immer + nanoid"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.a,{href:"https://github.com/prevwong/reka.js",children:"prevwong/reka.js"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u65b0\u7684\u72b6\u6001\u7ba1\u7406+\u5e8f\u5217\u5316"}),"\n",(0,s.jsx)(e.li,{children:"mobx"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.admonition,{type:"caution",children:(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u5bf9\u73b0\u6709\u7ec4\u4ef6\u4fb5\u5165"}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsxs)(e.del,{children:["\u6682\u4e0d\u652f\u6301 Reaact 18 StrictMode ",(0,s.jsx)(e.a,{href:"https://github.com/prevwong/craft.js/issues/404",children:"#404"})]})}),"\n"]})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-tsx",children:'import React from "react";\nimport {Editor, Frame, Canvas, Selector} from "@craftjs/core";\n\nconst TextComponent = ({text}) => {\n  const { connectors: { connect, drag }, isClicked, actions: {setProp} } = useNode(\n    (state) => ({\n      isClicked: state.event.selected,\n    })\n  );\n\n  return (\n    <div ref={dom => connect(drag(dom))}>\n      <h2>{text}</h2>\n      {\n        isClicked ? (\n          <Modal>\n            <input\n              type="text"\n              value={text}\n              onChange={e => setProp(e.target.value)}\n            />\n          </Modal>\n        )\n      }\n    </div>\n  )\n}\n\nconst Container = () => {\n  const { actions: {add}, query: { createNode, node } } = useEditor();\n  const { id, connectors: {drag, connect} } = useNode();\n  return (\n    <div ref={dom => connect(drag(dom))}>\n      <a onClick={() => {\n        const { data: {type, props}} = node(id).get();\n        add(\n          createNode(React.createElement(type, props));\n        );\n      }}>\n        Make a copy of me\n      </a>\n    </div>\n  )\n}\n\nconst SaveButton = () => {\n  const { query } = useEditor();\n  return <a onClick={() => console.log(query.serialize()) }>Get JSON</a>\n}\n\nconst App = () => {\n  return (\n    <div>\n      <header>Editor</header>\n      <Editor>\n        <Frame resolver={{TextComponent, Container}}>\n          <Canvas>\n            <TextComponent text="I\'m already rendered here" />\n          </Canvas>\n        </Frame>\n        <SaveButton/>\n      </Editor>\n    </div>\n  )\n}\n'})}),"\n",(0,s.jsx)(e.h2,{id:"internal",children:"Internal"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["useMethos \u57fa\u4e8e ",(0,s.jsx)(e.a,{href:"https://github.com/pelotom/use-methods",children:"pelotom/use-methods"})," \u505a\u4e86\u4e00\u5b9a\u8c03\u6574\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u52a0\u4e86 QueryMethods - \u7528\u4e8e\u67e5\u8be2\u72b6\u6001"}),"\n",(0,s.jsx)(e.li,{children:"\u52a0\u4e86\u72b6\u6001\u8ba2\u9605\u673a\u5236"}),"\n",(0,s.jsxs)(e.li,{children:["\u539f\u59cb userMethods \u8fd4\u56de ",(0,s.jsx)(e.code,{children:"[state, callbacks]"}),", \u73b0\u5728\u7684\u8fd4\u56de ",(0,s.jsx)(e.code,{children:"[actions, query, watcher, getState]"})]}),"\n",(0,s.jsxs)(e.li,{children:["\u7406\u89e3 ",(0,s.jsx)(e.code,{children:"useMethos"})," \u5bf9\u770b\u61c2 useEditor \u548c useNode \u975e\u5e38\u6709\u5e2e\u52a9"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["Editor\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\u914d\u7f6e\u9879\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"onRender - \u6e32\u67d3 hoc"}),"\n",(0,s.jsx)(e.li,{children:"resolver - \u7ec4\u4ef6\u5217\u8868"}),"\n",(0,s.jsx)(e.li,{children:"enabled - \u662f\u5426\u542f\u7528\u7f16\u8f91"}),"\n",(0,s.jsx)(e.li,{children:"indicator - \u7ebf\u6761\u989c\u8272 - success \u548c error"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\u72b6\u6001\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"nodes - \u6240\u6709\u8282\u70b9"}),"\n",(0,s.jsx)(e.li,{children:"events - \u4e8b\u4ef6\u72b6\u6001"}),"\n",(0,s.jsx)(e.li,{children:"options - \u914d\u7f6e\u9879"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["API \u901a\u8fc7 useMethods \u5b9e\u73b0 - actions\u3001queries\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u4e3b\u8981\u662f\u7ef4\u62a4 node \u7684\u7ed3\u6784 - \u589e\u3001\u5220\u3001\u6539\u3001\u67e5"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["Events\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:'\u4e8b\u4ef6\u5904\u7406 - "select" | "hover" | "drag" | "drop" | "create"'}),"\n",(0,s.jsx)(e.li,{children:"\u7ef4\u62a4\u8282\u70b9\u4e0a\u7684\u4e8b\u4ef6\u72b6\u6001"}),"\n",(0,s.jsx)(e.li,{children:"\u7ef4\u62a4 drop \u7684 \u6807\u8bc6\u52a8\u753b"}),"\n",(0,s.jsx)(e.li,{children:"\u903b\u8f91\u76f8\u5bf9\u590d\u6742"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.li,{children:"NodeElement \u4f1a\u57fa\u4e8e id \u5bf9\u8282\u70b9\u8fdb\u884c memo"}),"\n",(0,s.jsx)(e.li,{children:"NodeHandlers \u4f1a\u4ece\u4e8b\u4ef6\u673a\u5236\u884d\u751f\u51fa\u9488\u5bf9\u8282\u70b9\u7684\u4e8b\u4ef6\u5904\u7406"}),"\n",(0,s.jsxs)(e.li,{children:["Canvas\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u66ff\u4ee3\u7ec4\u4ef6\uff0c\u76f8\u5f53\u4e8e\u7ec4\u4ef6\u7684 decorator\u3001hoc"}),"\n",(0,s.jsx)(e.li,{children:"\u521d\u59cb\u5316\u5185\u90e8\u7ec4\u4ef6"}),"\n",(0,s.jsx)(e.li,{children:"\u7ef4\u62a4 ID \u6620\u5c04\u5173\u7cfb"}),"\n",(0,s.jsx)(e.li,{children:"\u4f9d\u8d56 internalEditor \u548c internalNode \u7ef4\u62a4\u72b6\u6001"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["useInternalNode\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u4ece NodeContext \u66b4\u9732\u989d\u5916\u4fe1\u606f"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["NodeContext\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u5305\u542b id, related, connectors"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["UserComponent\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u9644\u52a0\u989d\u5916\u914d\u7f6e\u4fe1\u606f\u7684\u7ec4\u4ef6"}),"\n",(0,s.jsx)(e.li,{children:"name"}),"\n",(0,s.jsx)(e.li,{children:"rules - \u63a7\u5236\u62d6\u62c9\u884c\u4e3a"}),"\n",(0,s.jsx)(e.li,{children:"related"}),"\n",(0,s.jsx)(e.li,{children:"defaultProps"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["Node - \u8282\u70b9\u4fe1\u606f\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"id"}),"\n",(0,s.jsx)(e.li,{children:"data"}),"\n",(0,s.jsx)(e.li,{children:"events - selected\u3001dragged\u3001hovered"}),"\n",(0,s.jsx)(e.li,{children:"dom"}),"\n",(0,s.jsx)(e.li,{children:"related"}),"\n",(0,s.jsx)(e.li,{children:"rules - canDrag\u3001canMoveIn\u3001canMoveOut"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["NodeData - \u8282\u70b9\u6570\u636e\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"props"}),"\n",(0,s.jsx)(e.li,{children:"type"}),"\n",(0,s.jsx)(e.li,{children:"name"}),"\n",(0,s.jsx)(e.li,{children:"displayName"}),"\n",(0,s.jsx)(e.li,{children:"isCanvas"}),"\n",(0,s.jsx)(e.li,{children:"parent"}),"\n",(0,s.jsx)(e.li,{children:"index"}),"\n",(0,s.jsx)(e.li,{children:"nodes"}),"\n",(0,s.jsx)(e.li,{children:"hidden"}),"\n",(0,s.jsx)(e.li,{children:"custom"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.li,{children:"\u5e8f\u5217\u5316\u4f1a\u6392\u51fa\u9ed8\u8ba4\u7684 type\u3001props\u3001isCanvas\u3001name \u7136\u540e\u5e8f\u5217\u5316\u7ec4\u4ef6"}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"https://craft.js.org/r/docs/acknowledgements/",children:"https://craft.js.org/r/docs/acknowledgements/"})}),"\n"]})]})}function h(n={}){const{wrapper:e}={...(0,t.M)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(a,{...n})}):a(n)}},38088:(n,e,r)=>{var s=r(96651),t=Symbol.for("react.element"),i=Symbol.for("react.fragment"),l=Object.prototype.hasOwnProperty,d=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function o(n,e,r){var s,i={},o=null,a=null;for(s in void 0!==r&&(o=""+r),void 0!==e.key&&(o=""+e.key),void 0!==e.ref&&(a=e.ref),e)l.call(e,s)&&!c.hasOwnProperty(s)&&(i[s]=e[s]);if(n&&n.defaultProps)for(s in e=n.defaultProps)void 0===i[s]&&(i[s]=e[s]);return{$$typeof:t,type:n,key:o,ref:a,props:i,_owner:d.current}}e.Fragment=i,e.jsx=o,e.jsxs=o},2488:(n,e,r)=>{n.exports=r(38088)},62780:(n,e,r)=>{r.d(e,{I:()=>d,M:()=>l});var s=r(96651);const t={},i=s.createContext(t);function l(n){const e=s.useContext(i);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function d(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:l(n.components),s.createElement(i.Provider,{value:e},n.children)}}}]);