"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[94536],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return m}});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},p=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,s=e.originalType,l=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),p=c(n),m=a,f=p["".concat(l,".").concat(m)]||p[m]||d[m]||s;return n?r.createElement(f,i(i({ref:t},u),{},{components:n})):r.createElement(f,i({ref:t},u))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var s=n.length,i=new Array(s);i[0]=p;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o.mdxType="string"==typeof e?e:a,i[1]=o;for(var c=2;c<s;c++)i[c]=n[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}p.displayName="MDXCreateElement"},39667:function(e,t,n){n.r(t),n.d(t,{assets:function(){return u},contentTitle:function(){return l},default:function(){return m},frontMatter:function(){return o},metadata:function(){return c},toc:function(){return d}});var r=n(87462),a=n(63366),s=(n(67294),n(3905)),i=["components"],o={title:"ethersjs"},l=void 0,c={unversionedId:"blockchain/ethersjs",id:"blockchain/ethersjs",title:"ethersjs",description:"- BN.js",source:"@site/notes/blockchain/ethersjs.md",sourceDirName:"blockchain",slug:"/blockchain/ethersjs",permalink:"/notes/blockchain/ethersjs",draft:!1,editUrl:"https://github.com/wenerme/wener/edit/master/notes/blockchain/ethersjs.md",tags:[],version:"current",frontMatter:{title:"ethersjs"},sidebar:"docs",previous:{title:"solidity",permalink:"/notes/blockchain/ethereum/solidity"},next:{title:"Metamask",permalink:"/notes/blockchain/metamask"}},u={},d=[],p={toc:d};function m(e){var t=e.components,n=(0,a.Z)(e,i);return(0,s.kt)("wrapper",(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"BN.js"),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"https://blog.ricmoo.com/human-readable-contract-abis-in-ethers-js-141902f4d917"},"ethers.js: Human-Readable Contract ABIs"))),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-ts"},"// MetaMask\nconst provider = new ethers.providers.Web3Provider(window.ethereum);\nconst signer = provider.getSigner();\n\n// Web3Provider({request,sendAsync,send})\n// WebSocketProvider\n// StaticJsonRpcProvider - \u907f\u514d chainId \u4fee\u6539\u7684\u5f71\u54cd\n// EtherscanProvider - homestead, ropsten, rinkeby, goerli, kovan\n// InfuraProvider\n// AlchemyProvider\n// CloudflareProvider - homestead\n// PocketProvider\n// AnkrProvider - homestead, matic, arbitrum\n// FallbackProvider - \u652f\u6301\u591a\u4e2a Provider\n// IpcProvider\nconst provider = new ethers.providers.JsonRpcProvider('http://localhost:8545', { chainId: '1337', name: 'dev' });\n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-ts"},"let ecr20 = [\n  `function name() view returns (string)`,\n  `function symbol() view returns (string)`,\n  `function decimals() view returns (uint8)`,\n  `function totalSupply() view returns (uint256)`,\n  'function balanceOf(address owner) view returns (uint)',\n  'function transfer(address to, uint256 value) returns (bool success)',\n  'function transferFrom(address from, address to, uint256 value) returns (bool success)',\n  'function approve(address spender, uint256 value) returns (bool success)',\n  'function allowance(address owner, address spender)  view returns (uint256 remaining)',\n\n  'event Transfer(address indexed from, address indexed to, uint256 _value)',\n  'event Approval(address indexed owner, address indexed spender, uint256 _value)',\n];\nlet ecr165 = ['function supportsInterface(interfaceId bytes4) view returns (bool)'];\nlet ecr1820registry = [\n  'function getInterfaceImplementer(address addr, bytes32 interfaceHash) view returns (address)',\n  'function setInterfaceImplementer(address addr, bytes32 interfaceHash, address implementer)',\n  'function setManager(address addr, address newManager)',\n  'function getManager(address addr) view returns(address)',\n  'function interfaceHash(string calldata interfaceName) pure returns(bytes32)',\n];\nlet ecr1820implementer = [\n  'function canImplementInterfaceForAddress(bytes32 interfaceHash, address addr) view returns(bytes32)',\n];\n\n// ropsten usdc\nlet contract = new ethers.Contract('0x07865c6E87B9F70255377e024ace6630C1Eaa37F', [...ecr20, ...ecr165], signer);\n\n// 0x01ffc9a7\nlet interfaceId = ethers.utils.keccak256(ethers.utils.toUtf8Bytes('supportsInterface(bytes4)')).substring(0, 10);\nlet interfaceId = ethers.utils.id('supportsInterface(bytes4)')\ncontract.supportsInterface(interfaceId);\n\nnew ethers.utils.Interface(ecr165).format(ethers.utils.FormatTypes.minimal);\n// balanceOf\nethers.utils.formatUnits(await contract.balanceOf(await signer.getAddress()), await contract.decimals());\n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},'// abi - json,human readable\nlet iface =  new ethers.utils.Interface(abi);\niface.format(ethers.utils.FormatTypes.full);\niface.format(ethers.utils.FormatTypes.minimal);\niface.format(ethers.utils.FormatTypes.json);\n\nethers.utils.formatEther(value)\n// \u9ed8\u8ba4 ether\nethers.utils.formatUnits(value, "ether").\n')),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-ts"},"interface ECR20 {\n  name(): Promise<string>;\n\n  symbol(): Promise<string>;\n\n  decimals(): Promise<number>;\n\n  balanceOf(address: string): Promise<ethers.BigNumber>;\n}\n\ninterface ECR165 {\n  supportsInterface(interfaceId: any);\n}\n")),(0,s.kt)("table",null,(0,s.kt)("thead",{parentName:"table"},(0,s.kt)("tr",{parentName:"thead"},(0,s.kt)("th",{parentName:"tr",align:null},"Name"),(0,s.kt)("th",{parentName:"tr",align:null},"Decimals"))),(0,s.kt)("tbody",{parentName:"table"},(0,s.kt)("tr",{parentName:"tbody"},(0,s.kt)("td",{parentName:"tr",align:null},"wei"),(0,s.kt)("td",{parentName:"tr",align:null},"0")),(0,s.kt)("tr",{parentName:"tbody"},(0,s.kt)("td",{parentName:"tr",align:null},"kwei"),(0,s.kt)("td",{parentName:"tr",align:null},"3")),(0,s.kt)("tr",{parentName:"tbody"},(0,s.kt)("td",{parentName:"tr",align:null},"mwei"),(0,s.kt)("td",{parentName:"tr",align:null},"6")),(0,s.kt)("tr",{parentName:"tbody"},(0,s.kt)("td",{parentName:"tr",align:null},"gwei"),(0,s.kt)("td",{parentName:"tr",align:null},"9")),(0,s.kt)("tr",{parentName:"tbody"},(0,s.kt)("td",{parentName:"tr",align:null},"szabo"),(0,s.kt)("td",{parentName:"tr",align:null},"12")),(0,s.kt)("tr",{parentName:"tbody"},(0,s.kt)("td",{parentName:"tr",align:null},"finney"),(0,s.kt)("td",{parentName:"tr",align:null},"15")),(0,s.kt)("tr",{parentName:"tbody"},(0,s.kt)("td",{parentName:"tr",align:null},"ether"),(0,s.kt)("td",{parentName:"tr",align:null},"18")))))}m.isMDXComponent=!0}}]);