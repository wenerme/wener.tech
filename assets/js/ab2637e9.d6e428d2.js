"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[82646],{49613:function(e,t,a){a.d(t,{Zo:function(){return u},kt:function(){return N}});var l=a(59496);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,l)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function p(e,t){if(null==e)return{};var a,l,n=function(e,t){if(null==e)return{};var a,l,n={},r=Object.keys(e);for(l=0;l<r.length;l++)a=r[l],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(l=0;l<r.length;l++)a=r[l],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var o=l.createContext({}),m=function(e){var t=l.useContext(o),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},u=function(e){var t=m(e.components);return l.createElement(o.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return l.createElement(l.Fragment,{},t)}},s=l.forwardRef((function(e,t){var a=e.components,n=e.mdxType,r=e.originalType,o=e.parentName,u=p(e,["components","mdxType","originalType","parentName"]),s=m(a),N=n,E=s["".concat(o,".").concat(N)]||s[N]||c[N]||r;return a?l.createElement(E,i(i({ref:t},u),{},{components:a})):l.createElement(E,i({ref:t},u))}));function N(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var r=a.length,i=new Array(r);i[0]=s;var p={};for(var o in t)hasOwnProperty.call(t,o)&&(p[o]=t[o]);p.originalType=e,p.mdxType="string"==typeof e?e:n,i[1]=p;for(var m=2;m<r;m++)i[m]=a[m];return l.createElement.apply(null,i)}return l.createElement.apply(null,a)}s.displayName="MDXCreateElement"},6894:function(e,t,a){a.r(t),a.d(t,{assets:function(){return k},contentTitle:function(){return N},default:function(){return b},frontMatter:function(){return s},metadata:function(){return E},toc:function(){return d}});var l=a(49613),n=Object.defineProperty,r=Object.defineProperties,i=Object.getOwnPropertyDescriptors,p=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,m=Object.prototype.propertyIsEnumerable,u=(e,t,a)=>t in e?n(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,c=(e,t)=>{for(var a in t||(t={}))o.call(t,a)&&u(e,a,t[a]);if(p)for(var a of p(t))m.call(t,a)&&u(e,a,t[a]);return e};const s={tags:["SQL"]},N="ScyllaDB SQL",E={unversionedId:"db/column/scylladb-cql",id:"db/column/scylladb-cql",title:"ScyllaDB SQL",description:"cqlsh",source:"@site/../notes/db/column/scylladb-cql.md",sourceDirName:"db/column",slug:"/db/column/scylladb-cql",permalink:"/notes/db/column/scylladb-cql",draft:!1,editUrl:"https://github.com/wenerme/wener/edit/master/notes/../notes/db/column/scylladb-cql.md",tags:[{label:"SQL",permalink:"/notes/tags/sql"}],version:"current",lastUpdatedBy:"wener",lastUpdatedAt:1664804552,formattedLastUpdatedAt:"Oct 3, 2022",frontMatter:{tags:["SQL"]},sidebar:"docs",previous:{title:"ScyllaDB \u914d\u7f6e",permalink:"/notes/db/column/scylladb-conf"},next:{title:"ScyllaDB \u5f00\u53d1",permalink:"/notes/db/column/scylladb-dev"}},k={},d=[{value:"cqlsh",id:"cqlsh",level:2},{value:"CQL",id:"cql",level:2}],S={toc:d};function b(e){var t,a=e,{components:n}=a,u=((e,t)=>{var a={};for(var l in e)o.call(e,l)&&t.indexOf(l)<0&&(a[l]=e[l]);if(null!=e&&p)for(var l of p(e))t.indexOf(l)<0&&m.call(e,l)&&(a[l]=e[l]);return a})(a,["components"]);return(0,l.kt)("wrapper",(t=c(c({},S),u),r(t,i({components:n,mdxType:"MDXLayout"}))),(0,l.kt)("h1",c({},{id:"scylladb-sql"}),"ScyllaDB SQL"),(0,l.kt)("h2",c({},{id:"cqlsh"}),"cqlsh"),(0,l.kt)("pre",null,(0,l.kt)("code",c({parentName:"pre"},{className:"language-sql"}),"SHOW VERSION;\nSHOW HOST;\n\nSHOW SESSION $id;\n\nSOURCE '/data/commands.cql'\n\nCAPTURE;\nCAPTURE OFF;\nCAPTURE '/data/file';\n\nTRACING ON;\nTRACING OFF;\n\nPAGING ON;\nPAGING OFF;\nPAGING $page_size_in_rows;\n\nEXPAND ON;\nEXPAND OFF;\n\n-- LOGIN <username> [<password>]\n\nCLEAR;\nCLS;\n\n-- DESCRIBE <>\nDESCRIBE CLUSTER;\nDESCRIBE SCHEMA;\nDESCRIBE KEYSPACES;\nDESCRIBE KEYSPACE keyspace_name;\nDESCRIBE TABLES;\nDESCRIBE TABLE table_name;\nDESCRIBE MATERIALIZED VIEW view_name;\nDESCRIBE TYPES;\nDESCRIBE TYPE type_name;\nDESCRIBE FUNCTIONS;\nDESCRIBE FUNCTION function_name;\nDESCRIBE AGGREGATES;\nDESCRIBE AGGREGATE aggregate_function_name;\n\n-- COPY <table name> [(<column>, ...)] TO <file name> WITH <copy option> [AND <copy option> ...]\n-- MAXREQUESTS=6 PAGESIZE=1000 PAGETIMEOUT=10\n-- BEGINTOKEN, ENDTOKEN\n-- MAXOUTPUTSIZE=-1\n-- ENCODING=utf8\n\n-- COPY <table name> [(<column>, ...)] FROM <file name> WITH <copy option> [AND <copy option> ...]\n-- INGESTRATE=100000 MAXROWS=-1 SKIPROWS=0 SKIPCOLS=0 MAXPARSEERRORS=-1 MAXINSERTERRORS=1000\n-- ERRFILE=import_<ks>_<table>.err\n-- MAXBATCHSIZE=20 MINBATCHSIZE=2\n-- CHUNKSIZE=1000\nCOPY test FROM 'file.csv' WITH HEADER=true;\n\n-- COPY\n-- NULLVAL=null HEADER=false DECIMALSEP=.\n-- THOUSANDSSEP\n-- BOOLSTYlE True, False\n-- NUMPROCESSES\n-- MAXATTEMPTS=5\n-- REPORTFREQUENCY=0.25\n-- RATEFILE\n")),(0,l.kt)("h2",c({},{id:"cql"}),"CQL"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"KEYSPACE - CREATE, DROP, DESCRIBE, ALTER",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u6570\u636e\u5e93\u6982\u5ff5"),(0,l.kt)("li",{parentName:"ul"},"durable_writes"),(0,l.kt)("li",{parentName:"ul"},"replication",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"class",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"NetworkTopologyStrategy",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"<datacenter>")," - \u7ed9\u5b9a dc \u7684\u526f\u672c\u6570"),(0,l.kt)("li",{parentName:"ul"},"replication_factor - dc \u9ed8\u8ba4\u526f\u672c\u6570"))),(0,l.kt)("li",{parentName:"ul"},"SimpleStrategy",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"replication_factor",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5168\u5c40\u526f\u672c\u6570\uff0c\u4e0d\u8003\u8651 datacenter"))))))))))),(0,l.kt)("li",{parentName:"ul"},"USE keyspace"),(0,l.kt)("li",{parentName:"ul"},"TABLE",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"column",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"STATIC - \u76f8\u540c\u5206\u7247\u503c\u76f8\u540c"))),(0,l.kt)("li",{parentName:"ul"},"PRIMARY KEY",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u4e0d\u6307\u5b9a\u5219\u6bcf\u884c\u4e3a\u4e00\u4e2a partition"),(0,l.kt)("li",{parentName:"ul"},"\u503c\u4e0d\u80fd\u4e3a null"),(0,l.kt)("li",{parentName:"ul"},"\u7b2c\u4e00\u4e2a\u5217\u4f5c\u4e3a partition key"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"PRIMARY KEY ((a, b), c)")," - \u591a\u4e2a partation key",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"c \u4e3a clustering column"))))),(0,l.kt)("li",{parentName:"ul"},"table_options",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("del",{parentName:"li"},"COMPACT STORAGE")),(0,l.kt)("li",{parentName:"ul"},"CLUSTERING ORDER",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u9ed8\u8ba4\u57fa\u4e8e clustering column \u6392\u5e8f"),(0,l.kt)("li",{parentName:"ul"},"\u53ef\u4fee\u6539\u6392\u5e8f"))),(0,l.kt)("li",{parentName:"ul"},"comment"),(0,l.kt)("li",{parentName:"ul"},"read_repair_chance=0"),(0,l.kt)("li",{parentName:"ul"},"dclocal_read_repair_chance=0"),(0,l.kt)("li",{parentName:"ul"},"speculative_retry=99PERCENTILE"),(0,l.kt)("li",{parentName:"ul"},"gc_grace_seconds=864000"),(0,l.kt)("li",{parentName:"ul"},"tombstone_gc"),(0,l.kt)("li",{parentName:"ul"},"bloom_filter_fp_chance=0.01"),(0,l.kt)("li",{parentName:"ul"},"default_time_to_live=0"),(0,l.kt)("li",{parentName:"ul"},"cdc",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"enabled=false"),(0,l.kt)("li",{parentName:"ul"},"preimage=false"),(0,l.kt)("li",{parentName:"ul"},"ttl"))),(0,l.kt)("li",{parentName:"ul"},"compaction - \u5408\u5e76 SSTables",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"tombstone_threshold=0.2"),(0,l.kt)("li",{parentName:"ul"},"tombstone_compaction_interval=86400s - 1day"),(0,l.kt)("li",{parentName:"ul"},"SizeTieredCompactionStrategy - STCS - \u9ed8\u8ba4",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"bucket_high=1.5, bucket_low=0.5"),(0,l.kt)("li",{parentName:"ul"},"min_sstable_size=50"),(0,l.kt)("li",{parentName:"ul"},"min_threshold=4, max_threshold=32"))),(0,l.kt)("li",{parentName:"ul"},"LeveledCompactionStrategy - LCS",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"sstable_size_in_mb=160"))),(0,l.kt)("li",{parentName:"ul"},"IncrementalCompactionStrategy - ICS - \u4f01\u4e1a\u7248"),(0,l.kt)("li",{parentName:"ul"},"DateTieredCompactionStrategy - TWCS",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"1 sstable/time window"),(0,l.kt)("li",{parentName:"ul"},"compaction_window_unit=DAYS, compaction_window_size=1"),(0,l.kt)("li",{parentName:"ul"},"expired_sstable_check_frequency_seconds=600"),(0,l.kt)("li",{parentName:"ul"},"min_threshold=4, max_threshold=32"))))),(0,l.kt)("li",{parentName:"ul"},"compression",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"sstable_compression=LZ4Compressor",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"SnappyCompressor"),(0,l.kt)("li",{parentName:"ul"},"DeflateCompressor"))),(0,l.kt)("li",{parentName:"ul"},"chunk_length_in_kb=4KB"))),(0,l.kt)("li",{parentName:"ul"},"scylla_encryption_options"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"caching = {'enabled': 'true'}")),(0,l.kt)("li",{parentName:"ul"},"speculative_retry"),(0,l.kt)("li",{parentName:"ul"},"cache",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"enabled=true"))))))),(0,l.kt)("li",{parentName:"ul"},"INDEX - \u4e8c\u7ea7\u7d22\u5f15",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u672c\u5730 - \u5355\u5206\u7247"),(0,l.kt)("li",{parentName:"ul"},"\u5168\u5c40"))),(0,l.kt)("li",{parentName:"ul"},"TTL",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u8bbe\u7f6e\u4e3a\u5217\u7ef4\u5ea6"),(0,l.kt)("li",{parentName:"ul"},"\u53ef\u4ee5\u884c\u7ef4\u5ea6"),(0,l.kt)("li",{parentName:"ul"},"\u8868\u53ef\u4ee5\u8bbe\u7f6e\u9ed8\u8ba4 default_time_to_live"))),(0,l.kt)("li",{parentName:"ul"},"JSON",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"SELECT JSON")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"INSERT JSON")),(0,l.kt)("li",{parentName:"ul"},"fromJson"),(0,l.kt)("li",{parentName:"ul"},"toJson"))),(0,l.kt)("li",{parentName:"ul"},"CREATE MATERIALIZED VIEW",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"SELECT \u9650\u5236",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u4e0d\u53ef\u4ee5 ALLOW FILTERING"),(0,l.kt)("li",{parentName:"ul"},"\u4e0d\u5141\u8bb8 order"),(0,l.kt)("li",{parentName:"ul"},"\u4e0d\u5305\u542b limit"))))),(0,l.kt)("li",{parentName:"ul"},"ScyllaDB \u6269\u5c55",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"SELECT BYPASS CACHE"),(0,l.kt)("li",{parentName:"ul"},"CREATE TABLE WITH paxos_grace_seconds"),(0,l.kt)("li",{parentName:"ul"},"SELECT/INSERT USING TIMEOUT"),(0,l.kt)("li",{parentName:"ul"},"KEYSPACE options"),(0,l.kt)("li",{parentName:"ul"},"PRUNE MATERIALIZED VIEW"),(0,l.kt)("li",{parentName:"ul"},"CREATE MATERIALIZED VIEW WITH synchronous_updates",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u540c\u6b65\u66f4\u65b0"))),(0,l.kt)("li",{parentName:"ul"},"MV \u4e8c\u7ea7\u7d22\u5f15 synchronous_updates"),(0,l.kt)("li",{parentName:"ul"},"REDUCEFUNC for UDA"),(0,l.kt)("li",{parentName:"ul"},"per_partition_rate_limit")))),(0,l.kt)("pre",null,(0,l.kt)("code",c({parentName:"pre"},{className:"language-sql"}),"CREATE KEYSPACE catalog WITH REPLICATION = { 'class' : 'NetworkTopologyStrategy','DC1' : 3};\nuse catalog;\nCREATE TABLE mutant_data (\n   first_name text,\n   last_name text,\n   address text,\n   picture_location text,\n   PRIMARY KEY((first_name, last_name)));\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",c({parentName:"li"},{href:"https://docs.scylladb.com/stable/cql/ddl.html"}),"https://docs.scylladb.com/stable/cql/ddl.html")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",c({parentName:"li"},{href:"https://docs.scylladb.com/stable/cql/types.html"}),"https://docs.scylladb.com/stable/cql/types.html")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",c({parentName:"li"},{href:"https://docs.scylladb.com/stable/cql/compaction.html"}),"https://docs.scylladb.com/stable/cql/compaction.html"))))}b.isMDXComponent=!0}}]);