/*! For license information please see 2a726fa6.4aaf7dc8.js.LICENSE.txt */
"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[36986],{48859:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>l,contentTitle:()=>a,default:()=>d,frontMatter:()=>r,metadata:()=>i,toc:()=>c});var o=s(11527),t=s(47214);const r={title:"jq"},a="jq",i={id:"os/linux/shell/jq",title:"jq",description:"- https://jqplay.org/",source:"@site/../notes/os/linux/shell/jq.md",sourceDirName:"os/linux/shell",slug:"/os/linux/shell/jq",permalink:"/notes/os/linux/shell/jq",draft:!1,unlisted:!1,editUrl:"https://github.com/wenerme/wener/edit/master/notes/../notes/os/linux/shell/jq.md",tags:[],version:"current",lastUpdatedBy:"wener",lastUpdatedAt:1695042174,formattedLastUpdatedAt:"Sep 18, 2023",frontMatter:{title:"jq"},sidebar:"docs",previous:{title:"fping",permalink:"/notes/os/linux/shell/fping"},next:{title:"lsof",permalink:"/notes/os/linux/shell/lsof"}},l={},c=[{value:"composer auth.json",id:"composer-authjson",level:2},{value:"parse error: Invalid numeric literal at line 1, column 3",id:"parse-error-invalid-numeric-literal-at-line-1-column-3",level:2}];function j(n){const e={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",li:"li",pre:"pre",ul:"ul",...(0,t.a)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.h1,{id:"jq",children:"jq"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:(0,o.jsx)(e.a,{href:"https://jqplay.org/",children:"https://jqplay.org/"})}),"\n",(0,o.jsx)(e.li,{children:(0,o.jsx)(e.a,{href:"https://stedolan.github.io/jq/manual/",children:"https://stedolan.github.io/jq/manual/"})}),"\n"]}),"\n",(0,o.jsx)(e.admonition,{type:"tip",children:(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"jq \u4e0d\u652f\u6301 inplace \u4fee\u6539"}),"\n"]})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-bash",children:'jq \'.components.rows|=sort_by(.id)|.components.rows[].properties|=sort_by(.name)\' file.json\n\n# inplace edit\njqi() {\n  cat <<< "$(jq "$1" < "$2")" > "$2"\n}\njqi ".a=1" test.json\n\n# merge\njq -s add a.json b.json c.json\n\n# deep merge\njq -s \'reduce .[] as $x ({}; . * $x)\' a.json b.json\n\n# array\n# \u975e\u5bf9\u8c61\u573a\u666f\njq -c \'.[]\' names.json | xargs -L 1 echo\n# \u5bf9\u8c61\u573a\u666f\njq -j \'.[] | tostring + "\\u0000"\' names.json | xargs -0 -n1 -I {} jq -n {}\n# \u4fbf\u5229\u6570\u7ec4\u5bf9\u8c61\u5b57\u6bb5\njq -j \'.builds[] | tostring + "\\u0000"\' build.json | xargs -0 -n1 -I {} sh -c "jq -n \'{}\' | jq -r .name"\n\n\nmapfile -t configArr < <(jq -c \'.[]\'  < app-cnfg.json)\nfor config in "${configArr[@]}"; do\n    aws dynamodb put-item --table-name "xxx" --item "$config"\ndone\n\nwhile IFS= read -r config; do\n    aws dynamodb put-item --table-name "xxx" --item "$config"\ndone< <(jq -c \'.[]\' < app-cnfg.json)\n\n# arg\njq --arg v "$PRJNAME" \'.dev.projects[$v]\' config.json\n\n\n# \u901a\u8fc7 redirect\njq \'.key\' <<< "$json_data"\n# \u901a\u8fc7 arg\njq -n --argjson data "$json_data" \'$data.key\'\n# \u901a\u8fc7\u73af\u5883\u53d8\u91cf\njson_data="$json_data" jq -n \'env.json_data | fromjson.key\'\n# \u901a\u8fc7\u53d8\u91cf\njq -n "$json_data" | jq .key\n\n# jsonl\njq -c \'.[]\'                           # array to jsonl\njq -n \'[inputs]\' <in.jsonl >out.json  # jsonl to array\njq --slurp . <in.jsonl >out.json      # jsonl to array\n'})}),"\n",(0,o.jsx)(e.h2,{id:"composer-authjson",children:"composer auth.json"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-bash",children:"COMPOSER_REPO=$(cat composer.json | jq '.repositories[0].url' -r | sed -r 's|https?://([^/]+).*|\\1|')\necho '{}' | jq '.\"http-basic\".\"code.dev.zhang66.cn\" = { \"username\": $ENV.COMPOSER_USER, \"password\": $ENV.COMPOSER_PASS }' > auth.json\n"})}),"\n",(0,o.jsx)(e.h2,{id:"parse-error-invalid-numeric-literal-at-line-1-column-3",children:"parse error: Invalid numeric literal at line 1, column 3"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"\u53ef\u80fd\u662f\u56e0\u4e3a\u6709 BOM"}),"\n"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-bash",children:"dos2unix in.json\n"})})]})}function d(n={}){const{wrapper:e}={...(0,t.a)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(j,{...n})}):j(n)}},3354:(n,e,s)=>{var o=s(50959),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,i=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(n,e,s){var o,r={},c=null,j=null;for(o in void 0!==s&&(c=""+s),void 0!==e.key&&(c=""+e.key),void 0!==e.ref&&(j=e.ref),e)a.call(e,o)&&!l.hasOwnProperty(o)&&(r[o]=e[o]);if(n&&n.defaultProps)for(o in e=n.defaultProps)void 0===r[o]&&(r[o]=e[o]);return{$$typeof:t,type:n,key:c,ref:j,props:r,_owner:i.current}}e.Fragment=r,e.jsx=c,e.jsxs=c},11527:(n,e,s)=>{n.exports=s(3354)},47214:(n,e,s)=>{s.d(e,{Z:()=>i,a:()=>a});var o=s(50959);const t={},r=o.createContext(t);function a(n){const e=o.useContext(r);return o.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function i(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:a(n.components),o.createElement(r.Provider,{value:e},n.children)}}}]);