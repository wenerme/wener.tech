"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[14712],{49613:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return m}});var r=n(59496);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=r.createContext({}),s=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},u=function(e){var t=s(e.components);return r.createElement(c.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},E=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,c=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),E=s(n),m=a,h=E["".concat(c,".").concat(m)]||E[m]||p[m]||i;return n?r.createElement(h,l(l({ref:t},u),{},{components:n})):r.createElement(h,l({ref:t},u))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,l=new Array(i);l[0]=E;var o={};for(var c in t)hasOwnProperty.call(t,c)&&(o[c]=t[c]);o.originalType=e,o.mdxType="string"==typeof e?e:a,l[1]=o;for(var s=2;s<i;s++)l[s]=n[s];return r.createElement.apply(null,l)}return r.createElement.apply(null,n)}E.displayName="MDXCreateElement"},13279:function(e,t,n){n.r(t),n.d(t,{assets:function(){return _},contentTitle:function(){return m},default:function(){return A},frontMatter:function(){return E},metadata:function(){return h},toc:function(){return N}});var r=n(49613),a=Object.defineProperty,i=Object.defineProperties,l=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,c=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,u=(e,t,n)=>t in e?a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,p=(e,t)=>{for(var n in t||(t={}))c.call(t,n)&&u(e,n,t[n]);if(o)for(var n of o(t))s.call(t,n)&&u(e,n,t[n]);return e};const E={title:"archivebox"},m="archivebox",h={unversionedId:"service/data/crawler/archivebox",id:"service/data/crawler/archivebox",title:"archivebox",description:"- ArchiveBox/ArchiveBox",source:"@site/../notes/service/data/crawler/archivebox.md",sourceDirName:"service/data/crawler",slug:"/service/data/crawler/archivebox",permalink:"/notes/service/data/crawler/archivebox",draft:!1,editUrl:"https://github.com/wenerme/wener/edit/master/notes/../notes/service/data/crawler/archivebox.md",tags:[],version:"current",lastUpdatedBy:"wener",lastUpdatedAt:1629271390,formattedLastUpdatedAt:"Aug 18, 2021",frontMatter:{title:"archivebox"},sidebar:"docs",previous:{title:"airbyte",permalink:"/notes/service/data/airbyte"},next:{title:"crawlab",permalink:"/notes/service/data/crawler/crawlab"}},_={},N=[{value:"\u914d\u7f6e",id:"\u914d\u7f6e",level:2},{value:"\u6570\u636e\u7ed3\u6784",id:"\u6570\u636e\u7ed3\u6784",level:2}],S={toc:N};function A(e){var t,n=e,{components:a}=n,u=((e,t)=>{var n={};for(var r in e)c.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&o)for(var r of o(e))t.indexOf(r)<0&&s.call(e,r)&&(n[r]=e[r]);return n})(n,["components"]);return(0,r.kt)("wrapper",(t=p(p({},S),u),i(t,l({components:a,mdxType:"MDXLayout"}))),(0,r.kt)("h1",p({},{id:"archivebox"}),"archivebox"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",p({parentName:"li"},{href:"https://github.com/ArchiveBox/ArchiveBox"}),"ArchiveBox/ArchiveBox"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"MIT, Python"),(0,r.kt)("li",{parentName:"ul"},"\u9488\u5bf9\u552f\u4e00 URL \u552f\u4e00\u63d0\u53d6\u7c7b\u578b \u8fdb\u884c Archive"),(0,r.kt)("li",{parentName:"ul"},"\u4f7f\u7528 chromium/chrome \u751f\u6210 \u622a\u5c4f\u3001PDF\u3001DOM HTML\u3001headless JS"),(0,r.kt)("li",{parentName:"ul"},"\u4f7f\u7528 node & npm \u751f\u6210 Readability, Mercury, SingleFile"),(0,r.kt)("li",{parentName:"ul"},"\u4f7f\u7528 wget \u751f\u6210 \u7eaf HTML, \u9759\u6001\u6587\u4ef6, WARC"),(0,r.kt)("li",{parentName:"ul"},"\u4f7f\u7528 curl \u83b7\u53d6 \u5934\u3001favicon\u3001\u8bf7\u6c42 archibe.org"),(0,r.kt)("li",{parentName:"ul"},"\u4f7f\u7528 youtube-dl \u5904\u7406\u89c6\u9891\u3001\u97f3\u9891\u3001\u5b57\u5e55"),(0,r.kt)("li",{parentName:"ul"},"\u4f7f\u7528 git \u514b\u9686\u4ed3\u5e93"))),(0,r.kt)("li",{parentName:"ul"},"\u8f93\u51fa\u683c\u5f0f",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Chrome SingleFile",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",p({parentName:"li"},{href:"https://github.com/gildas-lormeau/SingleFile"}),"https://github.com/gildas-lormeau/SingleFile")))),(0,r.kt)("li",{parentName:"ul"},"Chrome PDF"),(0,r.kt)("li",{parentName:"ul"},"Chrome Screenshot"),(0,r.kt)("li",{parentName:"ul"},"Wget HTML"),(0,r.kt)("li",{parentName:"ul"},"Archive.org"),(0,r.kt)("li",{parentName:"ul"},"Original"),(0,r.kt)("li",{parentName:"ul"},"Headers"),(0,r.kt)("li",{parentName:"ul"},"Chrome HTML"),(0,r.kt)("li",{parentName:"ul"},"Readability",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",p({parentName:"li"},{href:"https://github.com/mozilla/readability"}),"https://github.com/mozilla/readability")))),(0,r.kt)("li",{parentName:"ul"},"Mercury"),(0,r.kt)("li",{parentName:"ul"},"Media"),(0,r.kt)("li",{parentName:"ul"},"Git"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",p({parentName:"li"},{href:"https://raw.githubusercontent.com/ArchiveBox/ArchiveBox/master/docker-compose.yml"}),"ArchiveBox/ArchiveBox/docker-compose.yml"))),(0,r.kt)("admonition",p({},{type:"caution"}),(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},"\u76f4\u63a5\u9884\u89c8\u4f1a\u6267\u884c JS - \u53ef\u80fd\u5bfc\u81f4\u4fe1\u606f\u6cc4\u6f0f",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u53ea\u6709 wget \u4f1a\u63d0\u53d6 js\uff0c\u53ef\u4ee5\u5173\u95ed\u96c6\u6210"))),(0,r.kt)("li",{parentName:"ul"},"\u907f\u514d\u4f7f\u7528 EXT3/FAT \u4e4b\u7c7b\u7684 FS - \u5bf9\u5355\u76ee\u5f55\u6709 50k \u7684\u9650\u5236"),(0,r.kt)("li",{parentName:"ul"},"\u4e0d\u652f\u6301\u6293\u5168\u7ad9 - \u76ee\u524d depth=0/1 ",(0,r.kt)("a",p({parentName:"li"},{href:"https://github.com/ArchiveBox/ArchiveBox/issues/191"}),"ArchiveBox/ArchiveBox#191")),(0,r.kt)("li",{parentName:"ul"},"\u4e0d\u652f\u6301\u5355 URL \u591a\u5feb\u7167 ",(0,r.kt)("a",p({parentName:"li"},{href:"https://github.com/ArchiveBox/ArchiveBox/issues/179"}),"#179"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u76ee\u524d\u901a\u8fc7\u6dfb\u52a0 Hash \u5b9e\u73b0\u91cd\u5199\u5feb\u7167"))),(0,r.kt)("li",{parentName:"ul"},"\u6ca1\u6709 rest \u63a5\u53e3 ",(0,r.kt)("a",p({parentName:"li"},{href:"https://github.com/ArchiveBox/ArchiveBox/issues/496"}),"#496")))),(0,r.kt)("pre",null,(0,r.kt)("code",p({parentName:"pre"},{className:"language-bash"}),"docker run --rm -it \\\n  -v $PWD/archivebox:/data -p 8000:8000 \\\n  --name archivebox archivebox/archivebox\n# \u521b\u5efa\u7ba1\u7406\u5458\u8d26\u53f7\ndocker exec -it -u archivebox archivebox archivebox manage createsuperuser\n\n# \u547d\u4ee4\u884c\u64cd\u4f5c\n# \u7ba1\u7406\u96c6\u5408 archivebox setup/init/config/status/manage\n# \u7ba1\u7406\u5feb\u7167 archivebox add/schedule/remove/update/list/shell/oneshot\n# archivebox schedule\n\narchivebox server 0.0.0.0:8000          # \u542f\u52a8 Web\narchivebox add 'https://example.com'    # \u6dfb\u52a0\u5f52\u6863\narchivebox list 'https://example.com'   # \u67e5\u770b\narchivebox add 'https://example.com#2020-10-24' # \u4fdd\u5b58\u591a\u4efd\u5feb\u7167\n\narchivebox schedule --every=day --depth=1 https://example.com/rss.xml\n\n# \u5bfc\u51fa\u7d22\u5f15\narchivebox list --html --with-headers > index.html\narchivebox list --json --with-headers > index.json\narchivebox list --csv=timestamp,url,title > index.csv\n\n# --parser auto,pocket_api,wallabag_atom,pocket_html,pinboard_rss,shaarli_rss,medium_rss,netscape_html,rss,json,html,txt,url_list\n# --extract title,favicon,headers,singlefile,pdf,screenshot,dom,wget,readability,mercury,git,media,archive_org\n# --depth 0,1\n# --update-all \u540c\u65f6\u6267\u884c update\n# --tags\n# --index-only \u53ea\u6dfb\u52a0\u5230 index \u4e0d\u6267\u884c\n# --overwrite \u4ece\u65b0\u5f52\u6863\narchivebox add\n\n# \u66f4\u65b0\u5355\u4e2a\narchivebox update -t timestamp 1629214695.204162\n# \u66f4\u65b0\u6240\u6709 pending\n# \u91cd\u542f archivebox \u540e\u9700\u8981\u6267\u884c\narchivebox update\n# \u4ece\u67d0\u4e2a\u65f6\u95f4\u70b9\u5f00\u59cb\narchivebox update --resume 1629218154.996784\n")),(0,r.kt)("h2",p({},{id:"\u914d\u7f6e"}),"\u914d\u7f6e"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",p({parentName:"li"},{href:"https://github.com/ArchiveBox/ArchiveBox/blob/master/archivebox/config.py"}),"archivebox/config.py")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",p({parentName:"li"},{href:"https://github.com/ArchiveBox/ArchiveBox/wiki/Configuration"}),"Configuration")),(0,r.kt)("li",{parentName:"ul"},"ArchiveBox.conf"),(0,r.kt)("li",{parentName:"ul"},"\u914d\u7f6e\u4f18\u5148\u7ea7 - cli flag, env, config file, defaults")),(0,r.kt)("pre",null,(0,r.kt)("code",p({parentName:"pre"},{className:"language-bash"}),"archivebox config --set MEDIA_TIMEOUT=600\nenv MEDIA_TIMEOUT=600 USE_COLOR=False archivebox server\n\n# \u907f\u514d\u89e6\u53d1 archive.org \u4fdd\u5b58\narchivebox config --set SAVE_ARCHIVE_DOT_ORG=False\n# \u907f\u514d\u5916\u90e8\u8bbf\u95ee\narchivebox config --set PUBLIC_INDEX=False\narchivebox config --set PUBLIC_SNAPSHOTS=False\narchivebox config --set PUBLIC_ADD_VIEW=False\n")),(0,r.kt)("pre",null,(0,r.kt)("code",p({parentName:"pre"},{className:"language-ini"}),"[SHELL_CONFIG]\nIS_TTY                   =#lambda _: sys.stdout.isatty()\nUSE_COLOR                =#lambda c: c['IS_TTY']\nSHOW_PROGRESS            =#lambda c: (c['IS_TTY'] and platform.system() != 'Darwin') # progress bars are buggy on mac\nIN_DOCKER                =False\n# TODO: SHOW_HINTS      =True\n\n[GENERAL_CONFIG]\nOUTPUT_DIR               =None\nCONFIG_FILE              =None\nONLY_NEW                 =True\nTIMEOUT                  =60\nMEDIA_TIMEOUT            =3600\nOUTPUT_PERMISSIONS       ='755'\nRESTRICT_FILE_NAMES      ='windows'\nURL_BLACKLIST            =r'\\.(css|js|otf|ttf|woff|woff2|gstatic\\.com|googleapis\\.com/css)(\\?.*)?$'  # to avoid downloading code assets as their own pages\n\n[SERVER_CONFIG]\n# SECRET_KEY =\nSECRET_KEY               =\nBIND_ADDR                =# lambda c: ['127.0.0.1:8000', '0.0.0.0:8000'][c['IN_DOCKER']]\nALLOWED_HOSTS            ='*'\nDEBUG                    =False\nPUBLIC_INDEX             =True\nPUBLIC_SNAPSHOTS         =True\nPUBLIC_ADD_VIEW          =False\nFOOTER_INFO              ='Content is hosted for personal archiving purposes only.  Contact server owner for any takedown requests.'\nSNAPSHOTS_PER_PAGE       =40\nCUSTOM_TEMPLATES_DIR     =\nTIME_ZONE                ='UTC'\n\n\n[ARCHIVE_METHOD_TOGGLES]\nSAVE_TITLE               =True\n# \u4f9d\u8d56 Google \u670d\u52a1 https://www.google.com/s2/favicons?domain={domain}\nSAVE_FAVICON             =True\nSAVE_WGET                =True\n# images/css/js\nSAVE_WGET_REQUISITES     =True\n# \u4ece\u5df2\u7ecf\u4e0b\u8f7d\u7684\u5185\u5bb9\u63d0\u53d6\u6587\u672c\n# https://github.com/mozilla/readability\nSAVE_READABILITY         =True\n# \u529f\u80fd\u540c READABILITY\n# https://github.com/postlight/mercury-parser\nSAVE_MERCURY             =True\n\nSAVE_HEADERS             =True\nSAVE_WARC                =True\nSAVE_GIT                 =True\n# youtube-dl \u4e0b\u8f7d\u89c6\u9891\u97f3\u9891\nSAVE_MEDIA               =True\n# \u63d0\u4ea4\u5230 Archive.org\nSAVE_ARCHIVE_DOT_ORG     =True\n# \u4f9d\u8d56 Chrome\n# https://github.com/gildas-lormeau/SingleFile\nSAVE_SINGLEFILE          =True\nSAVE_PDF                 =True\nSAVE_SCREENSHOT          =True\n# dump DOM\nSAVE_DOM                 =True\n\n[ARCHIVE_METHOD_OPTIONS]\nRESOLUTION               ='1440,2000'\nGIT_DOMAINS              ='github.com,bitbucket.org,gitlab.com,gist.github.com'\nCHECK_SSL_VALIDITY       =True\nMEDIA_MAX_SIZE           ='750m'\nCURL_USER_AGENT          ='Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.61 Safari/537.36 ArchiveBox/{VERSION} (+https://github.com/ArchiveBox/ArchiveBox/) curl/{CURL_VERSION}'\nWGET_USER_AGENT          ='Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.61 Safari/537.36 ArchiveBox/{VERSION} (+https://github.com/ArchiveBox/ArchiveBox/) wget/{WGET_VERSION}'\nCHROME_USER_AGENT        ='Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.61 Safari/537.36 ArchiveBox/{VERSION} (+https://github.com/ArchiveBox/ArchiveBox/)'\nCOOKIES_FILE             =None\nCHROME_USER_DATA_DIR     =None\nCHROME_HEADLESS          =True\nCHROME_SANDBOX           = # lambda c: not c['IN_DOCKER']\n\nYOUTUBEDL_ARGS           =\nWGET_ARGS           =\nCURL_ARGS           =\nGIT_ARGS           =\n\n\n[SEARCH_BACKEND_CONFIG]\nUSE_INDEXING_BACKEND     =True\nUSE_SEARCHING_BACKEND    =True\n#\nSEARCH_BACKEND_ENGINE    ='ripgrep'\nSEARCH_BACKEND_HOST_NAME ='localhost'\nSEARCH_BACKEND_PORT      =1491\nSEARCH_BACKEND_PASSWORD  ='SecretPassword'\n# sonic\n# SEARCH_BACKEND_ENGINE=sonic\n# SEARCH_BACKEND_HOST_NAME=sonic\n# SEARCH_BACKEND_PASSWORD=SecretPassword\nSONIC_COLLECTION         ='archivebox'\nSONIC_BUCKET             ='snapshots'\nSEARCH_BACKEND_TIMEOUT   =90\n\n[DEPENDENCY_CONFIG]\nUSE_CURL                 =True\nUSE_WGET                 =True\nUSE_SINGLEFILE           =True\nUSE_READABILITY          =True\nUSE_MERCURY              =True\nUSE_GIT                  =True\nUSE_CHROME               =True\nUSE_NODE                 =True\nUSE_YOUTUBEDL            =True\nUSE_RIPGREP              =True\nCURL_BINARY              ='curl'\nGIT_BINARY               ='git'\nWGET_BINARY              ='wget'\nSINGLEFILE_BINARY        =# bin_path('single-file')\nREADABILITY_BINARY       =# bin_path('readability-extractor')\nMERCURY_BINARY           =# bin_path('mercury-parser')\nYOUTUBEDL_BINARY         ='youtube-dl'\nNODE_BINARY              ='node'\nRIPGREP_BINARY           ='rg'\nCHROME_BINARY            =None\nPOCKET_CONSUMER_KEY      =None\nPOCKET_ACCESS_TOKENS     ={}\n")),(0,r.kt)("pre",null,(0,r.kt)("code",p({parentName:"pre"},{className:"language-ini"}),"[GENERAL_CONFIG]\n# \u9ed8\u8ba4 60 \u6709\u65f6\u5019\u592a\u77ed\u4e86\nTIMEOUT =180\n[SERVER_CONFIG]\n# SECRET_KEY =\n\nPUBLIC_INDEX    =False\nPUBLIC_SNAPSHOTS=False\nPUBLIC_ADD_VIEW =False\n\n[ARCHIVE_METHOD_TOGGLES]\n# \u9700\u8981\u4ee3\u7406\nSAVE_FAVICON             =False\nSAVE_ARCHIVE_DOT_ORG     =False\n# \u4e00\u822c\u7528\u4e0d\u4e0a\nSAVE_WARC                =False\n# \u6709 SINGLEFILE \u5bf9 PDF \u548c SCREENSHOT \u9700\u6c42\u4e0d\u5927\nSAVE_PDF                 =False\nSAVE_SCREENSHOT          =False\n\n[ARCHIVE_METHOD_OPTIONS]\nCURL_USER_AGENT          ='Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.61 Safari/537.36'\nWGET_USER_AGENT          ='Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.61 Safari/537.36'\nCHROME_USER_AGENT        ='Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.61 Safari/537.36'\n")),(0,r.kt)("h2",p({},{id:"\u6570\u636e\u7ed3\u6784"}),"\u6570\u636e\u7ed3\u6784"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"./",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"index.sqlite3"),(0,r.kt)("li",{parentName:"ul"},"ArchiveBox.conf"),(0,r.kt)("li",{parentName:"ul"},"static/"),(0,r.kt)("li",{parentName:"ul"},"sources/"),(0,r.kt)("li",{parentName:"ul"},"logs/"),(0,r.kt)("li",{parentName:"ul"},"archive/",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"1617687755/ - timestamp",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"index.html - \u63cf\u8ff0\u6027\u5185\u5bb9"),(0,r.kt)("li",{parentName:"ul"},"index.json - \u63cf\u8ff0\u6027\u5185\u5bb9"),(0,r.kt)("li",{parentName:"ul"},"screenshot.png"),(0,r.kt)("li",{parentName:"ul"},"media/"),(0,r.kt)("li",{parentName:"ul"},"warc/"),(0,r.kt)("li",{parentName:"ul"},"git/")))))))))}A.isMDXComponent=!0}}]);