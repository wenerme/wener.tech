/*! For license information please see 852ee01d.1d6e294c.js.LICENSE.txt */
"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[37308],{69444:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>i,metadata:()=>l,toc:()=>o});var s=t(2488),r=t(62780);const i={title:"res_http"},a="res_http",l={id:"voip/asterisk/res_http",title:"res_http",description:"- asterisk http \u6838\u5fc3\u6a21\u5757",source:"@site/../notes/voip/asterisk/res_http.md",sourceDirName:"voip/asterisk",slug:"/voip/asterisk/res_http",permalink:"/notes/voip/asterisk/res_http",draft:!1,unlisted:!1,editUrl:"https://github.com/wenerme/wener/edit/master/notes/../notes/voip/asterisk/res_http.md",tags:[],version:"current",lastUpdatedBy:"wener",lastUpdatedAt:1622713470,formattedLastUpdatedAt:"Jun 3, 2021",frontMatter:{title:"res_http"},sidebar:"docs",previous:{title:"IAX",permalink:"/notes/voip/asterisk/iax"},next:{title:"phoneprov",permalink:"/notes/voip/asterisk/res_phoneprov"}},c={},o=[{value:"http.conf",id:"httpconf",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.M)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"res_http",children:"res_http"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["asterisk http \u6838\u5fc3\u6a21\u5757\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"stasis \u4f9d\u8d56"}),"\n",(0,s.jsx)(n.li,{children:"webrtc \u4f9d\u8d56"}),"\n",(0,s.jsx)(n.li,{children:"ari \u4f9d\u8d56"}),"\n",(0,s.jsx)(n.li,{children:"manager \u53ef\u901a\u8fc7 http \u652f\u6301 AMI"}),"\n",(0,s.jsx)(n.li,{children:"manager \u53ef\u901a\u8fc7 http \u4e0a\u4f20\u914d\u7f6e"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\u76f8\u5173\u6a21\u5757\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"res_http_media_cache.so"}),"\n",(0,s.jsx)(n.li,{children:"res_http_post.so"}),"\n",(0,s.jsxs)(n.li,{children:["res_http_websocket.so\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u652f\u6301 WebSocket - pjsip webrtc"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["manager.conf\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"webenabled=yes \u5141\u8bb8\u901a\u8fc7 http \u8bbf\u95ee AMI"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# \u67e5\u770b\u7ec8\u7aef\nhttp show status\n"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"endpoint"}),(0,s.jsx)(n.th,{children:"desc"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"/httpstatus"}),(0,s.jsx)(n.td,{children:"Asterisk HTTP General Status"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"/static/..."}),(0,s.jsx)(n.td,{children:"\u9759\u6001\u6587\u4ef6"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"/amanager"}),(0,s.jsx)(n.td,{children:"HTML Manager Event Interface w/Digest authentication"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"/manager"}),(0,s.jsx)(n.td,{children:"Manager Tester - \u6d4b\u8bd5\u6267\u884c\u7ba1\u7406\u547d\u4ee4"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"/arawman"}),(0,s.jsx)(n.td,{children:"Raw HTTP Manager Event Interface w/Digest authentication"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"/rawman"}),(0,s.jsx)(n.td,{children:"Raw HTTP Manager Event Interface"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"/amxml"}),(0,s.jsx)(n.td,{children:"XML Manager Event Interface w/Digest authentication"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"/mxml"}),(0,s.jsx)(n.td,{children:"XML Manager Event Interface"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"/ws"}),(0,s.jsx)(n.td,{children:"Asterisk HTTP WebSocket"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"/ari/..."}),(0,s.jsx)(n.td,{children:"Asterisk RESTful API"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"/phoneprov/..."}),(0,s.jsx)(n.td,{children:"Asterisk HTTP Phone Provisioning Tool"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"/test_media_cache/..."}),(0,s.jsx)(n.td,{children:"HTTP Media Cache Test URI"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"/moh"}),(0,s.jsx)(n.td,{children:"HTTP POST mapping"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"/backups"}),(0,s.jsx)(n.td,{children:"HTTP POST mapping"})]})]})]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["manager \u767b\u9646\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"http://localhost:8088/manager?action=login&username=admin&secret=admin",children:"http://localhost:8088/manager?action=login&username=admin&secret=admin"})}),"\n",(0,s.jsx)(n.li,{children:"\u4f1a\u8bb0\u5f55 cookie mansession_id"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# \u57fa\u4e8e cookie \u767b\u9646\u4f1a\u8bdd\u8bbf\u95ee\ncurl -b cookie.txt -c cookie.txt 'http://localhost:8088/manager?action=login&username=admin&secret=admin'\n# raw\ncurl -b cookie.txt -c cookie.txt 'http://localhost:8088/rawman?action=status'\n# xml\ncurl -b cookie.txt -c cookie.txt 'http://localhost:8088/mxml?action=status'\n\n# \u76f4\u63a5\u4f7f\u7528 digest \u8ba4\u8bc1\u8bbf\u95ee\ncurl --digest -u admin:admin -k 'https://127.0.0.1:8089/arawman?action=status'\ncurl --digest -u admin:admin -k 'https://127.0.0.1:8089/amxml?action=status'\n"})}),"\n",(0,s.jsx)(n.h2,{id:"httpconf",children:"http.conf"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-conf",children:'[general]\n; \u9ed8\u8ba4 Asterisk/{version}\n; \u53ef\u8bbe\u7f6e\u4e3a\u7a7a\nservername=Asterisk\n\n; \u542f\u7528 HTTP/HTTPS - \u5f71\u54cd manager/rawman/mxml\nenabled=yes\n\n; \u76d1\u542c\u5730\u5740\nbindaddr=0.0.0.0\n\n; HTTP \u7aef\u53e3\n;bindport=8088\n\n; \u8bf7\u6c42\u524d\u7f00 - \u7c7b\u4f3c base patch \u6216 context path\n;prefix=asterisk\n\n; \u4f1a\u8bdd\u6570\u91cf\u9650\u5236 - \u9ed8\u8ba4 100\n;sessionlimit=100\n; \u4e0d\u6d3b\u8dc3\u7b49\u5f85\u65f6\u95f4 - \u5355\u4f4d ms - \u9ed8\u8ba4 30s\n;session_inactivity=30000\n; \u7b49\u5f85\u4e0b\u4e00\u4e2a\u8bf7\u6c42\u7684\u65f6\u95f4 - \u5355\u4f4d ms - \u9ed8\u8ba4 15s, 0 \u7981\u7528\n;session_keep_alive=15000\n\n; \u662f\u5426\u5141\u8bb8\u8bbf\u95ee\u9759\u6001\u6587\u4ef6\n; enablestatic=yes\n;enable_static=yes\n; \u662f\u5426\u8fd4\u56de\u72b6\u6001\u9875\n;enable_status=no\n\n; \u81ea\u5b9a\u4e49\u91cd\u5b9a\u5411 from to\n; \u4f8b\u5982 asterisk Asterisk-gui\n;redirect = / /static/config/index.html\n\n; \u542f\u7528 HTTPS\n;tlsenable=yes\n;tlsbindaddr=0.0.0.0:8089\n; \u8bc1\u4e66\n;tlscertfile=</path/to/certificate.pem>\n;tlsprivatekey=</path/to/private.pem>\n; If no path is given for tlscertfile or tlsprivatekey, default is to look in current\n; directory. If no tlsprivatekey is given, default is to search tlscertfile for private key.\n;\n; To produce a certificate you can e.g. use openssl. This places both the cert and\n; private in same .pem file.\n; openssl req -new -x509 -days 365 -nodes -out /tmp/foo.pem -keyout /tmp/foo.pem\n;\n; tlscipher=                             ; The list of allowed ciphers\n;                                        ; if none are specified the following cipher\n;                                        ; list will be used instead:\n; ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:\n; ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:\n; kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:\n; ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:\n; ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:\n; DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:\n; AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:\n; AES:CAMELLIA:DES-CBC3-SHA:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!aECDH:\n; !EDH-DSS-DES-CBC3-SHA:!EDH-RSA-DES-CBC3-SHA:!KRB5-DES-CBC3-SHA\n;\n; tlsdisablev1=yes                ; Disable TLSv1 support - if not set this defaults to "yes"\n; tlsdisablev11=yes               ; Disable TLSv1.1 support - if not set this defaults to "no"\n; tlsdisablev12=yes               ; Disable TLSv1.2 support - if not set this defaults to "no"\n;\n; tlsservercipherorder=yes        ; Use the server preference order instead of the client order\n;                                 ; Defaults to "yes"\n\n; \u6620\u5c04 url \u8def\u5f84\u5230\u7cfb\u7edf  - POST \u4f1a\u4e0a\u4f20\u6587\u4ef6\n; \u9700\u8981 AMI \u7684 mansession_id \u4f5c\u4e3a cookie\n;[post_mappings]\n; \u5982\u679c\u8bbe\u7f6e\u4e86\u524d\u7f00 asterisk\n; \u5219 POST /asterisk/uploads \u4f1a\u4e0a\u4f20\u5230 /var/lib/asterisk/uploads/\n;uploads = /var/lib/asterisk/uploads/\n'})})]})}function h(e={}){const{wrapper:n}={...(0,r.M)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},38088:(e,n,t)=>{var s=t(96651),r=Symbol.for("react.element"),i=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,l=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function o(e,n,t){var s,i={},o=null,d=null;for(s in void 0!==t&&(o=""+t),void 0!==n.key&&(o=""+n.key),void 0!==n.ref&&(d=n.ref),n)a.call(n,s)&&!c.hasOwnProperty(s)&&(i[s]=n[s]);if(e&&e.defaultProps)for(s in n=e.defaultProps)void 0===i[s]&&(i[s]=n[s]);return{$$typeof:r,type:e,key:o,ref:d,props:i,_owner:l.current}}n.Fragment=i,n.jsx=o,n.jsxs=o},2488:(e,n,t)=>{e.exports=t(38088)},62780:(e,n,t)=>{t.d(n,{I:()=>l,M:()=>a});var s=t(96651);const r={},i=s.createContext(r);function a(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);