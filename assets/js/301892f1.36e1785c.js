/*! For license information please see 301892f1.36e1785c.js.LICENSE.txt */
"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[52179],{19341:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>s,metadata:()=>i,toc:()=>d});var a=r(11527),t=r(47214);const s={title:"ApacheDS Kerberos"},c="ApacheDS Kerberos",i={id:"service/auth/ldap/apacheds-kerberos",title:"ApacheDS Kerberos",description:"- ApacheDS 2.0 Kerberos User Guide",source:"@site/../notes/service/auth/ldap/apacheds-kerberos.md",sourceDirName:"service/auth/ldap",slug:"/service/auth/ldap/apacheds-kerberos",permalink:"/notes/service/auth/ldap/apacheds-kerberos",draft:!1,unlisted:!1,editUrl:"https://github.com/wenerme/wener/edit/master/notes/../notes/service/auth/ldap/apacheds-kerberos.md",tags:[],version:"current",lastUpdatedBy:"wener",lastUpdatedAt:1660664456,formattedLastUpdatedAt:"Aug 16, 2022",frontMatter:{title:"ApacheDS Kerberos"},sidebar:"docs",previous:{title:"LADP",permalink:"/notes/service/auth/ldap/"},next:{title:"ApacheDS \u8fd0\u7ef4",permalink:"/notes/service/auth/ldap/apacheds-ops"}},l={},d=[{value:"kerby",id:"kerby",level:2},{value:"\u542f\u52a8",id:"\u542f\u52a8",level:2},{value:"\u521d\u59cb\u914d\u7f6e",id:"\u521d\u59cb\u914d\u7f6e",level:2},{value:"\u5ba2\u6237\u7aef",id:"\u5ba2\u6237\u7aef",level:2},{value:"FAQ",id:"faq",level:2},{value:"Server not found in Kerberos database while getting initial credentials",id:"server-not-found-in-kerberos-database-while-getting-initial-credentials",level:3}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h1,{id:"apacheds-kerberos",children:"ApacheDS Kerberos"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.a,{href:"https://directory.apache.org/apacheds/kerberos-user-guide.html",children:"ApacheDS 2.0 Kerberos User Guide"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"KDC (Key DIstribution Center)"}),"\n",(0,a.jsx)(n.li,{children:"TGS (Ticket Granting Server)"}),"\n",(0,a.jsx)(n.li,{children:"AS (Authentication Server)"}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.li,{children:"\u5b9e\u73b0\u4e86 Kerberos V5"}),"\n",(0,a.jsx)(n.li,{children:"\u652f\u6301\u52a0\u5bc6 - des-cbc-md5, des3-cbc-sha1-kd, aes128-cts-hmac-sha1-96, aes256-cts-hmac-sha1-96, rc4-hmac encryption"}),"\n",(0,a.jsx)(n.li,{children:"\u652f\u6301 UDP TCP"}),"\n",(0,a.jsx)(n.li,{children:"\u6bcf\u6b21\u4fee\u6539\u5bc6\u7801 version \u4f1a\u589e\u52a0"}),"\n",(0,a.jsxs)(n.li,{children:["\u5b9e\u73b0\u7684 RFC ",(0,a.jsx)(n.a,{href:"https://directory.apache.org/apacheds/kerberos-ug/1.2.3-standards.html",children:"\u6807\u51c6"})]}),"\n",(0,a.jsxs)(n.li,{children:["\u6ce8\u610f\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\u5fc5\u987b\u8981\u660e\u6587\u5bc6\u7801\u751f\u6210 krb5 key\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"\u5bc6\u7801\u6700\u7ec8\u4e5f\u4f1a\u4ee5 SHA"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"kerby",children:"kerby"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://directory.apache.org/kerby/user-guide.html",children:"Kerby User Guide"})}),"\n",(0,a.jsxs)(n.li,{children:["\u540e\u7aef\u5b58\u50a8\u652f\u6301\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"\u5185\u5b58"}),"\n",(0,a.jsx)(n.li,{children:"Json"}),"\n",(0,a.jsx)(n.li,{children:"Zookeeper"}),"\n",(0,a.jsx)(n.li,{children:"LDAP"}),"\n",(0,a.jsx)(n.li,{children:"Mavibot"}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\u652f\u6301\u7684\u52a0\u5bc6\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"des, des3, rc4, aes, camellia"}),"\n",(0,a.jsxs)(n.li,{children:["\u90e8\u5206\u4f9d\u8d56 JCE - \u9700\u8981\u989d\u5916\u5b89\u88c5\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"OpenJDK \u6216\u65b0\u7248\u6709\u81ea\u5e26"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Encryption Type"}),(0,a.jsx)(n.th,{children:"Description"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"des-cbc-crc"}),(0,a.jsx)(n.td,{children:"DES cbc mode with CRC-32 (weak)"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"des-cbc-md4"}),(0,a.jsx)(n.td,{children:"DES cbc mode with RSA-MD4 (weak)"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"des-cbc-md5"}),(0,a.jsx)(n.td,{children:"DES cbc mode with RSA-MD5 (weak)"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"des3-cbc-sha1 des3-hmac-sha1 des3-cbc-sha1-kd"}),(0,a.jsx)(n.td,{children:"Triple DES cbc mode with HMAC/sha1"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"des-hmac-sha1"}),(0,a.jsx)(n.td,{children:"DES with HMAC/sha1 (weak)"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"aes256-cts-hmac-sha1-96 aes256-cts AES-256"}),(0,a.jsx)(n.td,{children:"CTS mode with 96-bit SHA-1 HMAC"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"aes128-cts-hmac-sha1-96 aes128-cts AES-128"}),(0,a.jsx)(n.td,{children:"CTS mode with 96-bit SHA-1 HMAC"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"arcfour-hmac rc4-hmac arcfour-hmac-md5"}),(0,a.jsx)(n.td,{children:"RC4 with HMAC/MD5"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"arcfour-hmac-exp rc4-hmac-exp arcfour-hmac-md5-exp"}),(0,a.jsx)(n.td,{children:"Exportable RC4 with HMAC/MD5 (weak)"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"camellia256-cts-cmac camellia256-cts"}),(0,a.jsx)(n.td,{children:"Camellia-256 CTS mode with CMAC"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"camellia128-cts-cmac camellia128-cts"}),(0,a.jsx)(n.td,{children:"Camellia-128 CTS mode with CMAC"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"des"}),(0,a.jsx)(n.td,{children:"The DES family: des-cbc-crc, des-cbc-md5, and des-cbc-md4 (weak)"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"des3"}),(0,a.jsx)(n.td,{children:"The triple DES family: des3-cbc-sha1"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"aes"}),(0,a.jsx)(n.td,{children:"The AES family: aes256-cts-hmac-sha1-96 and aes128-cts-hmac-sha1-96"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"rc4"}),(0,a.jsx)(n.td,{children:"The RC4 family: arcfour-hmac"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"camellia"}),(0,a.jsx)(n.td,{children:"The Camellia family: camellia256-cts-cmac and camellia128-cts-cmac"})]})]})]}),"\n",(0,a.jsx)(n.h1,{id:"\u672c\u5730\u5b9e\u9a8c",children:"\u672c\u5730\u5b9e\u9a8c"}),"\n",(0,a.jsx)(n.h2,{id:"\u542f\u52a8",children:"\u542f\u52a8"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# \u6620\u5c04\u76ee\u5f55\u540e\u672c\u5730\u4e5f\u53ef\u4ee5\u4f7f\u7528\ndocker run --rm -it -e TZ=Asia/Shanghai \\\n  -p 10389:10389 -p 10636:10636 \\\n  -p 60088:60088 -p 60464:60464  -p 60088:60088/udp -p 60464:60464/udp \\\n  -v $PWD/apacheds:/opt/apacheds/instances \\\n  --name apacheds wener/apacheds\n"})}),"\n",(0,a.jsx)(n.h2,{id:"\u521d\u59cb\u914d\u7f6e",children:"\u521d\u59cb\u914d\u7f6e"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"\u521b\u5efa\u670d\u52a1"}),"\n",(0,a.jsxs)(n.li,{children:["\u53c2\u8003\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"http://directory.apache.org/apacheds/kerberos-ug/4-using-kerberos.html",children:"http://directory.apache.org/apacheds/kerberos-ug/4-using-kerberos.html"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ldif",children:"# \u57fa\u7840\u9876\u5c42\u67b6\u6784\ndn: dc=security,dc=example,dc=com\nobjectClass: top\nobjectClass: domain\ndc: security\n\ndn: ou=services,dc=security,dc=example,dc=com\nobjectClass: top\nobjectClass: organizationalUnit\nou: services\n\ndn: ou=users,dc=security,dc=example,dc=com\nobjectClass: top\nobjectClass: organizationalUnit\nou: users\n\n# \u521b\u5efa\u7528\u6237 wener\ndn: uid=wener,ou=users,dc=security,dc=example,dc=com\nobjectClass: top\nobjectClass: krb5KDCEntry\nobjectClass: inetOrgPerson\nobjectClass: krb5Principal\nobjectClass: person\nobjectClass: organizationalPerson\ncn: Wener Chen\nkrb5KeyVersionNumber: 1\nkrb5PrincipalName: wener@EXAMPLE.COM\nsn: Wener\nuid: wener\nuserPassword: secret\n\n# \u521b\u5efa\u670d\u52a1\ndn: uid=ldap,ou=services,dc=security,dc=example,dc=com\nobjectClass: top\nobjectClass: organizationalUnit\nobjectClass: krb5KDCEntry\nobjectClass: uidObject\nobjectClass: krb5Principal\nkrb5KeyVersionNumber: 0\nkrb5PrincipalName: ldap/example.net@EXAMPLE.COM\nuid: ldap\nuserPassword: randomKey\nou: LDAP\n\ndn: uid=krbtgt,ou=services,dc=security,dc=example,dc=com\nobjectClass: top\nobjectClass: organizationalUnit\nobjectClass: krb5KDCEntry\nobjectClass: uidObject\nobjectClass: krb5Principal\nkrb5KeyVersionNumber: 0\nkrb5PrincipalName: krbtgt/EXAMPLE.COM@EXAMPLE.COM\nuid: krbtgt\nuserPassword:: randomkey\nou: TGT\n\ndn: uid=kpasswd,ou=services,dc=security,dc=example,dc=com\nobjectClass: top\nobjectClass: organizationalUnit\nobjectClass: krb5KDCEntry\nobjectClass: uidObject\nobjectClass: krb5Principal\nkrb5KeyVersionNumber: 0\nkrb5PrincipalName: kadmin/changepw@EXAMPLE.COM\nuid: kpasswd\nuserPassword:: randomkey\nou: KPasswd\n"})}),"\n",(0,a.jsx)(n.h2,{id:"\u5ba2\u6237\u7aef",children:"\u5ba2\u6237\u7aef"}),"\n",(0,a.jsxs)(n.p,{children:["\u76f8\u540c\u8282\u70b9\u5ba2\u6237\u7aef\u914d\u7f6e\uff0c\u4fee\u6539 hosts ",(0,a.jsx)(n.code,{children:"example.com"})," \u6307\u5411\u672c\u5730"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"/etc/krb5.conf"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ini",children:" [logging]\n default = FILE:/var/log/krb5libs.log\n kdc = FILE:/var/log/krb5kdc.log\n admin_server = FILE:/var/log/kadmind.log\n\n[libdefaults]\ndebug = true\ndefault_realm = EXAMPLE.COM\ndns_lookup_realm = false\ndns_lookup_kdc = false\nticket_lifetime = 24h\nrenew_lifetime = 7d\nrdns = false\nforwardable = true\nallow_weak_crypto = yes\n\n[realms]\n EXAMPLE.COM = {\n  kdc = 127.0.0.1:60088\n  chpasswd_server = 127.0.0.1:60464\n  kpasswd_server = 127.0.0.1:60464\n  default_domain = EXAMPLE.COM\n }\n\n\n[domain_realm]\n.EXAMPLE.COM = EXAMPLE.COM\nEXAMPLE.COM = EXAMPLE.COM\n"})}),"\n",(0,a.jsx)(n.h2,{id:"faq",children:"FAQ"}),"\n",(0,a.jsx)(n.h3,{id:"server-not-found-in-kerberos-database-while-getting-initial-credentials",children:"Server not found in Kerberos database while getting initial credentials"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"\u53ef\u80fd\u662f\u52a0\u5bc6\u7b97\u6cd5\u9700\u8981\u5b89\u5168\u6269\u5c55\uff0c\u5c1d\u8bd5\u8c03\u6574"}),"\n",(0,a.jsx)(n.li,{children:"\u53ef\u80fd\u662f\u6ca1\u6709\u521b\u5efa\u76f8\u5e94\u7684\u670d\u52a1"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"[21:35:42] ERROR [org.apache.directory.server.KERBEROS_LOG] - ERR_152 Unexpected exception: null\njava.lang.NullPointerException\n\tat org.apache.directory.server.kerberos.kdc.authentication.AuthenticationService.verifyEncryptedTimestamp(AuthenticationService.java:335)\n\tat org.apache.directory.server.kerberos.kdc.authentication.AuthenticationService.execute(AuthenticationService.java:129)\n\tat org.apache.directory.server.kerberos.protocol.KerberosProtocolHandler.messageReceived(KerberosProtocolHandler.java:217)\n\tat org.apache.mina.core.filterchain.DefaultIoFilterChain$TailFilter.messageReceived(DefaultIoFilterChain.java:1015)\n\tat org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextMessageReceived(DefaultIoFilterChain.java:650)\n\tat org.apache.mina.core.filterchain.DefaultIoFilterChain.access$1300(DefaultIoFilterChain.java:49)\n\tat org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.messageReceived(DefaultIoFilterChain.java:1128)\n\tat org.apache.mina.filter.codec.ProtocolCodecFilter$ProtocolDecoderOutputImpl.flush(ProtocolCodecFilter.java:413)\n\tat org.apache.mina.filter.codec.ProtocolCodecFilter.messageReceived(ProtocolCodecFilter.java:257)\n\tat org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextMessageReceived(DefaultIoFilterChain.java:650)\n\tat org.apache.mina.core.filterchain.DefaultIoFilterChain.access$1300(DefaultIoFilterChain.java:49)\n\tat org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.messageReceived(DefaultIoFilterChain.java:1128)\n\tat org.apache.mina.core.filterchain.IoFilterAdapter.messageReceived(IoFilterAdapter.java:122)\n\tat org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextMessageReceived(DefaultIoFilterChain.java:650)\n\tat org.apache.mina.core.filterchain.DefaultIoFilterChain.fireMessageReceived(DefaultIoFilterChain.java:643)\n\tat org.apache.mina.transport.socket.nio.NioDatagramAcceptor.readHandle(NioDatagramAcceptor.java:314)\n\tat org.apache.mina.transport.socket.nio.NioDatagramAcceptor.processReadySessions(NioDatagramAcceptor.java:270)\n\tat org.apache.mina.transport.socket.nio.NioDatagramAcceptor.access$700(NioDatagramAcceptor.java:68)\n\tat org.apache.mina.transport.socket.nio.NioDatagramAcceptor$Acceptor.run(NioDatagramAcceptor.java:181)\n\tat org.apache.mina.util.NamePreservingRunnable.run(NamePreservingRunnable.java:64)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\n\tat java.lang.Thread.run(Thread.java:748)\n"})})]})}function h(e={}){const{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(o,{...e})}):o(e)}},3354:(e,n,r)=>{var a=r(50959),t=Symbol.for("react.element"),s=Symbol.for("react.fragment"),c=Object.prototype.hasOwnProperty,i=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function d(e,n,r){var a,s={},d=null,o=null;for(a in void 0!==r&&(d=""+r),void 0!==n.key&&(d=""+n.key),void 0!==n.ref&&(o=n.ref),n)c.call(n,a)&&!l.hasOwnProperty(a)&&(s[a]=n[a]);if(e&&e.defaultProps)for(a in n=e.defaultProps)void 0===s[a]&&(s[a]=n[a]);return{$$typeof:t,type:e,key:d,ref:o,props:s,_owner:i.current}}n.Fragment=s,n.jsx=d,n.jsxs=d},11527:(e,n,r)=>{e.exports=r(3354)},47214:(e,n,r)=>{r.d(n,{Z:()=>i,a:()=>c});var a=r(50959);const t={},s=a.createContext(t);function c(e){const n=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),a.createElement(s.Provider,{value:n},e.children)}}}]);