/*! For license information please see 2d31baf8.434a88ce.js.LICENSE.txt */
"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[30536],{82736:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>t,default:()=>h,frontMatter:()=>l,metadata:()=>c,toc:()=>d});var i=r(2488),s=r(62780);const l={title:"\u5fae\u4fe1\u5c0f\u7a0b\u5e8f"},t="\u5fae\u4fe1\u5c0f\u7a0b\u5e8f",c={id:"platform/wechat/wechat-miniprogram",title:"\u5fae\u4fe1\u5c0f\u7a0b\u5e8f",description:"- wxss/css",source:"@site/../notes/platform/wechat/wechat-miniprogram.md",sourceDirName:"platform/wechat",slug:"/platform/wechat/miniprogram",permalink:"/notes/platform/wechat/miniprogram",draft:!1,unlisted:!1,editUrl:"https://github.com/wenerme/wener/edit/master/notes/../notes/platform/wechat/wechat-miniprogram.md",tags:[],version:"current",lastUpdatedBy:"wener",lastUpdatedAt:1685087225,formattedLastUpdatedAt:"May 26, 2023",frontMatter:{title:"\u5fae\u4fe1\u5c0f\u7a0b\u5e8f"},sidebar:"docs",previous:{title:"\u5fae\u4fe1\u6d88\u606f",permalink:"/notes/platform/wechat/message"},next:{title:"\u5fae\u4fe1\u516c\u4f17\u53f7",permalink:"/notes/platform/wechat/officialaccount"}},o={},d=[{value:"wx",id:"wx",level:2},{value:"Library",id:"library",level:2},{value:"JS \u8bed\u6cd5",id:"js-\u8bed\u6cd5",level:2},{value:"CORS",id:"cors",level:2},{value:"\u8bf7\u6c42\u4f1a\u5305\u542b\u5e94\u7528\u4fe1\u606f",id:"\u8bf7\u6c42\u4f1a\u5305\u542b\u5e94\u7528\u4fe1\u606f",level:2},{value:"\u7528\u6237\u4fe1\u606f",id:"\u7528\u6237\u4fe1\u606f",level:2},{value:"SyntaxError: Unexpected token \uff1f",id:"syntaxerror-unexpected-token-",level:2},{value:"SyntaxError: Unexpected token .&quot;use strict&quot;;",id:"syntaxerror-unexpected-token-use-strict",level:2},{value:"miniprogram-ci 10009 undefined",id:"miniprogram-ci-10009-undefined",level:2}];function a(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.M)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"\u5fae\u4fe1\u5c0f\u7a0b\u5e8f",children:"\u5fae\u4fe1\u5c0f\u7a0b\u5e8f"}),"\n",(0,i.jsx)(n.admonition,{title:"\u8fd0\u884c\u65f6\u533a\u522b",type:"caution",children:(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["wxss/css\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u4e0d\u652f\u6301 ",(0,i.jsx)(n.code,{children:"*"})]}),"\n",(0,i.jsxs)(n.li,{children:["\u540d\u5b57\u4e0d\u80fd\u5305\u542b ",(0,i.jsx)(n.code,{children:":"}),",",(0,i.jsx)(n.code,{children:"#"}),",",(0,i.jsx)(n.code,{children:"/"}),",",(0,i.jsx)(n.code,{children:"["}),",",(0,i.jsx)(n.code,{children:"]"})]}),"\n",(0,i.jsxs)(n.li,{children:["\u4e0d\u652f\u6301\u6709\u4e9b\u573a\u666f\u7684 ",(0,i.jsx)(n.code,{children:"~"})]}),"\n",(0,i.jsx)(n.li,{children:"\u4e0d\u652f\u6301 rem"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["DOM \u73af\u5883\u65e0\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"fetch/Header/Request/Response"}),"\n",(0,i.jsx)(n.li,{children:"File/Blob/ReadableStream"}),"\n",(0,i.jsx)(n.li,{children:"FormData"}),"\n",(0,i.jsx)(n.li,{children:"AbortController/AbortSignal"}),"\n",(0,i.jsx)(n.li,{children:"URLSearchParams"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\u4e0d\u652f\u6301 svg \u6807\u7b7e\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u652f\u6301 canvas"}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://github.com/dntzhang/cax",children:"https://github.com/dntzhang/cax"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u901a\u8fc7 canvas \u6e32\u67d3 svg"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\u53ef\u4ee5\u901a\u8fc7 Image.src \u4f7f\u7528 svg\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://juejin.cn/post/6936529740433997861",children:"https://juejin.cn/post/6936529740433997861"})}),"\n",(0,i.jsx)(n.li,{children:"\u53ef\u4ee5 dataurl"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"\u6709 TextEncoder/TextDecoder/ArrayBuffer"}),"\n",(0,i.jsxs)(n.li,{children:["JS \u8bed\u6cd5\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u4e0d\u652f\u6301 ",(0,i.jsx)(n.code,{children:"??"}),", ",(0,i.jsx)(n.code,{children:"?."})]}),"\n",(0,i.jsxs)(n.li,{children:["\u4e0d\u652f\u6301 ",(0,i.jsx)(n.code,{children:"eval"}),", ",(0,i.jsx)(n.code,{children:"new Function"})]}),"\n",(0,i.jsx)(n.li,{children:"\u5185\u7f6e core-js"}),"\n"]}),"\n"]}),"\n"]})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"console.assert(globalThis === window);\nconst global = {\n  __wcc_version__: 'v0.5vv_20200413_syb_scopedata',\n  __wcc_version_info__: {\n    customComponents: true,\n    fixZeroRpx: true,\n    propValueDeepCopy: false,\n  },\n};\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://mp.weixin.qq.com/",children:"https://mp.weixin.qq.com/"})," \u767b\u5f55\u540e\u53f0"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://mp.weixin.qq.com/cgi-bin/wx",children:"https://mp.weixin.qq.com/cgi-bin/wx"})}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"wx",children:"wx"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"// Taro\nwx['webpackJsonp'];\nconsole.assert(wxModuleVersion === 2);\nWXWebAssembly;\n\n__wxAppCode__;\n__wxAppData;\n__wxAppCurrentFile__;\n__wxConfig;\n__wxRoute;\nwx.env;\n\n__wxAppCode__[__wxRoute + '.json'];\n__wxAppCode__[__wxRoute + '.wxml'];\n"})}),"\n",(0,i.jsx)(n.h2,{id:"library",children:"Library"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["NodeJS\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://www.npmjs.com/package/wx-server-sdk",children:"wx-server-sdk"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://cdn.jsdelivr.net/npm/wx-server-sdk/",children:"https://cdn.jsdelivr.net/npm/wx-server-sdk/"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"js-\u8bed\u6cd5",children:"JS \u8bed\u6cd5"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://github.com/wechat-miniprogram/miniprogram-compat",children:"wechat-miniprogram/miniprogram-compat"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://wechat-miniprogram.github.io/miniprogram-compat/",children:"https://wechat-miniprogram.github.io/miniprogram-compat/"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://developers.weixin.qq.com/miniprogram/dev/devtools/codecompile.html",children:"https://developers.weixin.qq.com/miniprogram/dev/devtools/codecompile.html"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://developers.weixin.qq.com/miniprogram/dev/framework/runtime/js-support.html",children:"https://developers.weixin.qq.com/miniprogram/dev/framework/runtime/js-support.html"})}),"\n"]}),"\n",(0,i.jsx)(n.h1,{id:"faq",children:"FAQ"}),"\n",(0,i.jsx)(n.h2,{id:"cors",children:"CORS"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"request \u8bf7\u6c42\u53ef\u4ee5\u76f4\u63a5\u4fee\u6539 Origin"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u56fe\u7247\u8d44\u6e90"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"cross-origin-resource-policy: cross-origin\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\u8bf7\u6c42\u4f1a\u5305\u542b\u5e94\u7528\u4fe1\u606f",children:"\u8bf7\u6c42\u4f1a\u5305\u542b\u5e94\u7528\u4fe1\u606f"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"referer: https://servicewechat.com/WXID/devtools/page-frame.html\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\u7528\u6237\u4fe1\u606f",children:"\u7528\u6237\u4fe1\u606f"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"const { appid, fakeId, nickName, openid, userName } = window.__INITIAL_STATE__.userInfo;\ncopy(JSON.stringify({ appid, fakeId, nickName, openid, userName }, null, 2));\n"})}),"\n",(0,i.jsx)(n.h2,{id:"syntaxerror-unexpected-token-",children:"SyntaxError: Unexpected token \uff1f"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"??"})," \u7684\u95ee\u9898"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"syntaxerror-unexpected-token-use-strict",children:'SyntaxError: Unexpected token ."use strict";'}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"?."})," \u7684\u95ee\u9898"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"miniprogram-ci-10009-undefined",children:"miniprogram-ci 10009 undefined"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\u4e0d\u8981\u628a miniprogram-ci \u5b89\u88c5\u5728\u73b0\u6709\u9879\u76ee\u91cc\uff0c\u592a\u591a\u4f9d\u8d56\u4e86"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"PROJECT_DIR=$PWD\nWXA_APP_ID=\nmkdir -p /tmp/wxa-ci\ncd /tmp/wxa-ci\npnpm init\npnpm add -D miniprogram-ci\n\npnpm miniprogram-ci upload --appid $WXA_APP_ID --pp $PROJECT_DIR/dist/weapp/ --pkp $PROJECT_DIR/private.key -r 1 -v --uv 1.0.0\n\n# by script\npnpm add -D tsx typescript\ncp $PROJECT_DIR/scripts/wxa-deploy.ts .\nenv PROJECT_DIR=$PROJECT_DIR pnpm tsx ./wxa-deploy.ts\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u9690\u85cf\u4e86\u5b9e\u9645\u7684 error\uff0c\u8c03\u6574\u5185\u90e8 js \u8f93\u51fa\u9519\u8bef\u53d1\u73b0\u662f"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"require() of ES Module ansi-styles from chalk not supported\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"chalk 5 is ESM"}),"\n",(0,i.jsx)(n.li,{children:"chalk 4 is CJS"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.M)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},38088:(e,n,r)=>{var i=r(96651),s=Symbol.for("react.element"),l=Symbol.for("react.fragment"),t=Object.prototype.hasOwnProperty,c=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function d(e,n,r){var i,l={},d=null,a=null;for(i in void 0!==r&&(d=""+r),void 0!==n.key&&(d=""+n.key),void 0!==n.ref&&(a=n.ref),n)t.call(n,i)&&!o.hasOwnProperty(i)&&(l[i]=n[i]);if(e&&e.defaultProps)for(i in n=e.defaultProps)void 0===l[i]&&(l[i]=n[i]);return{$$typeof:s,type:e,key:d,ref:a,props:l,_owner:c.current}}n.Fragment=l,n.jsx=d,n.jsxs=d},2488:(e,n,r)=>{e.exports=r(38088)},62780:(e,n,r)=>{r.d(n,{I:()=>c,M:()=>t});var i=r(96651);const s={},l=i.createContext(s);function t(e){const n=i.useContext(l);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);