/*! For license information please see 398d1173.4b5553a9.js.LICENSE.txt */
"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[62484],{31396:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>c,metadata:()=>i,toc:()=>o});var s=t(2488),r=t(62780);const c={title:"curl"},l="curl",i={id:"service/network/curl",title:"curl",description:"- manpage",source:"@site/../notes/service/network/curl.md",sourceDirName:"service/network",slug:"/service/network/curl",permalink:"/notes/service/network/curl",draft:!1,unlisted:!1,editUrl:"https://github.com/wenerme/wener/edit/master/notes/../notes/service/network/curl.md",tags:[],version:"current",lastUpdatedBy:"wener",lastUpdatedAt:1702440128,formattedLastUpdatedAt:"Dec 13, 2023",frontMatter:{title:"curl"},sidebar:"docs",previous:{title:"coturn",permalink:"/notes/service/network/coturn"},next:{title:"GFW",permalink:"/notes/service/network/gfw"}},d={},o=[{value:"\u6d4b\u8bd5 CORS",id:"\u6d4b\u8bd5-cors",level:2},{value:"\u5ef6\u65f6",id:"\u5ef6\u65f6",level:2},{value:"websocket",id:"websocket",level:2},{value:"Mark bundle as not supporting multiuse",id:"mark-bundle-as-not-supporting-multiuse",level:2},{value:"bad range specification in URL position",id:"bad-range-specification-in-url-position",level:2},{value:"CApath: none",id:"capath-none",level:2},{value:"hang after TLS handshake, Client hello",id:"hang-after-tls-handshake-client-hello",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.M)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"curl",children:"curl"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://curl.se/docs/manpage.html",children:"manpage"})}),"\n",(0,s.jsx)(n.li,{children:"-J \u4f7f\u7528\u670d\u52a1\u7aef\u8fd4\u56de\u7684\u540d\u5b57"}),"\n",(0,s.jsxs)(n.li,{children:["--remote-name-all\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u9ed8\u8ba4 ",(0,s.jsx)(n.code,{children:"-O"})," \u53ea\u5f71\u54cd\u7b2c\u4e00\u4e2a"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\u652f\u6301\u534f\u8bae\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"file"}),"\n",(0,s.jsx)(n.li,{children:"sftp, ftp, ftps"}),"\n",(0,s.jsx)(n.li,{children:"dict gopher gophers http https imap imaps ldap ldaps mqtt pop3 pop3s rtsp smb smbs smtp smtps telnet tftp"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# \u6d4b\u8bd5 SNI\n# resolve \u4e0d\u53ef\u4ee5\u6307\u5b9a\u8fdc\u7a0b port\n# connect-to \u53ef\u4ee5\u6307\u5b9a port\ncurl -vik --resolve example.com:8443:127.0.0.1 https://example.com:8443\ncurl -vik --resolve example.com:443:127.0.0.1 https://example.com\n\ncurl -vik --connect-to example.com:443:127.0.0.1:8443 https://example.com\n\ncurl -H \"Host: www.example.com\" http://localhost/\n\n# \u534f\u8bae\u9650\u5b9a\ncurl --http1.1 --no-alpn --no-npn --tlsv1.2 --tls-max 1.2 https://example.com\n\ncurl -sI https://curl.se -o/dev/null -w '%{http_version}\\n'\ncurl -sI --http3 https://curl.se -o/dev/null -w '%{http_version}\\n'\n"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"flag"}),(0,s.jsx)(n.th,{children:"since"}),(0,s.jsx)(n.th,{children:"for"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"-X, --request <method>"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"-x, --proxy [protocol://]host[:port]"})}),(0,s.jsx)(n.td,{}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"https?"}),",",(0,s.jsx)(n.code,{children:"socks{4,5}{a,h}"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"--json <data>"})}),(0,s.jsx)(n.td,{children:"7.82"}),(0,s.jsx)(n.td,{children:"--data+POST+Content-Type+Accept"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"--output-dir <dir>"})}),(0,s.jsx)(n.td,{children:"7.73"}),(0,s.jsx)(n.td,{children:"\u6307\u5b9a\u8f93\u51fa\u76ee\u5f55"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"--create-dirs"})}),(0,s.jsx)(n.td,{}),(0,s.jsxs)(n.td,{children:["\u521b\u5efa\u8f93\u51fa\u76ee\u5f55 mode=",(0,s.jsx)(n.code,{children:"0750"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"-C, --continue-at <offset>"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"\u7ee7\u7eed\u4e0b\u8f7d"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"--remote-name-all"})}),(0,s.jsx)(n.td,{}),(0,s.jsxs)(n.td,{children:["\u5168\u90e8\u4f7f\u7528 remote-name - URL \u6587\u4ef6\u540d\u90e8\u5206 - ",(0,s.jsx)(n.code,{children:"-O"})," \u53ea\u5f71\u54cd\u7b2c\u4e00\u4e2a"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"-O, --remote-name"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"\u7b2c\u4e00\u4e2a\u4f7f\u7528 remote-name"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"-J, --remote-header-name"})}),(0,s.jsx)(n.td,{}),(0,s.jsxs)(n.td,{children:["\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"Content-Disposition"})," \u5934\u91cc\u7684\u6587\u4ef6\u540d"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"--create-file-mode <mode>"})}),(0,s.jsx)(n.td,{children:"7.75"}),(0,s.jsx)(n.td,{})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"--dns-servers NS"}),(0,s.jsx)(n.td,{children:"7.33"}),(0,s.jsx)(n.td,{children:"c-ares"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"-Z, --parallel"}),(0,s.jsx)(n.td,{children:"7.66"}),(0,s.jsx)(n.td,{})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"--parallel-max <num>"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"50"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"--haproxy-protocol"}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"\u6d4b\u8bd5 HAProxy \u4ee3\u7406"})]})]})]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["proxy\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"port=1080"}),"\n",(0,s.jsx)(n.li,{children:"socks5h - \u4f7f\u7528 \u4ee3\u7406 resolve \u540d\u5b57\u800c\u975e\u672c\u5730 dns"}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"-p, --proxytunnel"})," - \u4f7f\u7528 HTTP CONNECT"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"curl -LOJC- https://example.com/pancakes.jpg # \u7ee7\u7eed\u4e0a\u6b21\u4e0b\u8f7d\u4f4d\u7f6e\n\n# \u4e0b\u8f7d\u5230\u6307\u5b9a\u76ee\u5f55\uff0c\u76ee\u5f55\u4e0d\u5b58\u5728\u5219\u521b\u5efa\ncurl --create-dirs -O --output-dir /tmp/receipes https://example.com/pancakes.jpg\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\u6d4b\u8bd5-cors",children:"\u6d4b\u8bd5 CORS"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'curl --head \\\n  -H "Origin: http://example.com" \\\n  -H "Access-Control-Request-Method: POST" \\\n  -H "Access-Control-Request-Headers: X-Requested-With" \\\n  -X OPTIONS --verbose \\\n  https://www.googleapis.com/discovery/v1/apis\n'})}),"\n",(0,s.jsx)(n.h2,{id:"\u5ef6\u65f6",children:"\u5ef6\u65f6"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# %{stderr} \u5199\u5165\u5230 stderr\ncat << EOF > curl-format.txt\n     time_namelookup:  %{time_namelookup}s\\n\n        time_connect:  %{time_connect}s\\n\n     time_appconnect:  %{time_appconnect}s\\n\n    time_pretransfer:  %{time_pretransfer}s\\n\n       time_redirect:  %{time_redirect}s\\n\n  time_starttransfer:  %{time_starttransfer}s\\n\n                      ----------\\n\n          time_total:  %{time_total}s\\n\nEOF\n# https://everything.curl.dev/usingcurl/verbose/writeout\ncurl -o /dev/null -s -w "@curl-format.txt" https://wener.me\ncat curl-format.txt | curl -o /dev/null -s -w @- https://wener.me\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"     time_namelookup:  0.001639s\n        time_connect:  1.230475s\n     time_appconnect:  1.708174s\n    time_pretransfer:  1.708254s\n       time_redirect:  0.000000s\n  time_starttransfer:  1.962050s\n                      ----------\n          time_total:  1.971632s\n"})}),"\n",(0,s.jsx)(n.h1,{id:"faq",children:"FAQ"}),"\n",(0,s.jsx)(n.h2,{id:"websocket",children:"websocket"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'curl --include \\\n  --no-buffer \\\n  --header "Connection: Upgrade" \\\n  --header "Upgrade: websocket" \\\n  --header "Host: example.com:80" \\\n  --header "Origin: http://example.com:80" \\\n  --header "Sec-WebSocket-Key: SGVsbG8sIHdvcmxkIQ==" \\\n  --header "Sec-WebSocket-Version: 13" \\\n  http://example.com:80/\n\n# https://github.com/vi/websocat\napk add websocat\n\nwebsocat -vv \'wss://\'\n'})}),"\n",(0,s.jsx)(n.h2,{id:"mark-bundle-as-not-supporting-multiuse",children:"Mark bundle as not supporting multiuse"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"HTTP/2 \u68c0\u6d4b"}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/curl/curl/blob/da973165965962a435a23ade336d9a17daf044ef/lib/http.c#L4276-L4279",children:"lib/http.c#L4276-L4279"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:'if(conn->httpversion < 20) {\n   conn->bundle->multiuse = BUNDLE_NO_MULTIUSE;\n   infof(data, "Mark bundle as not supporting multiuse\\n");\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"bad-range-specification-in-url-position",children:"bad range specification in URL position"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"-g/--globoff"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'curl -g "https://wener.me/[1,2]"\n'})}),"\n",(0,s.jsx)(n.h2,{id:"capath-none",children:"CApath: none"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"CAfile: /etc/ssl/certs/ca-certificates.crt\nCApath: none\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"CURL_CA_BUNDLE"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# /usr/share/ca-certificates\napk add ca-certificates\n\n# /etc/ssl/certs/ca-certificates.crt\n# /etc/ssl/cert.pem\n# /etc/ssl1.1/cert.pem\n# /etc/ssl1.1/certs\napk add ca-certificates-bundle\n"})}),"\n",(0,s.jsx)(n.h2,{id:"hang-after-tls-handshake-client-hello",children:"hang after TLS handshake, Client hello"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u53ef\u80fd\u662f MTU \u95ee\u9898"}),"\n",(0,s.jsxs)(n.li,{children:["docker in docker \u7684\u65f6\u5019\u51fa\u73b0\u4e86\uff0c\u8c03\u4f4e mtu\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"dockerd --mtu=1400"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/microsoft/WSL/issues/4698#issuecomment-871279847",children:"https://github.com/microsoft/WSL/issues/4698#issuecomment-871279847"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://serverfault.com/questions/231036",children:"https://serverfault.com/questions/231036"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.M)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},38088:(e,n,t)=>{var s=t(96651),r=Symbol.for("react.element"),c=Symbol.for("react.fragment"),l=Object.prototype.hasOwnProperty,i=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,d={key:!0,ref:!0,__self:!0,__source:!0};function o(e,n,t){var s,c={},o=null,a=null;for(s in void 0!==t&&(o=""+t),void 0!==n.key&&(o=""+n.key),void 0!==n.ref&&(a=n.ref),n)l.call(n,s)&&!d.hasOwnProperty(s)&&(c[s]=n[s]);if(e&&e.defaultProps)for(s in n=e.defaultProps)void 0===c[s]&&(c[s]=n[s]);return{$$typeof:r,type:e,key:o,ref:a,props:c,_owner:i.current}}n.Fragment=c,n.jsx=o,n.jsxs=o},2488:(e,n,t)=>{e.exports=t(38088)},62780:(e,n,t)=>{t.d(n,{I:()=>i,M:()=>l});var s=t(96651);const r={},c=s.createContext(r);function l(e){const n=s.useContext(c);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),s.createElement(c.Provider,{value:n},e.children)}}}]);