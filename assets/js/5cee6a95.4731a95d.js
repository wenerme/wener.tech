/*! For license information please see 5cee6a95.4731a95d.js.LICENSE.txt */
"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[75118],{60410:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>t,default:()=>h,frontMatter:()=>l,metadata:()=>a,toc:()=>d});var i=s(11527),r=s(47214);const l={title:"Android"},t="Android",a={id:"os/android/README",title:"Android",description:"- \u5b89\u5353",source:"@site/../notes/os/android/README.md",sourceDirName:"os/android",slug:"/os/android/",permalink:"/notes/os/android/",draft:!1,unlisted:!1,editUrl:"https://github.com/wenerme/wener/edit/master/notes/../notes/os/android/README.md",tags:[],version:"current",lastUpdatedBy:"wener",lastUpdatedAt:1702882608,formattedLastUpdatedAt:"Dec 18, 2023",frontMatter:{title:"Android"},sidebar:"docs",previous:{title:"Alpine Virt",permalink:"/notes/os/alpine/virt"},next:{title:"Android Awesome",permalink:"/notes/os/android/awesome"}},o={},d=[{value:"Shell",id:"shell",level:2},{value:"Touch Event",id:"touch-event",level:3},{value:"\u5c06 HttpClient \u7684\u65e5\u5fd7\u8f93\u51fa\u5230 Logcat",id:"\u5c06-httpclient-\u7684\u65e5\u5fd7\u8f93\u51fa\u5230-logcat",level:2},{value:"\u5728 APK \u4e2d\u6ce8\u5165\u4ee3\u7801",id:"\u5728-apk-\u4e2d\u6ce8\u5165\u4ee3\u7801",level:2},{value:"\u4ee3\u7801\u6ce8\u5165",id:"\u4ee3\u7801\u6ce8\u5165",level:3}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"android",children:"Android"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u5b89\u5353"}),"\n",(0,i.jsxs)(n.li,{children:["APK \u4e0b\u8f7d\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://apkpure.com/",children:"https://apkpure.com/"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"http://apk-dl.com/",children:"http://apk-dl.com/"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"http://www.apkmirror.com/",children:"http://www.apkmirror.com/"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"http://cn.jide.com/",children:"http://cn.jide.com/"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\u7248\u672c\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Play 2018.8 \u8981\u6c42\u6700\u4f4e API Level 26 - Android 8.0\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/facebook/react-native/issues/17287",children:"facebook/react-native#17287"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://android-developers.googleblog.com/2017/12/improving-app-security-and-performance.html",children:"Improving app security and performance on Google Play for years to come"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://www.statista.com/statistics/271774/share-of-android-platforms-on-mobile-devices-with-android-os/",children:"Android version market share distribution among smartphone owners as of September 2018"})}),"\n",(0,i.jsxs)(n.li,{children:["Device Id\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://developer.android.com/training/articles/user-data-ids",children:"https://developer.android.com/training/articles/user-data-ids"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"shell",children:"Shell"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Simulate fast tap\n# /mnt/sdcard/events \u662f\u4ece dev \u4e2d\u83b7\u53d6\u5230\u7684\nadb shell \"while true;do cat /mnt/sdcard/events > /dev/input/event1 && sleep 0.01; done;\"\n\n# \u8bbe\u5907 ID\nadb shell settings get secure android_id\n# \u67e5\u770b\u5f53\u524d Activity \u7684\u540d\u5b57\nadb shell dumpsys activity | grep mFocusedActivity\n# \u4e32\u53f7\nadb shell getprop ro.serialno\n# \u67e5\u770b\u8bbe\u5907\u4fe1\u606f Android < 5.0\nadb shell dumpsys iphonesubinfo\n# \u901a\u8fc7 TCP \u94fe\u63a5\nadb tcpip 5555\nadb connect 192.168.0.101:5555\nadb shell ip -f inet addr show wlan0\n# \u6062\u590d\u4e3a USB \u94fe\u63a5\nadb usb\n\n# \u670d\u52a1\u8c03\u7528\n# http://ktnr74.blogspot.com/2014/09/calling-android-services-from-adb-shell.html\n# \u83b7\u53d6 IMEI\nadb shell service call iphonesubinfo 1 | awk -F \"'\" '{print $2}' | sed 's/[^0-9A-F]*//g' | tr -d '\\n' && echo\n# 1  getDeviceId\n# 2  getDeviceIdForSubscriber\n# 3  getImeiForSubscriber\n# 4  getDeviceSvn\n# 5  getSubscriberId\n# 6  getSubscriberIdForSubscriber\n# 7  getGroupIdLevel1\n# 8  getGroupIdLevel1ForSubscriber\n# 9  getIccSerialNumber\n# 10  getIccSerialNumberForSubscriber\n# 11  getLine1Number\n# 12  getLine1NumberForSubscriber\n# 13  getLine1AlphaTag\n# 14  getLine1AlphaTagForSubscriber\n# 15  getMsisdn\n# 16  getMsisdnForSubscriber\n# 17  getVoiceMailNumber\n# 18  getVoiceMailNumberForSubscriber\n# 19  getCompleteVoiceMailNumber\n# 20  getCompleteVoiceMailNumberForSubscriber\n# 21  getVoiceMailAlphaTag\n# 22  getVoiceMailAlphaTagForSubscriber\n# 23  getIsimImpi\n# 24  getIsimDomain\n# 25  getIsimImpu\n# 26  getIsimIst\n# 27  getIsimPcscf\n# 28  getIsimChallengeResponse\n# 29  getIccSimChallengeResponse\n\n# \u83b7\u53d6\u5c4f\u5e55\u4e0a\u7684\u989c\u8272\n# <bytes per pixel> \u4e00\u822c\u4e3a4\n# <pixel offset> = Y * width + X\n# \u9700\u8981 ROOT \u6743\u9650\nadb shell \"dd if=/dev/graphics/fb0 bs=<bytes per pixel> count=1 skip=<pixel offset> 2>/dev/null | hd\"\n# \u83b7\u53d6\u5c4f\u5e55\u5bbd\u5ea6\nadb shell getprop ro.sf.lcd_density\n\n# \u62c9\u53d6\u6240\u6709\u7167\u7247\nadb pull /mnt/sdcard/DCIM/\n\n# \u77ed\u4fe1\n# \u6570\u636e\u5e93\u6587\u4ef6\u9700\u8981 root \u6743\u9650\n# /data/data/com.android.providers.telephony/databases/mmssms.db\n# \u53ef\u4f7f\u7528 APP \u5907\u4efd\u7136\u540e\u4e0b\u8f7d\n# https://play.google.com/store/apps/details?id=com.riteshsahu.SMSBackupRestore\n# \u5907\u4efd\u540e\u62c9\u53d6\u5373\u53ef\nadb pull /mnt/sdcard/SMSBackupRestore\n"})}),"\n",(0,i.jsx)(n.h3,{id:"touch-event",children:"Touch Event"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# \u67e5\u770b\u6240\u6709\u7684\u8bbe\u5907,\u6709 MT_TOUCH \u4e3a\u89e6\u6478\u8bbe\u5907\ngetevent -pl\n# \u5047\u8bbe /dev/input/event1 \u4e3a\u89e6\u6478\u8bbe\u5907\n# \u8bb0\u5f55\u6240\u6709\u7684\u64cd\u4f5c, \u9700\u624b\u52a8\u4e2d\u65ad\ncat /dev/input/event1 > event-dump\n# \u56de\u653e\u8bb0\u5f55\u7684\u64cd\u4f5c\ncat event-dump > /dev/input/event1\n# \u53ef\u547d\u4ee4\u884c\u64cd\u4f5c tap\ninput tap 233 466\n# \u67e5\u770b\u6240\u6709\u64cd\u4f5c\u7684\u4e8b\u4ef6\ngetevent -l\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\u5c06-httpclient-\u7684\u65e5\u5fd7\u8f93\u51fa\u5230-logcat",children:"\u5c06 HttpClient \u7684\u65e5\u5fd7\u8f93\u51fa\u5230 Logcat"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u4ee3\u7801"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'java.util.logging.Logger.getLogger("org.apache.http.wire").setLevel(java.util.logging.Level.FINEST);\njava.util.logging.Logger.getLogger("org.apache.http.headers").setLevel(java.util.logging.Level.FINEST);\n\nSystem.setProperty("org.apache.commons.logging.Log", "org.apache.commons.logging.impl.SimpleLog");\nSystem.setProperty("org.apache.commons.logging.simplelog.showdatetime", "true");\nSystem.setProperty("org.apache.commons.logging.simplelog.log.httpclient.wire", "debug");\nSystem.setProperty("org.apache.commons.logging.simplelog.log.org.apache.http", "debug");\nSystem.setProperty("org.apache.commons.logging.simplelog.log.org.apache.http.headers", "debug");\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u547d\u4ee4\u884c"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'adb shell setprop log.tag.org.apache.http VERBOSE\nadb shell setprop log.tag.org.apache.http.wire VERBOSE\nadb shell setprop log.tag.org.apache.http.headers VERBOSE\n\nadb logcat -s "org.apache.http.wire" -s "log.tag.org.apache.http.headers" -s "org.apache.http"\n'})}),"\n",(0,i.jsx)(n.h2,{id:"\u5728-apk-\u4e2d\u6ce8\u5165\u4ee3\u7801",children:"\u5728 APK \u4e2d\u6ce8\u5165\u4ee3\u7801"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u5de5\u5177\u51c6\u5907\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Android Studio\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u5b89\u88c5 ",(0,i.jsx)(n.a,{href:"https://github.com/JesusFreke/smali/wiki/smalidea",children:"SmaliIdea"})," \u63d2\u4ef6\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u53ea\u80fd\u901a\u8fc7\u4e0b\u8f7d\u5b89\u88c5"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"\u5b89\u88c5 Java2Smali \u63d2\u4ef6 - \u53ef\u5728\u63d2\u4ef6\u4ed3\u5e93\u4e2d\u641c\u7d22\u5230"}),"\n",(0,i.jsx)(n.li,{children:"\u914d\u5408 ddms \u53ef\u76f4\u63a5\u5728 smali \u4e2d\u6253\u65ad\u70b9\u8fdb\u884c\u8c03\u8bd5"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"http://ibotpeaches.github.io/Apktool/documentation",children:"APKTool"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\u53ef\u9009\u5de5\u5177\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://github.com/pxb1988/dex2jar",children:"dex2jar"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u53ef\u5c06 dex \u8f6c\u4e3a jar, \u7136\u540e\u5728 idea \u4e2d\u67e5\u770b\u7684\u53cd\u7f16\u8bd1\u5185\u5bb9,\u6bd4 smali \u76f4\u89c2"}),"\n",(0,i.jsxs)(n.li,{children:["\u53ef\u5c06\u8f6c\u6362\u540e\u7684 jar \u6dfb\u52a0\u5230\u7c7b\u8def\u5f84,\u7136\u540e\u5728\u4e66\u5199\u6ce8\u5165\u7c7b\u65f6\u5c31\u53ef\u4ee5\u76f4\u63a5\u5f15\u7528\u5176\u4ed6 smali \u7684\u7c7b,\u5426\u5219\u53ea\u80fd\u4f7f\u7528\u53cd\u5c04\u6765\u64cd\u4f5c\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Java \u65e0\u6cd5\u5f15\u7528 smali \u4e2d\u7684\u5185\u5bb9"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"\u5982\u679c\u60f3\u8981\u6dfb\u52a0\u65b0\u7684 jar \u5230\u9879\u76ee,\u9700\u8981\u4f7f\u7528 dex2smali,\u7136\u540e\u5c06\u6240\u6709\u7684 smali \u6dfb\u52a0\u5230\u9879\u76ee"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u547d\u4ee4\u884c\u64cd\u4f5c\u6d41\u7a0b"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# \u5c06 APK \u89e3\u538b\u5230 ./my\napktool d my.apk\n# \u5c06 ./my \u5bfc\u5165\u5230 idea\n# \u5c06 ./my/smali \u8bbe\u7f6e\u4e3a \u6e90\u7801\u76ee\u5f55\n\n# \u4fee\u6539\u9879\u76ee\u5185\u5bb9\n\n# \u6784\u5efa\u4fee\u6539\u540e\u7684\u9879\u76ee,\u7ed3\u679c\u4e3a ./my/dist/my.apk\napktool b my\n\n# \u53c2\u8003 https://developer.android.com/studio/publish/app-signing.html#signing-manually\n# \u5982\u679c\u6ca1\u6709 my-release-key.keystore \u5219\u9700\u8981\u6267\u884c\u4e0b\u9762\u8fd9\u4e00\u6b65\u751f\u6210 keystore,\u5982\u679c\u6709\u4e86,\u5219\u53ef\u4ee5\u8df3\u8fc7\n# keytool -genkey -v -keystore my-release-key.keystore -alias alias_name -keyalg RSA -keysize 2048 -validity 10000\n# \u7b7e\u540d\u540e\u53ef\u4f7f\u7528 jarsigner -verify -verbose -certs my_application.apk \u6765\u9a8c\u8bc1\u7b7e\u540d\n\n# \u4f7f\u7528 my-release-key.keystore \u5bf9 APK \u8fdb\u884c\u7b7e\u540d\njarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore my-release-key.keystore my/dist/my.apk alias_name\n# \u5b89\u88c5\u5230\u8bbe\u5907\nadb install -r my/dist/my.apk\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u5176\u5b83\u64cd\u4f5c"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# \u5bf9 apk \u89e3\u538b\u53ef\u62ff\u5230\u4ee3\u7801\u6587\u4ef6\nunzip my.apk -d apk # \u4ee3\u7801\u4e3a apk/classes.dex\n# \u5c06 Dex \u8f6c\u4e3a jar - classes-dex2jar.jar\nd2j-dex2jar classes.dex\n# \u5c06 classes-dex2jar.jar \u6dfb\u52a0\u5230\u9879\u76ee\u7c7b\u8def\u5f84\u5219\u53ef\u4ee5\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u4ee3\u7801\u6ce8\u5165",children:"\u4ee3\u7801\u6ce8\u5165"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u4f7f\u7528 Java \u7f16\u5199\u5165\u53e3\u70b9\u7c7b"}),"\n",(0,i.jsx)(n.li,{children:"\u5c06\u5176\u8f6c\u6362\u4e3a Smali"}),"\n",(0,i.jsx)(n.li,{children:"\u5728\u542f\u52a8\u65f6\u6302\u8f7d\u8be5\u5165\u53e3"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["\u5728 ",(0,i.jsx)(n.code,{children:"./my/smali/my"})," \u4e0b\u6dfb\u52a0 Extra \u7c7b\u4f5c\u4e3a\u6ce8\u5165\u5165\u53e3"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Extra.java"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'package my;\nimport android.util.Log;\n// \u6ce8\u5165\u5165\u53e3\npublic class Extra{\n  public static void init(){\n    Log.w("Injected", "Init");\n  }\n}\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u7136\u540e\u83dc\u5355 ",(0,i.jsx)(n.code,{children:"Build -> Compile to smali"}),", \u4f1a\u5728\u76f8\u540c\u76ee\u5f55\u4e0b\u751f\u6210 ",(0,i.jsx)(n.code,{children:"Extra.smali"})]}),"\n",(0,i.jsxs)(n.li,{children:["\u5728 ",(0,i.jsx)(n.code,{children:"AndroidManifest.xml"})," \u4e2d\u627e\u5230\u4e3b\u7a0b\u5e8f\u5165\u53e3,\u6807\u7b7e\u4e3a ",(0,i.jsx)(n.code,{children:'<application android:name="me.wener.hello.MainApplication">'})]}),"\n",(0,i.jsxs)(n.li,{children:["\u627e\u5230\u4e3b\u7a0b\u5e8f\u7684\u5bf9\u5e94 smali \u6587\u4ef6, \u4e0a\u4f8b\u4e2d\u7684\u5165\u53e3\u4e3a ",(0,i.jsx)(n.code,{children:"smali/me/wener/hello/MainApplication.smali"})]}),"\n",(0,i.jsxs)(n.li,{children:["\u7136\u540e\u627e\u5230 ",(0,i.jsx)(n.code,{children:".method public onCreate()V"})," onCreate \u65b9\u6cd5,\u5728\u4e0b\u9762\u6dfb\u52a0 ",(0,i.jsx)(n.code,{children:"invoke-static {}, Lmy/Extra;->init()V"})," \u6765\u8c03\u7528\u6211\u4eec\u7684\u6ce8\u5165\u5185\u5bb9\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u6839\u636e\u9700\u8981\u6ce8\u5165\u7684\u5185\u5bb9\u4e0d\u540c,\u53ef\u9009\u62e9\u4e0d\u540c\u7684\u6ce8\u5165\u70b9: \u6784\u9020\u51fd\u6570,\u9759\u6001\u6784\u9020\u51fd\u6570,onCreate \u7b49"}),"\n",(0,i.jsx)(n.li,{children:"\u9700\u8981\u5728\u5176\u4ed6\u5730\u65b9\u6ce8\u5165\u4ee3\u7801\u65f6\u64cd\u4f5c\u4e5f\u662f\u4e00\u6837\u7684"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"\u7136\u540e\u53c2\u7167\u4e0a\u8ff0\u547d\u4ee4\u884c\u64cd\u4f5c,\u91cd\u65b0\u5c06\u8be5\u9879\u76ee\u6784\u5efa\u4e3a\u4e00\u4e2a APK \u5373\u53ef"}),"\n",(0,i.jsxs)(n.li,{children:["\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:'adb logcat -s "Injected"'})," \u6765\u67e5\u770b\u5728\u6ce8\u5165\u4ee3\u7801\u4e2d\u6253\u5370\u7684\u65e5\u5fd7"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},3354:(e,n,s)=>{var i=s(50959),r=Symbol.for("react.element"),l=Symbol.for("react.fragment"),t=Object.prototype.hasOwnProperty,a=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function d(e,n,s){var i,l={},d=null,c=null;for(i in void 0!==s&&(d=""+s),void 0!==n.key&&(d=""+n.key),void 0!==n.ref&&(c=n.ref),n)t.call(n,i)&&!o.hasOwnProperty(i)&&(l[i]=n[i]);if(e&&e.defaultProps)for(i in n=e.defaultProps)void 0===l[i]&&(l[i]=n[i]);return{$$typeof:r,type:e,key:d,ref:c,props:l,_owner:a.current}}n.Fragment=l,n.jsx=d,n.jsxs=d},11527:(e,n,s)=>{e.exports=s(3354)},47214:(e,n,s)=>{s.d(n,{Z:()=>a,a:()=>t});var i=s(50959);const r={},l=i.createContext(r);function t(e){const n=i.useContext(l);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);