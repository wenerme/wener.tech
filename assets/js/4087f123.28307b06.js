/*! For license information please see 4087f123.28307b06.js.LICENSE.txt */
"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([[51924],{10352:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>c,contentTitle:()=>d,default:()=>a,frontMatter:()=>l,metadata:()=>t,toc:()=>h});var r=s(11527),i=s(47214);const l={id:"dns",title:"DNS"},d="DNS",t={id:"network/application/dns",title:"DNS",description:"Tips",source:"@site/../notes/network/application/dns.md",sourceDirName:"network/application",slug:"/network/application/dns",permalink:"/notes/network/application/dns",draft:!1,unlisted:!1,editUrl:"https://github.com/wenerme/wener/edit/master/notes/../notes/network/application/dns.md",tags:[],version:"current",lastUpdatedBy:"wener",lastUpdatedAt:1645033829,formattedLastUpdatedAt:"Feb 16, 2022",frontMatter:{id:"dns",title:"DNS"},sidebar:"docs",previous:{title:"OKR",permalink:"/notes/mgmt/theory/okr"},next:{title:"SNMP",permalink:"/notes/network/application/snmp"}},c={},h=[{value:"Tips",id:"tips",level:2},{value:"\u670d\u52a1",id:"\u670d\u52a1",level:2},{value:"coredns",id:"coredns",level:2},{value:"dnsupdate",id:"dnsupdate",level:2},{value:"dig",id:"dig",level:2},{value:"FAQ",id:"faq",level:3},{value:"\u516c\u5171 DSN",id:"\u516c\u5171-dsn",level:4},{value:"\u5c06\u65e5\u5fd7\u8bb0\u5f55\u5230\u6587\u4ef6",id:"\u5c06\u65e5\u5fd7\u8bb0\u5f55\u5230\u6587\u4ef6",level:4},{value:"DDNS",id:"ddns",level:4},{value:"\u4f18\u5316",id:"\u4f18\u5316",level:3}];function o(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.a)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.h1,{id:"dns",children:"DNS"}),"\n",(0,r.jsx)(e.h2,{id:"tips",children:"Tips"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://en.wikipedia.org/wiki/Comparison_of_DNS_server_software",children:"Comparison of DNS server software"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://www.isc.org/community/rfcs/dns/",children:"DNS RFC"})}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"https://tools.ietf.org/html/rfc2136",children:"rfc2136"})," - Dynamic Updates in the Domain Name System (DNS UPDATE)\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://en.wikipedia.org/wiki/Dynamic_DNS",children:"Dynamic DNS:wiki"})}),"\n",(0,r.jsxs)(e.li,{children:["caddy ",(0,r.jsx)(e.a,{href:"https://caddyserver.com/docs/tls.dns.rfc2136",children:"tls.dns.rfc2136"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"https://intodns.com",children:"intodns"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"DNS \u68c0\u6d4b"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://zh.wikipedia.org/zh-cn/%E5%9F%9F%E5%90%8D%E7%B3%BB%E7%BB%9F",children:"DNS"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://en.wikipedia.org/wiki/List_of_DNS_record_types",children:"List of DNS record types"})}),"\n",(0,r.jsxs)(e.li,{children:["\u5237\u65b0 Google ",(0,r.jsx)(e.a,{href:"https://developers.google.com/speed/public-dns/cache",children:"Public DNS"})]}),"\n",(0,r.jsx)(e.li,{children:"SOA - Start of [a zone of] authority record"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"Primary nameserver: ns.wener.me\nHostmaster E-mail address: hostmaster.i.wener.me\nSerial #: 1\nRefresh: 10800\nRetry: 3600\nExpire: 604800   1 weeks\nDefault TTL: 3600\n"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"TSIG - Transaction Signature"}),"\n",(0,r.jsxs)(e.li,{children:["KSK - Key Signing Key\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u662f\u4e00\u5bf9\u516c\u94a5\u79c1\u94a5."}),"\n",(0,r.jsx)(e.li,{children:"\u79c1\u94a5\u7528\u4e8e\u751f\u6210 ZSK \u7684\u6570\u5b57\u7b7e\u540d. \u516c\u94a5\u5b58\u50a8\u4e8e DNS, \u7528\u4e8e\u5bf9 ZSK \u8fdb\u884c\u8ba4\u8bc1"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["ZSK - Zone Signing Key\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u662f\u4e00\u5bf9\u516c\u94a5\u79c1\u94a5."}),"\n",(0,r.jsx)(e.li,{children:"\u79c1\u94a5\u7528\u4e8e\u751f\u6210\u6570\u5b57\u7b7e\u540d, \u5373\u4e3a\u6bcf\u4e2a RRSET \u751f\u6210 RSSIG(Resource Record Signature).\u516c\u94a5\u5b58\u50a8\u4e8e DNS \u7528\u4e8e\u5bf9 RRSIG \u8fdb\u884c\u8ba4\u8bc1."}),"\n",(0,r.jsx)(e.li,{children:"\u6bcf\u4e2a DNSSET \u4e2d\u7b7e\u540d\u7684 zone \u90fd\u7531 RRSIG \u4fdd\u62a4"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["AXFR - Authoritative Zone Transfer\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://en.wikipedia.org/wiki/DNS_zone_transfer",children:"DNS zone transfer"})}),"\n",(0,r.jsxs)(e.li,{children:["PowerDNS ",(0,r.jsx)(e.a,{href:"https://github.com/PowerDNS/pdns/wiki/AXFR-FAQ",children:"AXFR-FAQ"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["References\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://www.cloudflare.com/dns/dnssec/how-dnssec-works/",children:"How DNSSEC works"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"http://tinydns.org/",children:"http://tinydns.org/"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://github.com/miekg/dns",children:"https://github.com/miekg/dns"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"http://social.dnsmadeeasy.com/blog/authoritative-vs-recursive-dns-servers-whats-the-difference/",children:"Authoritative vs. Recursive DNS Servers: What\u2019s The Difference?"})}),"\n",(0,r.jsxs)(e.li,{children:["dnsimple ",(0,r.jsx)(e.a,{href:"https://support.dnsimple.com/categories/dns/",children:"DNS FAQ"})]}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://support.dnsimple.com/articles/differences-between-a-cname-alias-url/",children:"Differences between the A, CNAME, ALIAS and URL records"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"\u670d\u52a1",children:"\u670d\u52a1"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.a,{href:"https://www.knot-dns.cz/",children:"https://www.knot-dns.cz/"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"C + Lua"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.a,{href:"https://github.com/tenta-browser/tenta-dns",children:"tenta-browser/tenta-dns"})," Recursive and authoritative DNS server in go, including DNSSEC and DNS-over-TLS"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://news.ycombinator.com/item?id=15796943",children:"HN"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"coredns",children:"coredns"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://coredns.io/",children:"https://coredns.io/"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://github.com/coredns/coredns",children:"https://github.com/coredns/coredns"})}),"\n",(0,r.jsx)(e.li,{children:"CNCF \u4e0b\u7684\u9879\u76ee"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"coredns -conf Corefile -dns.port 1053\n\ndig -p 1053 @localhost AAAA www.example.org +noall +answer\n\nnslookup -type=A twitter.com 1.0.0.1\nnslookup -type=A twitter.com 114.114.114.114\n"})}),"\n",(0,r.jsx)(e.h2,{id:"dnsupdate",children:"dnsupdate"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://linux.die.net/man/8/nsupdate",children:"nsupdate.8"})}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# \u66f4\u65b0 NS \u8bb0\u5f55\u7684\u51fd\u6570\nns_update_record(){\n  nsupdate -y $TSIG_NAME:$TSIG_SECRET <<!\n  update delete $1 $3\n  update add $1 $2 $3 $4\n  send\n  !\n}\n# ns_update_record test.wener.me 600 A 192.168.1.1\n"})}),"\n",(0,r.jsx)(e.h2,{id:"dig",children:"dig"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# \u6240\u6709 IP\ndig +short amazon.com\n# \u6240\u6709 NS\ndig NS +short amazon.com\n# \u8bf7\u6c42\u8fc7\u7a0b\ndig amazone.com +trace\n# \u901a\u8fc7 IP \u8bf7\u6c42\u57df\u540d\ndig +short -x 8.8.8.8\n# \u9876\u7ea7\u57df\u540d\u7684 NS\ndig +short NS me.\n# \u6307\u5b9a\u8bf7\u6c42\u7684 ns\ndig google.com @8.8.8.8\n# \u83b7\u53d6\u8d85\u65f6\u65f6\u95f4\ndig google.com +noall +answer\n# \u5224\u65ad\u662f\u5426\u6240\u6709 NS \u90fd\u540c\u6b65\u4e86\u57df\u540d, \u4e3b\u8981\u901a\u8fc7 SOA \u5e8f\u53f7\u5224\u65ad\ndig google.com +nssearch\n# \u770b\u57df\u540d\u5728 DNS \u4e0a\u662f\u5426\u5b58\u5728\ndig SOA google.nl @ns1.dns.nl.\n"})}),"\n",(0,r.jsx)(e.h3,{id:"faq",children:"FAQ"}),"\n",(0,r.jsx)(e.h4,{id:"\u516c\u5171-dsn",children:"\u516c\u5171 DSN"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.a,{href:"https://public-dns.info/",children:"https://public-dns.info/"})}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.a,{href:"https://wiki.ipfire.org/dns/public-servers",children:"https://wiki.ipfire.org/dns/public-servers"})}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.a,{href:"https://www.lifewire.com/free-and-public-dns-servers-2626062",children:"https://www.lifewire.com/free-and-public-dns-servers-2626062"})}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.a,{href:"https://www.dnsperf.com",children:"https://www.dnsperf.com"})}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"8.8.8.8"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"8.8.4.4"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"223.6.6.6"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"223.5.5.5"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"114.114.114.114"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"1.1.1.1"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://blog.cloudflare.com/dns-resolver-1-1-1-1/",children:"https://blog.cloudflare.com/dns-resolver-1-1-1-1/"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"1.0.0.1"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h4,{id:"\u5c06\u65e5\u5fd7\u8bb0\u5f55\u5230\u6587\u4ef6",children:"\u5c06\u65e5\u5fd7\u8bb0\u5f55\u5230\u6587\u4ef6"}),"\n",(0,r.jsx)(e.p,{children:"\u4fee\u6539\u914d\u7f6e,\u8c03\u6574 syslog \u8f93\u51fa"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"# \u4f7f\u7528 LOCAL0 \u4f5c\u4e3a\u65e5\u5fd7\u8f93\u51fa\nlogging-facility=0\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u91cd\u5b9a\u5411 syslog \u8f93\u51fa"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"# \u4fee\u6539 syslog.conf\nlocal0\t/var/log/pdns.log\n"})}),"\n",(0,r.jsx)(e.h4,{id:"ddns",children:"DDNS"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://wiki.archlinux.org/index.php/Dynamic_DNS",children:"https://wiki.archlinux.org/index.php/Dynamic_DNS"})}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"\u4fee\u6539 pdns.conf \u542f\u7528 dnsupdate"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"# \u542f\u7528\ndnsupdate=yes\n# \u9ed8\u8ba4\u662f 0.0.0.0/0, \u7f6e\u7a7a\u5219\u7981\u6b62\u6240\u6709\nallow-dnsupdate-from=\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# \u751f\u6210 TSIG\npu generate-tsig-key home-test hmac-md5\n# \u4e3a\u8be5 ZONE \u8bbe\u7f6e\u5141\u8bb8\u4fee\u6539\npu set-meta i.wener.me ALLOW-DNSUPDATE-FROM 0.0.0.0/0\n# \u4f7f\u7528 nsupdate \u66f4\u65b0\u8bb0\u5f55\nnsupdate <<!\nserver 127.0.0.1 5300\nzone i.wener.me\nupdate delete dev.i.wener.me. A\nupdate add dev.i.wener.me. 3600 A 127.0.0.4\nkey home-wener jI8oJLnLIVOEc6QR7fCUylRnpiD3DL4yXgvBQoaAodM=\nsend\n!\n\n# \u751f\u6210\u53e6\u5916\u4e00\u4e2a tsig\npu generate-tsig-key home-test2 hmac-md5\n# \u4fee\u6539\u4e3a\u53ea\u5141\u8bb8\u6307\u5b9a\u7684 tsig \u4fee\u6539\npu set-meta i.wener.me TSIG-ALLOW-DNSUPDATE home-test2\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u4f18\u5316",children:"\u4f18\u5316"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://doc.powerdns.com/md/authoritative/performance/",children:"Performance and Tuning"})}),"\n",(0,r.jsx)(e.li,{children:"\u67e5\u8be2\u7f13\u5b58"}),"\n",(0,r.jsx)(e.li,{children:"\u5305\u7f13\u5b58"}),"\n",(0,r.jsx)(e.li,{children:"\u76d1\u63a7\u7edf\u8ba1"}),"\n",(0,r.jsx)(e.li,{children:"\u65e5\u5fd7"}),"\n",(0,r.jsx)(e.li,{children:"\u540e\u7aef\u7f13\u5b58"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"# \u4ee5\u4e0b\u7684\u503c\u5747\u4e3a\u9ed8\u8ba4\u503c\n\n# SO_REUSEPORT\nreuseport=no\n# \u542f\u52a8\u76d1\u542c\u7684\u7ebf\u7a0b\u6570, \u4e00\u822c\u5efa\u8bae 3-4\nreceiver-threads=1\n# \u6bcf\u4e2a\u63a5\u6536\u7ebf\u7a0b\u5bf9\u5e94\u7684\u540e\u7aef\u7ebf\u7a0b\u6570\ndistributor-threads=3\n# \u5305\u7f13\u5b58\u7684\u65f6\u95f4, \u5c06\u5305\u7f13\u5b58\u540e\u4e0d\u9700\u8981\u8bf7\u6c42\u540e\u7aef\u6765\u4ece\u65b0\u7ec4\u88c5\u4e00\u4e2a\u5b8c\u6574\u7684\u6570\u636e\u5305\n# \u8bbe\u7f6e\u4e3a 60 \u4e00\u822c\u4e0d\u4f1a\u6709\u95ee\u9898\n# \u4e5f\u53ef\u4ee5\u5c06\u8be5\u503c\u8bbe\u7f6e\u4e3a\u51e0\u4e2a\u5c0f\u65f6, \u9700\u8981\u6e05\u9664\u7f13\u5b58\u7684\u65f6\u5019\u901a\u8fc7 pdns_control purge \u6765\u6e05\u9664\ncache-ttl=20\n# \u7f13\u5b58\u67e5\u8be2\u548c\u7ed3\u679c\u7684\u65f6\u95f4\nquery-cache-ttl=20\n# \u7f13\u5b58\u67e5\u8be2\u4f46\u4e0d\u7f13\u5b58\u7ed3\u679c\u7684\u65f6\u95f4\nnegquery-cache-ttl=60\n"})})]})}function a(n={}){const{wrapper:e}={...(0,i.a)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(o,{...n})}):o(n)}},3354:(n,e,s)=>{var r=s(50959),i=Symbol.for("react.element"),l=Symbol.for("react.fragment"),d=Object.prototype.hasOwnProperty,t=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function h(n,e,s){var r,l={},h=null,o=null;for(r in void 0!==s&&(h=""+s),void 0!==e.key&&(h=""+e.key),void 0!==e.ref&&(o=e.ref),e)d.call(e,r)&&!c.hasOwnProperty(r)&&(l[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps)void 0===l[r]&&(l[r]=e[r]);return{$$typeof:i,type:n,key:h,ref:o,props:l,_owner:t.current}}e.Fragment=l,e.jsx=h,e.jsxs=h},11527:(n,e,s)=>{n.exports=s(3354)},47214:(n,e,s)=>{s.d(e,{Z:()=>t,a:()=>d});var r=s(50959);const i={},l=r.createContext(i);function d(n){const e=r.useContext(l);return r.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function t(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:d(n.components),r.createElement(l.Provider,{value:e},n.children)}}}]);