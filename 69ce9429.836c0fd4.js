(window.webpackJsonp=window.webpackJsonp||[]).push([[245],{306:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return l})),a.d(t,"metadata",(function(){return c})),a.d(t,"rightToc",(function(){return i})),a.d(t,"default",(function(){return O}));var n=a(2),b=a(7),r=(a(0),a(667)),l={id:"k8s-labels",title:"Kubernetes \u6807\u7b7e"},c={unversionedId:"devops/kubernetes/internal/k8s-labels",id:"devops/kubernetes/internal/k8s-labels",isDocsHomePage:!1,title:"Kubernetes \u6807\u7b7e",description:"Kubernetes \u6807\u7b7e\u6ce8\u89e3",source:"@site/notes/devops/kubernetes/internal/k8s-labels.md",slug:"/devops/kubernetes/internal/k8s-labels",permalink:"/notes/devops/kubernetes/internal/k8s-labels",editUrl:"https://github.com/wenerme/wener/edit/master/notes/devops/kubernetes/internal/k8s-labels.md",version:"current"},i=[{value:"\u8282\u70b9\u6807\u7b7e",id:"\u8282\u70b9\u6807\u7b7e",children:[{value:"Deprecated",id:"deprecated",children:[]}]},{value:"\u8d44\u6e90\u6807\u7b7e",id:"\u8d44\u6e90\u6807\u7b7e",children:[]},{value:"\u5e94\u7528\u6807\u7b7e",id:"\u5e94\u7528\u6807\u7b7e",children:[]},{value:"Helm \u6807\u7b7e",id:"helm-\u6807\u7b7e",children:[]},{value:"Helm \u6ce8\u89e3",id:"helm-\u6ce8\u89e3",children:[]}],p={rightToc:i};function O(e){var t=e.components,a=Object(b.a)(e,["components"]);return Object(r.b)("wrapper",Object(n.a)({},p,a,{components:t,mdxType:"MDXLayout"}),Object(r.b)("h1",{id:"kubernetes-\u6807\u7b7e\u6ce8\u89e3"},"Kubernetes \u6807\u7b7e\u6ce8\u89e3"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"https://kubernetes.io/docs/reference/kubernetes-api/labels-annotations-taints"}),"https://kubernetes.io/docs/reference/kubernetes-api/labels-annotations-taints"))),Object(r.b)("h2",{id:"\u8282\u70b9\u6807\u7b7e"},"\u8282\u70b9\u6807\u7b7e"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"kubernetes.io/ingress.class")),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"label"),Object(r.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"demo"),Object(r.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"desc"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"k3s.io/hostname"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"node-3"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"k3s.io/internal-ip"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"10.10.1.1"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"kubernetes.io/arch"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"amd64"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"+v1.14")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"kubernetes.io/hostname"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"node-3"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"kubernetes.io/os"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"linux"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"+v1.14")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"node-role.kubernetes.io/",Object(r.b)("inlineCode",{parentName:"td"},"<role>")),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"true"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"node-role.kubernetes.io/master"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"true"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Master node")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"node.kubernetes.io/instance-type"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"k3s"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"topology.kubernetes.io/region"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null})),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"+v1.17")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"topology.kubernetes.io/zone"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null})),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"+v1.17")))),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),"# \u8bbe\u7f6e node role \u4e3a worker\n# role \u540d\u5b57\u4efb\u610f\n# value \u4e0d\u91cd\u8981\uff0c\u4e3b\u8981\u662f\u5b58\u5728\u8be5 label\nkubectl label node-2 node-role.kubernetes.io/worker=true\n")),Object(r.b)("h3",{id:"deprecated"},"Deprecated"),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"label"),Object(r.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"demo"),Object(r.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"desc"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"beta.kubernetes.io/arch"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"amd64"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"!v1.14, -v1.18")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"beta.kubernetes.io/instance-type"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"k3s"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"!v1.17")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"beta.kubernetes.io/os"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"linux"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"!v1.14, -v1.18")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"failure-domain.beta.kubernetes.io/region"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null})),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"!v1.17")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"failure-domain.beta.kubernetes.io/zone"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null})),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"!v1.17")))),Object(r.b)("h2",{id:"\u8d44\u6e90\u6807\u7b7e"},"\u8d44\u6e90\u6807\u7b7e"),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"kind"),Object(r.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"annotation"),Object(r.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"demo"),Object(r.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"desc"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"StorageClass"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"storageclass.kubernetes.io/is-default-class"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"true"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"\u9ed8\u8ba4 StorageClass")))),Object(r.b)("h2",{id:"\u5e94\u7528\u6807\u7b7e"},"\u5e94\u7528\u6807\u7b7e"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"https://kubernetes.io/docs/concepts/overview/working-with-objects/common-labels/"}),"Recommanded Lables")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"https://helm.sh/docs/chart_best_practices/labels/"}),"Helm Labels"))),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"label"),Object(r.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"example"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"app.kubernetes.io/name"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"mysql"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"app.kubernetes.io/instance"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"mysql-abcd"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"app.kubernetes.io/version"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"5.7"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"app.kubernetes.io/component"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"database"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"app.kubernetes.io/part-of"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"ghost"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"app.kubernetes.io/managed-by"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(r.b)("inlineCode",{parentName:"td"},"helm"))))),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-yaml"}),"podAntiAffinity:\n  preferredDuringSchedulingIgnoredDuringExecution:\n    - weight: 100\n      podAffinityTerm:\n        labelSelector:\n          matchLabels:\n            app.kubernetes.io/component: prometheus\n            app.kubernetes.io/instance: kube-prometheus\n            app.kubernetes.io/name: kube-prometheus\n        topologyKey: kubernetes.io/hostname\n")),Object(r.b)("h2",{id:"helm-\u6807\u7b7e"},"Helm \u6807\u7b7e"),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"label"),Object(r.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"example"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"app.kubernetes.io/managed-by"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Helm")))),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-yaml"}),"# \u8d44\u6e90 label\nlabels:\n  app.kubernetes.io/component: controller\n  app.kubernetes.io/instance: ingress-nginx\n  app.kubernetes.io/managed-by: Helm\n  app.kubernetes.io/name: ingress-nginx\n  app.kubernetes.io/version: 0.35.0\n  helm.sh/chart: ingress-nginx-2.16.0\n\n# selector label\nmatchLabels:\n  app.kubernetes.io/component: controller\n  app.kubernetes.io/instance: ingress-nginx\n  app.kubernetes.io/name: ingress-nginx\n")),Object(r.b)("h2",{id:"helm-\u6ce8\u89e3"},"Helm \u6ce8\u89e3"),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"annotation"),Object(r.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"value"),Object(r.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"desc"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"meta.helm.sh/release-name"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"linkerd2"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"meta.helm.sh/release-namespace"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"linkerd"),Object(r.b)("td",Object(n.a)({parentName:"tr"},{align:null}))))))}O.isMDXComponent=!0},667:function(e,t,a){"use strict";a.d(t,"a",(function(){return j})),a.d(t,"b",(function(){return m}));var n=a(0),b=a.n(n);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,b=function(e,t){if(null==e)return{};var a,n,b={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(b[a]=e[a]);return b}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(b[a]=e[a])}return b}var p=b.a.createContext({}),O=function(e){var t=b.a.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):c(c({},t),e)),a},j=function(e){var t=O(e.components);return b.a.createElement(p.Provider,{value:t},e.children)},o={inlineCode:"code",wrapper:function(e){var t=e.children;return b.a.createElement(b.a.Fragment,{},t)}},u=b.a.forwardRef((function(e,t){var a=e.components,n=e.mdxType,r=e.originalType,l=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),j=O(a),u=n,m=j["".concat(l,".").concat(u)]||j[u]||o[u]||r;return a?b.a.createElement(m,c(c({ref:t},p),{},{components:a})):b.a.createElement(m,c({ref:t},p))}));function m(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var r=a.length,l=new Array(r);l[0]=u;var c={};for(var i in t)hasOwnProperty.call(t,i)&&(c[i]=t[i]);c.originalType=e,c.mdxType="string"==typeof e?e:n,l[1]=c;for(var p=2;p<r;p++)l[p]=a[p];return b.a.createElement.apply(null,l)}return b.a.createElement.apply(null,a)}u.displayName="MDXCreateElement"}}]);