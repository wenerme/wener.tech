(window.webpackJsonp=window.webpackJsonp||[]).push([[673],{746:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return c})),n.d(t,"metadata",(function(){return i})),n.d(t,"toc",(function(){return p})),n.d(t,"default",(function(){return u}));var a=n(3),r=n(8),l=(n(0),n(879)),c={slug:"alpinelinux-setup-xfce",title:"AlpineLinux \u5b89\u88c5 Xfce \u684c\u9762",tags:["AlpineLinux","\u684c\u9762","Xfce"]},i={permalink:"/story/alpinelinux-setup-xfce",editUrl:"https://github.com/wenerme/wener/edit/master/story/2021/2021-02-26-alpinelinux-setup-xfce.md",source:"@site/story/2021/2021-02-26-alpinelinux-setup-xfce.md",description:"\u5047\u8bbe\u5df2\u7ecf\u6709\u4e00\u4e2a\u57fa\u7840\u53ef\u7528\u7684 AlpineLinux, \u5982\u679c\u6ca1\u6709\u53ef\u524d\u5f80 wenerme/alpine-image \u4e0b\u8f7d\u6216\u81ea\u884c\u5236\u4f5c",date:"2021-02-26T00:00:00.000Z",tags:[{label:"AlpineLinux",permalink:"/story/tags/alpine-linux"},{label:"\u684c\u9762",permalink:"/story/tags/\u684c\u9762"},{label:"Xfce",permalink:"/story/tags/xfce"}],title:"AlpineLinux \u5b89\u88c5 Xfce \u684c\u9762",readingTime:2.71,truncated:!1,prevItem:{title:"\u8bb0\u5f55\u4e00\u6b21\u4fee\u590d init \u811a\u672c\u7684\u7ecf\u5386",permalink:"/story/fix-init-script"},nextItem:{title:"\u4e3a\u4ec0\u4e48\u9700\u8981 GraphQL",permalink:"/story/why-need-graphql"}},p=[{value:"setup xorg",id:"setup-xorg",children:[]},{value:"setup lightdm",id:"setup-lightdm",children:[]},{value:"setup xfce",id:"setup-xfce",children:[]},{value:"\u5e94\u7528",id:"\u5e94\u7528",children:[{value:"flatpak",id:"flatpak",children:[]},{value:"AppImage",id:"appimage",children:[]}]},{value:"\u5176\u4ed6\u670d\u52a1",id:"\u5176\u4ed6\u670d\u52a1",children:[]},{value:"xfce \u652f\u6301\u9ad8\u5206\u8fa8\u7387",id:"xfce-\u652f\u6301\u9ad8\u5206\u8fa8\u7387",children:[]},{value:"\u67e5\u770b\u5f53\u524d\u663e\u5361\u548c\u58f0\u5361\u4fe1\u606f",id:"\u67e5\u770b\u5f53\u524d\u663e\u5361\u548c\u58f0\u5361\u4fe1\u606f",children:[]},{value:"kernel: i915 0000:00:02.0: drm <em>ERROR</em> CPU pipe A FIFO underrun",id:"kernel-i915-000000020-drm-error-cpu-pipe-a-fifo-underrun",children:[]},{value:"VNC \u8fdc\u7a0b\u684c\u9762",id:"vnc-\u8fdc\u7a0b\u684c\u9762",children:[]}],b={toc:p};function u(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(l.b)("wrapper",Object(a.a)({},b,n,{components:t,mdxType:"MDXLayout"}),Object(l.b)("blockquote",null,Object(l.b)("p",{parentName:"blockquote"},"\u5047\u8bbe\u5df2\u7ecf\u6709\u4e00\u4e2a\u57fa\u7840\u53ef\u7528\u7684 AlpineLinux, \u5982\u679c\u6ca1\u6709\u53ef\u524d\u5f80 ",Object(l.b)("a",{parentName:"p",href:"https://github.com/wenerme/alpine-image"},"wenerme/alpine-image")," \u4e0b\u8f7d\u6216\u81ea\u884c\u5236\u4f5c")),Object(l.b)("h2",{id:"setup-xorg"},"setup xorg"),Object(l.b)("p",null,"\u5b89\u88c5 X server \u548c\u57fa\u7840\u786c\u4ef6\u9a71\u52a8"),Object(l.b)("pre",null,Object(l.b)("code",{parentName:"pre",className:"language-bash"},"# xfce + xorg\nsetup-xorg-base xfce4 xfce4-terminal dbus-x11 sudo\n\n# xorg \u8f93\u5165\u8bbe\u5907\napk add xf86-input-mouse xf86-input-keyboard kbd\n\n# Intel \u82af\u7247\u96c6\u6210\u663e\u5361\napk add xf86-video-intel\n# AMD \u663e\u5361\napk add xf86-video-amdgpu\n# QEMU\n# apk add xf86-video-qxl\n# \u5982\u679c\u4ee5\u4e0a\u90fd\u4e0d\u652f\u6301\u5219\u8003\u8651\u4f7f\u7528 framebuffer\n# apk add xf86-video-fbdev\n")),Object(l.b)("p",null,"\u6b64\u65f6\u5df2\u7ecf\u53ef\u4ee5\u8fdb\u5165 xfce \u684c\u9762, \u6ca1\u6709\u767b\u9646\u754c\u9762, \u8fdb\u5165\u754c\u9762\u540e\u53ef\u53f3\u4e0a\u89d2\u9000\u51fa\u767b\u9646\u6216\u8005 ",Object(l.b)("inlineCode",{parentName:"p"},"Ctrl+Alt+F1")," \u6765\u5207\u6362\u56de\u547d\u4ee4\u884c\u4f1a\u8bdd\u3002"),Object(l.b)("pre",null,Object(l.b)("code",{parentName:"pre",className:"language-bash"},"# \u901a\u8fc7 xorg \u63d0\u4f9b\u7684 startx \u542f\u52a8\nstartx\n# \u6216\u8005\u6307\u5b9a\u542f\u52a8 xfce4\nstartxfce4\n")),Object(l.b)("h2",{id:"setup-lightdm"},"setup lightdm"),Object(l.b)("p",null,"\u5b89\u88c5 lightdm \u540e\u53ef\u4ee5\u53ef\u4ee5\u901a\u8fc7\u8d26\u53f7\u5bc6\u7801\u767b\u9646, \u4e5f\u53ef\u4ee5\u8fdc\u7a0b VNC \u8fdb\u5165 xfce \u4f1a\u8bdd\u3002"),Object(l.b)("pre",null,Object(l.b)("code",{parentName:"pre",className:"language-bash"},"apk add lightdm-gtk-greeter\n\n# \u5982\u679c\u6ca1\u542f\u52a8\u5219\u9700\u8981\u63d0\u524d\u5f00\u542f\nrc-service dbus start\nrc-update add dbus\n\n# \u6dfb\u52a0\u975e root \u7528\u6237 admin \u5bc6\u7801 admin - \u4e0d\u5c11\u5e94\u7528\u9700\u8981\u975e root \u7528\u6237\nadduser -d admin\necho admin:admin | chpasswd\necho 'admin ALL=(ALL) NOPASSWD: ALL' >> /etc/sudoers\n\n# \u5f00\u673a\u8fdb\u5165\u767b\u9646\u754c\u9762\nrc-update add lightdm\n# \u7acb\u5373\u542f\u52a8 lightdm \u8fdb\u884c\u767b\u9646\nrc-service lightdm start\n")),Object(l.b)("h2",{id:"setup-xfce"},"setup xfce"),Object(l.b)("p",null,"\u5b89\u88c5\u5e38\u7528\u7684\u5305"),Object(l.b)("pre",null,Object(l.b)("code",{parentName:"pre",className:"language-bash"},"# \u9ed8\u8ba4\u65e0\u6cd5\u663e\u793a\u4e2d\u6587\u5b57\u7b26\napk add noto-font-cjk\n\n# \u5141\u8bb8\u975e root \u901a\u8fc7 fuse \u8bbf\u95ee\u8bbe\u5907\napk add gvfs-fuse gvfs-smb\nrc-service fuse start\nrc-update add fuse\n\n# \u81ea\u52a8\u6302\u8f7d \u5916\u90e8\u8bbe\u5907\napk add thunar-volman udisks2\n# \u90e8\u5206\u8bbe\u5907\u9700\u8981\u989d\u5916\u7684\u5305\n# gvfs-mtp - MTP - \u5a92\u4f53\u64ad\u653e\u5668\u548c\u79fb\u52a8\u8bbe\u5907\n# gvfs-gphoto2 - PTP - \u76f8\u673a\u548c\u79fb\u52a8\u8bbe\u5907\n# gvfs-afc - \u82f9\u679c\u79fb\u52a8\u8bbe\u5907\n\n# \u6587\u4ef6\u7ba1\u7406\u5668\u652f\u6301\u538b\u7f29\u548c\u89e3\u538b\napk add thunar-archive-plugin\napk add file-roller # thunar-archive-plugin \u652f\u6301\u7684\u7ba1\u7406\u5668\n")),Object(l.b)("p",null,"\u5b89\u88c5\u4e86\u76f8\u5173\u63d2\u4ef6\u540e\u6700\u597d\u9000\u51fa\u4f1a\u8bdd\u91cd\u65b0\u767b\u9646\u786e\u4fdd\u751f\u6548\u3002"),Object(l.b)("h2",{id:"\u5e94\u7528"},"\u5e94\u7528"),Object(l.b)("pre",null,Object(l.b)("code",{parentName:"pre",className:"language-bash"},"# \u5c4f\u4fdd, \u4efb\u52a1\u7ba1\u7406\u5668\napk add xfce4-screensaver xfce4-taskmanager\n\n# \u8c37\u6b4c\u6d4f\u89c8\u5668 - \u4e5f\u53ef\u4ee5\u901a\u8fc7 flatpak \u5b89\u88c5\napk add chromium\n# \u706b\u72d0\u6d4f\u89c8\u5668\n# apk add firefox-esr\n")),Object(l.b)("h3",{id:"flatpak"},"flatpak"),Object(l.b)("p",null,"Linux \u56e0\u4e3a\u53d1\u5e03\u7248\u592a\u5927\u4e86\uff0c\u5e94\u7528\u5206\u53d1\u6bd4\u8f83\u6df7\u4e71\uff0c\u4e14\u4e0d\u5c11\u5e94\u7528\u5e76\u4e0d\u76f4\u63a5\u652f\u6301 musl\uff0c\u4f7f\u7528 flatpak \u6253\u5305\u7684\u5e94\u7528\u53ef\u907f\u514d\u8fd9\u4e9b\u95ee\u9898\u3002"),Object(l.b)("pre",null,Object(l.b)("code",{parentName:"pre",className:"language-bash"},"apk add flatpak\nflatpak remote-add --if-not-exists flathub https://flathub.org/repo/flathub.flatpakrepo\n\n# \u5b89\u88c5\nflatpak install flathub com.visualstudio.code\n# \u542f\u52a8\nflatpak run com.visualstudio.code\n")),Object(l.b)("p",null,Object(l.b)("strong",{parentName:"p"},"\u5e38\u7528\u5e94\u7528")),Object(l.b)("table",null,Object(l.b)("thead",{parentName:"table"},Object(l.b)("tr",{parentName:"thead"},Object(l.b)("th",{parentName:"tr",align:null},"id"),Object(l.b)("th",{parentName:"tr",align:null},"name"),Object(l.b)("th",{parentName:"tr",align:null},"\u7528\u9014"))),Object(l.b)("tbody",{parentName:"table"},Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",{parentName:"tr",align:null},"com.visualstudio.code"),Object(l.b)("td",{parentName:"tr",align:null},"VSC"),Object(l.b)("td",{parentName:"tr",align:null},"\u7f16\u8f91\u5668")),Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",{parentName:"tr",align:null},"om.vscodium.codium"),Object(l.b)("td",{parentName:"tr",align:null},"Codium"),Object(l.b)("td",{parentName:"tr",align:null},"\u7f16\u8f91\u5668")),Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",{parentName:"tr",align:null},"org.chromium.Chromium"),Object(l.b)("td",{parentName:"tr",align:null},"Chromium"),Object(l.b)("td",{parentName:"tr",align:null},"\u6d4f\u89c8\u5668")),Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",{parentName:"tr",align:null},"org.mozilla.firefox"),Object(l.b)("td",{parentName:"tr",align:null},"Firefox"),Object(l.b)("td",{parentName:"tr",align:null},"\u6d4f\u89c8\u5668")),Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",{parentName:"tr",align:null},"org.telegram.desktop"),Object(l.b)("td",{parentName:"tr",align:null},"Telegram"),Object(l.b)("td",{parentName:"tr",align:null},"\u5373\u65f6\u804a\u5929")),Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",{parentName:"tr",align:null},"com.valvesoftware.Steam"),Object(l.b)("td",{parentName:"tr",align:null},"Steam"),Object(l.b)("td",{parentName:"tr",align:null},"\u6e38\u620f")),Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",{parentName:"tr",align:null},"org.mozilla.Thunderbird"),Object(l.b)("td",{parentName:"tr",align:null},"Thunderbird"),Object(l.b)("td",{parentName:"tr",align:null},"\u90ae\u4ef6")),Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",{parentName:"tr",align:null},"org.filezillaproject.Filezilla"),Object(l.b)("td",{parentName:"tr",align:null},"Filezilla"),Object(l.b)("td",{parentName:"tr",align:null},"\u6587\u4ef6")))),Object(l.b)("h3",{id:"appimage"},"AppImage"),Object(l.b)("p",null,"\u4e0d\u901a\u8fc7 flatpak \u9700\u8981\u5b89\u88c5\uff0cAppImage \u662f\u5c01\u88c5\u597d\u7684\u4e00\u4f53\u5316\u5e94\u7528\uff0c\u7c7b\u4f3c\u5bb9\u5668\uff0c\u7c7b\u4f3c macOS \u5e94\u7528\u3002\n\u4f46\u76ee\u524d\u7531\u4e8e glibc \u517c\u5bb9\u95ee\u9898 Alpine \u65e0\u6cd5\u8fd0\u884c AppImage \u53c2\u89c1 ",Object(l.b)("a",{parentName:"p",href:"https://github.com/AppImage/AppImageKit/issues/1015"},"AppImage/AppImageKit#1015"),"\u3002"),Object(l.b)("p",null,Object(l.b)("strong",{parentName:"p"},"\u5df2\u77e5\u63d0\u4f9b AppImage \u7684\u5e94\u7528")),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},"Jetbrain Toolbox"),Object(l.b)("li",{parentName:"ul"},"Lens - Kubernetes IDE")),Object(l.b)("h2",{id:"\u5176\u4ed6\u670d\u52a1"},"\u5176\u4ed6\u670d\u52a1"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},"xrdp - RDP \u670d\u52a1\u7aef - \u652f\u6301 Windows \u76f4\u63a5\u8fdc\u7a0b\u767b\u9646"),Object(l.b)("li",{parentName:"ul"},"gvncviewer - VNC \u5ba2\u6237\u7aef")),Object(l.b)("h1",{id:"faq"},"FAQ"),Object(l.b)("h2",{id:"xfce-\u652f\u6301\u9ad8\u5206\u8fa8\u7387"},"xfce \u652f\u6301\u9ad8\u5206\u8fa8\u7387"),Object(l.b)("pre",null,Object(l.b)("code",{parentName:"pre",className:"language-bash"},"# \u4e24\u500d\u7f29\u653e\n# Settings Manager > Appearance > Settings > Window Scaling\nxfconf-query -c xsettings -p /Gdk/WindowScalingFactor -s 2\n# \u8c03\u6574\u4e3b\u9898\u4e3a \u9ed8\u8ba4 xhdpi\n# Settings Manager > Window Manager > Style\nxfconf-query -c xfwm4 -p /general/theme -s Default-xhdpi\n")),Object(l.b)("h2",{id:"\u67e5\u770b\u5f53\u524d\u663e\u5361\u548c\u58f0\u5361\u4fe1\u606f"},"\u67e5\u770b\u5f53\u524d\u663e\u5361\u548c\u58f0\u5361\u4fe1\u606f"),Object(l.b)("pre",null,Object(l.b)("code",{parentName:"pre",className:"language-bash"},"apk add inxi\ninxi -AG\n")),Object(l.b)("h2",{id:"kernel-i915-000000020-drm-error-cpu-pipe-a-fifo-underrun"},"kernel: i915 0000:00:02.0: ","[drm]"," ",Object(l.b)("em",{parentName:"h2"},"ERROR")," CPU pipe A FIFO underrun"),Object(l.b)("p",null,"\u5982\u679c\u8be5\u9519\u8bef\u5bfc\u81f4\u95ea\u70c1\u53ef\u6dfb\u52a0\u542f\u52a8\u53c2\u6570\u907f\u514d ",Object(l.b)("inlineCode",{parentName:"p"},"i915.enable_psr=0")),Object(l.b)("blockquote",null,Object(l.b)("p",{parentName:"blockquote"},Object(l.b)("a",{parentName:"p",href:"https://wiki.archlinux.org/index.php/Intel_graphics#Screen_flickering"},"Intel graphics#Screen flickering")),Object(l.b)("p",{parentName:"blockquote"},"\u53ef\u80fd\u7531\u4e8e Intel \u96c6\u6210\u663e\u5361\u7684\u8282\u80fd\u529f\u80fd\u5bfc\u81f4")),Object(l.b)("h2",{id:"vnc-\u8fdc\u7a0b\u684c\u9762"},"VNC \u8fdc\u7a0b\u684c\u9762"),Object(l.b)("pre",null,Object(l.b)("code",{parentName:"pre",className:"language-bash"},'apk add x11vnc\n\n# \u542f\u52a8\u670d\u52a1\u7aef\u8bbf\u95ee\u5df2\u6253\u5f00\u4f1a\u8bdd\nx11vnc -display :0 -auth /var/run/lightdm/root/\\:0\n# \u7136\u540e\u8bbf\u95ee vnc://<IP>:5900 \u5373\u53ef\n\n# \u4e0d\u9000\u51fa\nx11vnc -display :0 -auth /var/run/lightdm/root/\\:0 --loop\n\n# \u8bbf\u95ee\u65f6\u521b\u5efa\u65b0\u7684\u4f1a\u8bdd\n# \u786e\u4fdd init \u80fd\u542f\u52a8\necho "exec startxfce4" >> ~/.xinitrc\napk add xvfb\nx11vnc -ncache_cr -display :1 -auth /var/run/lightdm/root/\\:1 --create\n\n# \u4e0d\u8b66\u544a\u6ca1\u6709\u8bbe\u7f6e\u5bc6\u7801\necho nopw >> ~/.x11vncrc\n\n# \u53ef\u8bbe\u7f6e\u4e3a\u5f00\u673a\u542f\u52a8\n# x11vnc -create -xkb -noxrecord -noxfixes -noxdamage -display :0 -auth /var/run/lightdm/root/:0 -rfbauth /etc/x11vnc.pass -rfbport 5900\n\n# \u767b\u9646\u4e4b\u524d\u5f00\u542f VNC\n# x11vnc -auth guess -display :0\n')),Object(l.b)("blockquote",null,Object(l.b)("p",{parentName:"blockquote"},"\u5982\u679c\u670d\u52a1\u5e38\u5f00\uff0c\u5efa\u8bae\u8bbe\u7f6e\u5bc6\u7801")),Object(l.b)("h1",{id:"\u53c2\u8003"},"\u53c2\u8003"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},"AlpineLinux ",Object(l.b)("a",{parentName:"li",href:"https://wiki.alpinelinux.org/wiki/Xfce_Setup"},"Xfce Setup")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",{parentName:"li",href:"https://wiki.archlinux.org/index.php/HiDPI#Xfce"},"HiDPI#Xfce")),Object(l.b)("li",{parentName:"ul"},"flatpak ",Object(l.b)("a",{parentName:"li",href:"https://flathub.org/apps"},"\u5e94\u7528\u5217\u8868")),Object(l.b)("li",{parentName:"ul"},"archlinux ",Object(l.b)("a",{parentName:"li",href:"https://wiki.archlinux.org/index.php/x11vnc"},"x11vnc"))))}u.isMDXComponent=!0},879:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var a=n(0),r=n.n(a);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var b=r.a.createContext({}),u=function(e){var t=r.a.useContext(b),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},o=function(e){var t=u(e.components);return r.a.createElement(b.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},m=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,l=e.originalType,c=e.parentName,b=p(e,["components","mdxType","originalType","parentName"]),o=u(n),m=a,s=o["".concat(c,".").concat(m)]||o[m]||d[m]||l;return n?r.a.createElement(s,i(i({ref:t},b),{},{components:n})):r.a.createElement(s,i({ref:t},b))}));function s(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var l=n.length,c=new Array(l);c[0]=m;var i={};for(var p in t)hasOwnProperty.call(t,p)&&(i[p]=t[p]);i.originalType=e,i.mdxType="string"==typeof e?e:a,c[1]=i;for(var b=2;b<l;b++)c[b]=n[b];return r.a.createElement.apply(null,c)}return r.a.createElement.apply(null,n)}m.displayName="MDXCreateElement"}}]);