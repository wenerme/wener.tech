(window.webpackJsonp=window.webpackJsonp||[]).push([[292],{353:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return b})),n.d(t,"rightToc",(function(){return s})),n.d(t,"default",(function(){return o}));var a=n(2),r=n(7),l=(n(0),n(670)),i={id:"kubesphere",title:"Kubesphere"},b={unversionedId:"devops/kubernetes/platform/kubesphere",id:"devops/kubernetes/platform/kubesphere",isDocsHomePage:!1,title:"Kubesphere",description:"Kubesphere",source:"@site/notes/devops/kubernetes/platform/kubesphere.md",slug:"/devops/kubernetes/platform/kubesphere",permalink:"/notes/devops/kubernetes/platform/kubesphere",editUrl:"https://github.com/wenerme/wener/edit/master/notes/devops/kubernetes/platform/kubesphere.md",version:"current"},s=[{value:"\u914d\u7f6e",id:"\u914d\u7f6e",children:[]},{value:"\u5378\u8f7d",id:"\u5378\u8f7d",children:[]}],c={rightToc:s};function o(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(l.b)("wrapper",Object(a.a)({},c,n,{components:t,mdxType:"MDXLayout"}),Object(l.b)("h1",{id:"kubesphere"},"Kubesphere"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},"\u662f\u4ec0\u4e48",Object(l.b)("ul",{parentName:"li"},Object(l.b)("li",{parentName:"ul"},"\u56fd\u4ea7\u9752\u4e91 \u5f00\u6e90\u7684 kubesphere \u7ba1\u7406\u5e73\u53f0"),Object(l.b)("li",{parentName:"ul"},"vs Rancher",Object(l.b)("ul",{parentName:"li"},Object(l.b)("li",{parentName:"ul"},"UI \u597d\u770b"),Object(l.b)("li",{parentName:"ul"},"\u66f4\u504f\u5411\u5e94\u7528\u5f00\u53d1"),Object(l.b)("li",{parentName:"ul"},"\u6743\u9650\u66f4\u7ec6"))))),Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(a.a)({parentName:"li"},{href:"https://kubesphere.io"}),"kubesphere.io"),Object(l.b)("ul",{parentName:"li"},Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(a.a)({parentName:"li"},{href:"https://kubesphere.com.cn"}),"kubesphere.com.cn")," - \u4e2d\u6587"))),Object(l.b)("li",{parentName:"ul"},"\u5b9e\u73b0 mysql+redis+minio+openldap+redis+es"),Object(l.b)("li",{parentName:"ul"},"\u9ed8\u8ba4 NodePort 30880 - admin/P@88w0rd"),Object(l.b)("li",{parentName:"ul"},"\u5168\u5957\u5b89\u88c5\u4e0b\u6765\u81f3\u5c11 16G+ - \u56e0\u6b64\u670d\u52a1\u5668\u81f3\u5c11\u9700\u8981 48G/64G"),Object(l.b)("li",{parentName:"ul"},"kubesphere-system",Object(l.b)("ul",{parentName:"li"},Object(l.b)("li",{parentName:"ul"},"\u5b89\u88c5 installer"))),Object(l.b)("li",{parentName:"ul"},"kubesphere-monitoring-system"),Object(l.b)("li",{parentName:"ul"},"kubesphere-controls-system"),Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(a.a)({parentName:"li"},{href:"https://github.com/kubesphere/ks-installer"}),"kubesphere/ks-installer"),Object(l.b)("ul",{parentName:"li"},Object(l.b)("li",{parentName:"ul"},"\u5b89\u88c5 Kubesphere \u7684 Operator"),Object(l.b)("li",{parentName:"ul"},"\u5b89\u88c5\u4f7f\u7528 Ansible")))),Object(l.b)("table",null,Object(l.b)("thead",{parentName:"table"},Object(l.b)("tr",{parentName:"thead"},Object(l.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Integration"),Object(l.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"CPU"),Object(l.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Memory"),Object(l.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Impl"),Object(l.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Desc"))),Object(l.b)("tbody",{parentName:"table"},Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"alerting"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"0.3 Core"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"300 MiB"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null})),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}))),Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"auditing"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null})),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null})),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"\u5ba1\u8ba1\u65e5\u5fd7 - \u4f9d\u8d56 ES"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"kubesphere-logging-system")),Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"devops"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"0.47 Core"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"8.6 G"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"CI/CD Jinkins"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"kubesphere-devops-system")),Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"events"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null})),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null})),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null})),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"kubesphere-logging-system")),Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"logging"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"57 m"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"2.76 G"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"Elasticsearch, fluentbit"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}))),Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"metrics_server"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"56 m"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"44.35 MiB"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null})),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"HPA - Horizontal Pod Autoscaler")),Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"multicluster"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null})),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null})),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null})),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"\u591a\u96c6\u7fa4\u7ba1\u7406")),Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"networkpolicy"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null})),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null})),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null})),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"\u96c6\u7fa4\u5185\u7f51\u7edc\u9694\u79bb")),Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"notification"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null})),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null})),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null})),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"Email, WeChat Work, Slack")),Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"monitoring"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null})),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"Request 400Mi"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"Prometheus"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}))),Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"openpitrix"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"2 Core"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"3.6 G"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"openpitrix"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"HELM/\u5e94\u7528\u5546\u5e97")),Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"servicemesh"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"0.3 Core"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"300 MiB"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"Istio"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}))))),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"# crd installer.kubesphere.io/v1alpha1\n# kubesphere-system\n# ServiceAccount ks-installer\n# ClusterRole ks-installer\n# Deployment ks-installer\n#   https://hub.docker.com/layers/kubesphere/ks-installer\nkubectl apply -f https://raw.githubusercontent.com/kubesphere/ks-installer/v3.0.0/deploy/kubesphere-installer.yaml\n# \u5b89\u88c5\u914d\u7f6e - \u53ef\u4e0b\u8f7d\u81ea\u884c\u4fee\u6539\n# ClusterConfiguration installer.kubesphere.io/v1alpha1\n# \u4e0a\u6b21\u7684 jwtSecret kubectl -n kubesphere-system get cm kubesphere-config -o yaml | grep -v \"apiVersion\" | grep jwtSecret\nkubectl apply -f https://raw.githubusercontent.com/kubesphere/ks-installer/v3.0.0/deploy/cluster-configuration.yaml\n\n# \u5b89\u88c5\u8fc7\u7a0b\nkubectl logs -n kubesphere-system $(kubectl get pod -n kubesphere-system -l app=ks-install -o jsonpath='{.items[0].metadata.name}') -f\n")),Object(l.b)("h2",{id:"\u914d\u7f6e"},"\u914d\u7f6e"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(a.a)({parentName:"li"},{href:"https://github.com/kubesphere/kubekey/blob/master/docs/config-example.md"}),"https://github.com/kubesphere/kubekey/blob/master/docs/config-example.md"))),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),'apiVersion: installer.kubesphere.io/v1alpha1\nkind: ClusterConfiguration\nmetadata:\n  name: ks-installer\n  namespace: kubesphere-system\n  labels:\n    version: v3.0.0\nspec:\n  persistence:\n    storageClass: ""        # If there is not a default StorageClass in your cluster, you need to specify an existing StorageClass here.\n  authentication:\n    jwtSecret: ""           # Keep the jwtSecret consistent with the host cluster. Retrive the jwtSecret by executing "kubectl -n kubesphere-system get cm kubesphere-config -o yaml | grep -v "apiVersion" | grep jwtSecret" on the host cluster.\n  etcd:\n    monitoring: false       # Whether to enable etcd monitoring dashboard installation. You have to create a secret for etcd before you enable it.\n    endpointIps: localhost  # etcd cluster EndpointIps, it can be a bunch of IPs here.\n    port: 2379              # etcd port\n    tlsEnable: true\n  common:\n    mysqlVolumeSize: 20Gi # MySQL PVC size.\n    minioVolumeSize: 20Gi # Minio PVC size.\n    etcdVolumeSize: 20Gi  # etcd PVC size.\n    openldapVolumeSize: 2Gi   # openldap PVC size.\n    redisVolumSize: 2Gi # Redis PVC size.\n    es:   # Storage backend for logging, events and auditing.\n      # elasticsearchMasterReplicas: 1   # total number of master nodes, it\'s not allowed to use even number\n      # elasticsearchDataReplicas: 1     # total number of data nodes.\n      elasticsearchMasterVolumeSize: 4Gi   # Volume size of Elasticsearch master nodes.\n      elasticsearchDataVolumeSize: 20Gi    # Volume size of Elasticsearch data nodes.\n      logMaxAge: 7                     # Log retention time in built-in Elasticsearch, it is 7 days by default.\n      elkPrefix: logstash              # The string making up index names. The index name will be formatted as ks-<elk_prefix>-log.\n      # \u5916\u90e8 Elasticsearch - \u751f\u4ea7\u5efa\u8bae\u4f7f\u7528\u5916\u90e8\n      externalElasticsearchUrl: # The URL of external Elasticsearch\n      externalElasticsearchPort: # The port of external Elasticsearch\n  console:\n    enableMultiLogin: true  # enable/disable multiple sing on, it allows an account can be used by different users at the same time.\n    port: 30880\n  alerting:                # (CPU: 0.3 Core, Memory: 300 MiB) Whether to install KubeSphere alerting system. It enables Users to customize alerting policies to send messages to receivers in time with different time intervals and alerting levels to choose from.\n    enabled: false\n  auditing:                # Whether to install KubeSphere audit log system. It provides a security-relevant chronological set of records\uff0crecording the sequence of activities happened in platform, initiated by different tenants.\n    enabled: false\n  devops:                  # (CPU: 0.47 Core, Memory: 8.6 G) Whether to install KubeSphere DevOps System. It provides out-of-box CI/CD system based on Jenkins, and automated workflow tools including Source-to-Image & Binary-to-Image.\n    enabled: false\n    jenkinsMemoryLim: 2Gi      # Jenkins memory limit.\n    jenkinsMemoryReq: 1500Mi   # Jenkins memory request.\n    jenkinsVolumeSize: 8Gi     # Jenkins volume size.\n    jenkinsJavaOpts_Xms: 512m  # The following three fields are JVM parameters.\n    jenkinsJavaOpts_Xmx: 512m\n    jenkinsJavaOpts_MaxRAM: 2g\n  events:                  # Whether to install KubeSphere events system. It provides a graphical web console for Kubernetes Events exporting, filtering and alerting in multi-tenant Kubernetes clusters.\n    enabled: false\n    ruler:\n      enabled: true\n      replicas: 2\n  logging:                 # (CPU: 57 m, Memory: 2.76 G) Whether to install KubeSphere logging system. Flexible logging functions are provided for log query, collection and management in a unified console. Additional log collectors can be added, such as Elasticsearch, Kafka and Fluentd.\n    enabled: false\n    logsidecarReplicas: 2\n  metrics_server:                    # (CPU: 56 m, Memory: 44.35 MiB) Whether to install metrics-server. IT enables HPA (Horizontal Pod Autoscaler).\n    enabled: false\n  monitoring:\n    # prometheusReplicas: 1            # Prometheus replicas are responsible for monitoring different segments of data source and provide high availability as well.\n    prometheusMemoryRequest: 400Mi   # Prometheus request memory.\n    prometheusVolumeSize: 20Gi       # Prometheus PVC size.\n    # alertmanagerReplicas: 1          # AlertManager Replicas.\n  multicluster:\n    clusterRole: none  # host | member | none  # You can install a solo cluster, or specify it as the role of host or member cluster.\n  networkpolicy:       # Network policies allow network isolation within the same cluster, which means firewalls can be set up between certain instances (Pods).\n    # Make sure that the CNI network plugin used by the cluster supports NetworkPolicy. There are a number of CNI network plugins that support NetworkPolicy, including Calico, Cilium, Kube-router, Romana and Weave Net.\n    enabled: false\n  notification:        # Email Notification support for the legacy alerting system, should be enabled/disabled together with the above alerting option.\n    enabled: false\n  openpitrix:          # (2 Core, 3.6 G) Whether to install KubeSphere Application Store. It provides an application store for Helm-based applications, and offer application lifecycle management.\n    enabled: false\n  servicemesh:         # (0.3 Core, 300 MiB) Whether to install KubeSphere Service Mesh (Istio-based). It provides fine-grained traffic management, observability and tracing, and offer visualization for traffic topology.\n    enabled: false\n')),Object(l.b)("h2",{id:"\u5378\u8f7d"},"\u5378\u8f7d"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(a.a)({parentName:"li"},{href:"https://github.com/kubesphere/ks-installer/blob/master/scripts/kubesphere-delete.sh"}),"scripts/kubesphere-delete.sh")),Object(l.b)("li",{parentName:"ul"},"\u4f1a\u7528\u5230 helm")),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"curl -LO https://raw.githubusercontent.com/kubesphere/ks-installer/master/scripts/kubesphere-delete.sh\nchmod +x kubesphere-delete.sh\n\n# alpine 3.12 \u5b89\u88c5 helm\napk add helm -X https://mirrors.aliyun.com/alpine/edge/testing/\n# K3S\nexport KUBECONFIG=/etc/rancher/k3s/k3s.yaml\n\n./kubesphere-delete.sh\n")))}o.isMDXComponent=!0},670:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return d}));var a=n(0),r=n.n(a);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=r.a.createContext({}),o=function(e){var t=r.a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):b(b({},t),e)),n},p=function(e){var t=o(e.components);return r.a.createElement(c.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},m=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,l=e.originalType,i=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),p=o(n),m=a,d=p["".concat(i,".").concat(m)]||p[m]||u[m]||l;return n?r.a.createElement(d,b(b({ref:t},c),{},{components:n})):r.a.createElement(d,b({ref:t},c))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var l=n.length,i=new Array(l);i[0]=m;var b={};for(var s in t)hasOwnProperty.call(t,s)&&(b[s]=t[s]);b.originalType=e,b.mdxType="string"==typeof e?e:a,i[1]=b;for(var c=2;c<l;c++)i[c]=n[c];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,n)}m.displayName="MDXCreateElement"}}]);