(window.webpackJsonp=window.webpackJsonp||[]).push([[838],{1107:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return d}));var a=n(0),r=n.n(a);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=r.a.createContext({}),b=function(e){var t=r.a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=b(e.components);return r.a.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},m=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,l=e.parentName,s=c(e,["components","mdxType","originalType","parentName"]),p=b(n),m=a,d=p["".concat(l,".").concat(m)]||p[m]||u[m]||i;return n?r.a.createElement(d,o(o({ref:t},s),{},{components:n})):r.a.createElement(d,o({ref:t},s))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,l=new Array(i);l[0]=m;var o={};for(var c in t)hasOwnProperty.call(t,c)&&(o[c]=t[c]);o.originalType=e,o.mdxType="string"==typeof e?e:a,l[1]=o;for(var s=2;s<i;s++)l[s]=n[s];return r.a.createElement.apply(null,l)}return r.a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},912:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return l})),n.d(t,"metadata",(function(){return o})),n.d(t,"toc",(function(){return c})),n.d(t,"default",(function(){return b}));var a=n(3),r=n(8),i=(n(0),n(1107)),l={id:"faq",title:"\u5e38\u89c1\u95ee\u9898"},o={unversionedId:"voip/asterisk/faq",id:"voip/asterisk/faq",isDocsHomePage:!1,title:"\u5e38\u89c1\u95ee\u9898",description:"Asterisk FAQ",source:"@site/notes/voip/asterisk/asterisk-faq.md",slug:"/voip/asterisk/faq",permalink:"/notes/voip/asterisk/faq",editUrl:"https://github.com/wenerme/wener/edit/master/notes/voip/asterisk/asterisk-faq.md",version:"current",sidebar:"docs",previous:{title:"\u62e8\u53f7\u8ba1\u5212",permalink:"/notes/voip/asterisk/asterisk-dialplain"},next:{title:"Asterisk \u8bcd\u6c47",permalink:"/notes/voip/asterisk/asterisk-glossary"}},c=[{value:"\u591a\u79df\u6237\u65b9\u5f0f",id:"\u591a\u79df\u6237\u65b9\u5f0f",children:[]},{value:"Everyone is busy/congested at this time (1:0/0/1)",id:"everyone-is-busycongested-at-this-time-1001",children:[]},{value:"verbose 3 Remote UNIX connection",id:"verbose-3-remote-unix-connection",children:[]},{value:"\u53d1\u8d77\u547c\u53eb\u8bbe\u7f6e CallerID",id:"\u53d1\u8d77\u547c\u53eb\u8bbe\u7f6e-callerid",children:[]},{value:"AES encryption disabled. Install OpenSSL.",id:"aes-encryption-disabled-install-openssl",children:[]},{value:"cel_pgsql.c:352 pgsql_log: Reason: ERROR: value too long for type character varying",id:"cel_pgsqlc352-pgsql_log-reason-error-value-too-long-for-type-character-varying",children:[]},{value:"Couldn&#39;t find mailbox 4021 in context default",id:"couldnt-find-mailbox-4021-in-context-default",children:[]},{value:"IAX2 status UNKNOWN",id:"iax2-status-unknown",children:[]},{value:"Dial \u63a5\u901a\u4e4b\u524d\u6ca1\u6709\u94c3\u58f0",id:"dial-\u63a5\u901a\u4e4b\u524d\u6ca1\u6709\u94c3\u58f0",children:[]},{value:"The canary is no more. He has ceased to be!",id:"the-canary-is-no-more-he-has-ceased-to-be",children:[]}],s={toc:c};function b(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(i.b)("wrapper",Object(a.a)({},s,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("h1",{id:"asterisk-faq"},"Asterisk FAQ"),Object(i.b)("h2",{id:"\u591a\u79df\u6237\u65b9\u5f0f"},"\u591a\u79df\u6237\u65b9\u5f0f"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"\u53ef\u4ee5\u5b9e\u73b0\u7b80\u5355\u7684\u591a\u79df\u6237",Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"\u4f7f\u7528 context \u9694\u79bb\u79df\u6237\u8def\u7531"),Object(i.b)("li",{parentName:"ul"},"\u4f7f\u7528 realm \u9694\u79bb\u79df\u6237\u7528\u6237"))),Object(i.b)("li",{parentName:"ul"},"\u590d\u6742\u591a\u79df\u6237\u5f88\u96be\u5b9e\u73b0",Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"\u4f8b\u5982 \u96be\u4ee5\u652f\u6301 meetme, message, transfer \u7b49"),Object(i.b)("li",{parentName:"ul"},"\u591a\u5957\u90e8\u7f72\u53ef\u80fd\u4f1a\u7b80\u5355\u70b9"))),Object(i.b)("li",{parentName:"ul"},"\u5176\u4ed6\u65b9\u6848",Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"\u4f7f\u7528 FreeSwitch - \u5bf9\u591a\u79df\u6237\u548c\u5927\u89c4\u6a21\u652f\u6301\u66f4\u597d"),Object(i.b)("li",{parentName:"ul"},"\u4f7f\u7528 Kamailio \u524d\u7aef\u5206\u6d41\u548c\u8d1f\u8f7d"))),Object(i.b)("li",{parentName:"ul"},"\u7c7b\u4f3c\u573a\u666f\u5546\u4e1a\u4ea7\u54c1",Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",{parentName:"li",href:"https://www.mirtapbx.com/architecture.html"},"MiRTA PBX")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",{parentName:"li",href:"https://www.vitalpbx.org/"},"Vital PBX")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",{parentName:"li",href:"https://www.indosoft.com/multi-tenant-pbx.htm"},"iHostPBX: Your Multi-Tenant PBX Setup Using Asterisk")))),Object(i.b)("li",{parentName:"ul"},"\u53c2\u8003",Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",{parentName:"li",href:"https://github.com/a4business/MPBX"},"a4business/MPBX"),"\nMultitenant PBX")))),Object(i.b)("h2",{id:"everyone-is-busycongested-at-this-time-1001"},"Everyone is busy/congested at this time (1:0/0/1)"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"\u5f00\u542f\u65e5\u5fd7\u6392\u67e5 ",Object(i.b)("inlineCode",{parentName:"li"},"pjsip set logger on")),Object(i.b)("li",{parentName:"ul"},"\u9047\u5230\u8fc7\u7684\u95ee\u9898",Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"488 Not Acceptable Here"),' Warning: 305 devnull "SDP: Incompatible media format: no common codec"',Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"\u88ab\u53eb\u8fd4\u56de\u4e0d\u652f\u6301\u7f16\u7801"),Object(i.b)("li",{parentName:"ul"},"\u5c1d\u8bd5 allow=all \u6765\u8fdb\u884c\u8c03\u8bd5 - \u7136\u540e\u518d\u4fee\u6539\u5141\u8bb8\u7684\u7f16\u7801"))))),Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",{parentName:"li",href:"https://feeding.cloud.geek.nz/posts/asterisk-everyone-busy-congested-at-this-time/"},"Mysterious 'everybody is busy/congested at this time' error in Asterisk"),Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"\u539f\u56e0\u662f\u88ab\u53eb\u8fd4\u56de\u4e86 ",Object(i.b)("inlineCode",{parentName:"li"},"Do Not Disturb")))),Object(i.b)("li",{parentName:"ul"},"pjsip contacts NonQual",Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"\u4e3a aor \u8bbe\u7f6e qualify \u95f4\u9694"))),Object(i.b)("li",{parentName:"ul"},"pjsip \u6ce8\u518c\u5230\u5bf9\u65b9 - \u5bf9\u65b9\u663e\u793a UNKNOWN",Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"\u5728 stun \u5b8c\u6210\u540e\u5373\u53ef\u6ce8\u518c\u6210\u529f")))),Object(i.b)("h2",{id:"verbose-3-remote-unix-connection"},"verbose 3 Remote UNIX connection"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"verbose \u8bbe\u7f6e\u4e3a 3 \u65f6\u975e\u5e38\u591a\u8fd9\u4e2a\u65e5\u5fd7"),Object(i.b)("li",{parentName:"ul"},"AMI \u8bf7\u6c42\u5bfc\u81f4 - \u4f8b\u5982 freepbx \u6216\u8005\u5176\u4ed6\u7f51\u5173\u63a5\u53e3\u8bf7\u6c42"),Object(i.b)("li",{parentName:"ul"},"SNMP \u8bf7\u6c42\u5bfc\u81f4"),Object(i.b)("li",{parentName:"ul"},"asterisk -r \u5bfc\u81f4")),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre"},"-- Remote UNIX connection\n-- Remote UNIX connection disconnected\n-- Remote UNIX connection\n-- Remote UNIX connection disconnected\n")),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"asterisk.conf")),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-ini"},"[options]\n# \u9690\u85cf remote console \u8fde\u63a5\u4fe1\u606f\nhideconnect=yes\n")),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-bash"},"# \u4fee\u6539\u540e\u91cd\u542f\nasterisk -rx 'core restart now'\n")),Object(i.b)("h2",{id:"\u53d1\u8d77\u547c\u53eb\u8bbe\u7f6e-callerid"},"\u53d1\u8d77\u547c\u53eb\u8bbe\u7f6e CallerID"),Object(i.b)("blockquote",null,Object(i.b)("p",{parentName:"blockquote"},"\u547d\u4ee4\u884c\u53d1\u8d77\u65e0\u6cd5\u8bbe\u7f6e")),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"#1 AMI \u53d1\u8d77")),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre"},"Action: Originate\nChannel: local/12345@outgoing\nApplication: Echo\nCallerID: Asterisk <12345>\n")),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"#2 extensions \u8bbe\u7f6e")),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-conf"},"[outgoing]\nexten => 12345,1,NoOp()\nsame => n,Verbose(1, Outgoing Caller ID: {$CALLERID(all)})\nsame => n,Dial(SIP/${EXTEN})\nsame => n,Hangup()\n\nexten => 12345,1,NoOp()\nsame => n,Set(CALLERID(num)=54321)\nsame => n,Set(CALLERID(name)=Asterisk)\nsame => n,Verbose(1, Outgoing Caller ID: {$CALLERID(all)})\nsame => n,Dial(SIP/${EXTEN})\nsame => n,Hangup()\n")),Object(i.b)("h2",{id:"aes-encryption-disabled-install-openssl"},"AES encryption disabled. Install OpenSSL."),Object(i.b)("p",null,"iax2 \u65f6\u53d1\u751f, \u52a0\u8f7d res_crypto"),Object(i.b)("h2",{id:"cel_pgsqlc352-pgsql_log-reason-error-value-too-long-for-type-character-varying"},"cel_pgsql.c:352 pgsql_log: Reason: ERROR: value too long for type character varying"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"\u5c06 CEL \u7684 APPDATA \u6539\u4e3a\u66f4\u957f\u7684\u7c7b\u578b, \u5982\u679c\u662f pg, \u5efa\u8bae\u76f4\u63a5\u6539\u4e3a text")),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre"},"[Sep 11 09:30:06] WARNING[3434]: cel_pgsql.c:351 pgsql_log: Failed to insert call detail record into database!\n[Sep 11 09:30:06] WARNING[3434]: cel_pgsql.c:352 pgsql_log: Reason: ERROR:  value too long for type character varying(255)\n")),Object(i.b)("h2",{id:"couldnt-find-mailbox-4021-in-context-default"},"Couldn't find mailbox 4021 in context default"),Object(i.b)("p",null,"\u6ce8\u610f, DADHI FXS \u751f\u6210\u7684\u914d\u7f6e\u6587\u4ef6\u4f1a\u9ed8\u8ba4\u6dfb\u52a0 voicemail, \u4f1a\u5bfc\u81f4\u51fa\u73b0\u975e\u5e38\u591a\u8fd9\u6837\u7684\u65e5\u5fd7"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre"},"[Sep 25 18:18:46] WARNING[3003]: app_voicemail.c:2476 __messagecount: Couldn't find mailbox 4021 in context default\n\n# \u5173\u95ed `app_voicemail` \u540e\u4f1a\u51fa\u73b0\u4e0b\u9762\u7684\u95ee\u9898\n\nNo voicemail provider registered.\n")),Object(i.b)("h2",{id:"iax2-status-unknown"},"IAX2 status UNKNOWN"),Object(i.b)("h2",{id:"dial-\u63a5\u901a\u4e4b\u524d\u6ca1\u6709\u94c3\u58f0"},"Dial \u63a5\u901a\u4e4b\u524d\u6ca1\u6709\u94c3\u58f0"),Object(i.b)("p",null,"\u53ef\u4ee5\u5728 Dial \u4e4b\u524d\u5148 Answer"),Object(i.b)("h2",{id:"the-canary-is-no-more-he-has-ceased-to-be"},"The canary is no more. He has ceased to be!"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-c"},'static void *canary_thread(void *unused)\n{\n    struct stat canary_stat;\n    struct timeval now;\n\n    /* Give the canary time to sing */\n    sleep(120);\n\n    for (;;) {\n        now = ast_tvnow();\n        if (stat(canary_filename, &canary_stat) || now.tv_sec > canary_stat.st_mtime + 60) {\n            ast_log(LOG_WARNING,\n                "The canary is no more.  He has ceased to be!  "\n                "He\'s expired and gone to meet his maker!  "\n                "He\'s a stiff!  Bereft of life, he rests in peace.  "\n                "His metabolic processes are now history!  He\'s off the twig!  "\n                "He\'s kicked the bucket.  He\'s shuffled off his mortal coil, "\n                "run down the curtain, and joined the bleeding choir invisible!!  "\n                "THIS is an EX-CANARY.  (Reducing priority)\\n");\n            set_priority_all(0);\n            pthread_exit(NULL);\n        }\n\n        /* Check the canary once a minute */\n        sleep(60);\n    }\n}\n')))}b.isMDXComponent=!0}}]);